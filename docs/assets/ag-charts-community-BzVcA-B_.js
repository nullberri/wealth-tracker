var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});var __defProp2=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__reflectGet=Reflect.get,__knownSymbol=__name((name,symbol)=>(symbol=Symbol[name])?symbol:Symbol.for("Symbol."+name),"__knownSymbol"),__pow=Math.pow,__defNormalProp=__name((obj,key,value)=>key in obj?__defProp2(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,"__defNormalProp"),__spreadValues=__name((a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},"__spreadValues"),__spreadProps=__name((a,b)=>__defProps(a,__getOwnPropDescs(b)),"__spreadProps"),__objRest=__name((source,exclude)=>{var target={};for(var prop in source)__hasOwnProp.call(source,prop)&&exclude.indexOf(prop)<0&&(target[prop]=source[prop]);if(source!=null&&__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(source))exclude.indexOf(prop)<0&&__propIsEnum.call(source,prop)&&(target[prop]=source[prop]);return target},"__objRest"),__export=__name((target,all)=>{for(var name in all)__defProp2(target,name,{get:all[name],enumerable:!0})},"__export"),__decorateClass=__name((decorators,target,key,kind)=>{for(var result=kind>1?void 0:kind?__getOwnPropDesc(target,key):target,i=decorators.length-1,decorator;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp2(target,key,result),result},"__decorateClass"),__superGet=__name((cls,obj,key)=>__reflectGet(__getProtoOf(cls),key,obj),"__superGet"),__async=__name((__this,__arguments,generator)=>new Promise((resolve,reject)=>{var fulfilled=__name(value=>{try{step(generator.next(value))}catch(e){reject(e)}},"fulfilled"),rejected=__name(value=>{try{step(generator.throw(value))}catch(e){reject(e)}},"rejected"),step=__name(x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected),"step");step((generator=generator.apply(__this,__arguments)).next())}),"__async"),__await=__name(function(promise,isYieldStar){this[0]=promise,this[1]=isYieldStar},"__await"),__yieldStar=__name(value=>{var obj=value[__knownSymbol("asyncIterator")],isAwait=!1,method,it={};return obj==null?(obj=value[__knownSymbol("iterator")](),method=__name(k=>it[k]=x=>obj[k](x),"method")):(obj=obj.call(value),method=__name(k=>it[k]=v=>{if(isAwait){if(isAwait=!1,k==="throw")throw v;return v}return isAwait=!0,{done:!1,value:new __await(new Promise(resolve=>{var x=obj[k](v);if(!(x instanceof Object))throw TypeError("Object expected");resolve(x)}),1)}},"method")),it[__knownSymbol("iterator")]=()=>it,method("next"),"throw"in obj?method("throw"):it.throw=x=>{throw x},"return"in obj&&method("return"),it},"__yieldStar"),AgTooltipPositionType=(AgTooltipPositionType2=>(AgTooltipPositionType2.POINTER="pointer",AgTooltipPositionType2.NODE="node",AgTooltipPositionType2))(AgTooltipPositionType||{}),time_exports={};__export(time_exports,{day:()=>day,friday:()=>friday,hour:()=>hour,millisecond:()=>millisecond,minute:()=>minute,monday:()=>monday,month:()=>month,saturday:()=>saturday,second:()=>second,sunday:()=>sunday,thursday:()=>thursday,tuesday:()=>tuesday,utcDay:()=>utcDay,utcHour:()=>utcHour,utcMinute:()=>utcMinute,utcMonth:()=>utcMonth,utcYear:()=>utcYear,wednesday:()=>wednesday,year:()=>year});var doOnceState=new Map;function doOnce(func,key){doOnceState.has(key)||(doOnceState.set(key,!0),func())}__name(doOnce,"doOnce");doOnce.clear=()=>doOnceState.clear();function identity(x){return x}__name(identity,"identity");function debounce(callback,waitMs=0,options){const{leading=!1,trailing=!0,maxWait=1/0}=options??{};let timerId,startTime;if(maxWait<waitMs)throw new Error("Value of maxWait cannot be lower than waitMs.");function debounceCallback(...args){if(leading&&!startTime){startTime=Date.now(),timerId=setTimeout(()=>startTime=null,waitMs),callback(...args);return}let adjustedWaitMs=waitMs;if(maxWait!==1/0&&startTime){const elapsedTime=Date.now()-startTime;waitMs>maxWait-elapsedTime&&(adjustedWaitMs=maxWait-elapsedTime)}clearTimeout(timerId),startTime??(startTime=Date.now()),timerId=setTimeout(()=>{startTime=null,trailing&&callback(...args)},adjustedWaitMs)}return __name(debounceCallback,"debounceCallback"),Object.assign(debounceCallback,{cancel(){clearTimeout(timerId),startTime=null}})}__name(debounce,"debounce");function throttle(callback,waitMs=0,options){const{leading=!0,trailing=!0}=options??{};let timerId,lastArgs,shouldWait=!1;function timeoutHandler(){trailing&&lastArgs?(timerId=setTimeout(timeoutHandler,waitMs),callback(...lastArgs)):shouldWait=!1,lastArgs=null}__name(timeoutHandler,"timeoutHandler");function throttleCallback(...args){shouldWait?lastArgs=args:(shouldWait=!0,timerId=setTimeout(timeoutHandler,waitMs),leading?callback(...args):lastArgs=args)}return __name(throttleCallback,"throttleCallback"),Object.assign(throttleCallback,{cancel(){clearTimeout(timerId),shouldWait=!1,lastArgs=null}})}__name(throttle,"throttle");var Logger={log(...logContent){console.log(...logContent)},warn(message,...logContent){console.warn(`AG Charts - ${message}`,...logContent)},error(message,...logContent){typeof message=="object"?console.error("AG Charts error",message,...logContent):console.error(`AG Charts - ${message}`,...logContent)},table(...logContent){console.table(...logContent)},warnOnce(message,...logContent){doOnce(()=>Logger.warn(message,...logContent),`Logger.warn: ${message}`)},errorOnce(message,...logContent){doOnce(()=>Logger.error(message,...logContent),`Logger.error: ${message}`)}},_a,TimeInterval=(_a=class{constructor(_encode,_decode,_rangeCallback){this._encode=_encode,this._decode=_decode,this._rangeCallback=_rangeCallback}floor(date){const d=new Date(date),e=this._encode(d);return this._decode(e)}ceil(date){const d=new Date(Number(date)-1),e=this._encode(d);return this._decode(e+1)}range(start,stop,extend){var _a201;const rangeCallback=(_a201=this._rangeCallback)==null?void 0:_a201.call(this,start,stop),e0=this._encode(extend?this.floor(start):this.ceil(start)),e1=this._encode(extend?this.ceil(stop):this.floor(stop));if(e1<e0)return[];const range3=[];for(let e=e0;e<=e1;e++){const d=this._decode(e);range3.push(d)}return rangeCallback==null||rangeCallback(),range3}},__name(_a,"TimeInterval"),_a),_a2,CountableTimeInterval=(_a2=class extends TimeInterval{getOffset(snapTo,step){const s=typeof snapTo=="number"||snapTo instanceof Date?this._encode(new Date(snapTo)):0;return Math.floor(s)%step}every(step,options){let offset4=0,rangeCallback;const unsafeStep=step;step=Math.max(1,Math.round(step)),unsafeStep!==step&&Logger.warnOnce(`interval step of [${unsafeStep}] rounded to [${step}].`);const{snapTo="start"}=options??{};if(typeof snapTo=="string"){const initialOffset=offset4;rangeCallback=__name((start,stop)=>{const s=snapTo==="start"?start:stop;return offset4=this.getOffset(s,step),()=>offset4=initialOffset},"rangeCallback")}else typeof snapTo=="number"?offset4=this.getOffset(new Date(snapTo),step):snapTo instanceof Date&&(offset4=this.getOffset(snapTo,step));const encode13=__name(date=>{const e=this._encode(date);return Math.floor((e-offset4)/step)},"encode13"),decode13=__name(encoded=>this._decode(encoded*step+offset4),"decode13");return new TimeInterval(encode13,decode13,rangeCallback)}},__name(_a2,"CountableTimeInterval"),_a2);function encode(date){return date.getTime()}__name(encode,"encode");function decode(encoded){return new Date(encoded)}__name(decode,"decode");var millisecond=new CountableTimeInterval(encode,decode),millisecond_default=millisecond;new Date(0).getFullYear();var durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,offset=new Date().getTimezoneOffset()*durationMinute;function encode2(date){return Math.floor((date.getTime()-offset)/durationSecond)}__name(encode2,"encode2");function decode2(encoded){return new Date(offset+encoded*durationSecond)}__name(decode2,"decode2");var second=new CountableTimeInterval(encode2,decode2),second_default=second,offset2=new Date().getTimezoneOffset()*durationMinute;function encode3(date){return Math.floor((date.getTime()-offset2)/durationMinute)}__name(encode3,"encode3");function decode3(encoded){return new Date(offset2+encoded*durationMinute)}__name(decode3,"decode3");var minute=new CountableTimeInterval(encode3,decode3),minute_default=minute,offset3=new Date().getTimezoneOffset()*durationMinute;function encode4(date){return Math.floor((date.getTime()-offset3)/durationHour)}__name(encode4,"encode4");function decode4(encoded){return new Date(offset3+encoded*durationHour)}__name(decode4,"decode4");var hour=new CountableTimeInterval(encode4,decode4),hour_default=hour;function encode5(date){const tzOffsetMs=date.getTimezoneOffset()*durationMinute;return Math.floor((date.getTime()-tzOffsetMs)/durationDay)}__name(encode5,"encode5");function decode5(encoded){const d=new Date(1970,0,1);return d.setDate(d.getDate()+encoded),d}__name(decode5,"decode5");var day=new CountableTimeInterval(encode5,decode5),day_default=day;function weekday(weekStart){const dayShift=(7+weekStart-4)%7;function encode13(date){const tzOffsetMs=date.getTimezoneOffset()*durationMinute;return Math.floor((date.getTime()-tzOffsetMs)/durationWeek-dayShift/7)}__name(encode13,"encode13");function decode13(encoded){const d=new Date(1970,0,1);return d.setDate(d.getDate()+encoded*7+dayShift),d}return __name(decode13,"decode13"),new CountableTimeInterval(encode13,decode13)}__name(weekday,"weekday");var sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6),week_default=sunday;function encode6(date){return date.getFullYear()*12+date.getMonth()}__name(encode6,"encode6");function decode6(encoded){const year2=Math.floor(encoded/12),month2=encoded-year2*12;return new Date(year2,month2,1)}__name(decode6,"decode6");var month=new CountableTimeInterval(encode6,decode6),month_default=month;function encode7(date){return date.getFullYear()}__name(encode7,"encode7");function decode7(encoded){const d=new Date;return d.setFullYear(encoded),d.setMonth(0,1),d.setHours(0,0,0,0),d}__name(decode7,"decode7");var year=new CountableTimeInterval(encode7,decode7),year_default=year;function encode8(date){return Math.floor(date.getTime()/durationMinute)}__name(encode8,"encode8");function decode8(encoded){return new Date(encoded*durationMinute)}__name(decode8,"decode8");var utcMinute=new CountableTimeInterval(encode8,decode8);function encode9(date){return Math.floor(date.getTime()/durationHour)}__name(encode9,"encode9");function decode9(encoded){return new Date(encoded*durationHour)}__name(decode9,"decode9");var utcHour=new CountableTimeInterval(encode9,decode9);function encode10(date){return Math.floor(date.getTime()/durationDay)}__name(encode10,"encode10");function decode10(encoded){const d=new Date(0);return d.setUTCDate(d.getUTCDate()+encoded),d.setUTCHours(0,0,0,0),d}__name(decode10,"decode10");var utcDay=new CountableTimeInterval(encode10,decode10);function encode11(date){return date.getUTCFullYear()*12+date.getUTCMonth()}__name(encode11,"encode11");function decode11(encoded){const year2=Math.floor(encoded/12),month2=encoded-year2*12;return new Date(Date.UTC(year2,month2,1))}__name(decode11,"decode11");var utcMonth=new CountableTimeInterval(encode11,decode11);function encode12(date){return date.getUTCFullYear()}__name(encode12,"encode12");function decode12(encoded){const d=new Date;return d.setUTCFullYear(encoded),d.setUTCMonth(0,1),d.setUTCHours(0,0,0,0),d}__name(decode12,"decode12");var utcYear=new CountableTimeInterval(encode12,decode12),enterpriseModule={isEnterprise:!1},_a3,BaseModuleInstance=(_a3=class{constructor(){this.destroyFns=[]}destroy(){for(const destroyFn of this.destroyFns)destroyFn()}},__name(_a3,"BaseModuleInstance"),_a3),REGISTERED_MODULES=[];function registerModule(module){const otherModule=REGISTERED_MODULES.find(other=>module.type===other.type&&module.optionsKey===other.optionsKey&&module.identifier===other.identifier);if(otherModule){if(module.packageType==="enterprise"&&otherModule.packageType==="community"){const index=REGISTERED_MODULES.indexOf(otherModule);REGISTERED_MODULES.splice(index,1,module)}}else REGISTERED_MODULES.push(module)}__name(registerModule,"registerModule");function hasRegisteredEnterpriseModules(){return REGISTERED_MODULES.some(m=>m.packageType==="enterprise")}__name(hasRegisteredEnterpriseModules,"hasRegisteredEnterpriseModules");var AXIS_CONSTRUCTORS={};function registerAxis(axisType,ctor){AXIS_CONSTRUCTORS[axisType]=ctor}__name(registerAxis,"registerAxis");function getAxis(axisType,moduleCtx){const axisConstructor=AXIS_CONSTRUCTORS[axisType];if(axisConstructor)return new axisConstructor(moduleCtx);throw new Error(`AG Charts - unknown axis type: ${axisType}`)}__name(getAxis,"getAxis");var AXIS_TYPES={has(axisType){return Object.hasOwn(AXIS_CONSTRUCTORS,axisType)},get axesTypes(){return Object.keys(AXIS_CONSTRUCTORS)}},AXIS_THEME_TEMPLATES={};function registerAxisThemeTemplate(axisType,theme){AXIS_THEME_TEMPLATES[axisType]=theme}__name(registerAxisThemeTemplate,"registerAxisThemeTemplate");function getAxisThemeTemplate(axisType){var _a201;return(_a201=AXIS_THEME_TEMPLATES[axisType])!=null?_a201:{}}__name(getAxisThemeTemplate,"getAxisThemeTemplate");var BREAK_TRANSFORM_CHAIN=Symbol("BREAK"),CONFIG_KEY="__decorator_config";function initialiseConfig(target,propertyKeyOrSymbol){Object.getOwnPropertyDescriptor(target,CONFIG_KEY)==null&&Object.defineProperty(target,CONFIG_KEY,{value:{}});const config=target[CONFIG_KEY],propertyKey=propertyKeyOrSymbol.toString();if(typeof config[propertyKey]<"u")return config[propertyKey];const valuesMap=new WeakMap;config[propertyKey]={setters:[],getters:[],observers:[],valuesMap};const descriptor=Object.getOwnPropertyDescriptor(target,propertyKeyOrSymbol),prevSet=descriptor==null?void 0:descriptor.set,prevGet=descriptor==null?void 0:descriptor.get;return Object.defineProperty(target,propertyKeyOrSymbol,{set:__name(function(value){const{setters,observers}=config[propertyKey];let oldValue;setters.some(f=>f.length>2)&&(oldValue=prevGet?prevGet.call(this):valuesMap.get(this));for(const transformFn of setters)if(value=transformFn(this,propertyKeyOrSymbol,value,oldValue),value===BREAK_TRANSFORM_CHAIN)return;prevSet?prevSet.call(this,value):valuesMap.set(this,value);for(const observerFn of observers)observerFn(this,value,oldValue)},"setter"),get:__name(function(){let value=prevGet?prevGet.call(this):valuesMap.get(this);for(const transformFn of config[propertyKey].getters)if(value=transformFn(this,propertyKeyOrSymbol,value),value===BREAK_TRANSFORM_CHAIN)return;return value},"getter"),enumerable:!0,configurable:!1}),config[propertyKey]}__name(initialiseConfig,"initialiseConfig");function addTransformToInstanceProperty(setTransform,getTransform,configMetadata){return(target,propertyKeyOrSymbol)=>{const config=initialiseConfig(target,propertyKeyOrSymbol);config.setters.push(setTransform),getTransform&&config.getters.unshift(getTransform),configMetadata&&Object.assign(config,configMetadata)}}__name(addTransformToInstanceProperty,"addTransformToInstanceProperty");function addObserverToInstanceProperty(setObserver){return(target,propertyKeyOrSymbol)=>{initialiseConfig(target,propertyKeyOrSymbol).observers.push(setObserver)}}__name(addObserverToInstanceProperty,"addObserverToInstanceProperty");function isDecoratedObject(target){return typeof target<"u"&&CONFIG_KEY in target}__name(isDecoratedObject,"isDecoratedObject");function listDecoratedProperties(target){const targets=new Set;for(;isDecoratedObject(target);)targets.add(target==null?void 0:target[CONFIG_KEY]),target=Object.getPrototypeOf(target);return Array.from(targets).flatMap(configMap=>Object.keys(configMap))}__name(listDecoratedProperties,"listDecoratedProperties");function extractDecoratedProperties(target){return listDecoratedProperties(target).reduce((result,key)=>{var _a201;return result[key]=(_a201=target[key])!=null?_a201:null,result},{})}__name(extractDecoratedProperties,"extractDecoratedProperties");function extractDecoratedPropertyMetadata(target,propertyKeyOrSymbol){const propertyKey=propertyKeyOrSymbol.toString();for(;isDecoratedObject(target);){const config=target[CONFIG_KEY];if(Object.hasOwn(config,propertyKey))return config[propertyKey];target=Object.getPrototypeOf(target)}}__name(extractDecoratedPropertyMetadata,"extractDecoratedPropertyMetadata");function isDefined(val){return val!=null}__name(isDefined,"isDefined");function isArray(value){return Array.isArray(value)}__name(isArray,"isArray");function isBoolean(value){return typeof value=="boolean"}__name(isBoolean,"isBoolean");function isDate(value){return value instanceof Date}__name(isDate,"isDate");function isValidDate(value){return isDate(value)&&!isNaN(Number(value))}__name(isValidDate,"isValidDate");function isRegExp(value){return value instanceof RegExp}__name(isRegExp,"isRegExp");function isFunction(value){return typeof value=="function"}__name(isFunction,"isFunction");function isObject(value){return typeof value=="object"&&value!==null&&!isArray(value)}__name(isObject,"isObject");function isObjectLike(value){return isArray(value)||isPlainObject(value)}__name(isObjectLike,"isObjectLike");function isPlainObject(value){return typeof value=="object"&&value!==null&&value.constructor===Object}__name(isPlainObject,"isPlainObject");function isString(value){return typeof value=="string"}__name(isString,"isString");function isNumber(value){return typeof value=="number"}__name(isNumber,"isNumber");function isFiniteNumber(value){return isNumber(value)&&Number.isFinite(value)}__name(isFiniteNumber,"isFiniteNumber");function isHtmlElement(value){return typeof window<"u"&&value instanceof HTMLElement}__name(isHtmlElement,"isHtmlElement");function isEnumKey(enumObject,enumKey){return isString(enumKey)&&Object.keys(enumObject).includes(enumKey)}__name(isEnumKey,"isEnumKey");function isEnumValue(enumObject,enumValue){return Object.values(enumObject).includes(enumValue)}__name(isEnumValue,"isEnumValue");function isSymbol(value){return typeof value=="symbol"}__name(isSymbol,"isSymbol");function deepMerge(...sources){return mergeDefaults(...sources.reverse())}__name(deepMerge,"deepMerge");function mergeDefaults(...sources){var _a201;const target={};for(const source of sources){if(!isObject(source))continue;const keys=isDecoratedObject(source)?listDecoratedProperties(source):Object.keys(source);for(const key of keys)isPlainObject(target[key])&&isPlainObject(source[key])?target[key]=mergeDefaults(target[key],source[key]):(_a201=target[key])!=null||(target[key]=source[key])}return target}__name(mergeDefaults,"mergeDefaults");function mergeArrayDefaults(dataArray,...itemDefaults){return itemDefaults&&isArray(dataArray)?dataArray.map(item=>mergeDefaults(item,...itemDefaults)):dataArray}__name(mergeArrayDefaults,"mergeArrayDefaults");function mapValues(object,mapper){return Object.entries(object).reduce((result,[key,value])=>(result[key]=mapper(value,key,object),result),{})}__name(mapValues,"mapValues");function getPath(object,path){return(isArray(path)?path:path.split(".")).reduce((value,pathKey)=>value[pathKey],object)}__name(getPath,"getPath");function setPath(object,path,newValue){const pathArray=isArray(path)?path.slice():path.split("."),lastKey=pathArray.pop(),lastObject=pathArray.reduce((value,pathKey)=>value[pathKey],object);lastObject[lastKey]=newValue}__name(setPath,"setPath");function partialAssign(keysToCopy,target,source){if(source===void 0)return target;for(const key of keysToCopy){const value=source[key];value!==void 0&&(target[key]=value)}return target}__name(partialAssign,"partialAssign");var TYPES={},DEFAULTS={},CHART_TYPES={has(seriesType){return Object.hasOwn(TYPES,seriesType)},isCartesian(seriesType){return TYPES[seriesType]==="cartesian"},isPolar(seriesType){return TYPES[seriesType]==="polar"},isHierarchy(seriesType){return TYPES[seriesType]==="hierarchy"},get seriesTypes(){return Object.keys(TYPES)},get cartesianTypes(){return this.seriesTypes.filter(t=>this.isCartesian(t))},get polarTypes(){return this.seriesTypes.filter(t=>this.isPolar(t))},get hierarchyTypes(){return this.seriesTypes.filter(t=>this.isHierarchy(t))}};function registerChartSeriesType(seriesType,chartType2){TYPES[seriesType]=chartType2}__name(registerChartSeriesType,"registerChartSeriesType");function registerChartDefaults(chartType2,defaults){DEFAULTS[chartType2]=mergeDefaults(defaults,DEFAULTS[chartType2])}__name(registerChartDefaults,"registerChartDefaults");function getChartDefaults(chartType2){var _a201;return(_a201=DEFAULTS[chartType2])!=null?_a201:{}}__name(getChartDefaults,"getChartDefaults");function getChartType(seriesType){var _a201;return(_a201=TYPES[seriesType])!=null?_a201:"unknown"}__name(getChartType,"getChartType");var EXPECTED_ENTERPRISE_MODULES=[{type:"root",optionsKey:"animation",chartTypes:["cartesian","polar","hierarchy"]},{type:"root",optionsKey:"background",chartTypes:["cartesian","polar","hierarchy"],optionsInnerKey:"image"},{type:"root",optionsKey:"contextMenu",chartTypes:["cartesian","polar","hierarchy"]},{type:"root",optionsKey:"dataSource",chartTypes:["cartesian","polar","hierarchy"]},{type:"root",optionsKey:"sync",chartTypes:["cartesian"]},{type:"root",optionsKey:"zoom",chartTypes:["cartesian"]},{type:"legend",optionsKey:"gradientLegend",chartTypes:["cartesian","polar","hierarchy"],identifier:"gradient"},{type:"root",optionsKey:"navigator",chartTypes:["cartesian"],optionsInnerKey:"miniChart"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-number"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-number"},{type:"axis-option",optionsKey:"crosshair",chartTypes:["cartesian"]},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"box-plot"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"bullet"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"heatmap"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"nightingale"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-area"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-line"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-bar"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-column"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-area"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-bar"},{type:"series",optionsKey:"series[]",chartTypes:["hierarchy"],identifier:"sunburst"},{type:"series",optionsKey:"series[]",chartTypes:["hierarchy"],identifier:"treemap"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"waterfall"},{type:"series-option",optionsKey:"errorBar",chartTypes:["cartesian"],identifier:"error-bars"}];function isEnterpriseSeriesType(type){return EXPECTED_ENTERPRISE_MODULES.some(s=>s.type==="series"&&s.identifier===type)}__name(isEnterpriseSeriesType,"isEnterpriseSeriesType");function getEnterpriseSeriesChartTypes(type){var _a201;return(_a201=EXPECTED_ENTERPRISE_MODULES.find(s=>s.type==="series"&&s.identifier===type))==null?void 0:_a201.chartTypes}__name(getEnterpriseSeriesChartTypes,"getEnterpriseSeriesChartTypes");function isEnterpriseSeriesTypeLoaded(type){var _a201,_b;return((_b=(_a201=EXPECTED_ENTERPRISE_MODULES.find(s=>s.type==="series"&&s.identifier===type))==null?void 0:_a201.useCount)!=null?_b:0)>0}__name(isEnterpriseSeriesTypeLoaded,"isEnterpriseSeriesTypeLoaded");function isEnterpriseCartesian(seriesType){var _a201;return((_a201=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a201.find(v=>v==="cartesian"))==="cartesian"}__name(isEnterpriseCartesian,"isEnterpriseCartesian");function isEnterprisePolar(seriesType){var _a201;return((_a201=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a201.find(v=>v==="polar"))==="polar"}__name(isEnterprisePolar,"isEnterprisePolar");function isEnterpriseHierarchy(seriesType){var _a201;return((_a201=getEnterpriseSeriesChartTypes(seriesType))==null?void 0:_a201.find(v=>v==="hierarchy"))==="hierarchy"}__name(isEnterpriseHierarchy,"isEnterpriseHierarchy");function isEnterpriseModule(module){return module.packageType==="enterprise"}__name(isEnterpriseModule,"isEnterpriseModule");function verifyIfModuleExpected(module){var _a201;if(!isEnterpriseModule(module))throw new Error("AG Charts - internal configuration error, only enterprise modules need verification.");const stub=EXPECTED_ENTERPRISE_MODULES.find(s=>s.type===module.type&&s.optionsKey===module.optionsKey&&s.identifier===module.identifier&&module.chartTypes.every(t=>s.chartTypes.includes(t)));return stub&&((_a201=stub.useCount)!=null||(stub.useCount=0),stub.useCount++),stub!=null}__name(verifyIfModuleExpected,"verifyIfModuleExpected");function getUnusedExpectedModules(){return EXPECTED_ENTERPRISE_MODULES.filter(({useCount})=>useCount==null||useCount===0)}__name(getUnusedExpectedModules,"getUnusedExpectedModules");function optionsType(input){var _a201,_b,_c;return(_c=(_b=(_a201=input.series)==null?void 0:_a201[0])==null?void 0:_b.type)!=null?_c:"line"}__name(optionsType,"optionsType");function isAgCartesianChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!0:specifiedType==="cartesian"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):CHART_TYPES.isCartesian(specifiedType)||isEnterpriseCartesian(specifiedType)}__name(isAgCartesianChartOptions,"isAgCartesianChartOptions");function isAgHierarchyChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!1:specifiedType==="hierarchy"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):CHART_TYPES.isHierarchy(specifiedType)||isEnterpriseHierarchy(specifiedType)}__name(isAgHierarchyChartOptions,"isAgHierarchyChartOptions");function isAgPolarChartOptions(input){const specifiedType=optionsType(input);return specifiedType==null?!1:specifiedType==="polar"?(Logger.warnOnce(`type '${specifiedType}' is deprecated, use a series type instead`),!0):CHART_TYPES.isPolar(specifiedType)||isEnterprisePolar(specifiedType)}__name(isAgPolarChartOptions,"isAgPolarChartOptions");function isAgPolarChartOptionsWithSeriesBasedLegend(input){const specifiedType=optionsType(input);return isAgPolarChartOptions(input)&&specifiedType!=="pie"&&specifiedType!=="donut"}__name(isAgPolarChartOptionsWithSeriesBasedLegend,"isAgPolarChartOptionsWithSeriesBasedLegend");function isSeriesOptionType(input){return input==null?!1:CHART_TYPES.has(input)}__name(isSeriesOptionType,"isSeriesOptionType");function isAxisOptionType(input){return input==null?!1:AXIS_TYPES.has(input)}__name(isAxisOptionType,"isAxisOptionType");function removeUsedEnterpriseOptions(options){var _a201,_b,_c,_d;const usedOptions=[],optionsChartType=getChartType(optionsType(options));for(const{type,chartTypes,optionsKey,optionsInnerKey,identifier}of EXPECTED_ENTERPRISE_MODULES)if(!(optionsChartType!=="unknown"&&!chartTypes.includes(optionsChartType))){if(type==="root"||type==="legend"){const optionValue=options[optionsKey];if(optionValue==null)continue;optionsInnerKey?optionValue[optionsInnerKey]&&(usedOptions.push(`${optionsKey}.${optionsInnerKey}`),delete optionValue[optionsInnerKey]):(usedOptions.push(optionsKey),delete options[optionsKey])}else if(type==="axis"){if(!("axes"in options)||!((_a201=options.axes)!=null&&_a201.some(axis=>axis.type===identifier)))continue;usedOptions.push(`axis[type=${identifier}]`),options.axes=options.axes.filter(axis=>axis.type!==identifier)}else if(type==="axis-option"){if(!("axes"in options)||!((_b=options.axes)!=null&&_b.some(axis=>axis[optionsKey])))continue;usedOptions.push(`axis.${optionsKey}`),options.axes.forEach(axis=>{axis[optionsKey]&&delete axis[optionsKey]})}else if(type==="series"){if(!((_c=options.series)!=null&&_c.some(series=>series.type===identifier)))continue;usedOptions.push(`series[type=${identifier}]`),options.series=options.series.filter(series=>series.type!==identifier)}else if(type==="series-option"){if(!((_d=options.series)!=null&&_d.some(series=>series[optionsKey])))continue;usedOptions.push(`series.${optionsKey}`),options.series.forEach(series=>{series[optionsKey]&&delete series[optionsKey]})}}usedOptions.length&&Logger.warnOnce([`unable to use these enterprise features as 'ag-charts-enterprise' has not been loaded:
`,"",...usedOptions,"","See: https://charts.ag-grid.com/javascript/installation/"].join(`
`))}__name(removeUsedEnterpriseOptions,"removeUsedEnterpriseOptions");var _a4,BaseProperties=(_a4=class{constructor(className){this.className=className}set(properties){const keys=new Set(Object.keys(properties));for(const propertyKey of listDecoratedProperties(this))if(keys.has(propertyKey)){const value=properties[propertyKey],self=this;isProperties(self[propertyKey])?self[propertyKey]=self[propertyKey]instanceof PropertiesArray?self[propertyKey].reset(value):self[propertyKey].set(value):self[propertyKey]=value,keys.delete(propertyKey)}for(const unknownKey of keys){const{className=this.constructor.name}=this.constructor;Logger.warn(`unable to set [${unknownKey}] in ${className} - property is unknown`)}return this}isValid(){return listDecoratedProperties(this).every(propertyKey=>{const{optional}=extractDecoratedPropertyMetadata(this,propertyKey);return optional||typeof this[propertyKey]<"u"})}toJson(){return listDecoratedProperties(this).reduce((object,propertyKey)=>{const propertyValue=this[propertyKey];return object[propertyKey]=isProperties(propertyValue)?propertyValue.toJson():propertyValue,object},{})}},__name(_a4,"BaseProperties"),_a4),_a5,PropertiesArray=(_a5=class extends Array{constructor(itemFactory,...properties){super(properties.length),Object.defineProperty(this,"itemFactory",{value:itemFactory,enumerable:!1,configurable:!1}),this.set(properties)}set(properties){if(isArray(properties)){this.length=properties.length;for(let i=0;i<properties.length;i++)this[i]=new this.itemFactory().set(properties[i])}return this}reset(properties){return new _a5(this.itemFactory,...properties)}toJson(){return this.slice()}},__name(_a5,"_PropertiesArray"),_a5);function isProperties(value){return value instanceof BaseProperties||value instanceof PropertiesArray}__name(isProperties,"isProperties");var CLASS_INSTANCE_TYPE="class-instance";function jsonDiff(source,target){if(isArray(target)){if(!isArray(source)||source.length!==target.length||target.some((v,i)=>jsonDiff(source[i],v)!=null))return target}else if(isPlainObject(target)){if(!isPlainObject(source))return target;const result={},allKeys=new Set([...Object.keys(source),...Object.keys(target)]);for(const key of allKeys)if(source[key]!==target[key])if(typeof source[key]!=typeof target[key])result[key]=target[key];else{const diff2=jsonDiff(source[key],target[key]);diff2!==null&&(result[key]=diff2)}return Object.keys(result).length?result:null}else if(source!==target)return target;return null}__name(jsonDiff,"jsonDiff");function deepClone(source,options){return isArray(source)?source.map(item=>deepClone(item,options)):isPlainObject(source)?Object.entries(source).reduce((result,[key,value])=>{var _a201;return result[key]=(_a201=options==null?void 0:options.shallow)!=null&&_a201.includes(key)?shallowClone(value):deepClone(value,options),result},{}):shallowClone(source)}__name(deepClone,"deepClone");function shallowClone(source){return isArray(source)?[...source]:isPlainObject(source)?__spreadValues({},source):isDate(source)?new Date(source):isRegExp(source)?new RegExp(source.source,source.flags):source}__name(shallowClone,"shallowClone");function jsonWalk(json,visit,opts,...jsons){var _a201;if(isArray(json))visit(json,...jsons),json.forEach((node,index)=>{jsonWalk(node,visit,opts,...keyMapper(jsons,index))});else if(isPlainObject(json)){visit(json,...jsons);for(const key of Object.keys(json)){if((_a201=opts==null?void 0:opts.skip)!=null&&_a201.includes(key))continue;const value=json[key];(isArray(value)||isPlainObject(value))&&jsonWalk(value,visit,opts,...keyMapper(jsons,key))}}}__name(jsonWalk,"jsonWalk");function jsonApply(target,source,params={}){var _a201,_b,_c;const{path,matcherPath=path?path.replace(/(\[[0-9+]+])/i,"[]"):void 0,skip=[],constructors={},constructedArrays=new WeakMap,allowedTypes={},idx}=params;if(target==null)throw new Error(`AG Charts - target is uninitialised: ${path??"<root>"}`);if(source==null)return target;if(isProperties(target))return target.set(source);const targetAny=target;idx!=null&&"_declarationOrder"in targetAny&&(targetAny._declarationOrder=idx);const targetType=classify(target);for(const property in source){const propertyMatcherPath=`${matcherPath?matcherPath+".":""}${property}`;if(skip.indexOf(propertyMatcherPath)>=0)continue;const newValue=source[property],propertyPath=`${path?path+".":""}${property}`,targetClass=targetAny.constructor,currentValue=targetAny[property];let ctr=(_a201=constructors[propertyMatcherPath])!=null?_a201:constructors[property];try{const currentValueType=classify(currentValue),newValueType=classify(newValue);if(targetType===CLASS_INSTANCE_TYPE&&!(property in target||Object.hasOwn(targetAny,property))){Logger.warn(`unable to set [${propertyPath}] in ${targetClass==null?void 0:targetClass.name} - property is unknown`);continue}const allowableTypes=(_b=allowedTypes[propertyMatcherPath])!=null?_b:[currentValueType];if(!(currentValueType===CLASS_INSTANCE_TYPE&&newValueType==="object")){if(currentValueType!=null&&newValueType!=null&&!allowableTypes.includes(newValueType)){Logger.warn(`unable to set [${propertyPath}] in ${targetClass==null?void 0:targetClass.name} - can't apply type of [${newValueType}], allowed types are: [${allowableTypes}]`);continue}}if(newValueType==="array")if(ctr=(_c=ctr??constructedArrays.get(currentValue))!=null?_c:constructors[`${propertyMatcherPath}[]`],isProperties(targetAny[property]))targetAny[property].set(newValue);else if(ctr!=null){const newValueArray=newValue;targetAny[property]=newValueArray.map((v,idx2)=>jsonApply(new ctr,v,__spreadProps(__spreadValues({},params),{path:propertyPath,matcherPath:propertyMatcherPath+"[]",idx:idx2})))}else targetAny[property]=newValue;else if(newValueType===CLASS_INSTANCE_TYPE)targetAny[property]=newValue;else if(newValueType==="object")if(isProperties(currentValue))targetAny[property].set(newValue);else if(currentValue!=null)jsonApply(currentValue,newValue,__spreadProps(__spreadValues({},params),{path:propertyPath,matcherPath:propertyMatcherPath,idx:void 0}));else if(ctr!=null){const obj=new ctr;isProperties(obj)?targetAny[property]=obj.set(newValue):targetAny[property]=jsonApply(obj,newValue,__spreadProps(__spreadValues({},params),{path:propertyPath,matcherPath:propertyMatcherPath,idx:void 0}))}else targetAny[property]=newValue;else isProperties(targetAny[property])?targetAny[property].set(newValue):targetAny[property]=newValue}catch(error){Logger.warn(`unable to set [${propertyPath}] in [${targetClass==null?void 0:targetClass.name}]; nested error is: ${error.message}`)}}return target}__name(jsonApply,"jsonApply");function keyMapper(data,key){return data.map(dataObject=>dataObject==null?void 0:dataObject[key])}__name(keyMapper,"keyMapper");function classify(value){return value==null?null:isHtmlElement(value)||isDate(value)?"primitive":isArray(value)?"array":isObject(value)?isPlainObject(value)?"object":CLASS_INSTANCE_TYPE:isFunction(value)?"function":"primitive"}__name(classify,"classify");var SERIES_FACTORIES={},SERIES_DEFAULTS={},SERIES_THEME_TEMPLATES={},ENTERPRISE_SERIES_THEME_TEMPLATES={},SERIES_PALETTE_FACTORIES={},SOLO_SERIES_TYPES=new Set,STACKABLE_SERIES_TYPES=new Set,GROUPABLE_SERIES_TYPES=new Set,STACKED_BY_DEFAULT_SERIES_TYPES=new Set,SWAP_DEFAULT_AXES_CONDITIONS={};function registerSeries({identifier:seriesType,chartTypes:[chartType2],instanceConstructor,seriesDefaults,themeTemplate,enterpriseThemeTemplate,paletteFactory,solo,stackable,groupable,stackedByDefault,swapDefaultAxesCondition}){SERIES_FACTORIES[seriesType]=instanceConstructor,SERIES_DEFAULTS[seriesType]=seriesDefaults,registerSeriesThemeTemplate(seriesType,themeTemplate,enterpriseThemeTemplate),paletteFactory&&addSeriesPaletteFactory(seriesType,paletteFactory),solo&&addSoloSeriesType(seriesType),stackable&&addStackableSeriesType(seriesType),groupable&&addGroupableSeriesType(seriesType),stackedByDefault&&addStackedByDefaultSeriesType(seriesType),swapDefaultAxesCondition&&addSwapDefaultAxesCondition(seriesType,swapDefaultAxesCondition),registerChartSeriesType(seriesType,chartType2)}__name(registerSeries,"registerSeries");function registerSeriesThemeTemplate(seriesType,themeTemplate,enterpriseThemeTemplate={}){const existingTemplate=SERIES_THEME_TEMPLATES[seriesType];SERIES_THEME_TEMPLATES[seriesType]=mergeDefaults(themeTemplate,existingTemplate),ENTERPRISE_SERIES_THEME_TEMPLATES[seriesType]=mergeDefaults(enterpriseThemeTemplate,themeTemplate,existingTemplate)}__name(registerSeriesThemeTemplate,"registerSeriesThemeTemplate");function createSeries(seriesType,moduleCtx){const seriesConstructor=SERIES_FACTORIES[seriesType];if(seriesConstructor)return new seriesConstructor(moduleCtx);throw new Error(`AG Charts - unknown series type: ${seriesType}`)}__name(createSeries,"createSeries");function getSeriesDefaults(chartType2){var _a201;return deepClone((_a201=SERIES_DEFAULTS[chartType2])!=null?_a201:{})}__name(getSeriesDefaults,"getSeriesDefaults");function getSeriesThemeTemplate(chartType2){return enterpriseModule.isEnterprise?ENTERPRISE_SERIES_THEME_TEMPLATES[chartType2]:SERIES_THEME_TEMPLATES[chartType2]}__name(getSeriesThemeTemplate,"getSeriesThemeTemplate");function addSeriesPaletteFactory(seriesType,factory){SERIES_PALETTE_FACTORIES[seriesType]=factory}__name(addSeriesPaletteFactory,"addSeriesPaletteFactory");function getSeriesPaletteFactory(seriesType){return SERIES_PALETTE_FACTORIES[seriesType]}__name(getSeriesPaletteFactory,"getSeriesPaletteFactory");function isSoloSeries(seriesType){return SOLO_SERIES_TYPES.has(seriesType)}__name(isSoloSeries,"isSoloSeries");function isStackableSeries(seriesType){return STACKABLE_SERIES_TYPES.has(seriesType)}__name(isStackableSeries,"isStackableSeries");function isGroupableSeries(seriesType){return GROUPABLE_SERIES_TYPES.has(seriesType)}__name(isGroupableSeries,"isGroupableSeries");function isSeriesStackedByDefault(seriesType){return STACKED_BY_DEFAULT_SERIES_TYPES.has(seriesType)}__name(isSeriesStackedByDefault,"isSeriesStackedByDefault");function addGroupableSeriesType(seriesType){GROUPABLE_SERIES_TYPES.add(seriesType)}__name(addGroupableSeriesType,"addGroupableSeriesType");function addSoloSeriesType(seriesType){SOLO_SERIES_TYPES.add(seriesType)}__name(addSoloSeriesType,"addSoloSeriesType");function addStackableSeriesType(seriesType){STACKABLE_SERIES_TYPES.add(seriesType)}__name(addStackableSeriesType,"addStackableSeriesType");function addStackedByDefaultSeriesType(seriesType){STACKED_BY_DEFAULT_SERIES_TYPES.add(seriesType)}__name(addStackedByDefaultSeriesType,"addStackedByDefaultSeriesType");function addSwapDefaultAxesCondition(seriesType,predicate){SWAP_DEFAULT_AXES_CONDITIONS[seriesType]=predicate}__name(addSwapDefaultAxesCondition,"addSwapDefaultAxesCondition");function isDefaultAxisSwapNeeded(opts){var _a201,_b;let result;for(const series of(_a201=opts.series)!=null?_a201:[]){const{type="line"}=series,isDefaultAxisSwapped=(_b=SWAP_DEFAULT_AXES_CONDITIONS[type])==null?void 0:_b.call(SWAP_DEFAULT_AXES_CONDITIONS,series);if(isDefaultAxisSwapped!=null){if(result!=null&&result!=isDefaultAxisSwapped)throw new Error("AG Charts - The provided series have incompatible directions");result=isDefaultAxisSwapped}}return result}__name(isDefaultAxisSwapNeeded,"isDefaultAxisSwapNeeded");var LEGEND_KEYS={};function registerLegend(type,key,ctr,theme){LEGEND_KEYS[type]=key,LEGEND_THEME_TEMPLATES[key]=theme}__name(registerLegend,"registerLegend");var LEGEND_THEME_TEMPLATES={};function getLegendThemeTemplates(){return LEGEND_THEME_TEMPLATES}__name(getLegendThemeTemplates,"getLegendThemeTemplates");function getLegendKeys(){return LEGEND_KEYS}__name(getLegendKeys,"getLegendKeys");var FONT_SIZE=(FONT_SIZE2=>(FONT_SIZE2[FONT_SIZE2.SMALL=12]="SMALL",FONT_SIZE2[FONT_SIZE2.MEDIUM=13]="MEDIUM",FONT_SIZE2[FONT_SIZE2.LARGE=17]="LARGE",FONT_SIZE2))(FONT_SIZE||{}),FONT_WEIGHT=(FONT_WEIGHT3=>(FONT_WEIGHT3.NORMAL="normal",FONT_WEIGHT3.BOLD="bold",FONT_WEIGHT3.BOLDER="bolder",FONT_WEIGHT3.LIGHTER="lighter",FONT_WEIGHT3))(FONT_WEIGHT||{}),POSITION=(POSITION3=>(POSITION3.TOP="top",POSITION3.RIGHT="right",POSITION3.BOTTOM="bottom",POSITION3.LEFT="left",POSITION3))(POSITION||{}),CARTESIAN_AXIS_TYPE=(CARTESIAN_AXIS_TYPE2=>(CARTESIAN_AXIS_TYPE2.CATEGORY="category",CARTESIAN_AXIS_TYPE2.NUMBER="number",CARTESIAN_AXIS_TYPE2.TIME="time",CARTESIAN_AXIS_TYPE2.LOG="log",CARTESIAN_AXIS_TYPE2))(CARTESIAN_AXIS_TYPE||{}),POLAR_AXIS_TYPE=(POLAR_AXIS_TYPE2=>(POLAR_AXIS_TYPE2.ANGLE_CATEGORY="angle-category",POLAR_AXIS_TYPE2.ANGLE_NUMBER="angle-number",POLAR_AXIS_TYPE2.RADIUS_CATEGORY="radius-category",POLAR_AXIS_TYPE2.RADIUS_NUMBER="radius-number",POLAR_AXIS_TYPE2))(POLAR_AXIS_TYPE||{}),POLAR_AXIS_SHAPE=(POLAR_AXIS_SHAPE2=>(POLAR_AXIS_SHAPE2.CIRCLE="circle",POLAR_AXIS_SHAPE2.POLYGON="polygon",POLAR_AXIS_SHAPE2))(POLAR_AXIS_SHAPE||{}),DEFAULT_FILLS={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},DEFAULT_STROKES={BLUE:"#2b5c95",ORANGE:"#cc6f10",GREEN:"#1e652e",CYAN:"#18859e",YELLOW:"#a69400",VIOLET:"#603c88",GRAY:"#575757",MAGENTA:"#7d2f6d",BROWN:"#4f3508",RED:"#a82529"},IS_DARK_THEME=Symbol("is-dark-theme"),EXTENDS_CHART_DEFAULTS=Symbol("extends-chart-defaults"),EXTENDS_LEGEND_DEFAULTS=Symbol("extends-legend-defaults"),EXTENDS_LEGEND_ITEM_DEFAULTS=Symbol("extends-legend-item-defaults"),EXTENDS_LEGEND_ITEM_MARKER_DEFAULTS=Symbol("extends-legend-item-marker-defaults"),EXTENDS_AXES_DEFAULTS=Symbol("extends-axes-defaults"),EXTENDS_AXES_LABEL_DEFAULTS=Symbol("extends-axes-label-defaults"),EXTENDS_AXES_LINE_DEFAULTS=Symbol("extends-axes-line-defaults"),EXTENDS_AXES_TICK_DEFAULTS=Symbol("extends-axes-tick-defaults"),EXTENDS_AXES_GRID_LINE_DEFAULTS=Symbol("extends-axes-grid-line-defaults"),EXTENDS_SERIES_DEFAULTS=Symbol("extends-series-defaults"),EXTENDS_CARTESIAN_MARKER_DEFAULTS=Symbol("extends-cartesian-marker-defaults"),OVERRIDE_SERIES_LABEL_DEFAULTS=Symbol("override-series-label-defaults"),DEFAULT_FONT_FAMILY=Symbol("default-font"),DEFAULT_LABEL_COLOUR=Symbol("default-label-colour"),DEFAULT_INVERTED_LABEL_COLOUR=Symbol("default-inverted-label-colour"),DEFAULT_INSIDE_SERIES_LABEL_COLOUR=Symbol("default-inside-series-label-colour"),DEFAULT_MUTED_LABEL_COLOUR=Symbol("default-muted-label-colour"),DEFAULT_AXIS_GRID_COLOUR=Symbol("default-axis-grid-colour"),DEFAULT_AXIS_LINE_COLOUR=Symbol("default-axis-line-colour"),DEFAULT_CROSS_LINES_COLOUR=Symbol("default-cross-lines-colour"),DEFAULT_BACKGROUND_COLOUR=Symbol("default-background-colour"),DEFAULT_SHADOW_COLOUR=Symbol("default-shadow-colour"),DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS=Symbol("default-waterfall-series-positive-colors"),DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS=Symbol("default-waterfall-series-negative-colors"),DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS=Symbol("default-waterfall-series-total-colors"),DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE=Symbol("default-waterfall-series-connector-line-stroke"),DEFAULT_POLAR_SERIES_STROKE=Symbol("default-polar-series-stroke"),DEFAULT_DIVERGING_SERIES_COLOUR_RANGE=Symbol("default-diverging-series-colour-range"),DEFAULT_HIERARCHY_FILLS=Symbol("default-hierarchy-fills"),DEFAULT_HIERARCHY_STROKES=Symbol("default-hierarchy-strokes"),DEFAULT_BACKGROUND_FILL="white",palette={fills:Object.values(DEFAULT_FILLS),strokes:Object.values(DEFAULT_STROKES)},CHART_TYPE_CONFIG={get cartesian(){return{seriesTypes:CHART_TYPES.cartesianTypes,commonOptions:["zoom","navigator"]}},get polar(){return{seriesTypes:CHART_TYPES.polarTypes,commonOptions:[]}},get hierarchy(){return{seriesTypes:CHART_TYPES.hierarchyTypes,commonOptions:[]}}},CHART_TYPE_SPECIFIC_COMMON_OPTIONS=Object.values(CHART_TYPE_CONFIG).reduce((r,{commonOptions})=>[...r,...commonOptions],[]);function resolvePartialPalette(partialPalette,basePalette){var _a201,_b;return partialPalette==null?null:{fills:(_a201=partialPalette.fills)!=null?_a201:basePalette.fills,strokes:(_b=partialPalette.strokes)!=null?_b:basePalette.strokes}}__name(resolvePartialPalette,"resolvePartialPalette");var _a6,_ChartTheme=(_a6=class{getPalette(){return palette}static getAxisDefaults(overrideDefaults){return mergeDefaults(overrideDefaults,{top:{},right:{},bottom:{},left:{},title:{enabled:!1,text:"Axis Title",spacing:25,fontWeight:"normal",fontSize:13,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR},label:{fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,padding:5,color:DEFAULT_LABEL_COLOUR,avoidCollisions:!0},line:{enabled:!0,width:1,color:DEFAULT_AXIS_LINE_COLOUR},tick:{enabled:!1,width:1,color:DEFAULT_AXIS_LINE_COLOUR},gridLine:{enabled:!0,style:[{stroke:DEFAULT_AXIS_GRID_COLOUR,lineDash:[]}]},crossLines:{enabled:!1,fill:DEFAULT_CROSS_LINES_COLOUR,stroke:DEFAULT_CROSS_LINES_COLOUR,fillOpacity:.1,strokeWidth:1,label:{enabled:!1,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,padding:5,color:DEFAULT_LABEL_COLOUR}}})}static getSeriesDefaults(){return{tooltip:{enabled:!0},visible:!0,showInLegend:!0,highlightStyle:{item:{fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},series:{dimOpacity:1},text:{color:"black"}},nodeClickRange:"exact"}}static getCartesianSeriesMarkerDefaults(){return{enabled:!0,shape:"circle",size:7,strokeWidth:1}}static getLegendItemMarkerDefaults(){return{size:15,padding:8}}static getCaptionWrappingDefaults(){return"hyphenate"}static getChartDefaults(){return{background:{visible:!0,fill:DEFAULT_BACKGROUND_COLOUR},padding:{top:20,right:20,bottom:20,left:20},title:{enabled:!1,text:"Title",fontWeight:"normal",fontSize:17,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,wrapping:_a6.getCaptionWrappingDefaults()},subtitle:{enabled:!1,text:"Subtitle",spacing:20,fontSize:13,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_MUTED_LABEL_COLOUR,wrapping:_a6.getCaptionWrappingDefaults()},footnote:{enabled:!1,text:"Footnote",spacing:20,fontSize:13,fontFamily:DEFAULT_FONT_FAMILY,color:"rgb(140, 140, 140)",wrapping:_a6.getCaptionWrappingDefaults()},legend:{position:"bottom",spacing:30,listeners:{},item:{paddingX:16,paddingY:8,marker:_a6.getLegendItemMarkerDefaults(),toggleSeriesVisible:!0,label:{color:DEFAULT_LABEL_COLOUR,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY}},reverseOrder:!1,pagination:{marker:{size:12},activeStyle:{fill:DEFAULT_LABEL_COLOUR},inactiveStyle:{fill:DEFAULT_MUTED_LABEL_COLOUR},highlightStyle:{fill:DEFAULT_LABEL_COLOUR},label:{color:DEFAULT_LABEL_COLOUR}}},tooltip:{enabled:!0,darkTheme:IS_DARK_THEME,range:"nearest",delay:0},overlays:{loading:{darkTheme:IS_DARK_THEME},noData:{darkTheme:IS_DARK_THEME},noVisibleSeries:{darkTheme:IS_DARK_THEME}},listeners:{}}}constructor(options){var _a201;options=deepClone(options??{});const{overrides=null,palette:palette11=null}=options,defaults=this.createChartConfigPerChartType(this.getDefaults());if(overrides){const{common}=overrides,applyOverrides=__name((seriesTypes,overrideOpts)=>{if(overrideOpts)for(const s of seriesTypes){const seriesType=s;defaults[seriesType]=mergeDefaults(overrideOpts,defaults[seriesType])}},"applyOverrides");for(const[,{seriesTypes,commonOptions}]of Object.entries(CHART_TYPE_CONFIG)){const cleanedCommon=__spreadValues({},common);for(const commonKey of CHART_TYPE_SPECIFIC_COMMON_OPTIONS)commonOptions.includes(commonKey)||delete cleanedCommon[commonKey];applyOverrides(seriesTypes,cleanedCommon)}CHART_TYPES.seriesTypes.forEach(s=>{const seriesType=s;overrides[seriesType]&&(defaults[seriesType]=mergeDefaults(overrides[seriesType],defaults[seriesType]))})}const basePalette=this.getPalette();this.palette=(_a201=resolvePartialPalette(palette11,basePalette))!=null?_a201:basePalette,this.config=Object.freeze(this.templateTheme(defaults))}createChartConfigPerChartType(config){return Object.entries(CHART_TYPE_CONFIG).forEach(([nextType,{seriesTypes}])=>{const typeDefaults=getChartDefaults(nextType);seriesTypes.forEach(seriesType=>{const alias=seriesType;config[alias]||(config[alias]=deepClone(typeDefaults))})}),config}getDefaults(){const getChartTypeDefaults=__name(chartType2=>__spreadValues(__spreadValues(__spreadValues({axes:{}},getLegendThemeTemplates()),_a6.getChartDefaults()),getChartDefaults(chartType2)),"getChartTypeDefaults"),getOverridesByType=__name((chartType2,seriesTypes)=>{var _a201;const chartDefaults=getChartTypeDefaults(chartType2),result={};for(const seriesType of seriesTypes){result[seriesType]=mergeDefaults(getSeriesThemeTemplate(seriesType),(_a201=result[seriesType])!=null?_a201:deepClone(chartDefaults));const{axes}=result[seriesType];for(const axisType of AXIS_TYPES.axesTypes)axes[axisType]=mergeDefaults(axes[axisType],getAxisThemeTemplate(axisType),chartType2==="cartesian"&&_a6.cartesianAxisDefault[axisType])}return result},"getOverridesByType");return mergeDefaults(getOverridesByType("cartesian",CHART_TYPES.cartesianTypes),getOverridesByType("polar",CHART_TYPES.polarTypes),getOverridesByType("hierarchy",CHART_TYPES.hierarchyTypes))}templateTheme(themeTemplate){const themeInstance=deepClone(themeTemplate),{extensions,properties}=this.getTemplateParameters();return jsonWalk(themeInstance,node=>{if(node.__extends__){const key=node.__extends__,source=extensions.get(key);if(source==null)throw new Error(`AG Charts - no template variable provided for: ${key}`);Object.keys(source).forEach(key2=>{key2 in node?isObject(node[key2])&&(node[key2]=mergeDefaults(node[key2],source[key2])):node[key2]=source[key2]}),delete node.__extends__}if(node.__overrides__){const key=node.__overrides__,source=extensions.get(key);if(source==null)throw new Error(`AG Charts - no template variable provided for: ${key}`);Object.assign(node,source),delete node.__overrides__}if(isArray(node))for(let i=0;i<node.length;i++){const symbol=node[i];properties.has(symbol)&&(node[i]=properties.get(symbol))}else for(const[name,value]of Object.entries(node))properties.has(value)&&(node[name]=properties.get(value))}),deepClone(themeInstance)}static getWaterfallSeriesDefaultPositiveColors(){return{fill:DEFAULT_FILLS.BLUE,stroke:DEFAULT_STROKES.BLUE,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:DEFAULT_FILLS.ORANGE,stroke:DEFAULT_STROKES.ORANGE,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:DEFAULT_FILLS.GRAY,stroke:DEFAULT_STROKES.GRAY,label:{color:DEFAULT_LABEL_COLOUR}}}getTemplateParameters(){const extensions=new Map;extensions.set(EXTENDS_CHART_DEFAULTS,_a6.getChartDefaults()),extensions.set(EXTENDS_AXES_DEFAULTS,_a6.getAxisDefaults()),extensions.set(EXTENDS_LEGEND_DEFAULTS,_a6.getChartDefaults().legend),extensions.set(EXTENDS_LEGEND_ITEM_DEFAULTS,_a6.getChartDefaults().legend.item),extensions.set(EXTENDS_LEGEND_ITEM_MARKER_DEFAULTS,_a6.getLegendItemMarkerDefaults()),extensions.set(EXTENDS_AXES_LABEL_DEFAULTS,_a6.getAxisDefaults().label),extensions.set(EXTENDS_AXES_LINE_DEFAULTS,_a6.getAxisDefaults().line),extensions.set(EXTENDS_AXES_TICK_DEFAULTS,_a6.getAxisDefaults().tick),extensions.set(EXTENDS_AXES_GRID_LINE_DEFAULTS,_a6.getAxisDefaults().gridLine),extensions.set(EXTENDS_SERIES_DEFAULTS,_a6.getSeriesDefaults()),extensions.set(OVERRIDE_SERIES_LABEL_DEFAULTS,{}),extensions.set(EXTENDS_CARTESIAN_MARKER_DEFAULTS,_a6.getCartesianSeriesMarkerDefaults());const properties=new Map;return properties.set(IS_DARK_THEME,!1),properties.set(DEFAULT_FONT_FAMILY,"Verdana, sans-serif"),properties.set(DEFAULT_LABEL_COLOUR,"rgb(70, 70, 70)"),properties.set(DEFAULT_INVERTED_LABEL_COLOUR,"white"),properties.set(DEFAULT_MUTED_LABEL_COLOUR,"rgb(140, 140, 140)"),properties.set(DEFAULT_AXIS_GRID_COLOUR,"rgb(224,234,241)"),properties.set(DEFAULT_AXIS_LINE_COLOUR,"rgb(195, 195, 195)"),properties.set(DEFAULT_CROSS_LINES_COLOUR,"rgb(70, 70, 70)"),properties.set(DEFAULT_INSIDE_SERIES_LABEL_COLOUR,DEFAULT_BACKGROUND_FILL),properties.set(DEFAULT_BACKGROUND_COLOUR,DEFAULT_BACKGROUND_FILL),properties.set(DEFAULT_SHADOW_COLOUR,"rgba(0, 0, 0, 0.5)"),properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[DEFAULT_FILLS.ORANGE,DEFAULT_FILLS.YELLOW,DEFAULT_FILLS.GREEN]),properties.set(DEFAULT_HIERARCHY_FILLS,["#ffffff","#e0e5ea","#c1ccd5","#a3b4c1","#859cad"]),properties.set(DEFAULT_HIERARCHY_STROKES,["#ffffff","#c5cbd1","#a4b1bd","#8498a9","#648096"]),properties.set(DEFAULT_POLAR_SERIES_STROKE,DEFAULT_BACKGROUND_FILL),properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a6.getWaterfallSeriesDefaultPositiveColors()),properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a6.getWaterfallSeriesDefaultNegativeColors()),properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a6.getWaterfallSeriesDefaultTotalColors()),properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a6.getWaterfallSeriesDefaultTotalColors().stroke),{extensions,properties}}},__name(_a6,"_ChartTheme"),_a6);_ChartTheme.cartesianAxisDefault={number:_ChartTheme.getAxisDefaults({line:{enabled:!1}}),log:_ChartTheme.getAxisDefaults({base:10,line:{enabled:!1}}),category:_ChartTheme.getAxisDefaults({groupPaddingInner:.1,label:{autoRotate:!0},gridLine:{enabled:!1}}),time:_ChartTheme.getAxisDefaults({gridLine:{enabled:!1}}),"grouped-category":_ChartTheme.getAxisDefaults()};var ChartTheme=_ChartTheme,DEFAULT_DARK_BACKGROUND_FILL="#192232",DEFAULT_DARK_FILLS={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},DEFAULT_DARK_STROKES={BLUE:"#74a8e6",ORANGE:"#ffbe70",GREEN:"#6cb176",CYAN:"#75d4ef",YELLOW:"#f6e559",VIOLET:"#aa86d8",GRAY:"#a1a1a1",MAGENTA:"#ce7ab9",BROWN:"#997b52",RED:"#ff7872"},palette2={fills:Object.values(DEFAULT_DARK_FILLS),strokes:Object.values(DEFAULT_DARK_STROKES)},_a7,DarkTheme=(_a7=class extends ChartTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:DEFAULT_DARK_FILLS.BLUE,stroke:DEFAULT_DARK_STROKES.BLUE,label:{color:"white"}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:DEFAULT_DARK_FILLS.ORANGE,stroke:DEFAULT_DARK_STROKES.ORANGE,label:{color:"white"}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:DEFAULT_DARK_FILLS.GRAY,stroke:DEFAULT_DARK_STROKES.GRAY,label:{color:"white"}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(IS_DARK_THEME,!0),result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a7.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a7.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a7.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a7.getWaterfallSeriesDefaultTotalColors().stroke),result.properties.set(DEFAULT_POLAR_SERIES_STROKE,DEFAULT_DARK_BACKGROUND_FILL),result.properties.set(DEFAULT_LABEL_COLOUR,"white"),result.properties.set(DEFAULT_MUTED_LABEL_COLOUR,"#7D91A0"),result.properties.set(DEFAULT_AXIS_GRID_COLOUR,"#545A6E"),result.properties.set(DEFAULT_CROSS_LINES_COLOUR,"white"),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[DEFAULT_DARK_FILLS.ORANGE,DEFAULT_DARK_FILLS.YELLOW,DEFAULT_DARK_FILLS.GREEN]),result.properties.set(DEFAULT_HIERARCHY_FILLS,["#192834","#253746","#324859","#3f596c","#4d6a80"]),result.properties.set(DEFAULT_HIERARCHY_STROKES,["#192834","#3b5164","#496275","#577287","#668399"]),result.properties.set(DEFAULT_BACKGROUND_COLOUR,DEFAULT_DARK_BACKGROUND_FILL),result.properties.set(DEFAULT_INSIDE_SERIES_LABEL_COLOUR,DEFAULT_DARK_BACKGROUND_FILL),result}getPalette(){return palette2}constructor(options){super(options)}},__name(_a7,"_DarkTheme"),_a7),MATERIAL_DARK_FILLS={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},MATERIAL_DARK_STROKES={BLUE:"#90CAF9",ORANGE:"#FFCC80",GREEN:"#A5D6A7",CYAN:"#80DEEA",YELLOW:"#FFF9C4",VIOLET:"#B39DDB",GRAY:"#E0E0E0",MAGENTA:"#F48FB1",BROWN:"#A1887F",RED:"#EF9A9A"},palette3={fills:Object.values(MATERIAL_DARK_FILLS),strokes:Object.values(MATERIAL_DARK_STROKES)},_a8,MaterialDark=(_a8=class extends DarkTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:MATERIAL_DARK_FILLS.BLUE,stroke:MATERIAL_DARK_STROKES.BLUE,label:{color:"white"}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:MATERIAL_DARK_FILLS.RED,stroke:MATERIAL_DARK_STROKES.RED,label:{color:"white"}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:MATERIAL_DARK_FILLS.GRAY,stroke:MATERIAL_DARK_STROKES.GRAY,label:{color:"white"}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a8.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a8.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a8.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[MATERIAL_DARK_FILLS.ORANGE,MATERIAL_DARK_FILLS.YELLOW,MATERIAL_DARK_FILLS.GREEN]),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a8.getWaterfallSeriesDefaultTotalColors().stroke),result}getPalette(){return palette3}},__name(_a8,"_MaterialDark"),_a8),MATERIAL_LIGHT_FILLS={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},MATERIAL_LIGHT_STROKES={BLUE:"#1565C0",ORANGE:"#E65100",GREEN:"#2E7D32",CYAN:"#00838F",YELLOW:"#F9A825",VIOLET:"#4527A0",GRAY:"#616161",MAGENTA:"#C2185B",BROWN:"#4E342E",RED:"#B71C1C"},palette4={fills:Object.values(MATERIAL_LIGHT_FILLS),strokes:Object.values(MATERIAL_LIGHT_STROKES)},_a9,MaterialLight=(_a9=class extends ChartTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:MATERIAL_LIGHT_FILLS.BLUE,stroke:MATERIAL_LIGHT_STROKES.BLUE,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:MATERIAL_LIGHT_FILLS.RED,stroke:MATERIAL_LIGHT_STROKES.RED,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:MATERIAL_LIGHT_FILLS.GRAY,stroke:MATERIAL_LIGHT_STROKES.GRAY,label:{color:DEFAULT_LABEL_COLOUR}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a9.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a9.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a9.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[MATERIAL_LIGHT_FILLS.ORANGE,MATERIAL_LIGHT_FILLS.YELLOW,MATERIAL_LIGHT_FILLS.GREEN]),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a9.getWaterfallSeriesDefaultTotalColors().stroke),result}getPalette(){return palette4}},__name(_a9,"_MaterialLight"),_a9),POLYCHROMA_DARK_FILLS={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4"},POLYCHROMA_DARK_STROKES={BLUE:"#6698ff",PURPLE:"#c0a3ff",MAGENTA:"#fc8dfc",PINK:"#ff82b1",RED:"#ff9b70",ORANGE:"#ffcf4e",YELLOW:"#ffff58",GREEN:"#58dd70",CYAN:"#51e2c9",MODERATE_BLUE:"#4fd7ff"},POLYCHROMA_DARK_FILL_GRAY="#bbbbbb",POLYCHROMA_DARK_STROKE_GRAY="#eeeeee",palette5={fills:Object.values(POLYCHROMA_DARK_FILLS),strokes:Object.values(POLYCHROMA_DARK_STROKES)},_a10,PolychromaDark=(_a10=class extends DarkTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:POLYCHROMA_DARK_FILLS.BLUE,stroke:POLYCHROMA_DARK_STROKES.BLUE,label:{color:"white"}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:POLYCHROMA_DARK_FILLS.RED,stroke:POLYCHROMA_DARK_STROKES.RED,label:{color:"white"}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:POLYCHROMA_DARK_FILL_GRAY,stroke:POLYCHROMA_DARK_STROKE_GRAY,label:{color:"white"}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a10.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a10.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a10.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[POLYCHROMA_DARK_FILLS.BLUE,POLYCHROMA_DARK_FILLS.RED]),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a10.getWaterfallSeriesDefaultTotalColors().stroke),result}getPalette(){return palette5}},__name(_a10,"_PolychromaDark"),_a10),POLYCHROMA_LIGHT_FILLS={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4"},POLYCHROMA_LIGHT_STROKES={BLUE:"#2346c9",PURPLE:"#7653d4",MAGENTA:"#a73da9",PINK:"#c32d66",RED:"#c84b1c",ORANGE:"#c87f00",YELLOW:"#c1b900",GREEN:"#008c1c",CYAN:"#00927c",MODERATE_BLUE:"#0087bb"},POLYCHROMA_LIGHT_FILL_GRAY="#bbbbbb",POLYCHROMA_LIGHT_STROKE_GRAY="#888888",palette6={fills:Object.values(POLYCHROMA_LIGHT_FILLS),strokes:Object.values(POLYCHROMA_LIGHT_STROKES)},_a11,PolychromaLight=(_a11=class extends ChartTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:POLYCHROMA_LIGHT_FILLS.BLUE,stroke:POLYCHROMA_LIGHT_STROKES.BLUE,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:POLYCHROMA_LIGHT_FILLS.RED,stroke:POLYCHROMA_LIGHT_STROKES.RED,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:POLYCHROMA_LIGHT_FILL_GRAY,stroke:POLYCHROMA_LIGHT_STROKE_GRAY,label:{color:DEFAULT_LABEL_COLOUR}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a11.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a11.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a11.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[POLYCHROMA_LIGHT_FILLS.BLUE,POLYCHROMA_LIGHT_FILLS.RED]),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a11.getWaterfallSeriesDefaultTotalColors().stroke),result}getPalette(){return palette6}},__name(_a11,"_PolychromaLight"),_a11),SHEETS_DARK_FILLS={BLUE:"#4472C4",ORANGE:"#ED7D31",GRAY:"#A5A5A5",YELLOW:"#FFC000",MODERATE_BLUE:"#5B9BD5",GREEN:"#70AD47",DARK_GRAY:"#7B7B7B",DARK_BLUE:"#264478",VERY_DARK_GRAY:"#636363",DARK_YELLOW:"#997300"},SHEETS_DARK_STROKES={BLUE:"#6899ee",ORANGE:"#ffa55d",GRAY:"#cdcdcd",YELLOW:"#ffea53",MODERATE_BLUE:"#82c3ff",GREEN:"#96d56f",DARK_GRAY:"#a1a1a1",DARK_BLUE:"#47689f",VERY_DARK_GRAY:"#878787",DARK_YELLOW:"#c0993d"},palette7={fills:Object.values(SHEETS_DARK_FILLS),strokes:Object.values(SHEETS_DARK_STROKES)},_a12,SheetsDark=(_a12=class extends DarkTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:SHEETS_DARK_FILLS.BLUE,stroke:SHEETS_DARK_STROKES.BLUE,label:{color:"white"}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:SHEETS_DARK_FILLS.ORANGE,stroke:SHEETS_DARK_STROKES.ORANGE,label:{color:"white"}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:SHEETS_DARK_FILLS.GRAY,stroke:SHEETS_DARK_STROKES.GRAY,label:{color:"white"}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a12.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a12.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a12.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[SHEETS_DARK_FILLS.ORANGE,SHEETS_DARK_FILLS.YELLOW,SHEETS_DARK_FILLS.GREEN]),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a12.getWaterfallSeriesDefaultTotalColors().stroke),result}getPalette(){return palette7}},__name(_a12,"_SheetsDark"),_a12),SHEETS_LIGHT_FILLS={BLUE:"#5281d5",ORANGE:"#ff8d44",GRAY:"#b5b5b5",YELLOW:"#ffd02f",MODERATE_BLUE:"#6aabe6",GREEN:"#7fbd57",DARK_GRAY:"#8a8a8a",DARK_BLUE:"#335287",VERY_DARK_GRAY:"#717171",DARK_YELLOW:"#a98220"},SHEETS_LIGHT_STROKES={BLUE:"#214d9b",ORANGE:"#c25600",GRAY:"#7f7f7f",YELLOW:"#d59800",MODERATE_BLUE:"#3575ac",GREEN:"#4b861a",DARK_GRAY:"#575757",DARK_BLUE:"#062253",VERY_DARK_GRAY:"#414141",DARK_YELLOW:"#734f00"},palette8={fills:Object.values(SHEETS_LIGHT_FILLS),strokes:Object.values(SHEETS_LIGHT_STROKES)},_a13,SheetsLight=(_a13=class extends ChartTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:SHEETS_LIGHT_FILLS.BLUE,stroke:SHEETS_LIGHT_STROKES.BLUE,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:SHEETS_LIGHT_FILLS.ORANGE,stroke:SHEETS_LIGHT_STROKES.ORANGE,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:SHEETS_LIGHT_FILLS.GRAY,stroke:SHEETS_LIGHT_STROKES.GRAY,label:{color:DEFAULT_LABEL_COLOUR}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a13.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a13.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a13.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[SHEETS_LIGHT_FILLS.ORANGE,SHEETS_LIGHT_FILLS.YELLOW,SHEETS_LIGHT_FILLS.GREEN]),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a13.getWaterfallSeriesDefaultTotalColors().stroke),result}getPalette(){return palette8}},__name(_a13,"_SheetsLight"),_a13),VIVID_DARK_FILLS={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},VIVID_DARK_STROKES={BLUE:"#67b7ff",ORANGE:"#ffc24d",GREEN:"#5cc86f",CYAN:"#54ebff",VIOLET:"#c18aff",YELLOW:"#fff653",GRAY:"#aeaeae",MAGENTA:"#f078d4",BROWN:"#ba8438",RED:"#ff726e"},palette9={fills:Object.values(VIVID_DARK_FILLS),strokes:Object.values(VIVID_DARK_STROKES)},_a14,VividDark=(_a14=class extends DarkTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:VIVID_DARK_FILLS.BLUE,stroke:VIVID_DARK_STROKES.BLUE,label:{color:"white"}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:VIVID_DARK_FILLS.ORANGE,stroke:VIVID_DARK_STROKES.ORANGE,label:{color:"white"}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:VIVID_DARK_FILLS.GRAY,stroke:VIVID_DARK_STROKES.GRAY,label:{color:"white"}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a14.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a14.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a14.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[VIVID_DARK_FILLS.ORANGE,VIVID_DARK_FILLS.YELLOW,VIVID_DARK_FILLS.GREEN]),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a14.getWaterfallSeriesDefaultTotalColors().stroke),result}getPalette(){return palette9}},__name(_a14,"_VividDark"),_a14),VIVID_FILLS={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},VIVID_STROKES={BLUE:"#0f68c0",ORANGE:"#d47100",GREEN:"#007922",CYAN:"#009ac2",VIOLET:"#bca400",YELLOW:"#753cac",GRAY:"#646464",MAGENTA:"#9b2685",BROWN:"#6c3b00",RED:"#cb0021"},palette10={fills:Object.values(VIVID_FILLS),strokes:Object.values(VIVID_STROKES)},_a15,VividLight=(_a15=class extends ChartTheme{static getWaterfallSeriesDefaultPositiveColors(){return{fill:VIVID_FILLS.BLUE,stroke:VIVID_STROKES.BLUE,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultNegativeColors(){return{fill:VIVID_FILLS.ORANGE,stroke:VIVID_STROKES.ORANGE,label:{color:DEFAULT_LABEL_COLOUR}}}static getWaterfallSeriesDefaultTotalColors(){return{fill:VIVID_FILLS.GRAY,stroke:VIVID_STROKES.GRAY,label:{color:DEFAULT_LABEL_COLOUR}}}getTemplateParameters(){const result=super.getTemplateParameters();return result.properties.set(DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,_a15.getWaterfallSeriesDefaultPositiveColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,_a15.getWaterfallSeriesDefaultNegativeColors()),result.properties.set(DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,_a15.getWaterfallSeriesDefaultTotalColors()),result.properties.set(DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,[VIVID_FILLS.ORANGE,VIVID_FILLS.YELLOW,VIVID_FILLS.GREEN]),result.properties.set(DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,_a15.getWaterfallSeriesDefaultTotalColors().stroke),result}getPalette(){return palette10}},__name(_a15,"_VividLight"),_a15),lightTheme=__name(()=>new ChartTheme,"lightTheme"),darkTheme=__name(()=>new DarkTheme,"darkTheme"),lightThemes={undefined:lightTheme,null:lightTheme,"ag-default":lightTheme,"ag-sheets":()=>new SheetsLight,"ag-polychroma":()=>new PolychromaLight,"ag-vivid":()=>new VividLight,"ag-material":()=>new MaterialLight},darkThemes={undefined:darkTheme,null:darkTheme,"ag-default-dark":darkTheme,"ag-sheets-dark":()=>new SheetsDark,"ag-polychroma-dark":()=>new PolychromaDark,"ag-vivid-dark":()=>new VividDark,"ag-material-dark":()=>new MaterialDark},themes=__spreadValues(__spreadValues({},darkThemes),lightThemes);function validateChartThemeObject(unknownObject){if(unknownObject===null)return;let valid=!0;const{baseTheme,palette:palette11,overrides}=unknownObject;if(baseTheme!==void 0&&typeof baseTheme!="string"&&typeof baseTheme!="object"&&(Logger.warn(`invalid theme.baseTheme type ${typeof baseTheme}, expected (string | object).`),valid=!1),overrides!==void 0&&typeof overrides!="object"&&(Logger.warn(`invalid theme.overrides type ${typeof overrides}, expected object.`),valid=!1),typeof palette11=="object"){if(palette11!==null){const{fills,strokes}=palette11;fills!==void 0&&!Array.isArray(fills)&&(Logger.warn("theme.overrides.fills must be undefined or an array"),valid=!1),strokes!==void 0&&!Array.isArray(strokes)&&(Logger.warn("theme.overrides.strokes must be undefined or an array"),valid=!1)}}else palette11!==void 0&&(Logger.warn(`invalid theme.palette type ${typeof palette11}, expected object.`),valid=!1);if(valid)return unknownObject}__name(validateChartThemeObject,"validateChartThemeObject");function validateChartTheme(value){if(value===void 0||typeof value=="string"||value instanceof ChartTheme)return value;if(typeof value=="object")return validateChartThemeObject(value);Logger.warn(`invalid theme value type ${typeof value}, expected object or string.`)}__name(validateChartTheme,"validateChartTheme");function getChartTheme(unvalidatedValue){let value=validateChartTheme(unvalidatedValue);if(value instanceof ChartTheme)return value;if(value===void 0||typeof value=="string"){const stockTheme=themes[value];return stockTheme?stockTheme():(Logger.warnOnce(`the theme [${value}] is invalid, using [ag-default] instead.`),lightTheme())}const overrides=[];let palette11;for(;typeof value=="object";)overrides.push(value.overrides),palette11??(palette11=value.palette),value=value.baseTheme;const flattenedTheme={baseTheme:value,overrides:mergeDefaults(...overrides),palette:palette11},baseTheme=flattenedTheme.baseTheme?getChartTheme(flattenedTheme.baseTheme):lightTheme();return new baseTheme.constructor(flattenedTheme)}__name(getChartTheme,"getChartTheme");function extent(values){if(values.length===0)return;let min=1/0,max=-1/0;for(let v of values)v instanceof Date&&(v=v.getTime()),typeof v=="number"&&(v<min&&(min=v),v>max&&(max=v));const extent2=[min,max];if(extent2.every(isFinite))return extent2}__name(extent,"extent");function normalisedExtent(d,min,max){return normalisedExtentWithMetadata(d,min,max).extent}__name(normalisedExtent,"normalisedExtent");function normalisedExtentWithMetadata(d,min,max){var _a201;let clipped=!1;return d.length>2&&(d=(_a201=extent(d))!=null?_a201:[NaN,NaN]),isNaN(min)||(clipped||(clipped=min>d[0]),d=[min,d[1]]),isNaN(max)||(clipped||(clipped=max<d[1]),d=[d[0],max]),d[0]>d[1]&&(d=[]),{extent:d,clipped}}__name(normalisedExtentWithMetadata,"normalisedExtentWithMetadata");function arraysEqual(a,b){if(a==null||b==null||a.length!==b.length)return!1;for(let i=0;i<a.length;i++)if(Array.isArray(a[i])&&Array.isArray(b[i])){if(!arraysEqual(a[i],b[i]))return!1}else if(a[i]!==b[i])return!1;return!0}__name(arraysEqual,"arraysEqual");function toArray(value){return typeof value>"u"?[]:Array.isArray(value)?value:[value]}__name(toArray,"toArray");function unique(array){return Array.from(new Set(array))}__name(unique,"unique");function groupBy(array,iteratee){return array.reduce((result,item)=>{var _a201;const groupKey=iteratee(item);return(_a201=result[groupKey])!=null||(result[groupKey]=[]),result[groupKey].push(item),result},{})}__name(groupBy,"groupBy");function circularSliceArray(data,size,offset4=0){if(data.length===0)return[];const result=[];for(let i=0;i<size;i++)result.push(data.at((i+offset4)%data.length));return result}__name(circularSliceArray,"circularSliceArray");function windowValue(name){const WINDOW=typeof window<"u"?window:void 0;return WINDOW==null?void 0:WINDOW[name]}__name(windowValue,"windowValue");var LONG_TIME_PERIOD_THRESHOLD=2e3,timeOfLastLog=Date.now(),logTimeGap=__name(()=>{const timeSinceLastLog=Date.now()-timeOfLastLog;if(timeSinceLastLog>LONG_TIME_PERIOD_THRESHOLD){const prettyDuration=(Math.floor(timeSinceLastLog/100)/10).toFixed(1);Logger.log(`**** ${prettyDuration}s since last log message ****`)}timeOfLastLog=Date.now()},"logTimeGap"),Debug={create(...debugSelectors){return Object.assign(__name((...logContent)=>{Debug.check(...debugSelectors)&&(typeof logContent[0]=="function"&&(logContent=toArray(logContent[0]())),logTimeGap(),Logger.log(...logContent))},"resultFn"),{check:()=>Debug.check(...debugSelectors)})},check(...debugSelectors){return debugSelectors.length===0&&debugSelectors.push(!0),toArray(windowValue("agChartsDebug")).some(selector=>debugSelectors.includes(selector))}},_a16,ChartOptions=(_a16=class{constructor(userOptions,specialOverrides){var _b,_c,_d;const cloneOptions={shallow:["data"]},options=deepClone(userOptions,cloneOptions),chartType2=this.optionsType(options);this.sanityCheckAndCleanup(options),this.userOptions=options,this.activeTheme=getChartTheme(options.theme),this.seriesDefaults=this.getOptionsDefaults(options),this.specialOverrides=this.specialOverridesDefaults(__spreadValues({},specialOverrides));const _a201=this.getSeriesThemeConfig(chartType2),{axes:axesThemes={},series:seriesThemes}=_a201,themeDefaults=__objRest(_a201,["axes","series"]);this.processedOptions=deepClone(mergeDefaults(this.userOptions,themeDefaults,this.seriesDefaults),cloneOptions),this.processAxesOptions(this.processedOptions,axesThemes),this.processSeriesOptions(this.processedOptions),(isAgCartesianChartOptions(this.processedOptions)||isAgPolarChartOptionsWithSeriesBasedLegend(this.processedOptions))&&((_b=this.processedOptions.legend)==null?void 0:_b.enabled)==null&&((_d=(_c=this.processedOptions).legend)!=null||(_c.legend={}),this.processedOptions.legend.enabled=this.processedOptions.series.length>1),this.enableConfiguredOptions(this.processedOptions),enterpriseModule.isEnterprise||removeUsedEnterpriseOptions(this.processedOptions)}getOptions(){var _a201;return(_a201=this.processedOptions)!=null?_a201:{}}diffOptions(options){return jsonDiff(options,this.processedOptions)}getSeriesThemeConfig(seriesType){var _a201,_b;return deepClone((_b=(_a201=this.activeTheme)==null?void 0:_a201.config[seriesType])!=null?_b:{})}getOptionsDefaults(options){const optionsType2=this.optionsType(options),seriesDefaults=getSeriesDefaults(optionsType2);return isDefaultAxisSwapNeeded(options)&&this.swapAxesPosition(seriesDefaults),seriesDefaults}optionsType(options){var _a201,_b,_c;return(_c=(_b=(_a201=options.series)==null?void 0:_a201[0])==null?void 0:_b.type)!=null?_c:"line"}sanityCheckAndCleanup(options){var _a201;this.deprecationWarnings(options),this.axesTypeIntegrity(options),this.seriesTypeIntegrity(options),this.soloSeriesIntegrity(options),this.removeDisabledOptions(options),this.removeLeftoverSymbols(options),(_a201=options.series)!=null&&_a201.some(s=>s.type==="bullet")&&options.sync!=null&&options.sync.enabled!==!1&&(Logger.warnOnce("bullet series cannot be synced, disabling synchronization."),delete options.sync)}swapAxesPosition(options){var _a201;if(isAgCartesianChartOptions(options)){const[axis0,axis1]=(_a201=options.axes)!=null?_a201:[];options.axes=[__spreadProps(__spreadValues({},axis0),{position:axis1.position}),__spreadProps(__spreadValues({},axis1),{position:axis0.position})]}}processAxesOptions(options,axesThemes){"axes"in options&&(options.axes=options.axes.map(axis=>{var _a201,_b,_d,_e;const _c=mergeDefaults((_a201=this.seriesDefaults.axes)==null?void 0:_a201.find(({type})=>type===axis.type),(_b=axesThemes[axis.type])==null?void 0:_b[axis.position],axesThemes[axis.type]),{crossLines:crossLinesTheme}=_c,axisTheme=__objRest(_c,["crossLines"]);axis.crossLines&&(axis.crossLines=mergeArrayDefaults(axis.crossLines,crossLinesTheme));const gridLineStyle=(_d=axisTheme.gridLine)==null?void 0:_d.style;(_e=axis.gridLine)!=null&&_e.style&&(gridLineStyle!=null&&gridLineStyle.length)&&(axis.gridLine.style=axis.gridLine.style.map((style,index)=>style.stroke!=null||style.lineDash!=null?mergeDefaults(style,gridLineStyle.at(index%gridLineStyle.length)):style));const _f=mergeDefaults(axis,axisTheme);return __objRest(_f,["top","right","bottom","left"])}))}processSeriesOptions(options){const defaultSeriesType=this.getDefaultSeriesType(options),defaultTooltipPosition=this.getTooltipPositionDefaults(options),paletteOptions={colourIndex:0,userPalette:!!(isObject(options.theme)&&options.theme.palette)},series=options.series.map(series2=>{var _a201,_b;(_a201=series2.type)!=null||(series2.type=defaultSeriesType);const _c=(_b=this.getSeriesThemeConfig(series2.type).series)!=null?_b:{},{innerLabels:innerLabelsTheme}=_c,seriesTheme=__objRest(_c,["innerLabels"]),seriesOptions=mergeDefaults(this.getSeriesGroupingOptions(series2),series2,defaultTooltipPosition,seriesTheme,this.getSeriesPalette(series2.type,paletteOptions));return seriesOptions.innerLabels&&(seriesOptions.innerLabels=mergeArrayDefaults(seriesOptions.innerLabels,innerLabelsTheme)),this.activeTheme.templateTheme(seriesOptions)});options.series=this.setSeriesGroupingOptions(series)}getSeriesPalette(seriesType,options){const paletteFactory=getSeriesPaletteFactory(seriesType),{colourIndex:colourOffset,userPalette}=options,{fills=[],strokes=[]}=this.activeTheme.palette;return paletteFactory==null?void 0:paletteFactory({userPalette,colorsCount:Math.max(fills.length,strokes.length),themeTemplateParameters:this.activeTheme.getTemplateParameters(),takeColors(count2){return options.colourIndex+=count2,{fills:circularSliceArray(fills,count2,colourOffset),strokes:circularSliceArray(strokes,count2,colourOffset)}}})}getSeriesGroupingOptions(series){const groupable=isGroupableSeries(series.type),stackable=isStackableSeries(series.type),stackedByDefault=isSeriesStackedByDefault(series.type);series.grouped&&!groupable&&Logger.warnOnce(`unsupported grouping of series type "${series.type}".`),(series.stacked||series.stackGroup)&&!stackable&&Logger.warnOnce(`unsupported stacking of series type "${series.type}".`);let{grouped,stacked}=series;return stacked??(stacked=(stackedByDefault||series.stackGroup!=null)&&!(groupable&&grouped)),grouped??(grouped=!0),{stacked:stackable&&stacked,grouped:groupable&&grouped&&!(stackable&&stacked)}}setSeriesGroupingOptions(series){const seriesGroups=this.getSeriesGrouping(series);Debug.create(!0,"opts")("setSeriesGroupingOptions() - series grouping: ",seriesGroups);const groupIdx={},groupCount2=seriesGroups.reduce((countMap,seriesGroup)=>{var _a201,_b;return seriesGroup.groupType==="default"||((_b=countMap[_a201=seriesGroup.seriesType])!=null||(countMap[_a201]=0),countMap[seriesGroup.seriesType]+=seriesGroup.groupType==="stack"?1:seriesGroup.series.length),countMap},{});return seriesGroups.flatMap(seriesGroup=>{var _a201,_b;switch((_b=groupIdx[_a201=seriesGroup.seriesType])!=null||(groupIdx[_a201]=0),seriesGroup.groupType){case"stack":const groupIndex=groupIdx[seriesGroup.seriesType]++;return seriesGroup.series.map((series2,stackIndex)=>Object.assign(series2,{seriesGrouping:{groupIndex,groupCount:groupCount2[seriesGroup.seriesType],stackIndex,stackCount:seriesGroup.series.length}}));case"group":return seriesGroup.series.map(series2=>Object.assign(series2,{seriesGrouping:{groupIndex:groupIdx[seriesGroup.seriesType]++,groupCount:groupCount2[seriesGroup.seriesType],stackIndex:0,stackCount:0}}))}return seriesGroup.series}).map(_a201=>{var _b=_a201,seriesOptions=__objRest(_b,["stacked","grouped"]);return seriesOptions})}getSeriesGroupId(series){var _a201;return!series.stacked&&!series.grouped?"default-ag-charts-group":[series.type,series.xKey,series.stacked?(_a201=series.stackGroup)!=null?_a201:"stacked":"grouped"].filter(Boolean).join("-")}getSeriesGrouping(series){const groupMap=new Map;return series.reduce((result,series2)=>{const seriesType=series2.type;if(!series2.stacked&&!series2.grouped)result.push({groupType:"default",seriesType,series:[series2]});else{const groupId=this.getSeriesGroupId(series2);if(!groupMap.has(groupId)){const record={groupType:series2.stacked?"stack":"group",seriesType,series:[]};groupMap.set(groupId,record),result.push(record)}groupMap.get(groupId).series.push(series2)}return result},[])}getDefaultSeriesType(options){if(isAgCartesianChartOptions(options))return"line";if(isAgHierarchyChartOptions(options))return"treemap";if(isAgPolarChartOptions(options))return"pie";throw new Error("Invalid chart options type detected.")}getTooltipPositionDefaults(options){var _a201;const position=(_a201=options.tooltip)==null?void 0:_a201.position;if(!isPlainObject(position))return;const{type,xOffset,yOffset}=position,result={};return isString(type)&&isEnumValue(AgTooltipPositionType,type)&&(result.type=type),isFiniteNumber(xOffset)&&(result.xOffset=xOffset),isFiniteNumber(yOffset)&&(result.yOffset=yOffset),{tooltip:{position:result}}}deprecationWarnings(options){Object.entries({yKeys:"yKey",yNames:"yName"}).forEach(([oldProp,newProp])=>{var _a201;(_a201=options.series)!=null&&_a201.some(s=>s[oldProp]!=null)&&Logger.warnOnce(`Property [series.${oldProp}] is deprecated, please use [series.${newProp}] and multiple series instead.`)})}axesTypeIntegrity(options){var _a201;if("axes"in options){const axes=(_a201=options.axes)!=null?_a201:[];for(const{type}of axes)isAxisOptionType(type)||(delete options.axes,Logger.warnOnce(`unknown axis type: ${type}; expected one of: ${AXIS_TYPES.axesTypes.join(", ")}, ignoring.`))}}seriesTypeIntegrity(options){var _a201;const series=(_a201=options.series)!=null?_a201:[];options.series=series.filter(({type})=>{if(type==null||isSeriesOptionType(type)||isEnterpriseSeriesType(type))return!0;Logger.warnOnce(`unknown series type: ${type}; expected one of: ${CHART_TYPES.seriesTypes.join(", ")}`)})}soloSeriesIntegrity(options){const series=options.series;if(series&&series.length>1&&series.some(series2=>isSoloSeries(series2.type))){const mainSeriesType=this.optionsType(options);if(isSoloSeries(mainSeriesType))Logger.warn(`series[0] of type '${mainSeriesType}' is incompatible with other series types. Only processing series[0]`),options.series=series.slice(0,1);else{const{solo,nonSolo}=groupBy(series,s=>isSoloSeries(s.type)?"solo":"nonSolo"),rejects=unique(solo.map(s=>s.type)).join(", ");Logger.warn(`Unable to mix these series types with the lead series type: ${rejects}`),options.series=nonSolo}}}enableConfiguredOptions(options){jsonWalk(this.userOptions,(visitingUserOpts,visitingMergedOpts)=>{visitingMergedOpts&&"enabled"in visitingMergedOpts&&!visitingMergedOpts._enabledFromTheme&&visitingUserOpts.enabled==null&&(visitingMergedOpts.enabled=!0)},{skip:["data","theme"]},options),jsonWalk(options,visitingMergedOpts=>{visitingMergedOpts._enabledFromTheme!=null&&delete visitingMergedOpts._enabledFromTheme},{skip:["data","theme"]})}removeDisabledOptions(options){jsonWalk(options,optionsNode=>{"enabled"in optionsNode&&optionsNode.enabled===!1&&Object.keys(optionsNode).forEach(key=>{key!=="enabled"&&delete optionsNode[key]})},{skip:["data","theme"]})}removeLeftoverSymbols(options){jsonWalk(options,optionsNode=>{if(!(!optionsNode||!isObject(optionsNode)))for(const[key,value]of Object.entries(optionsNode))isSymbol(value)&&delete optionsNode[key]},{skip:["data"]})}specialOverridesDefaults(options){if(options.window==null)if(typeof window<"u")options.window=window;else if(typeof global<"u")options.window=global.window;else throw new Error("AG Charts - unable to resolve global window");if(options.document==null)if(typeof document<"u")options.document=document;else if(typeof global<"u")options.document=global.document;else throw new Error("AG Charts - unable to resolve global document");return options}},__name(_a16,"ChartOptions"),_a16);function createDeprecationWarning(){return(key,message)=>{const msg=[`Property [${key}] is deprecated.`,message].filter(Boolean).join(" ");Logger.warnOnce(msg)}}__name(createDeprecationWarning,"createDeprecationWarning");function Deprecated(message,opts){const warnDeprecated=createDeprecationWarning(),def=opts==null?void 0:opts.default;return addTransformToInstanceProperty((_,key,value)=>(value!==def&&warnDeprecated(key.toString(),message),value))}__name(Deprecated,"Deprecated");function DeprecatedAndRenamedTo(newPropName,mapValue){const warnDeprecated=createDeprecationWarning();return addTransformToInstanceProperty((target,key,value)=>(value!==target[newPropName]&&(warnDeprecated(key.toString(),`Use [${newPropName}] instead.`),target[newPropName]=mapValue?mapValue(value):value),BREAK_TRANSFORM_CHAIN),(target,key)=>(warnDeprecated(key.toString(),`Use [${newPropName}] instead.`),target[newPropName]))}__name(DeprecatedAndRenamedTo,"DeprecatedAndRenamedTo");var fromToMotion_exports={};__export(fromToMotion_exports,{NODE_UPDATE_PHASES:()=>NODE_UPDATE_PHASES,NODE_UPDATE_STATE_TO_PHASE_MAPPING:()=>NODE_UPDATE_STATE_TO_PHASE_MAPPING,fromToMotion:()=>fromToMotion,staticFromToMotion:()=>staticFromToMotion});function zipObject(keys,values){const zipped={};if(Array.isArray(values))for(let i=0;i<keys.length;i++)zipped[`${keys[i]}`]=values[i];else for(let i=0;i<keys.length;i++)zipped[`${keys[i]}`]=values;return zipped}__name(zipObject,"zipObject");var ID_MAP=new Map;function resetIds(){ID_MAP.clear()}__name(resetIds,"resetIds");function createId(instance){var _a201;const constructor=instance.constructor,className=Object.hasOwn(constructor,"className")?constructor.className:constructor.name;if(!className)throw new Error(`The ${constructor} is missing the 'className' property.`);const nextId=((_a201=ID_MAP.get(className))!=null?_a201:0)+1;return ID_MAP.set(className,nextId),`${className}-${nextId}`}__name(createId,"createId");var RedrawType=(RedrawType2=>(RedrawType2[RedrawType2.NONE=0]="NONE",RedrawType2[RedrawType2.TRIVIAL=1]="TRIVIAL",RedrawType2[RedrawType2.MINOR=2]="MINOR",RedrawType2[RedrawType2.MAJOR=3]="MAJOR",RedrawType2))(RedrawType||{});function functionConstructorAvailable(){try{return new Function("return true"),!0}catch{return!1}}__name(functionConstructorAvailable,"functionConstructorAvailable");var STRING_FUNCTION_USEABLE=functionConstructorAvailable();function SceneChangeDetection(opts){const{changeCb,convertor}=opts??{};return function(target,key){const privateKey=`__${key}`;target[key]||(STRING_FUNCTION_USEABLE&&changeCb==null&&convertor==null?prepareFastGetSet(target,key,privateKey,opts):prepareSlowGetSet(target,key,privateKey,opts))}}__name(SceneChangeDetection,"SceneChangeDetection");function prepareFastGetSet(target,key,privateKey,opts){const{redraw=1,type="normal",checkDirtyOnAssignment=!1}=opts??{},setterJs=new Function("value",`
        const oldValue = this.${privateKey};
        if (value !== oldValue) {
            this.${privateKey} = value;
            ${type==="normal"?`this.markDirty(this, ${redraw});`:""}
            ${type==="transform"?`this.markDirtyTransform(${redraw});`:""}
            ${type==="path"?`if (!this._dirtyPath) { this._dirtyPath = true; this.markDirty(this, ${redraw}); }`:""}
            ${type==="font"?`if (!this._dirtyFont) { this._dirtyFont = true; this.markDirty(this, ${redraw}); }`:""}
        }
        ${checkDirtyOnAssignment?"if (value != null && value._dirty > 0) { this.markDirty(value, value._dirty); }":""}
`),getterJs=new Function(`return this.${privateKey};`);Object.defineProperty(target,key,{set:setterJs,get:getterJs,enumerable:!0,configurable:!0})}__name(prepareFastGetSet,"prepareFastGetSet");function prepareSlowGetSet(target,key,privateKey,opts){const{redraw=1,type="normal",changeCb,convertor,checkDirtyOnAssignment=!1}=opts??{};Object.defineProperty(target,key,{set:__name(function(value){const oldValue=this[privateKey];value=convertor?convertor(value):value,value!==oldValue&&(this[privateKey]=value,type==="normal"&&this.markDirty(this,redraw),type==="transform"&&this.markDirtyTransform(redraw),type==="path"&&!this._dirtyPath&&(this._dirtyPath=!0,this.markDirty(this,redraw)),type==="font"&&!this._dirtyFont&&(this._dirtyFont=!0,this.markDirty(this,redraw)),changeCb&&changeCb(this)),checkDirtyOnAssignment&&value!=null&&value._dirty>0&&this.markDirty(value,value._dirty)},"setter"),get:__name(function(){return this[privateKey]},"getter"),enumerable:!0,configurable:!0})}__name(prepareSlowGetSet,"prepareSlowGetSet");var _a17,ChangeDetectable=(_a17=class{constructor(){this._dirty=3}markDirty(_source,type=1){this._dirty<type&&(this._dirty=type)}markClean(_opts){this._dirty=0}isDirty(){return this._dirty>0}},__name(_a17,"ChangeDetectable"),_a17);function clamp(min,value,max){return Math.min(max,Math.max(min,value))}__name(clamp,"clamp");function clampArray(value,array){const[min,max]=findMinMax(array);return clamp(min,value,max)}__name(clampArray,"clampArray");function findMinMax(array){return array.length?[Math.min(...array),Math.max(...array)]:[]}__name(findMinMax,"findMinMax");function findRangeExtent(array){const[min,max]=findMinMax(array);return max-min}__name(findRangeExtent,"findRangeExtent");function isEqual(a,b,epsilon2=1e-10){return Math.abs(a-b)<epsilon2}__name(isEqual,"isEqual");function isNegative(value){return Math.sign(value)===-1||Object.is(value,-0)}__name(isNegative,"isNegative");function round(value,decimals=2){const base=__pow(10,decimals);return Math.round(value*base)/base}__name(round,"round");function toFixed(value,fractionOrSignificantDigits=2){const power=Math.floor(Math.log(Math.abs(value))/Math.LN10);return power>=0||!isFinite(power)?value.toFixed(fractionOrSignificantDigits):value.toFixed(Math.abs(power)-1+fractionOrSignificantDigits)}__name(toFixed,"toFixed");function mod(n,m){return Math.floor(n%m+(n<0?m:0))}__name(mod,"mod");function countFractionDigits(value,maximumFractionDigits=10){const[,decimal=""]=(Math.abs(value)%1).toLocaleString("en-GB",{minimumFractionDigits:0,maximumFractionDigits}).split(".");return decimal.length}__name(countFractionDigits,"countFractionDigits");function nearestSquared(point,objects,maxDistanceSquared=1/0){const result={nearest:void 0,distanceSquared:maxDistanceSquared};for(const obj of objects){const thisDistance=obj.distanceSquared(point);if(thisDistance===0)return{nearest:obj,distanceSquared:0};thisDistance<result.distanceSquared&&(result.nearest=obj,result.distanceSquared=thisDistance)}return result}__name(nearestSquared,"nearestSquared");function nearestSquaredInContainer(point,container,maxDistanceSquared=1/0){const tpoint=container.transformPoint(point.x,point.y),result={nearest:void 0,distanceSquared:maxDistanceSquared};for(const child of container.children){const{nearest,distanceSquared:distanceSquared2}=child.nearestSquared(tpoint,result.distanceSquared);if(distanceSquared2===0)return{nearest,distanceSquared:distanceSquared2};distanceSquared2<result.distanceSquared&&(result.nearest=nearest,result.distanceSquared=distanceSquared2)}return result}__name(nearestSquaredInContainer,"nearestSquaredInContainer");var _a18,_BBox=(_a18=class{constructor(x,y,width,height){this.x=x,this.y=y,this.width=width,this.height=height}clone(){const{x,y,width,height}=this;return new _a18(x,y,width,height)}equals(other){return this.x===other.x&&this.y===other.y&&this.width===other.width&&this.height===other.height}containsPoint(x,y){return x>=this.x&&x<=this.x+this.width&&y>=this.y&&y<=this.y+this.height}collidesBBox(other){return this.x<other.x+other.width&&this.x+this.width>other.x&&this.y<other.y+other.height&&this.y+this.height>other.y}isInfinite(){return Math.abs(this.x)===1/0||Math.abs(this.y)===1/0||Math.abs(this.width)===1/0||Math.abs(this.height)===1/0}distanceSquared(point){if(this.containsPoint(point.x,point.y))return 0;const dx=point.x-clamp(this.x,point.x,this.x+this.width),dy=point.y-clamp(this.y,point.y,this.y+this.height);return dx*dx+dy*dy}static nearestBox(point,boxes){return nearestSquared(point,boxes)}shrink(amount,position){const apply=__name((pos,amt)=>{switch(pos){case"top":this.y+=amt;case"bottom":this.height-=amt;break;case"left":this.x+=amt;case"right":this.width-=amt;break;case"vertical":this.y+=amt,this.height-=amt*2;break;case"horizontal":this.x+=amt,this.width-=amt*2;break;case void 0:this.x+=amt,this.width-=amt*2,this.y+=amt,this.height-=amt*2;break}},"apply");return typeof amount=="number"?apply(position,amount):typeof amount=="object"&&Object.entries(amount).forEach(([pos,amt])=>apply(pos,amt)),this}grow(amount,position){if(typeof amount=="number")this.shrink(-amount,position);else{const paddingCopy=__spreadValues({},amount);for(const key in paddingCopy)paddingCopy[key]*=-1;this.shrink(paddingCopy)}return this}static merge(boxes){let left=1/0,top=1/0,right=-1/0,bottom=-1/0;return boxes.forEach(box=>{box.x<left&&(left=box.x),box.y<top&&(top=box.y),box.x+box.width>right&&(right=box.x+box.width),box.y+box.height>bottom&&(bottom=box.y+box.height)}),new _a18(left,top,right-left,bottom-top)}},__name(_a18,"_BBox"),_a18);_BBox.zero=new _BBox(0,0,0,0);var BBox=_BBox,_a19,_Matrix=(_a19=class{get e(){return[...this.elements]}constructor(elements=[1,0,0,1,0,0]){this.elements=elements}setElements(elements){const e=this.elements;return e[0]=elements[0],e[1]=elements[1],e[2]=elements[2],e[3]=elements[3],e[4]=elements[4],e[5]=elements[5],this}get identity(){const e=this.elements;return e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1&&e[4]===0&&e[5]===0}AxB(A,B,C){const a=A[0]*B[0]+A[2]*B[1],b=A[1]*B[0]+A[3]*B[1],c=A[0]*B[2]+A[2]*B[3],d=A[1]*B[2]+A[3]*B[3],e=A[0]*B[4]+A[2]*B[5]+A[4],f=A[1]*B[4]+A[3]*B[5]+A[5];C=C??A,C[0]=a,C[1]=b,C[2]=c,C[3]=d,C[4]=e,C[5]=f}multiplySelf(other){return this.AxB(this.elements,other.elements),this}multiply(other){const elements=new Array(6);return this.AxB(this.elements,other.elements,elements),new _a19(elements)}preMultiplySelf(other){return this.AxB(other.elements,this.elements,this.elements),this}inverse(){const el=this.elements;let a=el[0],b=el[1],c=el[2],d=el[3];const e=el[4],f=el[5],rD=1/(a*d-b*c);return a*=rD,b*=rD,c*=rD,d*=rD,new _a19([d,-b,-c,a,c*f-d*e,b*e-a*f])}inverseTo(other){const el=this.elements;let a=el[0],b=el[1],c=el[2],d=el[3];const e=el[4],f=el[5],rD=1/(a*d-b*c);return a*=rD,b*=rD,c*=rD,d*=rD,other.setElements([d,-b,-c,a,c*f-d*e,b*e-a*f]),this}invertSelf(){const el=this.elements;let a=el[0],b=el[1],c=el[2],d=el[3];const e=el[4],f=el[5],rD=1/(a*d-b*c);return a*=rD,b*=rD,c*=rD,d*=rD,el[0]=d,el[1]=-b,el[2]=-c,el[3]=a,el[4]=c*f-d*e,el[5]=b*e-a*f,this}transformPoint(x,y){const e=this.elements;return{x:x*e[0]+y*e[2]+e[4],y:x*e[1]+y*e[3]+e[5]}}transformBBox(bbox,target){const elements=this.elements,xx=elements[0],xy=elements[1],yx=elements[2],yy=elements[3],h_w=bbox.width*.5,h_h=bbox.height*.5,cx=bbox.x+h_w,cy=bbox.y+h_h,w=Math.abs(h_w*xx)+Math.abs(h_h*yx),h=Math.abs(h_w*xy)+Math.abs(h_h*yy);return target||(target=new BBox(0,0,0,0)),target.x=cx*xx+cy*yx+elements[4]-w,target.y=cx*xy+cy*yy+elements[5]-h,target.width=w+w,target.height=h+h,target}toContext(ctx){if(this.identity)return;const e=this.elements;ctx.transform(e[0],e[1],e[2],e[3],e[4],e[5])}static flyweight(sourceMatrix){return _a19.instance.setElements(sourceMatrix.elements)}static updateTransformMatrix(matrix,scalingX,scalingY,rotation,translationX,translationY,opts){const[bbcx,bbcy]=[0,0],sx=scalingX,sy=scalingY;let scx,scy;sx===1&&sy===1?(scx=0,scy=0):(scx=(opts==null?void 0:opts.scalingCenterX)==null?bbcx:opts==null?void 0:opts.scalingCenterX,scy=(opts==null?void 0:opts.scalingCenterY)==null?bbcy:opts==null?void 0:opts.scalingCenterY);const r=rotation,cos=Math.cos(r),sin=Math.sin(r);let rcx,rcy;r===0?(rcx=0,rcy=0):(rcx=(opts==null?void 0:opts.rotationCenterX)==null?bbcx:opts==null?void 0:opts.rotationCenterX,rcy=(opts==null?void 0:opts.rotationCenterY)==null?bbcy:opts==null?void 0:opts.rotationCenterY);const tx=translationX,ty=translationY,tx4=scx*(1-sx)-rcx,ty4=scy*(1-sy)-rcy;return matrix.setElements([cos*sx,sin*sx,-sin*sy,cos*sy,cos*tx4-sin*ty4+rcx+tx,sin*tx4+cos*ty4+rcy+ty]),matrix}static fromContext(ctx){const domMatrix=ctx.getTransform();return new _a19([domMatrix.a,domMatrix.b,domMatrix.c,domMatrix.d,domMatrix.e,domMatrix.f])}},__name(_a19,"_Matrix"),_a19);_Matrix.instance=new _Matrix;var Matrix=_Matrix,PointerEvents=(PointerEvents2=>(PointerEvents2[PointerEvents2.All=0]="All",PointerEvents2[PointerEvents2.None=1]="None",PointerEvents2))(PointerEvents||{}),zIndexChangedCallback=__name(o=>{o.parent&&(o.parent.dirtyZIndex=!0),o.zIndexChanged()},"zIndexChangedCallback"),_a20,_Node=(_a20=class extends ChangeDetectable{constructor({isVirtual,tag}={}){super(),this.serialNumber=_a20._nextSerialNumber++,this.id=createId(this),this.isContainerNode=!1,this._virtualChildren=[],this._children=[],this.childSet={},this.matrix=new Matrix,this.inverseMatrix=new Matrix,this.dirtyTransform=!1,this.scalingX=1,this.scalingY=1,this.scalingCenterX=null,this.scalingCenterY=null,this.rotationCenterX=null,this.rotationCenterY=null,this.rotation=0,this.translationX=0,this.translationY=0,this.visible=!0,this.dirtyZIndex=!1,this.zIndex=0,this.zIndexSubOrder=void 0,this.pointerEvents=0,this.isVirtual=isVirtual??!1,this.tag=tag??NaN}get datum(){var _a201,_b;return(_b=this._datum)!=null?_b:(_a201=this._parent)==null?void 0:_a201.datum}get previousDatum(){return this._previousDatum}set datum(datum){this._datum!==datum&&(this._previousDatum=this._datum),this._datum=datum}_setLayerManager(value){this._layerManager=value,this._debug=value==null?void 0:value.debug;for(const child of this._children)child._setLayerManager(value);for(const child of this._virtualChildren)child._setLayerManager(value)}get layerManager(){return this._layerManager}get parent(){return this._parent}get children(){if(this._virtualChildren.length===0)return this._children;const result=[...this._children];for(const next of this._virtualChildren)result.push(...next.children);return result}get virtualChildren(){return this._virtualChildren}hasVirtualChildren(){return this._virtualChildren.length>0}setProperties(styles,pickKeys){const keys=pickKeys??Object.keys(styles);for(const key of keys)this[key]=styles[key];return this}append(nodes){Array.isArray(nodes)||(nodes=[nodes]);for(const node of nodes){if(node.parent)throw new Error(`${node} already belongs to another parent: ${node.parent}.`);if(node.layerManager)throw new Error(`${node} already belongs to a scene: ${node.layerManager}.`);if(this.childSet[node.id])throw new Error(`Duplicate ${node.constructor.name} node: ${node}`);node.isVirtual?this._virtualChildren.push(node):this._children.push(node),this.childSet[node.id]=!0,node._parent=this,node._setLayerManager(this.layerManager)}this.dirtyZIndex=!0,this.markDirty(this,3)}appendChild(node){return this.append(node),node}removeChild(node){const error=__name(()=>{throw new Error("The node to be removed is not a child of this node.")},"error");if(node.parent!==this&&error(),node.isVirtual){const i=this._virtualChildren.indexOf(node);i<0&&error(),this._virtualChildren.splice(i,1)}else{const i=this._children.indexOf(node);i<0&&error(),this._children.splice(i,1)}return delete this.childSet[node.id],node._parent=void 0,node._setLayerManager(),this.dirtyZIndex=!0,this.markDirty(node,3),node}calculateCumulativeMatrix(){this.computeTransformMatrix();const matrix=Matrix.flyweight(this.matrix);let parent=this.parent;for(;parent;)parent.computeTransformMatrix(),matrix.preMultiplySelf(parent.matrix),parent=parent.parent;return matrix}transformPoint(x,y){return this.calculateCumulativeMatrix().invertSelf().transformPoint(x,y)}inverseTransformPoint(x,y){return this.calculateCumulativeMatrix().transformPoint(x,y)}transformBBox(bbox){return this.calculateCumulativeMatrix().invertSelf().transformBBox(bbox)}inverseTransformBBox(bbox){return this.calculateCumulativeMatrix().transformBBox(bbox)}markDirtyTransform(){this.dirtyTransform=!0,this.markDirty(this,3)}containsPoint(_x,_y){return!1}pickNode(x,y){var _a201;if(!this.visible||this.pointerEvents===1||!this.containsPoint(x,y))return;const children=this.children;if(children.length>1e3)for(let i=children.length-1;i>=0;i--){const child=children[i],hit=((_a201=child.computeTransformedBBox())==null?void 0:_a201.containsPoint(x,y))?child.pickNode(x,y):void 0;if(hit)return hit}else if(children.length)for(let i=children.length-1;i>=0;i--){const hit=children[i].pickNode(x,y);if(hit)return hit}else if(!this.isContainerNode)return this}findNodes(predicate){const result=predicate(this)?[this]:[];for(const child of this.children){const childResult=child.findNodes(predicate);childResult&&result.push(...childResult)}return result}computeBBox(){}computeTransformedBBox(){const bbox=this.computeBBox();if(!bbox)return;this.computeTransformMatrix();const matrix=Matrix.flyweight(this.matrix);let parent=this.parent;for(;parent;)parent.computeTransformMatrix(),matrix.preMultiplySelf(parent.matrix),parent=parent.parent;return matrix.transformBBox(bbox,bbox),bbox}computeTransformMatrix(){if(!this.dirtyTransform)return;const{matrix,scalingX,scalingY,rotation,translationX,translationY,scalingCenterX,scalingCenterY,rotationCenterX,rotationCenterY}=this;Matrix.updateTransformMatrix(matrix,scalingX,scalingY,rotation,translationX,translationY,{scalingCenterX,scalingCenterY,rotationCenterX,rotationCenterY}),matrix.inverseTo(this.inverseMatrix),this.dirtyTransform=!1}render(renderCtx){const{stats}=renderCtx;this._dirty=0,stats&&stats.nodesRendered++}clearBBox(ctx){const bbox=this.computeBBox();if(bbox==null)return;const{x,y,width,height}=bbox,topLeft=this.transformPoint(x,y),bottomRight=this.transformPoint(x+width,y+height);ctx.clearRect(topLeft.x,topLeft.y,bottomRight.x-topLeft.x,bottomRight.y-topLeft.y)}markDirty(_source,type=1,parentType=type){this._dirty>type||this._dirty===type&&type===parentType||(this._dirty=type,this.parent?this.parent.markDirty(this,parentType):this.layerManager&&this.layerManager.markDirty())}get dirty(){return this._dirty}markClean(opts){const{force=!1,recursive=!0}=opts??{};if(!(this._dirty===0&&!force)){if(this._dirty=0,recursive!==!1)for(const child of this._virtualChildren)child.markClean({force});if(recursive===!0)for(const child of this._children)child.markClean({force})}}visibilityChanged(){}get nodeCount(){let count2=1,dirtyCount=this._dirty>=0||this.dirtyTransform?1:0,visibleCount=this.visible?1:0;const countChild=__name(child=>{const{count:childCount,visibleCount:childVisibleCount,dirtyCount:childDirtyCount}=child.nodeCount;count2+=childCount,visibleCount+=childVisibleCount,dirtyCount+=childDirtyCount},"countChild");for(const child of this._children)countChild(child);for(const child of this._virtualChildren)countChild(child);return{count:count2,visibleCount,dirtyCount}}zIndexChanged(){}},__name(_a20,"_Node"),_a20);_Node._nextSerialNumber=0;__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"scalingX",2);__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"scalingY",2);__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"scalingCenterX",2);__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"scalingCenterY",2);__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"rotationCenterX",2);__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"rotationCenterY",2);__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"rotation",2);__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"translationX",2);__decorateClass([SceneChangeDetection({type:"transform"})],_Node.prototype,"translationY",2);__decorateClass([SceneChangeDetection({redraw:3,changeCb:o=>o.visibilityChanged()})],_Node.prototype,"visible",2);__decorateClass([SceneChangeDetection({redraw:1,changeCb:zIndexChangedCallback})],_Node.prototype,"zIndex",2);__decorateClass([SceneChangeDetection({redraw:1,changeCb:zIndexChangedCallback})],_Node.prototype,"zIndexSubOrder",2);var Node=_Node,srgbToLinear=__name(value=>{const sign=value<0?-1:1,abs=Math.abs(value);return abs<=.04045?value/12.92:sign*__pow((abs+.055)/1.055,2.4)},"srgbToLinear"),srgbFromLinear=__name(value=>{const sign=value<0?-1:1,abs=Math.abs(value);return abs>.0031308?sign*(1.055*__pow(abs,1/2.4)-.055):12.92*value},"srgbFromLinear"),_a21,_Color=(_a21=class{constructor(r,g,b,a=1){this.r=clamp(0,r||0,1),this.g=clamp(0,g||0,1),this.b=clamp(0,b||0,1),this.a=clamp(0,a||0,1)}static validColorString(str){return str.indexOf("#")>=0?!!_a21.parseHex(str):str.indexOf("rgb")>=0?!!_a21.stringToRgba(str):!!_a21.nameToHex[str.toLowerCase()]}static fromString(str){if(str.indexOf("#")>=0)return _a21.fromHexString(str);const hex=_a21.nameToHex[str.toLowerCase()];if(hex)return _a21.fromHexString(hex);if(str.indexOf("rgb")>=0)return _a21.fromRgbaString(str);throw new Error(`Invalid color string: '${str}'`)}static tryParseFromString(str){try{return _a21.fromString(str)}catch{return Logger.warnOnce(`invalid color string: '${str}'.`),_a21.fromArray([0,0,0])}}static parseHex(input){input=input.replace(/ /g,"").slice(1);let parts;switch(input.length){case 6:case 8:parts=[];for(let i=0;i<input.length;i+=2)parts.push(parseInt(`${input[i]}${input[i+1]}`,16));break;case 3:case 4:parts=input.split("").map(p=>parseInt(p,16)).map(p=>p+p*16);break}if((parts==null?void 0:parts.length)>=3&&parts.every(p=>p>=0))return parts.length===3&&parts.push(255),parts}static fromHexString(str){const values=_a21.parseHex(str);if(values){const[r,g,b,a]=values;return new _a21(r/255,g/255,b/255,a/255)}throw new Error(`Malformed hexadecimal color string: '${str}'`)}static stringToRgba(str){let[po,pc]=[NaN,NaN];for(let i=0;i<str.length;i++){const c=str[i];if(!po&&c==="(")po=i;else if(c===")"){pc=i;break}}const contents=po&&pc&&str.substring(po+1,pc);if(!contents)return;const parts=contents.split(","),rgba=[];for(let i=0;i<parts.length;i++){const part=parts[i];let value=parseFloat(part);if(isNaN(value))return;part.indexOf("%")>=0?(value=clamp(0,value,100),value/=100):i===3?value=clamp(0,value,1):(value=clamp(0,value,255),value/=255),rgba.push(value)}return rgba}static fromRgbaString(str){const rgba=_a21.stringToRgba(str);if(rgba){if(rgba.length===3)return new _a21(rgba[0],rgba[1],rgba[2]);if(rgba.length===4)return new _a21(rgba[0],rgba[1],rgba[2],rgba[3])}throw new Error(`Malformed rgb/rgba color string: '${str}'`)}static fromArray(arr){if(arr.length===4)return new _a21(arr[0],arr[1],arr[2],arr[3]);if(arr.length===3)return new _a21(arr[0],arr[1],arr[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(h,s,b,alpha=1){const rgb=_a21.HSBtoRGB(h,s,b);return new _a21(rgb[0],rgb[1],rgb[2],alpha)}static fromHSL(h,s,l,alpha=1){const rgb=_a21.HSLtoRGB(h,s,l);return new _a21(rgb[0],rgb[1],rgb[2],alpha)}static fromOKLCH(l,c,h,alpha=1){const rgb=_a21.OKLCHtoRGB(l,c,h);return new _a21(rgb[0],rgb[1],rgb[2],alpha)}static padHex(str){return str.length===1?"0"+str:str}toHexString(){let hex="#"+_a21.padHex(Math.round(this.r*255).toString(16))+_a21.padHex(Math.round(this.g*255).toString(16))+_a21.padHex(Math.round(this.b*255).toString(16));return this.a<1&&(hex+=_a21.padHex(Math.round(this.a*255).toString(16))),hex}toRgbaString(fractionDigits=3){const components=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)],k=Math.pow(10,fractionDigits);return this.a!==1?(components.push(Math.round(this.a*k)/k),`rgba(${components.join(", ")})`):`rgb(${components.join(", ")})`}toString(){return this.a===1?this.toHexString():this.toRgbaString()}toHSB(){return _a21.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(r,g,b){const LSRGB0=srgbToLinear(r),LSRGB1=srgbToLinear(g),LSRGB2=srgbToLinear(b),LMS0=Math.cbrt(.4122214708*LSRGB0+.5363325363*LSRGB1+.0514459929*LSRGB2),LMS1=Math.cbrt(.2119034982*LSRGB0+.6806995451*LSRGB1+.1073969566*LSRGB2),LMS2=Math.cbrt(.0883024619*LSRGB0+.2817188376*LSRGB1+.6299787005*LSRGB2),OKLAB0=.2104542553*LMS0+.793617785*LMS1-.0040720468*LMS2,OKLAB1=1.9779984951*LMS0-2.428592205*LMS1+.4505937099*LMS2,OKLAB2=.0259040371*LMS0+.7827717662*LMS1-.808675766*LMS2,hue=Math.atan2(OKLAB2,OKLAB1)*180/Math.PI,OKLCH0=OKLAB0,OKLCH1=Math.hypot(OKLAB1,OKLAB2),OKLCH2=hue>=0?hue:hue+360;return[OKLCH0,OKLCH1,OKLCH2]}static OKLCHtoRGB(l,c,h){const OKLAB0=l,OKLAB1=c*Math.cos(h*Math.PI/180),OKLAB2=c*Math.sin(h*Math.PI/180),LMS0=__pow(OKLAB0+.3963377774*OKLAB1+.2158037573*OKLAB2,3),LMS1=__pow(OKLAB0-.1055613458*OKLAB1-.0638541728*OKLAB2,3),LMS2=__pow(OKLAB0-.0894841775*OKLAB1-1.291485548*OKLAB2,3),LSRGB0=4.0767416621*LMS0-3.3077115913*LMS1+.2309699292*LMS2,LSRGB1=-1.2684380046*LMS0+2.6097574011*LMS1-.3413193965*LMS2,LSRGB2=-.0041960863*LMS0-.7034186147*LMS1+1.707614701*LMS2,SRGB0=srgbFromLinear(LSRGB0),SRGB1=srgbFromLinear(LSRGB1),SRGB2=srgbFromLinear(LSRGB2);return[SRGB0,SRGB1,SRGB2]}static RGBtoHSL(r,g,b){const min=Math.min(r,g,b),max=Math.max(r,g,b),l=(max+min)/2;let h,s;if(max===min)h=NaN,s=0;else{const delta=max-min;s=l>.5?delta/(2-max-min):delta/(max+min),max===r?h=(g-b)/delta+(g<b?6:0):max===g?h=(b-r)/delta+2:h=(r-g)/delta+4,h*=360/6}return[h,s,l]}static HSLtoRGB(h,s,l){if(s===0)return[l,l,l];const q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;function hueToRgb(t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+(q-p)*6*t:t<1/2?q:t<2/3?p+(q-p)*(2/3-t)*6:p}__name(hueToRgb,"hueToRgb");const r=hueToRgb(h/360+1/3),g=hueToRgb(h/360),b=hueToRgb(h/360-1/3);return[r,g,b]}static RGBtoHSB(r,g,b){const min=Math.min(r,g,b),max=Math.max(r,g,b),S=max!==0?(max-min)/max:0;let H=NaN;if(min!==max){const delta=max-min,rc=(max-r)/delta,gc=(max-g)/delta,bc=(max-b)/delta;r===max?H=bc-gc:g===max?H=2+rc-bc:H=4+gc-rc,H/=6,H<0&&(H=H+1)}return[H*360,S,max]}static HSBtoRGB(H,S,B){isNaN(H)&&(H=0),H=(H%360+360)%360/360;let r=0,g=0,b=0;if(S===0)r=g=b=B;else{const h=(H-Math.floor(H))*6,f=h-Math.floor(h),p=B*(1-S),q=B*(1-S*f),t=B*(1-S*(1-f));switch(h>>0){case 0:r=B,g=t,b=p;break;case 1:r=q,g=B,b=p;break;case 2:r=p,g=B,b=t;break;case 3:r=p,g=q,b=B;break;case 4:r=t,g=p,b=B;break;case 5:r=B,g=p,b=q;break}}return[r,g,b]}derive(hueShift,saturationFactor,brightnessFactor,opacityFactor){const hsb=_a21.RGBtoHSB(this.r,this.g,this.b);let b=hsb[2];b==0&&brightnessFactor>1&&(b=.05);const h=((hsb[0]+hueShift)%360+360)%360,s=clamp(0,hsb[1]*saturationFactor,1);b=clamp(0,b*brightnessFactor,1);const a=clamp(0,this.a*opacityFactor,1),rgba=_a21.HSBtoRGB(h,s,b);return rgba.push(a),_a21.fromArray(rgba)}brighter(){return this.derive(0,1,1/.7,1)}darker(){return this.derive(0,1,.7,1)}static interpolate(color,other){const c0=_a21.tryParseFromString(color),c1=_a21.tryParseFromString(other);return t=>{const i=__name((x,y)=>x*(1-t)+y*t,"i");return new _a21(i(c0.r,c1.r),i(c0.g,c1.g),i(c0.b,c1.b),i(c0.a,c1.a)).toString()}}},__name(_a21,"_Color"),_a21);_Color.didDebug=!1;_Color.nameToHex=Object.freeze({aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",transparent:"#00000000",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"});var Color=_Color;function interpolateNumber(a,b){return d=>Number(a)*(1-d)+Number(b)*d}__name(interpolateNumber,"interpolateNumber");function interpolateColor(a,b){if(typeof a=="string")try{a=Color.fromString(a)}catch{a=Color.fromArray([0,0,0])}if(typeof b=="string")try{b=Color.fromString(b)}catch{b=Color.fromArray([0,0,0])}const red=interpolateNumber(a.r,b.r),green=interpolateNumber(a.g,b.g),blue=interpolateNumber(a.b,b.b),alpha=interpolateNumber(a.a,b.a);return d=>Color.fromArray([red(d),green(d),blue(d),alpha(d)]).toRgbaString()}__name(interpolateColor,"interpolateColor");var easing_exports={};__export(easing_exports,{easeIn:()=>easeIn,easeInOut:()=>easeInOut,easeInOutQuad:()=>easeInOutQuad,easeInQuad:()=>easeInQuad,easeOut:()=>easeOut,easeOutQuad:()=>easeOutQuad,inverseEaseOut:()=>inverseEaseOut,linear:()=>linear});var linear=__name(n=>n,"linear"),easeIn=__name(n=>1-Math.cos(n*Math.PI/2),"easeIn"),easeOut=__name(n=>Math.sin(n*Math.PI/2),"easeOut"),easeInOut=__name(n=>-(Math.cos(n*Math.PI)-1)/2,"easeInOut"),easeInQuad=__name(n=>n*n,"easeInQuad"),easeOutQuad=__name(n=>1-__pow(1-n,2),"easeOutQuad"),easeInOutQuad=__name(n=>n<.5?2*n*n:1-__pow(-2*n+2,2)/2,"easeInOutQuad"),inverseEaseOut=__name(x=>2*Math.asin(x)/Math.PI,"inverseEaseOut"),QUICK_TRANSITION=.2,INITIAL_LOAD={animationDuration:1,animationDelay:0},REMOVE_PHASE={animationDuration:.25,animationDelay:0},UPDATE_PHASE={animationDuration:.5,animationDelay:.25},ADD_PHASE={animationDuration:.25,animationDelay:.75},LABEL_PHASE={animationDuration:QUICK_TRANSITION,animationDelay:1},ANIMATION_PHASE_ORDER=["initial","remove","update","add","trailing","end"],ANIMATION_PHASE_TIMINGS={initial:INITIAL_LOAD,add:ADD_PHASE,remove:REMOVE_PHASE,update:UPDATE_PHASE,trailing:LABEL_PHASE,end:{animationDelay:1+QUICK_TRANSITION,animationDuration:0}},RepeatType=(RepeatType2=>(RepeatType2.Loop="loop",RepeatType2.Reverse="reverse",RepeatType2))(RepeatType||{});function isNodeArray(array){return array.every(n=>n instanceof Node)}__name(isNodeArray,"isNodeArray");function deconstructSelectionsOrNodes(selectionsOrNodes){return isNodeArray(selectionsOrNodes)?{nodes:selectionsOrNodes,selections:[]}:{nodes:[],selections:selectionsOrNodes}}__name(deconstructSelectionsOrNodes,"deconstructSelectionsOrNodes");var _a22,Animation=(_a22=class{constructor(opts){this.isComplete=!1,this.elapsed=0,this.iteration=0,this.isPlaying=!1,this.isReverse=!1;var _a201,_b,_c,_d,_e,_f,_g,_h;this.id=opts.id,this.groupId=opts.groupId,this.autoplay=(_a201=opts.autoplay)!=null?_a201:!0,this.ease=(_b=opts.ease)!=null?_b:linear,this.phase=opts.phase;const durationProportion=(_c=opts.duration)!=null?_c:ANIMATION_PHASE_TIMINGS[this.phase].animationDuration;this.duration=durationProportion*opts.defaultDuration,this.delay=((_d=opts.delay)!=null?_d:0)*opts.defaultDuration,this.onComplete=opts.onComplete,this.onPlay=opts.onPlay,this.onStop=opts.onStop,this.onUpdate=opts.onUpdate,this.interpolate=this.createInterpolator(opts.from,opts.to),opts.skip===!0?((_e=this.onUpdate)==null||_e.call(this,opts.to,!1,this),(_f=this.onStop)==null||_f.call(this,this),(_g=this.onComplete)==null||_g.call(this,this),this.isComplete=!0):this.autoplay&&(this.play(),(_h=this.onUpdate)==null||_h.call(this,opts.from,!0,this)),opts.collapsable!==!1&&(this.duration=this.checkCollapse(opts,this.duration))}checkCollapse(opts,calculatedDuration){let isNoop=opts.from===opts.to;return isNoop||(isNoop=typeof opts.from=="object"&&jsonDiff(opts.from,opts.to)==null),isNoop?0:calculatedDuration}play(){var _a201;!this.isPlaying&&!this.isComplete&&(this.isPlaying=!0,(_a201=this.onPlay)==null||_a201.call(this,this))}pause(){this.isPlaying&&(this.isPlaying=!1)}stop(){var _a201;this.isPlaying&&(this.isPlaying=!1,this.isComplete=!0,(_a201=this.onStop)==null||_a201.call(this,this))}update(time){var _a201,_b;const previousElapsed=this.elapsed;if(this.elapsed+=time,this.delay>this.elapsed)return 0;const value=this.interpolate(this.isReverse?1-this.delta:this.delta);(_a201=this.onUpdate)==null||_a201.call(this,value,!1,this);const totalDuration=this.delay+this.duration;return this.elapsed>=totalDuration?(this.stop(),this.isComplete=!0,(_b=this.onComplete)==null||_b.call(this,this),time-(totalDuration-previousElapsed)):0}get delta(){return this.ease(clamp(0,(this.elapsed-this.delay)/this.duration,1))}createInterpolator(from,to){if(typeof to!="object")return this.interpolateValue(from,to);const interpolatorEntries=[];for(const key in to){const interpolator=this.interpolateValue(from[key],to[key]);interpolator!=null&&interpolatorEntries.push([key,interpolator])}return d=>{const result={};for(const[key,interpolator]of interpolatorEntries)result[key]=interpolator(d);return result}}interpolateValue(a,b){if(!(a===void 0||b===void 0)){try{switch(typeof a){case"number":return interpolateNumber(a,b);case"string":return interpolateColor(a,b)}}catch{}throw new Error(`Unable to interpolate values: ${a}, ${b}`)}}},__name(_a22,"Animation"),_a22),NODE_UPDATE_PHASES=["removed","updated","added"],NODE_UPDATE_STATE_TO_PHASE_MAPPING={added:"add",updated:"update",removed:"remove",unknown:"initial"};function fromToMotion(groupId,subId,animationManager,selectionsOrNodes,fns,getDatumId,diff2){const{fromFn,toFn,intermediateFn}=fns,{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes),ids={added:{},removed:{}};getDatumId&&diff2&&(ids.added=zipObject(diff2.added,!0),ids.removed=zipObject(diff2.removed,!0));const processNodes=__name((liveNodes,nodes2)=>{var _c;let prevFromProps,liveNodeIndex=0,nodeIndex=0;for(const node of nodes2){const isLive=liveNodes[liveNodeIndex]===node,ctx={last:nodeIndex>=nodes2.length-1,lastLive:liveNodeIndex>=liveNodes.length-1,prev:nodes2[nodeIndex-1],prevFromProps,prevLive:liveNodes[liveNodeIndex-1],next:nodes2[nodeIndex+1],nextLive:liveNodes[liveNodeIndex+(isLive?1:0)]},animationId=`${groupId}_${subId}_${node.id}`;animationManager.stopByAnimationId(animationId);let status="unknown";isLive?getDatumId&&diff2&&(status=calculateStatus(node,node.datum,getDatumId,ids)):status="removed";const _a201=fromFn(node,node.datum,status,ctx),{phase,start,finish,delay,duration}=_a201,from=__objRest(_a201,["phase","start","finish","delay","duration"]),_b=toFn(node,node.datum,status,ctx),{phase:toPhase,start:toStart,finish:toFinish,delay:toDelay,duration:toDuration}=_b,to=__objRest(_b,["phase","start","finish","delay","duration"]),collapsable=finish==null&&toFinish==null;animationManager.animate({id:animationId,groupId,phase:(_c=phase??toPhase)!=null?_c:"update",duration:duration??toDuration,delay:delay??toDelay,from,to,ease:easeOut,collapsable,onPlay:()=>{node.setProperties(__spreadValues(__spreadValues({},start),toStart))},onUpdate(props){node.setProperties(props),intermediateFn&&node.setProperties(intermediateFn(node,node.datum,status,ctx))},onStop:()=>{node.setProperties(__spreadValues(__spreadValues(__spreadValues({},to),finish),toFinish))}}),isLive&&liveNodeIndex++,nodeIndex++,prevFromProps=from}},"processNodes");let selectionIndex=0;for(const selection of selections){const nodes2=selection.nodes(),liveNodes=nodes2.filter(n=>!selection.isGarbage(n));processNodes(liveNodes,nodes2),animationManager.animate({id:`${groupId}_${subId}_selection_${selectionIndex}`,groupId,phase:"end",from:0,to:1,ease:easeOut,onStop(){selection.cleanup()}}),selectionIndex++}processNodes(nodes,nodes)}__name(fromToMotion,"fromToMotion");function staticFromToMotion(groupId,subId,animationManager,selectionsOrNodes,from,to,extraOpts){const{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes),{start={},finish,phase}=extraOpts,collapsable=finish==null;animationManager.animate({id:`${groupId}_${subId}`,groupId,phase:phase??"update",from,to,ease:easeOut,collapsable,onPlay:()=>{for(const node of nodes)node.setProperties(start);for(const selection of selections)for(const node of selection.nodes())node.setProperties(start)},onUpdate(props){for(const node of nodes)node.setProperties(props);for(const selection of selections)for(const node of selection.nodes())node.setProperties(props)},onStop:()=>{for(const node of nodes)node.setProperties(__spreadValues(__spreadValues({},to),finish));for(const selection of selections)for(const node of selection.nodes())node.setProperties(__spreadValues(__spreadValues({},to),finish))}})}__name(staticFromToMotion,"staticFromToMotion");function calculateStatus(node,datum,getDatumId,ids){const id=getDatumId(node,datum);return ids.added[id]?"added":"updated"}__name(calculateStatus,"calculateStatus");var twoPi=Math.PI*2;function normalizeAngle360(radians){return radians%=twoPi,radians+=twoPi,radians%=twoPi,radians}__name(normalizeAngle360,"normalizeAngle360");function normalizeAngle360Inclusive(radians){return radians%=twoPi,radians+=twoPi,radians!==twoPi&&(radians%=twoPi),radians}__name(normalizeAngle360Inclusive,"normalizeAngle360Inclusive");function normalizeAngle180(radians){return radians%=twoPi,radians<-Math.PI?radians+=twoPi:radians>=Math.PI&&(radians-=twoPi),radians}__name(normalizeAngle180,"normalizeAngle180");function toRadians(degrees){return degrees/180*Math.PI}__name(toRadians,"toRadians");function toDegrees(radians){return radians/Math.PI*180}__name(toDegrees,"toDegrees");function angleBetween(angle0,angle1){return angle0=normalizeAngle360(angle0),angle1=normalizeAngle360(angle1),angle1-angle0+(angle0>angle1?2*Math.PI:0)}__name(angleBetween,"angleBetween");var Invalidating=__name((target,propertyKey)=>{const mappedProperty=Symbol(String(propertyKey));target[mappedProperty]=void 0,Object.defineProperty(target,propertyKey,{get(){return this[mappedProperty]},set(newValue){this[mappedProperty]!==newValue&&(this[mappedProperty]=newValue,this.invalid=!0)},enumerable:!0,configurable:!1})},"Invalidating"),_a23,BandScale=(_a23=class{constructor(){this.type="band",this.invalid=!0,this.interval=1,this.index=new Map,this.ordinalRange=[],this._domain=[],this.range=[0,1],this._bandwidth=1,this._step=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0,this.round=!1}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}set domain(values){this.invalid=!0;const domain=[];this.index=new Map;const index=this.index;values.forEach(value=>{index.get(value)===void 0&&index.set(value,domain.push(value)-1)}),this._domain=domain}get domain(){return this._domain}ticks(){this.refresh();const{interval=1}=this,step=Math.abs(Math.round(interval));return this._domain.filter((_,i)=>i%step===0)}convert(d){this.refresh();const i=this.index.get(d);if(i===void 0)return NaN;const r=this.ordinalRange[i];return r===void 0?NaN:r}invert(position){this.refresh();const index=this.ordinalRange.findIndex(p=>p===position);return this.domain[index]}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(value){value=clamp(0,value,1),this._paddingInner=value,this._paddingOuter=value}get padding(){return this._paddingInner}set paddingInner(value){this._paddingInner=clamp(0,value,1)}get paddingInner(){return this._paddingInner}set paddingOuter(value){this._paddingOuter=clamp(0,value,1)}get paddingOuter(){return this._paddingOuter}update(){const count2=this._domain.length;if(count2===0)return;const round3=this.round,paddingInner=this._paddingInner,paddingOuter=this._paddingOuter,[r0,r1]=this.range,width=r1-r0,rawStep=width/Math.max(1,count2+2*paddingOuter-paddingInner),step=round3?Math.floor(rawStep):rawStep,fullBandWidth=step*(count2-paddingInner),x0=r0+(width-fullBandWidth)/2,start=round3?Math.round(x0):x0,bw=step*(1-paddingInner),bandwidth=round3?Math.round(bw):bw,rawBandwidth=rawStep*(1-paddingInner),values=[];for(let i=0;i<count2;i++)values.push(start+step*i);this._bandwidth=bandwidth,this._rawBandwidth=rawBandwidth,this._step=step,this.ordinalRange=values}},__name(_a23,"BandScale"),_a23);__decorateClass([Invalidating],BandScale.prototype,"interval",2);__decorateClass([Invalidating],BandScale.prototype,"range",2);__decorateClass([Invalidating],BandScale.prototype,"round",2);function Validate(predicate,options={}){const{optional=!1}=options;return addTransformToInstanceProperty((target,property,value)=>{var _a201;const context=__spreadProps(__spreadValues({},options),{target,property});if(optional&&typeof value>"u"||predicate(value,context))return isProperties(target[property])&&!isProperties(value)?(target[property].set(value),target[property]):value;const cleanKey=String(property).replace(/^_*/,""),targetName=(_a201=target.constructor.className)!=null?_a201:target.constructor.name.replace(/Properties$/,"");return Logger.warn(`Property [${cleanKey}] of [${targetName}] cannot be set to [${stringify(value)}]${predicate.message?`; expecting ${getPredicateMessage(predicate,context)}`:""}, ignoring.`),BREAK_TRANSFORM_CHAIN},void 0,{optional})}__name(Validate,"Validate");var AND=__name((...predicates)=>{const messages=[];return predicateWithMessage((value,ctx)=>(messages.length=0,predicates.every(predicate=>{const isValid=predicate(value,ctx);return isValid||messages.push(getPredicateMessage(predicate,ctx)),isValid})),()=>messages.filter(Boolean).join(" AND "))},"AND"),OR=__name((...predicates)=>predicateWithMessage((value,ctx)=>predicates.some(predicate=>predicate(value,ctx)),ctx=>predicates.map(getPredicateMessageMapper(ctx)).filter(Boolean).join(" OR ")),"OR"),OBJECT=attachObjectRestrictions(predicateWithMessage((value,ctx)=>isProperties(value)||isObject(value)&&isProperties(ctx.target[ctx.property]),"an object")),BOOLEAN=predicateWithMessage(isBoolean,"a boolean"),FUNCTION=predicateWithMessage(isFunction,"a function"),STRING=predicateWithMessage(isString,"a string"),NUMBER=attachNumberRestrictions(predicateWithMessage(isFiniteNumber,"a number")),NAN=predicateWithMessage(value=>isNumber(value)&&isNaN(value),"NaN"),POSITIVE_NUMBER=NUMBER.restrict({min:0}),RATIO=NUMBER.restrict({min:0,max:1}),DEGREE=NUMBER.restrict({min:-360,max:360}),NUMBER_OR_NAN=OR(NUMBER,NAN),ARRAY=attachArrayRestrictions(predicateWithMessage(isArray,"an array")),ARRAY_OF=__name((predicate,message)=>predicateWithMessage((value,ctx)=>isArray(value)&&value.every(item=>predicate(item,ctx)),ctx=>{var _a201;const arrayMessage=(_a201=getPredicateMessage(ARRAY,ctx))!=null?_a201:"";return message?`${arrayMessage} of ${message}`:arrayMessage}),"ARRAY_OF"),isComparable=__name(value=>isFiniteNumber(value)||isValidDate(value),"isComparable"),LESS_THAN=__name(otherField=>predicateWithMessage((v,ctx)=>!isComparable(v)||!isComparable(ctx.target[otherField])||v<ctx.target[otherField],`expected to be less than ${otherField}`),"LESS_THAN"),GREATER_THAN=__name(otherField=>predicateWithMessage((v,ctx)=>!isComparable(v)||!isComparable(ctx.target[otherField])||v>ctx.target[otherField],`expected to be greater than ${otherField}`),"GREATER_THAN"),DATE=predicateWithMessage(isValidDate,"Date object"),DATE_OR_DATETIME_MS=OR(DATE,POSITIVE_NUMBER),colorMessage="A color string can be in one of the following formats to be valid: #rgb, #rrggbb, rgb(r, g, b), rgba(r, g, b, a) or a CSS color name such as 'white', 'orange', 'cyan', etc",COLOR_STRING=predicateWithMessage(v=>isString(v)&&Color.validColorString(v),`color String. ${colorMessage}`),COLOR_STRING_ARRAY=predicateWithMessage(ARRAY_OF(COLOR_STRING),`color strings. ${colorMessage}`),BOOLEAN_ARRAY=ARRAY_OF(BOOLEAN,"boolean values"),NUMBER_ARRAY=ARRAY_OF(NUMBER,"numbers"),STRING_ARRAY=ARRAY_OF(STRING,"strings"),DATE_ARRAY=predicateWithMessage(ARRAY_OF(DATE),"Date objects"),OBJECT_ARRAY=predicateWithMessage(ARRAY_OF(OBJECT),"objects"),LINE_CAP=UNION(["butt","round","square"],"a line cap"),LINE_JOIN=UNION(["round","bevel","miter"],"a line join"),LINE_DASH=predicateWithMessage(ARRAY_OF(POSITIVE_NUMBER),"numbers specifying the length in pixels of alternating dashes and gaps, for example, [6, 3] means dashes with a length of 6 pixels with gaps between of 3 pixels."),POSITION2=UNION(["top","right","bottom","left"],"a position"),FONT_STYLE=UNION(["normal","italic","oblique"],"a font style"),FONT_WEIGHT2=OR(UNION(["normal","bold","bolder","lighter"],"a font weight"),NUMBER.restrict({min:1,max:1e3})),TEXT_WRAP=UNION(["never","always","hyphenate","on-space"],"a text wrap strategy"),TEXT_ALIGN=UNION(["left","center","right"],"a text align"),VERTICAL_ALIGN=UNION(["top","middle","bottom"],"a vertical align"),OVERFLOW_STRATEGY=UNION(["ellipsis","hide"],"an overflow strategy"),DIRECTION=UNION(["horizontal","vertical"],"a direction"),PLACEMENT=UNION(["inside","outside"],"a placement"),INTERACTION_RANGE=OR(UNION(["exact","nearest"],"interaction range"),NUMBER);function UNION(options,message="a"){return predicateWithMessage(v=>options.includes(v),`${message} keyword such as ${joinUnionOptions(options)}`)}__name(UNION,"UNION");var MIN_SPACING=OR(AND(NUMBER.restrict({min:1}),LESS_THAN("maxSpacing")),NAN),MAX_SPACING=OR(AND(NUMBER.restrict({min:1}),GREATER_THAN("minSpacing")),NAN);function predicateWithMessage(predicate,message){return predicate.message=message,predicate}__name(predicateWithMessage,"predicateWithMessage");function joinUnionOptions(options){const values=options.map(option=>`'${option}'`);if(values.length===1)return values[0];const lastValue=values.pop();return`${values.join(", ")} or ${lastValue}`}__name(joinUnionOptions,"joinUnionOptions");function getPredicateMessage(predicate,ctx){return isFunction(predicate.message)?predicate.message(ctx):predicate.message}__name(getPredicateMessage,"getPredicateMessage");function getPredicateMessageMapper(ctx){return predicate=>getPredicateMessage(predicate,ctx)}__name(getPredicateMessageMapper,"getPredicateMessageMapper");function attachArrayRestrictions(predicate){return Object.assign(predicate,{restrict({length,minLength}={}){return predicateWithMessage(value=>isArray(value)&&(isNumber(length)?value.length===length:!0)&&(isNumber(minLength)?value.length>=minLength:!0),isNumber(minLength)&&minLength>0?"a non-empty array":isNumber(length)?`an array of length ${length}`:"an array")}})}__name(attachArrayRestrictions,"attachArrayRestrictions");function attachNumberRestrictions(predicate){return Object.assign(predicate,{restrict({min,max}={}){const message=["a number"],hasMin=isNumber(min),hasMax=isNumber(max);return hasMin&&hasMax?message.push(`between ${min} and ${max} inclusive`):hasMin?message.push(`greater than or equal to ${min}`):hasMax&&message.push(`less than or equal to ${max}`),predicateWithMessage(value=>isFiniteNumber(value)&&(hasMin?value>=min:!0)&&(hasMax?value<=max:!0),message.join(" "))}})}__name(attachNumberRestrictions,"attachNumberRestrictions");function attachObjectRestrictions(predicate){return Object.assign(predicate,{restrict(objectType){const isInstanceOf=__name(value=>isProperties(value)&&value instanceof objectType,"isInstanceOf");return predicateWithMessage((value,ctx)=>isInstanceOf(value)||isObject(value)&&isInstanceOf(ctx.target[ctx.property]),ctx=>{var _a201;return(_a201=getPredicateMessage(predicate,ctx))!=null?_a201:"an object"})}})}__name(attachObjectRestrictions,"attachObjectRestrictions");function stringify(value){if(typeof value=="number"){if(isNaN(value))return"NaN";if(value===1/0)return"Infinity";if(value===-1/0)return"-Infinity"}return JSON.stringify(value)}__name(stringify,"stringify");var ChartAxisDirection=(ChartAxisDirection2=>(ChartAxisDirection2.X="x",ChartAxisDirection2.Y="y",ChartAxisDirection2))(ChartAxisDirection||{});function hasConstrainedCanvasMemory(){if(typeof navigator>"u")return!1;const iPhoneOSMatch=navigator.userAgent.match(/\(iPhone; CPU iPhone OS (\d+_\d+_\d+) like Mac OS X\)/);if(iPhoneOSMatch==null)return!1;const versionString=iPhoneOSMatch[1].split("_"),major=Number(versionString[0]);return major>16?!1:major===16?Number(versionString[1])<6:!0}__name(hasConstrainedCanvasMemory,"hasConstrainedCanvasMemory");var _a24,_HdpiCanvas=(_a24=class{constructor(opts){this._enabled=!0,this._pixelRatio=NaN,this._width=0,this._height=0;const{document:document2,window:window2,width=600,height=300,domLayer=!1,zIndex=0,name=void 0,overrideDevicePixelRatio=void 0}=opts;this.document=document2,this.window=window2,_a24.document=document2,this.element=document2.createElement("canvas"),this.element.width=width,this.element.height=height,this.realContext=this.element.getContext("2d"),this.imageSource=this.realContext.canvas;const{style}=this.element;style.userSelect="none",style.display="block",domLayer&&(style.position="absolute",style.zIndex=String(zIndex),style.top="0",style.left="0",style.pointerEvents="none",style.opacity="1",name&&(this.element.id=name)),this.context=this.setPixelRatio(overrideDevicePixelRatio),this.resize(width,height)}set container(value){this._container!==value&&(this.remove(),value&&value.appendChild(this.element),this._container=value)}get container(){return this._container}set enabled(value){this.element.style.display=value?"block":"none",this._enabled=!!value}get enabled(){return this._enabled}remove(){const{parentNode}=this.element;parentNode!=null&&parentNode.removeChild(this.element)}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}snapshot(){}clear(){this.context.save(),this.context.resetTransform(),this.context.clearRect(0,0,this.width,this.height),this.context.restore()}toImage(){const img=this.document.createElement("img");return img.src=this.getDataURL(),img}getDataURL(type){return this.element.toDataURL(type)}download(fileName,fileFormat="image/png"){fileName=(fileName??"").trim()||"image";const dataUrl=this.getDataURL(fileFormat),document2=this.document,a=document2.createElement("a");a.href=dataUrl,a.download=fileName,a.style.display="none",document2.body.appendChild(a),a.click(),document2.body.removeChild(a)}get pixelRatio(){return this._pixelRatio}setPixelRatio(ratio){let pixelRatio=ratio??this.window.devicePixelRatio;return hasConstrainedCanvasMemory()&&(pixelRatio=1),this._pixelRatio=pixelRatio,_a24.overrideScale(this.realContext,pixelRatio)}set pixelated(value){this.element.style.imageRendering=value?"pixelated":"auto"}get pixelated(){return this.element.style.imageRendering==="pixelated"}get width(){return this._width}get height(){return this._height}resize(width,height){if(!(width>0&&height>0))return;const{element:element2,context,pixelRatio}=this;element2.width=Math.round(width*pixelRatio),element2.height=Math.round(height*pixelRatio),element2.style.width=width+"px",element2.style.height=height+"px",context.resetTransform(),this._width=width,this._height=height}static get textMeasuringContext(){if(this._textMeasuringContext)return this._textMeasuringContext;const canvas=this.document.createElement("canvas");return this._textMeasuringContext=canvas.getContext("2d"),this._textMeasuringContext}static get svgText(){if(this._svgText)return this._svgText;const xmlns="http://www.w3.org/2000/svg",svg=document.createElementNS(xmlns,"svg");svg.setAttribute("width","100"),svg.setAttribute("height","100"),svg.classList?svg.classList.add("text-measuring-svg"):svg.setAttribute("class","text-measuring-svg"),svg.style.position="absolute",svg.style.top="-1000px",svg.style.visibility="hidden";const svgText=document.createElementNS(xmlns,"text");return svgText.setAttribute("x","0"),svgText.setAttribute("y","30"),svgText.setAttribute("text","black"),svg.appendChild(svgText),document.body.appendChild(svg),this._svgText=svgText,svgText}static get has(){if(this._has)return this._has;const isChrome=typeof navigator>"u"||navigator.userAgent.indexOf("Chrome")>-1,isFirefox=typeof navigator<"u"&&navigator.userAgent.indexOf("Firefox")>-1,isSafari=!isChrome&&typeof navigator<"u"&&navigator.userAgent.indexOf("Safari")>-1;return this._has=Object.freeze({textMetrics:this.textMeasuringContext.measureText("test").actualBoundingBoxDescent!==void 0&&!isFirefox&&!isSafari,getTransform:this.textMeasuringContext.getTransform!==void 0}),this._has}static measureText(text,font,textBaseline,textAlign){const ctx=this.textMeasuringContext;return ctx.font=font,ctx.textBaseline=textBaseline,ctx.textAlign=textAlign,ctx.measureText(text)}static getTextSize(text,font){if(this.has.textMetrics){const ctx=this.textMeasuringContext;ctx.font=font;const metrics=ctx.measureText(text);return{width:metrics.width,height:metrics.actualBoundingBoxAscent+metrics.actualBoundingBoxDescent}}else return this.measureSvgText(text,font)}static measureSvgText(text,font){const cache=this.textSizeCache,fontCache=cache[font];if(fontCache){const size2=fontCache[text];if(size2)return size2}else cache[font]={};const svgText=this.svgText;svgText.style.font=font,svgText.textContent=text;const bbox=svgText.getBBox(),size={width:bbox.width,height:bbox.height};return cache[font][text]=size,size}static overrideScale(ctx,scale2){let depth=0;const overrides={save(){this.$save(),depth++},restore(){if(depth>0)this.$restore(),depth--;else throw new Error("AG Charts - Unable to restore() past depth 0")},setTransform(a,b,c,d,e,f){typeof a=="object"?this.$setTransform(a):this.$setTransform(a*scale2,b*scale2,c*scale2,d*scale2,e*scale2,f*scale2)},resetTransform(){this.$setTransform(scale2,0,0,scale2,0,0)},verifyDepthZero(){if(depth!==0)throw new Error("AG Charts - Save/restore depth is non-zero: "+depth)}};for(const name in overrides)Object.hasOwn(overrides,name)&&(ctx["$"+name]||(ctx["$"+name]=ctx[name]),ctx[name]=overrides[name]);return ctx}},__name(_a24,"_HdpiCanvas"),_a24);_HdpiCanvas.document=globalThis.document;_HdpiCanvas.textSizeCache={};var HdpiCanvas=_HdpiCanvas,_a25,Gradient=(_a25=class{constructor(){this.stops=[]}},__name(_a25,"Gradient"),_a25),_a26,LinearGradient=(_a26=class extends Gradient{constructor(){super(...arguments),this.angle=0}createGradient(ctx,bbox){const{stops,angle}=this,radians=normalizeAngle360(toRadians(angle+90)),cos=Math.cos(radians),sin=Math.sin(radians),w=bbox.width,h=bbox.height,cx=bbox.x+w*.5,cy=bbox.y+h*.5;if(w>0&&h>0){const diagonal=Math.sqrt(h*h+w*w)/2,diagonalAngle=Math.atan2(h,w);let quarteredAngle;radians<Math.PI/2?quarteredAngle=radians:radians<Math.PI?quarteredAngle=Math.PI-radians:radians<3*Math.PI/2?quarteredAngle=radians-Math.PI:quarteredAngle=2*Math.PI-radians;const l=diagonal*Math.abs(Math.cos(quarteredAngle-diagonalAngle)),gradient=ctx.createLinearGradient(cx+cos*l,cy+sin*l,cx-cos*l,cy-sin*l);return stops.forEach(stop=>{gradient.addColorStop(stop.offset,stop.color)}),gradient}return"black"}},__name(_a26,"LinearGradient"),_a26),LINEAR_GRADIENT_REGEXP=/^linear-gradient\((.*?)deg,\s*(.*?)\s*\)$/i,_a27,_Shape=(_a27=class extends Node{constructor(){super(...arguments),this.fillOpacity=1,this.strokeOpacity=1,this.fill=_a27.defaultStyles.fill,this.stroke=_a27.defaultStyles.stroke,this.strokeWidth=_a27.defaultStyles.strokeWidth,this.lineDash=_a27.defaultStyles.lineDash,this.lineDashOffset=_a27.defaultStyles.lineDashOffset,this.lineCap=_a27.defaultStyles.lineCap,this.lineJoin=_a27.defaultStyles.lineJoin,this.opacity=_a27.defaultStyles.opacity,this.fillShadow=_a27.defaultStyles.fillShadow}restoreOwnStyles(){const styles=this.constructor.defaultStyles,keys=Object.getOwnPropertyNames(styles);for(let i=0,n=keys.length;i<n;i++){const key=keys[i];this[key]=styles[key]}}updateGradient(){const{fill}=this;let linearGradientMatch;if(fill!=null&&fill.startsWith("linear-gradient")&&(linearGradientMatch=LINEAR_GRADIENT_REGEXP.exec(fill))){const angle=parseFloat(linearGradientMatch[1]),colors=[],colorsPart=linearGradientMatch[2],colorRegex=/(#[0-9a-f]+)|(rgba?\(.+?\))|([a-z]+)/gi;let c;for(;c=colorRegex.exec(colorsPart);)colors.push(c[0]);this.gradient=new LinearGradient,this.gradient.angle=angle,this.gradient.stops=colors.map((color,index)=>({offset:index/(colors.length-1),color}))}else this.gradient=void 0}align(start,length){var _a201,_b,_c;const pixelRatio=(_c=(_b=(_a201=this.layerManager)==null?void 0:_a201.canvas)==null?void 0:_b.pixelRatio)!=null?_c:1,alignedStart=Math.round(start*pixelRatio)/pixelRatio;return length==null?alignedStart:length===0?0:length<1?Math.ceil(length*pixelRatio)/pixelRatio:Math.round((length+start)*pixelRatio)/pixelRatio-alignedStart}fillStroke(ctx){this.renderFill(ctx),this.renderStroke(ctx)}renderFill(ctx){if(this.fill){const{globalAlpha}=ctx;this.applyFill(ctx),this.applyFillAlpha(ctx),this.applyShadow(ctx),ctx.fill(),ctx.globalAlpha=globalAlpha}ctx.shadowColor="rgba(0, 0, 0, 0)"}applyFill(ctx){this.gradient?ctx.fillStyle=this.gradient.createGradient(ctx,this.computeBBox()):ctx.fillStyle=this.fill}applyFillAlpha(ctx){const{globalAlpha}=ctx;ctx.globalAlpha=globalAlpha*this.opacity*this.fillOpacity}applyShadow(ctx){var _a201,_b;const pixelRatio=(_b=(_a201=this.layerManager)==null?void 0:_a201.canvas.pixelRatio)!=null?_b:1,fillShadow=this.fillShadow;fillShadow!=null&&fillShadow.enabled&&(ctx.shadowColor=fillShadow.color,ctx.shadowOffsetX=fillShadow.xOffset*pixelRatio,ctx.shadowOffsetY=fillShadow.yOffset*pixelRatio,ctx.shadowBlur=fillShadow.blur*pixelRatio)}renderStroke(ctx){if(this.stroke&&this.strokeWidth){const{globalAlpha}=ctx;ctx.strokeStyle=this.stroke,ctx.globalAlpha=globalAlpha*this.opacity*this.strokeOpacity,ctx.lineWidth=this.strokeWidth,this.lineDash&&ctx.setLineDash(this.lineDash),this.lineDashOffset&&(ctx.lineDashOffset=this.lineDashOffset),this.lineCap&&(ctx.lineCap=this.lineCap),this.lineJoin&&(ctx.lineJoin=this.lineJoin),ctx.stroke(),ctx.globalAlpha=globalAlpha}}containsPoint(x,y){return this.isPointInPath(x,y)}},__name(_a27,"_Shape"),_a27);_Shape.defaultStyles=Object.assign({},{fill:"black",stroke:void 0,strokeWidth:0,lineDash:void 0,lineDashOffset:0,lineCap:void 0,lineJoin:void 0,opacity:1,fillShadow:void 0});__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"fillOpacity",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"strokeOpacity",2);__decorateClass([SceneChangeDetection({redraw:2,changeCb:s=>s.updateGradient()})],_Shape.prototype,"fill",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"stroke",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"strokeWidth",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"lineDash",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"lineDashOffset",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"lineCap",2);__decorateClass([SceneChangeDetection({redraw:2})],_Shape.prototype,"lineJoin",2);__decorateClass([SceneChangeDetection({redraw:2,convertor:v=>clamp(0,v,1)})],_Shape.prototype,"opacity",2);__decorateClass([SceneChangeDetection({redraw:2,checkDirtyOnAssignment:!0})],_Shape.prototype,"fillShadow",2);var Shape=_Shape,ellipsis="";function SceneFontChangeDetection(opts){const{redraw=3,changeCb}=opts??{};return SceneChangeDetection({redraw,type:"font",changeCb})}__name(SceneFontChangeDetection,"SceneFontChangeDetection");var _a28,_Text=(_a28=class extends Shape{constructor(){super(...arguments),this.x=0,this.y=0,this.lines=[],this.text=void 0,this._dirtyFont=!0,this.fontSize=10,this.fontFamily="sans-serif",this.textAlign=_a28.defaultStyles.textAlign,this.textBaseline=_a28.defaultStyles.textBaseline,this.lineHeight=void 0}_setLines(){this.lines=splitText(this.text)}get font(){return(this._font==null||this._dirtyFont)&&(this._dirtyFont=!1,this._font=getFont(this)),this._font}computeBBox(){return HdpiCanvas.has.textMetrics?getPreciseBBox(this.lines,this.x,this.y,this):getApproximateBBox(this.lines,this.x,this.y,this)}getLineHeight(line){var _a201,_b;if(this.lineHeight)return this.lineHeight;if(HdpiCanvas.has.textMetrics){const metrics=HdpiCanvas.measureText(line,this.font,this.textBaseline,this.textAlign);return((_a201=metrics.fontBoundingBoxAscent)!=null?_a201:metrics.emHeightAscent)+((_b=metrics.fontBoundingBoxDescent)!=null?_b:metrics.emHeightDescent)}return HdpiCanvas.getTextSize(line,this.font).height}isPointInPath(x,y){const point=this.transformPoint(x,y),bbox=this.computeBBox();return bbox?bbox.containsPoint(point.x,point.y):!1}render(renderCtx){const{ctx,forceRender,stats}=renderCtx;if(this.dirty===0&&!forceRender){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}if(!this.lines.length||!this.layerManager){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}this.computeTransformMatrix(),this.matrix.toContext(ctx);const{fill,stroke,strokeWidth}=this;ctx.font=this.font,ctx.textAlign=this.textAlign,ctx.textBaseline=this.textBaseline;const pixelRatio=this.layerManager.canvas.pixelRatio||1,{globalAlpha}=ctx;if(fill){ctx.fillStyle=fill,ctx.globalAlpha=globalAlpha*this.opacity*this.fillOpacity;const{fillShadow}=this;fillShadow!=null&&fillShadow.enabled&&(ctx.shadowColor=fillShadow.color,ctx.shadowOffsetX=fillShadow.xOffset*pixelRatio,ctx.shadowOffsetY=fillShadow.yOffset*pixelRatio,ctx.shadowBlur=fillShadow.blur*pixelRatio),this.renderLines((line,x,y)=>ctx.fillText(line,x,y))}if(stroke&&strokeWidth){ctx.strokeStyle=stroke,ctx.lineWidth=strokeWidth,ctx.globalAlpha=globalAlpha*this.opacity*this.strokeOpacity;const{lineDash,lineDashOffset,lineCap,lineJoin}=this;lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),this.renderLines((line,x,y)=>ctx.strokeText(line,x,y))}super.render(renderCtx)}renderLines(renderCallback){const{lines,x,y}=this,lineHeights=this.lines.map(line=>this.getLineHeight(line));let offsetY=-(lineHeights.reduce((a,b)=>a+b,0)-lineHeights[0])*getVerticalOffset(this.textBaseline);for(let i=0;i<lines.length;i++)renderCallback(lines[i],x,y+offsetY),offsetY+=lineHeights[i]}static wrapLines(text,maxWidth,maxHeight,textProps,wrapping,overflow){const canOverflow=overflow!=="hide",font=getFont(textProps),measurer=createTextMeasurer(font),lines=text.split(/\r?\n/g);if(lines.length===0)return{lines:void 0,truncated:!1};if(wrapping==="never"){const{text:text2,truncated:truncated2}=_a28.truncateLine(lines[0],maxWidth,measurer,canOverflow?"auto":"never");return{lines:text2!=null?[text2]:void 0,truncated:truncated2}}const wrappedLines=[];let cumulativeHeight=0,truncated=!1;for(const line of lines){const wrappedLine=_a28.wrapLine(line,maxWidth,maxHeight,measurer,textProps,wrapping,cumulativeHeight,canOverflow);if(wrappedLine==null)return{lines:void 0,truncated:!1};if(wrappedLines.push(...wrappedLine.result),cumulativeHeight=wrappedLine.cumulativeHeight,wrappedLine.truncated){truncated=!0;break}}return{lines:wrappedLines,truncated}}static wrap(text,maxWidth,maxHeight,textProps,wrapping,overflow="ellipsis"){const{lines,truncated}=_a28.wrapLines(text,maxWidth,maxHeight,textProps,wrapping,overflow);return{text:lines!=null?lines.join(`
`).trim():"",truncated}}static wrapLine(text,maxWidth,maxHeight,measurer,textProps,wrapping,cumulativeHeight,canOverflow){if(text=text.trim(),!text)return{result:[],truncated:!1,cumulativeHeight};const initialSize=measurer.size(text);if(initialSize.width<=maxWidth)return{result:[text],truncated:!1,cumulativeHeight:cumulativeHeight+initialSize.height};if(initialSize.height>maxHeight||measurer.width("W")>maxWidth)return canOverflow?{result:[],truncated:!0,cumulativeHeight}:void 0;const words=text.split(/\s+/g),wrapResult=_a28.wrapLineSequentially(words,maxWidth,maxHeight,measurer,textProps,wrapping,cumulativeHeight,canOverflow);if(wrapResult==null)return;cumulativeHeight=wrapResult.cumulativeHeight;let{lines}=wrapResult;if(!(wrapResult.wordsBrokenOrTruncated||wrapResult.linesTruncated)){const linesCount=wrapResult.lines.length,balanced=_a28.wrapLineBalanced(words,maxWidth,measurer,linesCount);balanced.length===lines.length&&(lines=balanced)}return{result:lines.map(ln=>ln.join(" ")),truncated:wrapResult.linesTruncated,cumulativeHeight}}static breakWord(word,firstLineWidth,maxWidth,hyphens,measurer){const isPunctuationAt=__name(index=>_a28.punctuationMarks.includes(word[index]),"isPunctuationAt"),h=hyphens?measurer.width("-"):0,breaks=[];let partWidth=0,p=0;for(let i=0;i<word.length;i++){const c=word[i],w=measurer.width(c),limit=p===0?firstLineWidth:maxWidth;partWidth+w+h>limit&&(breaks.push(i),partWidth=0,p++),partWidth+=w}const parts=[];let start=0;for(const index of breaks){let part=word.substring(start,index);hyphens&&part.length>0&&!isPunctuationAt(index-1)&&!isPunctuationAt(index)&&(part+="-"),parts.push(part),start=index}return parts.push(word.substring(start)),parts}static truncateLine(text,maxWidth,measurer,ellipsisMode){text=text.trimEnd();const lineWidth=measurer.width(text);if(lineWidth>maxWidth&&ellipsisMode==="never")return{text:void 0,truncated:!1};if(lineWidth<=maxWidth&&ellipsisMode!=="force")return{text,truncated:!1};const ellipsisWidth=measurer.width(ellipsis);let trunc=text,truncWidth=lineWidth;for(;trunc.length>0&&truncWidth+ellipsisWidth>maxWidth;)trunc=trunc.slice(0,-1).trimEnd(),truncWidth=measurer.width(trunc);return truncWidth+ellipsisWidth<=maxWidth?{text:`${trunc}${ellipsis}`,truncated:!0}:{text:void 0,truncated:!1}}static wrapLineSequentially(words,maxWidth,maxHeight,measurer,textProps,wrapping,cumulativeHeight,canOverflow){const{fontSize=0,lineHeight=fontSize*_a28.defaultLineHeightRatio}=textProps,breakWord=wrapping==="always"||wrapping==="hyphenate",hyphenate=wrapping==="hyphenate",spaceWidth=measurer.width(" ");let wordsBrokenOrTruncated=!1,linesTruncated=!1;const lines=[];let currentLine=[],lineWidth=0;const getReturnValue=__name(()=>({lines,linesTruncated,wordsBrokenOrTruncated,cumulativeHeight}),"getReturnValue"),truncateLastLine=__name(()=>{if(!canOverflow)return;const lastLine=currentLine.join(" "),{text}=_a28.truncateLine(lastLine,maxWidth,measurer,"force");if(text!=null)return currentLine.splice(0,currentLine.length,text),linesTruncated=!0,getReturnValue()},"truncateLastLine"),addNewLine=__name(()=>{const expectedHeight=cumulativeHeight+lineHeight;return expectedHeight>=maxHeight?!1:(currentLine=[],lineWidth=0,cumulativeHeight=expectedHeight,lines.push(currentLine),!0)},"addNewLine");if(!addNewLine())return truncateLastLine();for(let i=0;i<words.length;i++){const word=words[i],wordWidth=measurer.width(word),expectedSpaceWidth=currentLine.length===0?0:spaceWidth,expectedLineWidth=lineWidth+expectedSpaceWidth+wordWidth;if(expectedLineWidth<=maxWidth){currentLine.push(word),lineWidth=expectedLineWidth;continue}if(wordWidth<=maxWidth){if(!addNewLine())return truncateLastLine();currentLine.push(word),lineWidth=wordWidth;continue}if(wordsBrokenOrTruncated=!0,breakWord){const availWidth=maxWidth-lineWidth-expectedSpaceWidth,parts=_a28.breakWord(word,availWidth,maxWidth,hyphenate,measurer);for(let p=0;p<parts.length;p++){const part=parts[p];if(part&&currentLine.push(part),p===parts.length-1)lineWidth=measurer.width(part);else if(!addNewLine())return truncateLastLine()}}else if(canOverflow){if(!addNewLine())return truncateLastLine();const{text}=_a28.truncateLine(word,maxWidth,measurer,"force");if(text==null)return;currentLine.push(text),i<words.length-1&&(linesTruncated=!0);break}else return}return getReturnValue()}static wrapLineBalanced(words,maxWidth,measurer,linesCount){const totalWordsWidth=words.reduce((sum2,w)=>sum2+measurer.width(w),0),spaceWidth=measurer.width(" "),totalSpaceWidth=spaceWidth*(words.length-linesCount-2),averageLineWidth=(totalWordsWidth+totalSpaceWidth)/linesCount,lines=[];let currentLine=[],lineWidth=measurer.width(words[0]),newLine=!0;for(const word of words){const width=measurer.width(word);if(newLine){currentLine=[],currentLine.push(word),lineWidth=width,newLine=!1,lines.push(currentLine);continue}const expectedLineWidth=lineWidth+spaceWidth+width;expectedLineWidth<=averageLineWidth?(currentLine.push(word),lineWidth=expectedLineWidth):expectedLineWidth<=maxWidth?(currentLine.push(word),newLine=!0):(currentLine=[word],lineWidth=width,lines.push(currentLine))}return lines}setFont(props){this.fontFamily=props.fontFamily,this.fontSize=props.fontSize,this.fontStyle=props.fontStyle,this.fontWeight=props.fontWeight}setAlign(props){this.textAlign=props.textAlign,this.textBaseline=props.textBaseline}},__name(_a28,"_Text"),_a28);_Text.className="Text";_Text.defaultLineHeightRatio=1.15;_Text.defaultStyles=Object.assign({},Shape.defaultStyles,{textAlign:"start",fontStyle:void 0,fontWeight:void 0,fontSize:10,fontFamily:"sans-serif",textBaseline:"alphabetic"});_Text.ellipsis=ellipsis;_Text.punctuationMarks=[".",",","-",":",";","!","?","'",'"',"(",")"];__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"x",2);__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"y",2);__decorateClass([SceneChangeDetection({redraw:3,changeCb:o=>o._setLines()})],_Text.prototype,"text",2);__decorateClass([SceneFontChangeDetection()],_Text.prototype,"fontStyle",2);__decorateClass([SceneFontChangeDetection()],_Text.prototype,"fontWeight",2);__decorateClass([SceneFontChangeDetection()],_Text.prototype,"fontSize",2);__decorateClass([SceneFontChangeDetection()],_Text.prototype,"fontFamily",2);__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"textAlign",2);__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"textBaseline",2);__decorateClass([SceneChangeDetection({redraw:3})],_Text.prototype,"lineHeight",2);var Text=_Text;function createTextMeasurer(font){const cache=new Map,getTextSize=__name(text=>HdpiCanvas.getTextSize(text,font),"getTextSize");return{size:getTextSize,width:__name(text=>{if(cache.has(text))return cache.get(text);const{width}=getTextSize(text);return cache.set(text,width),width},"getLineWidth")}}__name(createTextMeasurer,"createTextMeasurer");function getFont(fontProps){const{fontFamily,fontSize,fontStyle,fontWeight}=fontProps;return[fontStyle??"",fontWeight??"",fontSize+"px",fontFamily].join(" ").trim()}__name(getFont,"getFont");function measureText(lines,x,y,textProps){return HdpiCanvas.has.textMetrics?getPreciseBBox(lines,x,y,textProps):getApproximateBBox(lines,x,y,textProps)}__name(measureText,"measureText");function getPreciseBBox(lines,x,y,textProps){var _a201,_b;let left=0,top=0,width=0,height=0,baselineDistance=0;const font=getFont(textProps),{lineHeight,textBaseline=Text.defaultStyles.textBaseline,textAlign=Text.defaultStyles.textAlign}=textProps;for(let i=0;i<lines.length;i++){const metrics=HdpiCanvas.measureText(lines[i],font,textBaseline,textAlign);left=Math.max(left,metrics.actualBoundingBoxLeft),width=Math.max(width,metrics.width),i==0?(top+=metrics.actualBoundingBoxAscent,height+=metrics.actualBoundingBoxAscent):baselineDistance+=(_a201=metrics.fontBoundingBoxAscent)!=null?_a201:metrics.emHeightAscent,i==lines.length-1?height+=metrics.actualBoundingBoxDescent:baselineDistance+=(_b=metrics.fontBoundingBoxDescent)!=null?_b:metrics.emHeightDescent}return lineHeight!==void 0&&(baselineDistance=(lines.length-1)*lineHeight),height+=baselineDistance,top+=baselineDistance*getVerticalOffset(textBaseline),new BBox(x-left,y-top,width,height)}__name(getPreciseBBox,"getPreciseBBox");function getApproximateBBox(lines,x,y,textProps){let width=0,firstLineHeight=0,baselineDistance=0;const font=getFont(textProps),{lineHeight,textBaseline=Text.defaultStyles.textBaseline,textAlign=Text.defaultStyles.textAlign}=textProps;if(lines.length>0){const lineSize=HdpiCanvas.getTextSize(lines[0],font);width=lineSize.width,firstLineHeight=lineSize.height}for(let i=1;i<lines.length;i++){const lineSize=HdpiCanvas.getTextSize(lines[i],font);width=Math.max(width,lineSize.width),baselineDistance+=lineHeight??lineSize.height}switch(textAlign){case"end":case"right":x-=width;break;case"center":x-=width/2}switch(textBaseline){case"alphabetic":y-=firstLineHeight*.7+baselineDistance*.5;break;case"middle":y-=firstLineHeight*.45+baselineDistance*.5;break;case"ideographic":y-=firstLineHeight+baselineDistance;break;case"hanging":y-=firstLineHeight*.2+baselineDistance*.5;break;case"bottom":y-=firstLineHeight+baselineDistance;break}return new BBox(x,y,width,firstLineHeight+baselineDistance)}__name(getApproximateBBox,"getApproximateBBox");function getVerticalOffset(textBaseline){switch(textBaseline){case"top":case"hanging":return 0;case"bottom":case"alphabetic":case"ideographic":return 1;case"middle":return .5}}__name(getVerticalOffset,"getVerticalOffset");function splitText(text){return typeof text=="string"?text.split(/\r?\n/g):[]}__name(splitText,"splitText");function ProxyProperty(proxyPath){const pathArray=isArray(proxyPath)?proxyPath:proxyPath.split(".");if(pathArray.length===1){const[property]=pathArray;return addTransformToInstanceProperty((target,_,value)=>target[property]=value,target=>target[property])}return addTransformToInstanceProperty((target,_,value)=>setPath(target,pathArray,value),target=>getPath(target,pathArray))}__name(ProxyProperty,"ProxyProperty");function ProxyOnWrite(proxyProperty){return addTransformToInstanceProperty((target,_,value)=>target[proxyProperty]=value)}__name(ProxyOnWrite,"ProxyOnWrite");function ProxyPropertyOnWrite(childName,childProperty){return addTransformToInstanceProperty((target,key,value)=>target[childName][childProperty??key]=value)}__name(ProxyPropertyOnWrite,"ProxyPropertyOnWrite");function ActionOnSet(opts){const{newValue:newValueFn,oldValue:oldValueFn,changeValue:changeValueFn}=opts;return addTransformToInstanceProperty((target,_,newValue,oldValue)=>(newValue!==oldValue&&(oldValue!==void 0&&(oldValueFn==null||oldValueFn.call(target,oldValue)),newValue!==void 0&&(newValueFn==null||newValueFn.call(target,newValue)),changeValueFn==null||changeValueFn.call(target,newValue,oldValue)),newValue))}__name(ActionOnSet,"ActionOnSet");function ObserveChanges(observerFn){return addObserverToInstanceProperty(observerFn)}__name(ObserveChanges,"ObserveChanges");function injectStyle(document2,cssStyle){const styleElement=document2.createElement("style");styleElement.innerHTML=cssStyle,document2.head.insertBefore(styleElement,document2.head.querySelector("style"))}__name(injectStyle,"injectStyle");var DEFAULT_TOOLTIP_CLASS="ag-chart-tooltip",DEFAULT_TOOLTIP_DARK_CLASS="ag-chart-dark-tooltip",defaultTooltipCss=`
.${DEFAULT_TOOLTIP_CLASS} {
    transition: transform 0.1s ease;
    max-width: 100%;
    position: fixed;
    left: 0px;
    top: 0px;
    z-index: 99999;
    font: 12px Verdana, sans-serif;
    color: rgb(70, 70, 70);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
}

.${DEFAULT_TOOLTIP_CLASS}-wrap-always {
    overflow-wrap: break-word;
    word-break: break-word;
    hyphens: none;
}

.${DEFAULT_TOOLTIP_CLASS}-wrap-hyphenate {
    overflow-wrap: break-word;
    word-break: break-word;
    hyphens: auto;
}

.${DEFAULT_TOOLTIP_CLASS}-wrap-on-space {
    overflow-wrap: normal;
    word-break: normal;
}

.${DEFAULT_TOOLTIP_CLASS}-wrap-never {
    white-space: pre;
    text-overflow: ellipsis;
}

.${DEFAULT_TOOLTIP_CLASS}-no-interaction {
    pointer-events: none;
    user-select: none;
}

.${DEFAULT_TOOLTIP_CLASS}-no-animation {
    transition: none !important;
}

.${DEFAULT_TOOLTIP_CLASS}-hidden {
    visibility: hidden;
}

.${DEFAULT_TOOLTIP_CLASS}-title {
    overflow: hidden;
    position: relative;
    padding: 8px 14px;
    border-top-left-radius: 2px;
    border-top-right-radius: 2px;
    color: white;
    background-color: #888888;
    z-index: 1;
    text-overflow: inherit;
}

.${DEFAULT_TOOLTIP_CLASS}-title:only-child {
    border-bottom-left-radius: 2px;
    border-bottom-right-radius: 2px;
}

.${DEFAULT_TOOLTIP_CLASS}-content {
    overflow: hidden;
    padding: 6px 14px;
    line-height: 1.7em;
    background: white;
    border-bottom-left-radius: 2px;
    border-bottom-right-radius: 2px;
    border: 1px solid rgba(0, 0, 0, 0.15);
    overflow: hidden;
    text-overflow: inherit;
}

.${DEFAULT_TOOLTIP_CLASS}-arrow::before {
    content: "";

    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);

    border: 5px solid #d9d9d9;

    border-left-color: transparent;
    border-right-color: transparent;
    border-bottom-color: transparent;

    width: 0;
    height: 0;

    margin: 0 auto;
}

.${DEFAULT_TOOLTIP_CLASS}-arrow::after {
    content: "";

    position: absolute;
    top: calc(100% - 1px);
    left: 50%;
    transform: translateX(-50%);

    border: 5px solid white;

    border-left-color: transparent;
    border-right-color: transparent;
    border-bottom-color: transparent;

    width: 0;
    height: 0;

    margin: 0 auto;
}

.ag-chart-wrapper {
    box-sizing: border-box;
    overflow: hidden;
}
`;function toTooltipHtml(input,defaults){var _a201,_b,_c;if(typeof input=="string")return input;const{content=(_a201=defaults==null?void 0:defaults.content)!=null?_a201:"",title=defaults==null?void 0:defaults.title,color=(_b=defaults==null?void 0:defaults.color)!=null?_b:"white",backgroundColor=(_c=defaults==null?void 0:defaults.backgroundColor)!=null?_c:"#888"}=input,titleHtml=title?`<div class="${DEFAULT_TOOLTIP_CLASS}-title"
        style="color: ${color}; background-color: ${backgroundColor}">${title}</div>`:"",contentHtml=content?`<div class="${DEFAULT_TOOLTIP_CLASS}-content">${content}</div>`:"";return`${titleHtml}${contentHtml}`}__name(toTooltipHtml,"toTooltipHtml");var _a29,TooltipPosition=(_a29=class extends BaseProperties{constructor(){super(...arguments),this.type="pointer",this.xOffset=0,this.yOffset=0}},__name(_a29,"TooltipPosition"),_a29);__decorateClass([Validate(UNION(["pointer","node"],"a position type"))],TooltipPosition.prototype,"type",2);__decorateClass([Validate(NUMBER)],TooltipPosition.prototype,"xOffset",2);__decorateClass([Validate(NUMBER)],TooltipPosition.prototype,"yOffset",2);var _a30,_Tooltip=(_a30=class{constructor(canvasElement,document2,window2,container){this.enableInteraction=!1,this.enabled=!0,this.showArrow=void 0,this.class=void 0,this.lastClass=void 0,this.delay=0,this.range="nearest",this.wrapping="hyphenate",this.darkTheme=!1,this.lastVisibilityChange=Date.now(),this.position=new TooltipPosition,this.showTimeout=0,this._showArrow=!0,this.tooltipRoot=container,this.window=window2;const element2=document2.createElement("div");if(this.element=this.tooltipRoot.appendChild(element2),this.element.classList.add(DEFAULT_TOOLTIP_CLASS),this.canvasElement=canvasElement,typeof IntersectionObserver<"u"){const observer=new IntersectionObserver(entries=>{for(const entry of entries)entry.target===this.canvasElement&&entry.intersectionRatio===0&&this.toggle(!1)},{root:this.tooltipRoot});observer.observe(this.canvasElement),this.observer=observer}_a30.tooltipDocuments.indexOf(document2)<0&&(injectStyle(document2,defaultTooltipCss),_a30.tooltipDocuments.push(document2))}destroy(){const{parentNode}=this.element;parentNode&&parentNode.removeChild(this.element),this.observer&&this.observer.unobserve(this.canvasElement)}isVisible(){const{element:element2}=this;return!element2.classList.contains(DEFAULT_TOOLTIP_CLASS+"-hidden")}updateClass(visible,showArrow,addCustomClass=!0){const{element:element2,class:newClass,lastClass,enableInteraction,lastVisibilityChange}=this,wasVisible=this.isVisible(),nowVisible=!!visible;let timeSinceLastVisibilityChangeMs=1/0;if(wasVisible!==nowVisible){const now=Date.now();timeSinceLastVisibilityChangeMs=now-lastVisibilityChange,this.lastVisibilityChange=now}const toggleClass=__name((name,include)=>{const className=`${DEFAULT_TOOLTIP_CLASS}-${name}`;include?element2.classList.add(className):element2.classList.remove(className)},"toggleClass"),animatedMoveThresholdMs=100,thrashingThresholdMs=5,noAnimation=!wasVisible&&nowVisible&&timeSinceLastVisibilityChangeMs>animatedMoveThresholdMs;timeSinceLastVisibilityChangeMs>thrashingThresholdMs&&toggleClass("no-animation",noAnimation),toggleClass("no-interaction",!enableInteraction),toggleClass("hidden",!visible),toggleClass("arrow",!!showArrow),element2.classList.toggle(DEFAULT_TOOLTIP_DARK_CLASS,this.darkTheme),this.updateWrapping(),addCustomClass?(newClass!==lastClass&&(lastClass&&element2.classList.remove(lastClass),newClass&&element2.classList.add(newClass)),this.lastClass=newClass):(lastClass&&element2.classList.remove(lastClass),this.lastClass=void 0)}updateWrapping(){const{element:element2,wrapping}=this,wrappingOptions={always:!1,hyphenate:!1,"on-space":!1,never:!1};wrappingOptions[wrapping]=!0,Object.entries(wrappingOptions).forEach(([name,force])=>{element2.classList.toggle(`${DEFAULT_TOOLTIP_CLASS}-wrap-${name}`,force)})}show(meta,html,instantly=!1){var _a201,_b,_c,_d,_e,_f,_g;const{element:element2,canvasElement}=this;if(html!==void 0)element2.innerHTML=html;else if(!element2.innerHTML){this.toggle(!1);return}const xOffset=(_b=(_a201=meta.position)==null?void 0:_a201.xOffset)!=null?_b:0,yOffset=(_d=(_c=meta.position)==null?void 0:_c.yOffset)!=null?_d:0,canvasRect=canvasElement.getBoundingClientRect(),naiveLeft=canvasRect.left+meta.offsetX-element2.clientWidth/2+xOffset,naiveTop=canvasRect.top+meta.offsetY-element2.clientHeight-8+yOffset,windowBounds=this.getWindowBoundingBox(),maxLeft=windowBounds.x+windowBounds.width-element2.clientWidth-1,maxTop=windowBounds.y+windowBounds.height-element2.clientHeight,left=clamp(windowBounds.x,naiveLeft,maxLeft),top=clamp(windowBounds.y,naiveTop,maxTop),defaultShowArrow=!(left!==naiveLeft||top!==naiveTop)&&!xOffset&&!yOffset,showArrow=(_f=(_e=meta.showArrow)!=null?_e:this.showArrow)!=null?_f:defaultShowArrow;if(this.updateShowArrow(showArrow),element2.style.transform=`translate(${Math.round(left)}px, ${Math.round(top)}px)`,this.enableInteraction=(_g=meta.enableInteraction)!=null?_g:!1,this.delay>0&&!instantly){this.toggle(!1),this.showTimeout=this.window.setTimeout(()=>{this.toggle(!0,meta.addCustomClass)},this.delay);return}this.toggle(!0,meta.addCustomClass)}getWindowBoundingBox(){return new BBox(0,0,this.window.innerWidth,this.window.innerHeight)}toggle(visible,addCustomClass){visible||this.window.clearTimeout(this.showTimeout),this.updateClass(visible,this._showArrow,addCustomClass)}pointerLeftOntoTooltip(event){var _a201;if(!this.enableInteraction)return!1;const classList=(_a201=event.sourceEvent.relatedTarget)==null?void 0:_a201.classList,classListContains=!!["","-title","-content"].filter(c=>classList==null?void 0:classList.contains(`${DEFAULT_TOOLTIP_CLASS}${c}`));return classList!==void 0&&classListContains}updateShowArrow(show){this._showArrow=show}},__name(_a30,"_Tooltip"),_a30);_Tooltip.tooltipDocuments=[];__decorateClass([Validate(BOOLEAN)],_Tooltip.prototype,"enabled",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],_Tooltip.prototype,"showArrow",2);__decorateClass([Validate(STRING,{optional:!0})],_Tooltip.prototype,"class",2);__decorateClass([Validate(POSITIVE_NUMBER)],_Tooltip.prototype,"delay",2);__decorateClass([Validate(INTERACTION_RANGE)],_Tooltip.prototype,"range",2);__decorateClass([Validate(TEXT_WRAP)],_Tooltip.prototype,"wrapping",2);__decorateClass([Validate(BOOLEAN)],_Tooltip.prototype,"darkTheme",2);var Tooltip=_Tooltip,_a31,Caption=(_a31=class extends BaseProperties{constructor(){super(...arguments),this.id=createId(this),this.node=new Text().setProperties({textAlign:"center",pointerEvents:1}),this.enabled=!1,this.textAlign="center",this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always",this.truncated=!1}registerInteraction(moduleCtx){return moduleCtx.interactionManager.addListener("hover",event=>this.handleMouseMove(moduleCtx,event))}computeTextWrap(containerWidth,containerHeight){var _a201,_b;const{text,wrapping}=this,maxWidth=Math.min((_a201=this.maxWidth)!=null?_a201:1/0,containerWidth),maxHeight=(_b=this.maxHeight)!=null?_b:containerHeight;if(!isFinite(maxWidth)&&!isFinite(maxHeight)){this.node.text=text;return}const{text:wrappedText,truncated}=Text.wrap(text??"",maxWidth,maxHeight,this,wrapping);this.node.text=wrappedText,this.truncated=truncated}handleMouseMove(moduleCtx,event){if(!this.enabled)return;const{offsetX,offsetY}=event,bbox=this.node.computeBBox(),pointerInsideCaption=this.node.visible&&bbox.containsPoint(offsetX,offsetY);pointerInsideCaption&&event.consume(),!this.truncated||!pointerInsideCaption?moduleCtx.tooltipManager.removeTooltip(this.id):moduleCtx.tooltipManager.updateTooltip(this.id,{offsetX,offsetY,lastPointerEvent:event,showArrow:!1,addCustomClass:!1},toTooltipHtml({content:this.text}))}},__name(_a31,"Caption"),_a31);Caption.SMALL_PADDING=10;Caption.LARGE_PADDING=20;__decorateClass([Validate(BOOLEAN)],Caption.prototype,"enabled",2);__decorateClass([Validate(STRING,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"text",2);__decorateClass([Validate(TEXT_ALIGN,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"textAlign",2);__decorateClass([Validate(FONT_STYLE,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT2,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER),ProxyPropertyOnWrite("node")],Caption.prototype,"fontSize",2);__decorateClass([Validate(STRING),ProxyPropertyOnWrite("node")],Caption.prototype,"fontFamily",2);__decorateClass([Validate(COLOR_STRING,{optional:!0}),ProxyPropertyOnWrite("node","fill")],Caption.prototype,"color",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"spacing",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"lineHeight",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"maxWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"maxHeight",2);__decorateClass([Validate(TEXT_WRAP)],Caption.prototype,"wrapping",2);var _a32,AxisTitle=(_a32=class{constructor(){this.enabled=!1,this.spacing=Caption.SMALL_PADDING,this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always"}},__name(_a32,"AxisTitle"),_a32);__decorateClass([Validate(BOOLEAN)],AxisTitle.prototype,"enabled",2);__decorateClass([Validate(STRING,{optional:!0})],AxisTitle.prototype,"text",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],AxisTitle.prototype,"spacing",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],AxisTitle.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT2,{optional:!0})],AxisTitle.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisTitle.prototype,"fontSize",2);__decorateClass([Validate(STRING)],AxisTitle.prototype,"fontFamily",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],AxisTitle.prototype,"color",2);__decorateClass([Validate(TEXT_WRAP)],AxisTitle.prototype,"wrapping",2);__decorateClass([Validate(FUNCTION,{optional:!0})],AxisTitle.prototype,"formatter",2);var JSON_APPLY_PLUGINS={constructedArrays:new WeakMap};function assignJsonApplyConstructedArray(array,ctor){var _a201;(_a201=JSON_APPLY_PLUGINS.constructedArrays)==null||_a201.set(array,ctor)}__name(assignJsonApplyConstructedArray,"assignJsonApplyConstructedArray");var JSON_APPLY_OPTIONS={constructors:{"axes[].title":AxisTitle},allowedTypes:{"legend.pagination.marker.shape":["primitive","function"],"axis[].tick.count":["primitive","class-instance"]}},_a33,_ContinuousScale=(_a33=class{constructor(domain,range3){this.invalid=!0,this.nice=!1,this.interval=void 0,this.tickCount=_a33.defaultTickCount,this.minTickCount=0,this.maxTickCount=1/0,this.niceDomain=[],this.defaultClampMode="raw",this.domain=domain,this.range=range3}static is(value){return value instanceof _a33}transform(x){return x}transformInvert(x){return x}calcBandwidth(smallestInterval=1){const{range:range3}=this,domain=this.getDomain(),rangeDistance=Math.abs(range3[1]-range3[0]),intervals=Math.abs(domain[1]-domain[0])/smallestInterval+1,maxBands=Math.floor(rangeDistance),bands=Math.min(intervals,maxBands);return rangeDistance/Math.max(1,bands)}fromDomain(d){return typeof d=="number"?d:d instanceof Date?d.getTime():NaN}getDomain(){return this.nice&&(this.refresh(),this.niceDomain.length)?this.niceDomain:this.domain}convert(x,opts){var _a201;const clampMode=(_a201=opts==null?void 0:opts.clampMode)!=null?_a201:this.defaultClampMode;if(!this.domain||this.domain.length<2)return NaN;this.refresh();const domain=this.getDomain().map(d=>this.transform(d)),[d0,d1]=domain,{range:range3}=this,[r0,r1]=range3;if(x=this.transform(x),clampMode==="clamped"){const start=Math.min(this.fromDomain(d0),this.fromDomain(d1)),stop=Math.max(this.fromDomain(d0),this.fromDomain(d1));if(this.fromDomain(x)<start)return r0;if(this.fromDomain(x)>stop)return r1}return d0===d1?(r0+r1)/2:x===d0?r0:x===d1?r1:r0+(this.fromDomain(x)-this.fromDomain(d0))/(this.fromDomain(d1)-this.fromDomain(d0))*(r1-r0)}invert(x){this.refresh();const domain=this.getDomain().map(d2=>this.transform(d2)),[d0,d1]=domain,{range:range3}=this,[r0,r1]=range3,isReversed=r0>r1,rMin=isReversed?r1:r0,rMax=isReversed?r0:r1;let d;return x<rMin?isReversed?d1:d0:x>rMax?isReversed?d0:d1:(r0===r1?d=this.toDomain((this.fromDomain(d0)+this.fromDomain(d1))/2):d=this.toDomain(this.fromDomain(d0)+(x-r0)/(r1-r0)*(this.fromDomain(d1)-this.fromDomain(d0))),this.transformInvert(d))}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}getPixelRange(){const range3=this.range.slice().sort((a,b)=>a-b);return range3[1]-range3[0]}isDenseInterval({start,stop,interval,count:count2}){const domain=stop-start,availableRange=this.getPixelRange();return count2??(count2=domain/(typeof interval=="number"?interval:1)),count2>=availableRange?(Logger.warn("the configured interval results in more than 1 item per pixel, ignoring. Supply a larger interval or omit this configuration"),!0):!1}},__name(_a33,"_ContinuousScale"),_a33);_ContinuousScale.defaultTickCount=5;_ContinuousScale.defaultMaxTickCount=6;__decorateClass([Invalidating],_ContinuousScale.prototype,"domain",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"range",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"nice",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"interval",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"tickCount",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"minTickCount",2);__decorateClass([Invalidating],_ContinuousScale.prototype,"maxTickCount",2);var ContinuousScale=_ContinuousScale;function ascendingStringNumberUndefined(a,b){let diff2=0;return typeof a=="number"&&typeof b=="number"?diff2=a-b:typeof a=="string"&&typeof b=="string"?diff2=a.localeCompare(b):a==null&&b==null||(a==null?diff2=-1:b==null?diff2=1:diff2=String(a).localeCompare(String(b))),diff2}__name(ascendingStringNumberUndefined,"ascendingStringNumberUndefined");function compoundAscending(a,b,comparator){const toLiteral=__name(v=>typeof v=="function"?v():v,"toLiteral");for(const idx in a){const diff2=comparator(toLiteral(a[idx]),toLiteral(b[idx]));if(diff2!==0)return diff2}return 0}__name(compoundAscending,"compoundAscending");var _a34,_Group=(_a34=class extends Node{constructor(opts){var _a201;super({isVirtual:opts==null?void 0:opts.isVirtual}),this.opts=opts,this.opacity=1,this.lastBBox=void 0;const{zIndex,zIndexSubOrder}=opts??{};this.isContainerNode=!0,zIndex!==void 0&&(this.zIndex=zIndex),zIndexSubOrder!==void 0&&(this.zIndexSubOrder=zIndexSubOrder),this.name=(_a201=this.opts)==null?void 0:_a201.name}zIndexChanged(){var _a201;this.layer&&((_a201=this._layerManager)==null||_a201.moveLayer(this.layer,this.zIndex,this.zIndexSubOrder))}isLayer(){return this.layer!=null}_setLayerManager(scene){var _a201,_b;if(this._layerManager&&this.layer&&(this._layerManager.removeLayer(this.layer),this.layer=void 0),this.layer)throw new Error("AG Charts - unable to deregister scene rendering layer!");if(super._setLayerManager(scene),scene&&((_a201=this.opts)!=null&&_a201.layer)){const{zIndex,zIndexSubOrder,name}=(_b=this.opts)!=null?_b:{},getComputedOpacity=__name(()=>this.getComputedOpacity(),"getComputedOpacity"),getVisibility=__name(()=>this.getVisibility(),"getVisibility");this.layer=scene.addLayer({zIndex,zIndexSubOrder,name,getComputedOpacity,getVisibility})}}getComputedOpacity(){let opacity=1,node=this;do node instanceof _a34&&(opacity*=node.opacity);while(node=node.parent);return opacity}getVisibility(){let node=this,visible=this.visible;for(;node=node.parent;)node.visible||(visible=node.visible);return visible}visibilityChanged(){this.layer&&(this.layer.enabled=this.visible)}markDirty(source,type=1){if(this.isVirtual){super.markDirty(source,type);return}let parentType=type;(type<2||this.layer!=null)&&(parentType=1),super.markDirty(source,type,parentType)}containsPoint(_x,_y){return!0}computeBBox(){return this.computeTransformMatrix(),_a34.computeBBox(this.children)}computeTransformedBBox(){return this.computeBBox()}render(renderCtx){var _a201,_b;const{opts:{name=void 0}={},_debug:debug3=__name(()=>{},"debug3")}=this,{dirty,dirtyZIndex,layer,children,clipRect,dirtyTransform}=this;let{ctx,forceRender,clipBBox}=renderCtx;const{resized,stats}=renderCtx,canvasCtxTransform=ctx.getTransform(),isDirty=dirty>=2||dirtyZIndex||resized;let isChildDirty=isDirty,isChildLayerDirty=!1;for(const child of children)if(isChildDirty||(isChildDirty=child.layerManager==null&&child.dirty>=1),isChildLayerDirty||(isChildLayerDirty=child.layerManager!=null&&child.dirty>=1),isChildDirty)break;if(name&&debug3({name,group:this,isDirty,isChildDirty,dirtyTransform,renderCtx,forceRender}),dirtyTransform)forceRender="dirtyTransform";else if(layer){const currentBBox=this.computeBBox();(this.lastBBox===void 0||!this.lastBBox.equals(currentBBox))&&(forceRender="dirtyTransform",this.lastBBox=currentBBox)}if(!isDirty&&!isChildDirty&&!isChildLayerDirty&&!forceRender){name&&stats&&debug3({name,result:"skipping",renderCtx,counts:this.nodeCount,group:this}),layer&&stats&&(stats.layersSkipped++,stats.nodesSkipped+=this.nodeCount.count),this.markClean({recursive:!1});return}const groupVisible=this.visible;if(layer){if(ctx=layer.context,ctx.save(),ctx.resetTransform(),forceRender!=="dirtyTransform"&&(forceRender=isChildDirty||dirtyZIndex),forceRender&&layer.clear(),clipBBox){const{width,height,x,y}=clipBBox;debug3(()=>({name,clipBBox,ctxTransform:ctx.getTransform(),renderCtx,group:this})),this.clipCtx(ctx,x,y,width,height)}ctx.setTransform(canvasCtxTransform)}else ctx.globalAlpha*=this.opacity;if(this.computeTransformMatrix(),this.matrix.toContext(ctx),clipRect){const{x,y,width,height}=clipRect;ctx.save(),debug3(()=>({name,clipRect,ctxTransform:ctx.getTransform(),renderCtx,group:this})),this.clipCtx(ctx,x,y,width,height),clipBBox=this.matrix.transformBBox(clipRect)}const hasVirtualChildren=this.hasVirtualChildren();dirtyZIndex?(this.sortChildren(children),forceRender!=="dirtyTransform"&&(forceRender=!0)):hasVirtualChildren&&this.sortChildren(children);const childRenderContext=forceRender!==renderCtx.forceRender||clipBBox!==renderCtx.clipBBox||ctx!==renderCtx.ctx?__spreadProps(__spreadValues({},renderCtx),{ctx,forceRender,clipBBox}):renderCtx;let skipped=0;for(const child of children){if(!child.visible||!groupVisible){child.markClean(),stats&&(skipped+=child.nodeCount.count);continue}if(!forceRender&&child.dirty===0){stats&&(skipped+=child.nodeCount.count);continue}ctx.save(),child.render(childRenderContext),ctx.restore()}if(stats&&(stats.nodesSkipped+=skipped),super.render(renderCtx),clipRect&&ctx.restore(),hasVirtualChildren)for(const child of this.virtualChildren)child.markClean({recursive:"virtual"});layer&&(stats&&stats.layersRendered++,ctx.restore(),forceRender&&layer.snapshot(),(_b=(_a201=layer.context).verifyDepthZero)==null||_b.call(_a201)),name&&stats&&debug3({name,result:"rendered",skipped,renderCtx,counts:this.nodeCount,group:this})}sortChildren(children){this.dirtyZIndex=!1,children.sort((a,b)=>{var _a201,_b;return compoundAscending([a.zIndex,...(_a201=a.zIndexSubOrder)!=null?_a201:[void 0,void 0],a.serialNumber],[b.zIndex,...(_b=b.zIndexSubOrder)!=null?_b:[void 0,void 0],b.serialNumber],ascendingStringNumberUndefined)})}clipCtx(ctx,x,y,width,height){ctx.beginPath(),ctx.moveTo(x,y),ctx.lineTo(x+width,y),ctx.lineTo(x+width,y+height),ctx.lineTo(x,y+height),ctx.closePath(),ctx.clip()}static computeBBox(nodes){let left=1/0,right=-1/0,top=1/0,bottom=-1/0;return nodes.forEach(n=>{if(!n.visible)return;const bbox=n.computeTransformedBBox();if(!bbox)return;const x=bbox.x,y=bbox.y;x<left&&(left=x),y<top&&(top=y),x+bbox.width>right&&(right=x+bbox.width),y+bbox.height>bottom&&(bottom=y+bbox.height)}),new BBox(left,top,right-left,bottom-top)}setClipRectInGroupCoordinateSpace(bbox){this.clipRect=bbox?this.transformBBox(bbox):void 0}},__name(_a34,"_Group"),_a34);_Group.className="Group";__decorateClass([SceneChangeDetection({redraw:3,convertor:v=>clamp(0,v,1)})],_Group.prototype,"opacity",2);var Group=_Group,_a35,Range=(_a35=class extends Shape{constructor(opts={}){super(opts),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.startLine=!1,this.endLine=!1,this.isRange=!1,this.restoreOwnStyles()}computeBBox(){return new BBox(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1)}isPointInPath(_x,_y){return!1}render(renderCtx){var _a201;const{ctx,forceRender,stats}=renderCtx;if(this.dirty===0&&!forceRender){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}this.computeTransformMatrix(),this.matrix.toContext(ctx);let{x1,y1,x2,y2}=this;x1=this.align(x1),y1=this.align(y1),x2=this.align(x2),y2=this.align(y2);const{fill,opacity,isRange}=this;if(!!(isRange&&fill)){const{fillOpacity}=this;ctx.fillStyle=fill,ctx.globalAlpha=opacity*fillOpacity,ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y1),ctx.lineTo(x2,y2),ctx.lineTo(x1,y2),ctx.closePath(),ctx.fill()}const{stroke,strokeWidth,startLine,endLine}=this;if(!!((startLine||endLine)&&stroke&&strokeWidth)){const{strokeOpacity,lineDash,lineDashOffset,lineCap,lineJoin}=this;ctx.strokeStyle=stroke,ctx.globalAlpha=opacity*strokeOpacity,ctx.lineWidth=strokeWidth,lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),ctx.beginPath(),startLine&&(ctx.moveTo(x1,y1),ctx.lineTo(x2,y1)),endLine&&(ctx.moveTo(x2,y2),ctx.lineTo(x1,y2)),ctx.stroke()}(_a201=this.fillShadow)==null||_a201.markClean(),super.render(renderCtx)}},__name(_a35,"Range"),_a35);Range.className="Range";Range.defaultStyles=__spreadProps(__spreadValues({},Shape.defaultStyles),{strokeWidth:1});__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"x1",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"y1",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"x2",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"y2",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"startLine",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"endLine",2);__decorateClass([SceneChangeDetection({redraw:2})],Range.prototype,"isRange",2);var _a36,Label=(_a36=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0,this.color="#464646",this.fontSize=12,this.fontFamily="Verdana, sans-serif"}getFont(){return getFont(this)}},__name(_a36,"Label"),_a36);__decorateClass([Validate(BOOLEAN)],Label.prototype,"enabled",2);__decorateClass([Validate(COLOR_STRING)],Label.prototype,"color",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],Label.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT2,{optional:!0})],Label.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],Label.prototype,"fontSize",2);__decorateClass([Validate(STRING)],Label.prototype,"fontFamily",2);__decorateClass([Validate(FUNCTION,{optional:!0})],Label.prototype,"formatter",2);function calculateLabelRotation(opts){const{parallelFlipRotation=0,regularFlipRotation=0}=opts,configuredRotation=opts.rotation?normalizeAngle360(toRadians(opts.rotation)):0,parallelFlipFlag=!configuredRotation&&parallelFlipRotation>=0&&parallelFlipRotation<=Math.PI?-1:1,regularFlipFlag=!configuredRotation&&regularFlipRotation>=0&&regularFlipRotation<=Math.PI?-1:1;let defaultRotation=0;return opts.parallel?defaultRotation=parallelFlipFlag*Math.PI/2:regularFlipFlag===-1&&(defaultRotation=Math.PI),{configuredRotation,defaultRotation,parallelFlipFlag,regularFlipFlag}}__name(calculateLabelRotation,"calculateLabelRotation");function getLabelSpacing(minSpacing,rotated){return isNaN(minSpacing)?rotated?0:10:minSpacing}__name(getLabelSpacing,"getLabelSpacing");function getTextBaseline(parallel,labelRotation,sideFlag,parallelFlipFlag){return parallel&&!labelRotation?sideFlag*parallelFlipFlag===-1?"hanging":"bottom":"middle"}__name(getTextBaseline,"getTextBaseline");function getTextAlign(parallel,labelRotation,labelAutoRotation,sideFlag,regularFlipFlag){const labelRotated=labelRotation>0&&labelRotation<=Math.PI,labelAutoRotated=labelAutoRotation>0&&labelAutoRotation<=Math.PI,alignFlag=labelRotated||labelAutoRotated?-1:1;if(parallel)if(labelRotation||labelAutoRotation){if(sideFlag*alignFlag===-1)return"end"}else return"center";else if(sideFlag*regularFlipFlag===-1)return"end";return"start"}__name(getTextAlign,"getTextAlign");function calculateLabelBBox(text,bbox,labelX,labelY,labelMatrix){const{width,height}=bbox,translatedBBox=new BBox(labelX,labelY,0,0);labelMatrix.transformBBox(translatedBBox,bbox);const{x=0,y=0}=bbox;return bbox.width=width,bbox.height=height,{point:{x,y,size:0},label:{width,height,text}}}__name(calculateLabelBBox,"calculateLabelBBox");var Layers=(Layers2=>(Layers2[Layers2.SERIES_BACKGROUND_ZINDEX=0]="SERIES_BACKGROUND_ZINDEX",Layers2[Layers2.AXIS_GRID_ZINDEX=1]="AXIS_GRID_ZINDEX",Layers2[Layers2.AXIS_ZINDEX=2]="AXIS_ZINDEX",Layers2[Layers2.SERIES_CROSSLINE_RANGE_ZINDEX=3]="SERIES_CROSSLINE_RANGE_ZINDEX",Layers2[Layers2.SERIES_LAYER_ZINDEX=4]="SERIES_LAYER_ZINDEX",Layers2[Layers2.AXIS_FOREGROUND_ZINDEX=5]="AXIS_FOREGROUND_ZINDEX",Layers2[Layers2.SERIES_CROSSHAIR_ZINDEX=6]="SERIES_CROSSHAIR_ZINDEX",Layers2[Layers2.SERIES_LABEL_ZINDEX=7]="SERIES_LABEL_ZINDEX",Layers2[Layers2.SERIES_CROSSLINE_LINE_ZINDEX=8]="SERIES_CROSSLINE_LINE_ZINDEX",Layers2[Layers2.LEGEND_ZINDEX=9]="LEGEND_ZINDEX",Layers2))(Layers||{}),isStringObject=__name(value=>!!value&&Object.hasOwn(value,"toString")&&isString(value.toString()),"isStringObject"),isNumberObject=__name(value=>!!value&&Object.hasOwn(value,"valueOf")&&isFiniteNumber(value.valueOf()),"isNumberObject"),isContinuous=__name(value=>isFiniteNumber(value)||isNumberObject(value)||isValidDate(value),"isContinuous");function checkDatum(value,isContinuousScale){if(isContinuousScale&&isContinuous(value))return value;if(!isContinuousScale)return isString(value)||isStringObject(value)?value:String(value)}__name(checkDatum,"checkDatum");function transformIntegratedCategoryValue(value){return isStringObject(value)&&Object.hasOwn(value,"id")?value.id:value}__name(transformIntegratedCategoryValue,"transformIntegratedCategoryValue");var MATCHING_CROSSLINE_TYPE=__name(property=>property==="value"?predicateWithMessage((_,ctx)=>ctx.target.type==="line",ctx=>ctx.target.type==="range"?"crossLine type 'range' to have a 'range' property instead of 'value'":"crossLine property 'type' to be 'line'"):predicateWithMessage((_,ctx)=>ctx.target.type==="range",ctx=>ctx.target.type==="line"?"crossLine type 'line' to have a 'value' property instead of 'range'":"crossLine property 'type' to be 'range'"),"MATCHING_CROSSLINE_TYPE"),validateCrossLineValues=__name((type,value,range3,scale2)=>{const lineCrossLine=type==="line"&&value!==void 0,rangeCrossLine=type==="range"&&range3!==void 0;if(!lineCrossLine&&!rangeCrossLine)return!0;const[start,end]=range3??[value,void 0],isContinuous2=ContinuousScale.is(scale2),validStart=checkDatum(start,isContinuous2)!=null&&!isNaN(scale2.convert(start)),validEnd=checkDatum(end,isContinuous2)!=null&&!isNaN(scale2.convert(end));if(lineCrossLine&&validStart||rangeCrossLine&&validStart&&validEnd)return!0;const message=["Expecting crossLine"];return rangeCrossLine?(validStart||message.push(`range start ${stringify(start)}`),validEnd||message.push(`${validStart?"":"and "}range end ${stringify(end)}`)):message.push(`value ${stringify(start)}`),message.push("to match the axis scale domain."),Logger.warnOnce(message.join(" ")),!1},"validateCrossLineValues"),horizontalCrosslineTranslationDirections={top:{xTranslationDirection:0,yTranslationDirection:-1},bottom:{xTranslationDirection:0,yTranslationDirection:1},left:{xTranslationDirection:-1,yTranslationDirection:0},right:{xTranslationDirection:1,yTranslationDirection:0},topLeft:{xTranslationDirection:1,yTranslationDirection:-1},topRight:{xTranslationDirection:-1,yTranslationDirection:-1},bottomLeft:{xTranslationDirection:1,yTranslationDirection:1},bottomRight:{xTranslationDirection:-1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},insideLeft:{xTranslationDirection:1,yTranslationDirection:0},insideRight:{xTranslationDirection:-1,yTranslationDirection:0},insideTop:{xTranslationDirection:0,yTranslationDirection:1},insideBottom:{xTranslationDirection:0,yTranslationDirection:-1},insideTopLeft:{xTranslationDirection:1,yTranslationDirection:1},insideBottomLeft:{xTranslationDirection:1,yTranslationDirection:-1},insideTopRight:{xTranslationDirection:-1,yTranslationDirection:1},insideBottomRight:{xTranslationDirection:-1,yTranslationDirection:-1}},verticalCrossLineTranslationDirections={top:{xTranslationDirection:1,yTranslationDirection:0},bottom:{xTranslationDirection:-1,yTranslationDirection:0},left:{xTranslationDirection:0,yTranslationDirection:-1},right:{xTranslationDirection:0,yTranslationDirection:1},topLeft:{xTranslationDirection:-1,yTranslationDirection:-1},topRight:{xTranslationDirection:-1,yTranslationDirection:1},bottomLeft:{xTranslationDirection:1,yTranslationDirection:-1},bottomRight:{xTranslationDirection:1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},insideLeft:{xTranslationDirection:0,yTranslationDirection:1},insideRight:{xTranslationDirection:0,yTranslationDirection:-1},insideTop:{xTranslationDirection:-1,yTranslationDirection:0},insideBottom:{xTranslationDirection:1,yTranslationDirection:0},insideTopLeft:{xTranslationDirection:-1,yTranslationDirection:1},insideBottomLeft:{xTranslationDirection:1,yTranslationDirection:1},insideTopRight:{xTranslationDirection:-1,yTranslationDirection:-1},insideBottomRight:{xTranslationDirection:1,yTranslationDirection:-1}};function calculateLabelTranslation({yDirection,padding=0,position="top",bbox}){const crossLineTranslationDirections=yDirection?horizontalCrosslineTranslationDirections:verticalCrossLineTranslationDirections,{xTranslationDirection,yTranslationDirection}=crossLineTranslationDirections[position],w=yDirection?bbox.width:bbox.height,h=yDirection?bbox.height:bbox.width,xTranslation=xTranslationDirection*(padding+w/2),yTranslation=yTranslationDirection*(padding+h/2);return{xTranslation,yTranslation}}__name(calculateLabelTranslation,"calculateLabelTranslation");function calculateLabelChartPadding({yDirection,bbox,padding=0,position="top"}){const chartPadding={};return position.startsWith("inside")||(position==="top"&&!yDirection?chartPadding.top=padding+bbox.height:position==="bottom"&&!yDirection?chartPadding.bottom=padding+bbox.height:position==="left"&&yDirection?chartPadding.left=padding+bbox.width:position==="right"&&yDirection&&(chartPadding.right=padding+bbox.width)),chartPadding}__name(calculateLabelChartPadding,"calculateLabelChartPadding");var POSITION_TOP_COORDINATES=__name(({yDirection,xEnd,yStart,yEnd})=>yDirection?{x:xEnd/2,y:yStart}:{x:xEnd,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2},"POSITION_TOP_COORDINATES"),POSITION_LEFT_COORDINATES=__name(({yDirection,xStart,xEnd,yStart,yEnd})=>yDirection?{x:xStart,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}:{x:xEnd/2,y:yStart},"POSITION_LEFT_COORDINATES"),POSITION_RIGHT_COORDINATES=__name(({yDirection,xEnd,yStart,yEnd})=>yDirection?{x:xEnd,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}:{x:xEnd/2,y:isNaN(yEnd)?yStart:yEnd},"POSITION_RIGHT_COORDINATES"),POSITION_BOTTOM_COORDINATES=__name(({yDirection,xStart,xEnd,yStart,yEnd})=>yDirection?{x:xEnd/2,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2},"POSITION_BOTTOM_COORDINATES"),POSITION_INSIDE_COORDINATES=__name(({xEnd,yStart,yEnd})=>({x:xEnd/2,y:isNaN(yEnd)?yStart:(yStart+yEnd)/2}),"POSITION_INSIDE_COORDINATES"),POSITION_TOP_LEFT_COORDINATES=__name(({yDirection,xStart,xEnd,yStart})=>yDirection?{x:xStart/2,y:yStart}:{x:xEnd,y:yStart},"POSITION_TOP_LEFT_COORDINATES"),POSITION_BOTTOM_LEFT_COORDINATES=__name(({yDirection,xStart,yStart,yEnd})=>yDirection?{x:xStart,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:yStart},"POSITION_BOTTOM_LEFT_COORDINATES"),POSITION_TOP_RIGHT_COORDINATES=__name(({yDirection,xEnd,yStart,yEnd})=>yDirection?{x:xEnd,y:yStart}:{x:xEnd,y:isNaN(yEnd)?yStart:yEnd},"POSITION_TOP_RIGHT_COORDINATES"),POSITION_BOTTOM_RIGHT_COORDINATES=__name(({yDirection,xStart,xEnd,yStart,yEnd})=>yDirection?{x:xEnd,y:isNaN(yEnd)?yStart:yEnd}:{x:xStart,y:isNaN(yEnd)?yStart:yEnd},"POSITION_BOTTOM_RIGHT_COORDINATES"),labelDirectionHandling={top:{c:POSITION_TOP_COORDINATES},bottom:{c:POSITION_BOTTOM_COORDINATES},left:{c:POSITION_LEFT_COORDINATES},right:{c:POSITION_RIGHT_COORDINATES},topLeft:{c:POSITION_TOP_LEFT_COORDINATES},topRight:{c:POSITION_TOP_RIGHT_COORDINATES},bottomLeft:{c:POSITION_BOTTOM_LEFT_COORDINATES},bottomRight:{c:POSITION_BOTTOM_RIGHT_COORDINATES},inside:{c:POSITION_INSIDE_COORDINATES},insideLeft:{c:POSITION_LEFT_COORDINATES},insideRight:{c:POSITION_RIGHT_COORDINATES},insideTop:{c:POSITION_TOP_COORDINATES},insideBottom:{c:POSITION_BOTTOM_COORDINATES},insideTopLeft:{c:POSITION_TOP_LEFT_COORDINATES},insideBottomLeft:{c:POSITION_BOTTOM_LEFT_COORDINATES},insideTopRight:{c:POSITION_TOP_RIGHT_COORDINATES},insideBottomRight:{c:POSITION_BOTTOM_RIGHT_COORDINATES}},CROSSLINE_LABEL_POSITION=UNION(["top","left","right","bottom","topLeft","topRight","bottomLeft","bottomRight","inside","insideLeft","insideRight","insideTop","insideBottom","insideTopLeft","insideBottomLeft","insideTopRight","insideBottomRight"],"crossLine label position"),_a37,CartesianCrossLineLabel=(_a37=class{constructor(){this.enabled=void 0,this.text=void 0,this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)",this.position=void 0,this.rotation=void 0,this.parallel=void 0}},__name(_a37,"CartesianCrossLineLabel"),_a37);__decorateClass([Validate(BOOLEAN,{optional:!0})],CartesianCrossLineLabel.prototype,"enabled",2);__decorateClass([Validate(STRING,{optional:!0})],CartesianCrossLineLabel.prototype,"text",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],CartesianCrossLineLabel.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT2,{optional:!0})],CartesianCrossLineLabel.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],CartesianCrossLineLabel.prototype,"fontSize",2);__decorateClass([Validate(STRING)],CartesianCrossLineLabel.prototype,"fontFamily",2);__decorateClass([Validate(NUMBER)],CartesianCrossLineLabel.prototype,"padding",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],CartesianCrossLineLabel.prototype,"color",2);__decorateClass([Validate(CROSSLINE_LABEL_POSITION,{optional:!0})],CartesianCrossLineLabel.prototype,"position",2);__decorateClass([Validate(DEGREE,{optional:!0})],CartesianCrossLineLabel.prototype,"rotation",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],CartesianCrossLineLabel.prototype,"parallel",2);var _a38,_CartesianCrossLine=(_a38=class{constructor(){this.id=createId(this),this.enabled=void 0,this.type=void 0,this.range=void 0,this.value=void 0,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=void 0,this.strokeOpacity=void 0,this.lineDash=void 0,this.label=new CartesianCrossLineLabel,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction="x",this.group=new Group({name:`${this.id}`,layer:!0,zIndex:_a38.LINE_LAYER_ZINDEX}),this.labelGroup=new Group({name:`${this.id}`,layer:!0,zIndex:_a38.LABEL_LAYER_ZINDEX}),this.crossLineRange=new Range,this.crossLineLabel=new Text,this.labelPoint=void 0,this.data=[],this.startLine=!1,this.endLine=!1,this.isRange=!1;const{group:group2,labelGroup,crossLineRange,crossLineLabel}=this;group2.append(crossLineRange),labelGroup.append(crossLineLabel),crossLineRange.pointerEvents=1}update(visible){const{enabled,data,type,value,range:range3,scale:scale2}=this;if(!type||!scale2||!enabled||!visible||!validateCrossLineValues(type,value,range3,scale2)||data.length===0){this.group.visible=!1,this.labelGroup.visible=!1;return}this.group.visible=visible,this.labelGroup.visible=visible,this.group.zIndex=this.getZIndex(this.isRange),this.updateNodes()}calculateLayout(visible,reversedAxis){if(!visible||!this.createNodeData(reversedAxis))return;const{sideFlag,gridLength,data}=this,boxes=[],x1=0,x2=sideFlag*gridLength,y1=data[0],y2=data[1],crossLineBox=new BBox(Math.min(x1,x2),Math.min(y1,y2),Math.abs(x1-x2),Math.abs(y1-y2));boxes.push(crossLineBox);const labelBox=this.computeLabelBBox();return labelBox&&boxes.push(labelBox),BBox.merge(boxes)}updateNodes(){this.updateRangeNode(),this.label.enabled&&(this.updateLabel(),this.positionLabel())}createNodeData(reversedAxis){var _a201,_b,_c;const{scale:scale2,gridLength,sideFlag,direction,label:{position="top"},clippedRange,strokeWidth=0}=this;if(this.data=[],!scale2)return!1;const bandwidth=(_a201=scale2.bandwidth)!=null?_a201:0,step=(_b=scale2.step)!=null?_b:0,padding=(reversedAxis?-1:1)*(scale2 instanceof BandScale?(step-bandwidth)/2:0),[xStart,xEnd]=[0,sideFlag*gridLength];let[yStart,yEnd]=this.getRange(),[clampedYStart,clampedYEnd]=[Number(scale2.convert(yStart,{clampMode:"clamped"}))-padding,scale2.convert(yEnd,{clampMode:"clamped"})+bandwidth+padding];clampedYStart=clampArray(clampedYStart,clippedRange),clampedYEnd=clampArray(clampedYEnd,clippedRange),[yStart,yEnd]=[Number(scale2.convert(yStart)),scale2.convert(yEnd)+bandwidth];const validRange=(yStart===clampedYStart||yEnd===clampedYEnd||clampedYStart!==clampedYEnd)&&Math.abs(clampedYEnd-clampedYStart)>0;if(validRange&&clampedYStart>clampedYEnd&&([clampedYStart,clampedYEnd]=[clampedYEnd,clampedYStart],[yStart,yEnd]=[yEnd,yStart]),yStart-padding>=clampedYStart&&(yStart-=padding),yEnd+padding<=clampedYEnd&&(yEnd+=padding),this.isRange=validRange,this.startLine=strokeWidth>0&&yStart>=clampedYStart&&yStart<=clampedYStart+padding,this.endLine=strokeWidth>0&&yEnd>=clampedYEnd-bandwidth-padding&&yEnd<=clampedYEnd,!validRange&&!this.startLine&&!this.endLine)return!1;if(this.data=[clampedYStart,clampedYEnd],this.label.enabled){const yDirection=direction==="y",{c=POSITION_TOP_COORDINATES}=(_c=labelDirectionHandling[position])!=null?_c:{},{x:labelX,y:labelY}=c({yDirection,xStart,xEnd,yStart:clampedYStart,yEnd:clampedYEnd});this.labelPoint={x:labelX,y:labelY}}return!0}updateRangeNode(){var _a201;const{crossLineRange,sideFlag,gridLength,data,startLine,endLine,isRange,fill,fillOpacity,stroke,strokeWidth,lineDash}=this;crossLineRange.x1=0,crossLineRange.x2=sideFlag*gridLength,crossLineRange.y1=data[0],crossLineRange.y2=data[1],crossLineRange.startLine=startLine,crossLineRange.endLine=endLine,crossLineRange.isRange=isRange,crossLineRange.fill=fill,crossLineRange.fillOpacity=fillOpacity??1,crossLineRange.stroke=stroke,crossLineRange.strokeWidth=strokeWidth??1,crossLineRange.strokeOpacity=(_a201=this.strokeOpacity)!=null?_a201:1,crossLineRange.lineDash=lineDash}updateLabel(){const{crossLineLabel,label}=this;label.text&&(crossLineLabel.fontStyle=label.fontStyle,crossLineLabel.fontWeight=label.fontWeight,crossLineLabel.fontSize=label.fontSize,crossLineLabel.fontFamily=label.fontFamily,crossLineLabel.fill=label.color,crossLineLabel.text=label.text)}positionLabel(){const{crossLineLabel,labelPoint:{x=void 0,y=void 0}={},label:{parallel,rotation,position="top",padding=0},direction,parallelFlipRotation,regularFlipRotation}=this;if(x===void 0||y===void 0)return;const{defaultRotation,configuredRotation}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation});crossLineLabel.rotation=defaultRotation+configuredRotation,crossLineLabel.textBaseline="middle",crossLineLabel.textAlign="center";const bbox=crossLineLabel.computeTransformedBBox();if(!bbox)return;const yDirection=direction==="y",{xTranslation,yTranslation}=calculateLabelTranslation({yDirection,padding,position,bbox});crossLineLabel.translationX=x+xTranslation,crossLineLabel.translationY=y+yTranslation}getZIndex(isRange=!1){return isRange?_a38.RANGE_LAYER_ZINDEX:_a38.LINE_LAYER_ZINDEX}getRange(){var _a201;const{value,range:range3,scale:scale2}=this,isContinuous2=ContinuousScale.is(scale2),start=(_a201=range3==null?void 0:range3[0])!=null?_a201:value;let end=range3==null?void 0:range3[1];return!isContinuous2&&end===void 0&&(end=start),isContinuous2&&start===end&&(end=void 0),[start,end]}computeLabelBBox(){const{label}=this;if(!label.enabled)return;const tempText=new Text;tempText.fontFamily=label.fontFamily,tempText.fontSize=label.fontSize,tempText.fontStyle=label.fontStyle,tempText.fontWeight=label.fontWeight,tempText.text=label.text;const{labelPoint:{x=void 0,y=void 0}={},label:{parallel,rotation,position="top",padding=0},direction,parallelFlipRotation,regularFlipRotation}=this;if(x===void 0||y===void 0)return;const{configuredRotation}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation});tempText.rotation=configuredRotation,tempText.textBaseline="middle",tempText.textAlign="center";const bbox=tempText.computeTransformedBBox();if(!bbox)return;const yDirection=direction==="y",{xTranslation,yTranslation}=calculateLabelTranslation({yDirection,padding,position,bbox});return tempText.translationX=x+xTranslation,tempText.translationY=y+yTranslation,tempText.computeTransformedBBox()}calculatePadding(padding){var _a201,_b,_c,_d,_e,_f,_g,_h;const{isRange,startLine,endLine,direction,label:{padding:labelPadding=0,position="top"}}=this;if(!isRange&&!startLine&&!endLine)return;const crossLineLabelBBox=this.computeLabelBBox();if((crossLineLabelBBox==null?void 0:crossLineLabelBBox.x)==null||(crossLineLabelBBox==null?void 0:crossLineLabelBBox.y)==null)return;const chartPadding=calculateLabelChartPadding({yDirection:direction==="y",padding:labelPadding,position,bbox:crossLineLabelBBox});padding.left=Math.max((_a201=padding.left)!=null?_a201:0,(_b=chartPadding.left)!=null?_b:0),padding.right=Math.max((_c=padding.right)!=null?_c:0,(_d=chartPadding.right)!=null?_d:0),padding.top=Math.max((_e=padding.top)!=null?_e:0,(_f=chartPadding.top)!=null?_f:0),padding.bottom=Math.max((_g=padding.bottom)!=null?_g:0,(_h=chartPadding.bottom)!=null?_h:0)}},__name(_a38,"_CartesianCrossLine"),_a38);_CartesianCrossLine.LINE_LAYER_ZINDEX=8;_CartesianCrossLine.RANGE_LAYER_ZINDEX=3;_CartesianCrossLine.LABEL_LAYER_ZINDEX=7;_CartesianCrossLine.className="CrossLine";__decorateClass([Validate(BOOLEAN,{optional:!0})],_CartesianCrossLine.prototype,"enabled",2);__decorateClass([Validate(UNION(["range","line"],"a crossLine type"),{optional:!0})],_CartesianCrossLine.prototype,"type",2);__decorateClass([Validate(AND(MATCHING_CROSSLINE_TYPE("range"),ARRAY.restrict({length:2})),{optional:!0})],_CartesianCrossLine.prototype,"range",2);__decorateClass([Validate(MATCHING_CROSSLINE_TYPE("value"),{optional:!0})],_CartesianCrossLine.prototype,"value",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],_CartesianCrossLine.prototype,"fill",2);__decorateClass([Validate(RATIO,{optional:!0})],_CartesianCrossLine.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],_CartesianCrossLine.prototype,"stroke",2);__decorateClass([Validate(NUMBER,{optional:!0})],_CartesianCrossLine.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO,{optional:!0})],_CartesianCrossLine.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH,{optional:!0})],_CartesianCrossLine.prototype,"lineDash",2);var CartesianCrossLine=_CartesianCrossLine,_a39,ModuleMap=(_a39=class{constructor(){this.moduleMap=new Map}addModule(module,moduleFactory){if(this.moduleMap.has(module.optionsKey))throw new Error(`AG Charts - module already initialised: ${module.optionsKey}`);this.moduleMap.set(module.optionsKey,moduleFactory(module))}removeModule(module){var _a201;const moduleKey=isString(module)?module:module.optionsKey;(_a201=this.moduleMap.get(moduleKey))==null||_a201.destroy(),this.moduleMap.delete(moduleKey)}isModuleEnabled(module){return this.moduleMap.has(isString(module)?module:module.optionsKey)}getModule(module){return this.moduleMap.get(isString(module)?module:module.optionsKey)}get modules(){return this.moduleMap.values()}mapValues(callback){return Array.from(this.moduleMap.values()).map(callback)}destroy(){for(const optionsKey of this.moduleMap.keys())this.removeModule({optionsKey})}},__name(_a39,"ModuleMap"),_a39),resetMotion_exports={};__export(resetMotion_exports,{resetMotion:()=>resetMotion});function resetMotion(selectionsOrNodes,propsFn){const{nodes,selections}=deconstructSelectionsOrNodes(selectionsOrNodes);for(const selection of selections){for(const node of selection.nodes()){const from=propsFn(node,node.datum);node.setProperties(from)}selection.cleanup()}for(const node of nodes){const from=propsFn(node,node.datum);node.setProperties(from)}}__name(resetMotion,"resetMotion");var _a40,StateMachine=(_a40=class{constructor(initialState,states,preTransitionCb){this.states=states,this.preTransitionCb=preTransitionCb,this.debug=Debug.create(!0,"animation"),this.state=initialState,this.debug(`%c${this.constructor.name} | init -> ${initialState}`,"color: green")}transition(event,data){var _a201,_b;const currentStateConfig=this.states[this.state],destinationTransition=currentStateConfig==null?void 0:currentStateConfig[event];if(!destinationTransition){this.debug(`%c${this.constructor.name} | ${this.state} -> ${event} -> ${this.state}`,"color: grey");return}let destinationState=this.state;return typeof destinationTransition=="string"?destinationState=destinationTransition:typeof destinationTransition=="object"&&(destinationState=destinationTransition.target),this.debug(`%c${this.constructor.name} | ${this.state} -> ${event} -> ${destinationState}`,"color: green"),(_a201=this.preTransitionCb)==null||_a201.call(this,this.state,destinationState),this.state=destinationState,typeof destinationTransition=="function"?destinationTransition(data):typeof destinationTransition=="object"&&((_b=destinationTransition.action)==null||_b.call(destinationTransition,data)),this.state}},__name(_a40,"StateMachine"),_a40),group=__name(content=>`(${content})`,"group"),optionalGroup=__name(content=>`${group(content)}?`,"optionalGroup"),nonCapturingGroup=__name(content=>optionalGroup(`?:${content}`),"nonCapturingGroup"),formatRegEx=(()=>{const fill=".",align="[<>=^]",sign="[+\\-( ]",symbol="[$#]",zero="0",width="\\d+",comma=",",precision="\\d+",tilde="~",type="[%a-z]";return new RegExp(["^",nonCapturingGroup(`${optionalGroup(fill)}${group(align)}`),optionalGroup(sign),optionalGroup(symbol),optionalGroup(zero),optionalGroup(width),optionalGroup(comma),nonCapturingGroup(`\\.${group(precision)}`),optionalGroup(tilde),optionalGroup(type),"$"].join(""),"i")})(),surroundedRegEx=(()=>{const prefix=".*?",content=".+?",suffix=".*?";return new RegExp(["^",group(prefix),`#\\{${group(content)}\\}`,group(suffix),"$"].join(""))})();function parseFormatter(formatter){let prefix,suffix;const surrounded=surroundedRegEx.exec(formatter);surrounded&&([,prefix,formatter,suffix]=surrounded);const match=formatRegEx.exec(formatter);if(!match)throw new Error(`The number formatter is invalid: ${formatter}`);const[,fill,align,sign,symbol,zero,width,comma,precision,trim,type]=match;return{fill,align,sign,symbol,zero,width:parseInt(width),comma,precision:parseInt(precision),trim:!!trim,type,prefix,suffix}}__name(parseFormatter,"parseFormatter");function format(formatter){const options=typeof formatter=="string"?parseFormatter(formatter):formatter,{fill,align,sign="-",symbol,zero,width,comma,type,prefix="",suffix="",precision}=options;let{trim}=options;const precisionIsNaN=precision===void 0||isNaN(precision);let formatBody;if(!type)formatBody=decimalTypes.g,trim=!0;else if(type in decimalTypes&&type in integerTypes)formatBody=precisionIsNaN?integerTypes[type]:decimalTypes[type];else if(type in decimalTypes)formatBody=decimalTypes[type];else if(type in integerTypes)formatBody=integerTypes[type];else throw new Error(`The number formatter type is invalid: ${type}`);let formatterPrecision;return precision==null||precisionIsNaN?formatterPrecision=type?6:12:formatterPrecision=precision,n=>{let result=formatBody(n,formatterPrecision);return trim&&(result=removeTrailingZeros(result)),comma&&(result=insertSeparator(result,comma)),result=addSign(n,result,sign),symbol&&symbol!=="#"&&(result=`${symbol}${result}`),symbol==="#"&&type==="x"&&(result=`0x${result}`),type==="s"&&(result=`${result}${getSIPrefix(n)}`),(type==="%"||type==="p")&&(result=`${result}%`),width!=null&&!isNaN(width)&&(result=addPadding(result,width,fill??zero,align)),result=`${prefix}${result}${suffix}`,result}}__name(format,"format");var absFloor=__name(n=>Math.floor(Math.abs(n)),"absFloor"),integerTypes={b:n=>absFloor(n).toString(2),c:n=>String.fromCharCode(n),d:n=>Math.round(Math.abs(n)).toFixed(0),o:n=>absFloor(n).toString(8),x:n=>absFloor(n).toString(16),X:n=>integerTypes.x(n).toUpperCase(),n:n=>integerTypes.d(n),"%":n=>`${absFloor(n*100).toFixed(0)}`},decimalTypes={e:(n,f)=>Math.abs(n).toExponential(f),E:(n,f)=>decimalTypes.e(n,f).toUpperCase(),f:(n,f)=>Math.abs(n).toFixed(f),F:(n,f)=>decimalTypes.f(n,f).toUpperCase(),g:(n,f)=>{if(n===0)return"0";const a=Math.abs(n),p=Math.floor(Math.log10(a));return p>=-4&&p<f?a.toFixed(f-1-p):a.toExponential(f-1)},G:(n,f)=>decimalTypes.g(n,f).toUpperCase(),n:(n,f)=>decimalTypes.g(n,f),p:(n,f)=>decimalTypes.r(n*100,f),r:(n,f)=>{if(n===0)return"0";const a=Math.abs(n),q=Math.floor(Math.log10(a))-(f-1);if(q<=0)return a.toFixed(-q);const x=Math.pow(10,q);return(Math.round(a/x)*x).toFixed()},s:(n,f)=>{const p=getSIPrefixPower(n);return decimalTypes.r(n/Math.pow(10,p),f)},"%":(n,f)=>decimalTypes.f(n*100,f)};function removeTrailingZeros(numString){return numString.replace(/\.0+$/,"").replace(/(\.[1-9])0+$/,"$1")}__name(removeTrailingZeros,"removeTrailingZeros");function insertSeparator(numString,separator){let dotIndex=numString.indexOf(".");dotIndex<0&&(dotIndex=numString.length);const integerChars=numString.substring(0,dotIndex).split(""),fractionalPart=numString.substring(dotIndex);for(let i=integerChars.length-3;i>0;i-=3)integerChars.splice(i,0,separator);return`${integerChars.join("")}${fractionalPart}`}__name(insertSeparator,"insertSeparator");function getSIPrefix(n){return siPrefixes[getSIPrefixPower(n)]}__name(getSIPrefix,"getSIPrefix");function getSIPrefixPower(n){return clamp(minSIPrefix,Math.floor(Math.log10(Math.abs(n))/3)*3,maxSIPrefix)}__name(getSIPrefixPower,"getSIPrefixPower");var minSIPrefix=-24,maxSIPrefix=24,siPrefixes={[minSIPrefix]:"y",[-21]:"z",[-18]:"a",[-15]:"f",[-12]:"p",[-9]:"n",[-6]:"",[-3]:"m",0:"",3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",[maxSIPrefix]:"Y"},minusSign="";function addSign(num,numString,signType=""){if(signType==="(")return num>=0?numString:`(${numString})`;const plusSign=signType==="+"?"+":"";return`${num>=0?plusSign:minusSign}${numString}`}__name(addSign,"addSign");function addPadding(numString,width,fill=" ",align=">"){let result=numString;if(align===">"||!align)result=result.padStart(width,fill);else if(align==="<")result=result.padEnd(width,fill);else if(align==="^"){const padWidth=Math.max(0,width-result.length),padLeft=Math.ceil(padWidth/2),padRight=Math.floor(padWidth/2);result=result.padStart(padLeft+result.length,fill),result=result.padEnd(padRight+result.length,fill)}return result}__name(addPadding,"addPadding");function tickFormat(ticks,formatter){const options=parseFormatter(formatter??",f"),{precision}=options;(precision==null||isNaN(precision))&&(options.type==="f"||options.type==="%"?options.precision=Math.max(...ticks.map(x=>{if(typeof x!="number"||x===0)return 0;const l=Math.floor(Math.log10(Math.abs(x))),digits=options.type?6:12,exp=x.toExponential(digits-1).replace(/\.?0+e/,"e"),dotIndex=exp.indexOf(".");if(dotIndex<0)return l>=0?0:-l;const s=exp.indexOf("e")-dotIndex;return Math.max(0,s-l-1)})):(!options.type||options.type in decimalTypes)&&(options.precision=Math.max(...ticks.map(x=>{if(typeof x!="number")return 0;const exp=x.toExponential((options.type?6:12)-1).replace(/\.?0+e/,"e");return exp.substring(0,exp.indexOf("e")).replace(".","").length}))));const f=format(options);return n=>f(Number(n))}__name(tickFormat,"tickFormat");var createNumericTicks=__name((fractionDigits,takingValues=[])=>Object.assign(takingValues,{fractionDigits}),"createNumericTicks");function ticks_default(start,stop,count2,minCount,maxCount){if(count2<2)return range(start,stop,stop-start);const step=tickStep(start,stop,count2,minCount,maxCount);return isNaN(step)?createNumericTicks(0):(start=Math.ceil(start/step)*step,stop=Math.floor(stop/step)*step,range(start,stop,step))}__name(ticks_default,"ticks_default");var tickMultipliers=[1,2,5,10];function tickStep(a,b,count2,minCount=0,maxCount=1/0){const extent2=Math.abs(b-a),rawStep=extent2/count2,power=Math.floor(Math.log10(rawStep)),step=Math.pow(10,power),m=tickMultipliers.map(multiplier=>{const s=multiplier*step,c=Math.ceil(extent2/s),isWithinBounds=c>=minCount&&c<=maxCount,diffCount=Math.abs(c-count2);return{multiplier,isWithinBounds,diffCount}}).sort((a2,b2)=>a2.isWithinBounds!==b2.isWithinBounds?a2.isWithinBounds?-1:1:a2.diffCount-b2.diffCount)[0].multiplier;return!m||isNaN(m)?NaN:m*step}__name(tickStep,"tickStep");function singleTickDomain(a,b){const extent2=Math.abs(b-a),power=Math.floor(Math.log10(extent2)),step=Math.pow(10,power),roundStart=a>b?Math.ceil:Math.floor,roundStop=b<a?Math.floor:Math.ceil;return tickMultipliers.map(multiplier=>{const s=multiplier*step,start=roundStart(a/s)*s,end=roundStop(b/s)*s;return{error:1-extent2/Math.abs(end-start),domain:[start,end]}}).sort((a2,b2)=>a2.error-b2.error)[0].domain}__name(singleTickDomain,"singleTickDomain");function range(start,stop,step){const d0=Math.min(start,stop),d1=Math.max(start,stop),fractionalDigits=countFractionDigits(step),f=Math.pow(10,fractionalDigits),n=Math.ceil((d1-d0)/step),values=createNumericTicks(fractionalDigits);for(let i=0;i<=n;i++){const value=d0+step*i;values.push(Math.round(value*f)/f)}return values}__name(range,"range");var _a41,_LogScale=(_a41=class extends ContinuousScale{constructor(){super([1,10],[0,1]),this.type="log",this.base=10,this.baseLog=identity,this.basePow=identity,this.log=x=>Math.min(...this.domain)>=0?this.baseLog(x):-this.baseLog(-x),this.pow=x=>Math.min(...this.domain)>=0?this.basePow(x):-this.basePow(-x),this.defaultClampMode="clamped"}toDomain(d){return d}transform(x){return Math.min(...this.domain)>=0?Math.log(x):-Math.log(-x)}transformInvert(x){return Math.min(...this.domain)>=0?Math.exp(x):-Math.exp(-x)}refresh(){this.base<=0&&(this.base=0,Logger.warnOnce("expecting a finite Number greater than to 0")),super.refresh()}update(){!this.domain||this.domain.length<2||(this.baseLog=_a41.getBaseLogMethod(this.base),this.basePow=_a41.getBasePowerMethod(this.base),this.nice&&this.updateNiceDomain())}updateNiceDomain(){const[d0,d1]=this.domain,roundStart=d0>d1?Math.ceil:Math.floor,roundStop=d0>d1?Math.floor:Math.ceil,n0=this.pow(roundStart(this.log(d0))),n1=this.pow(roundStop(this.log(d1)));this.niceDomain=[n0,n1]}ticks(){var _a201;const count2=(_a201=this.tickCount)!=null?_a201:10;if(!this.domain||this.domain.length<2||count2<1)return[];this.refresh();const base=this.base,[d0,d1]=this.getDomain(),start=Math.min(d0,d1),stop=Math.max(d0,d1);let p0=this.log(start),p1=this.log(stop);if(this.interval){const step=Math.abs(this.interval),absDiff=Math.abs(p1-p0);let ticks2=range(p0,p1,Math.min(absDiff,step));if(ticks2=createNumericTicks(ticks2.fractionDigits,ticks2.map(x=>this.pow(x)).filter(t=>t>=start&&t<=stop)),!this.isDenseInterval({start,stop,interval:step,count:ticks2.length}))return ticks2}const isBaseInteger=base%1===0,isDiffLarge=p1-p0>=count2;if(!isBaseInteger||isDiffLarge){let ticks2=ticks_default(p0,p1,Math.min(p1-p0,count2));return ticks2=createNumericTicks(ticks2.fractionDigits,ticks2.map(x=>this.pow(x))),ticks2}const ticks=[],isPositive=start>0;p0=Math.floor(p0)-1,p1=Math.round(p1)+1;const availableSpacing=findRangeExtent(this.range)/count2;let lastTickPosition=1/0;for(let p=p0;p<=p1;p++){const nextMagnitudeTickPosition=this.convert(this.pow(p+1));for(let k=1;k<base;k++){const q=isPositive?k:base-k+1,t=this.pow(p)*q,tickPosition=this.convert(t),prevSpacing=Math.abs(lastTickPosition-tickPosition),nextSpacing=Math.abs(tickPosition-nextMagnitudeTickPosition),fits=prevSpacing>=availableSpacing&&nextSpacing>=availableSpacing;t>=start&&t<=stop&&(k===1||fits)&&(ticks.push(t),lastTickPosition=tickPosition)}}return ticks}tickFormat({count:count2,ticks,specifier}){return count2!==1/0&&ticks==null&&this.ticks(),specifier??(specifier=this.base===10?".0e":","),isString(specifier)?format(specifier):specifier}static getBaseLogMethod(base){switch(base){case 10:return Math.log10;case Math.E:return Math.log;case 2:return Math.log2;default:const logBase=Math.log(base);return x=>Math.log(x)/logBase}}static getBasePowerMethod(base){switch(base){case 10:return x=>x>=0?__pow(10,x):1/__pow(10,-x);case Math.E:return Math.exp;default:return x=>__pow(base,x)}}},__name(_a41,"_LogScale"),_a41);__decorateClass([Invalidating],_LogScale.prototype,"base",2);var LogScale=_LogScale,CONSTANTS={periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};function dayOfYear(date,startOfYear=new Date(date.getFullYear(),0,1)){const startOffset=date.getTimezoneOffset()-startOfYear.getTimezoneOffset(),timeDiff=date.getTime()-startOfYear.getTime()+startOffset*6e4,timeOneDay=36e5*24;return Math.floor(timeDiff/timeOneDay)}__name(dayOfYear,"dayOfYear");function weekOfYear(date,startDay){const startOfYearDay=new Date(date.getFullYear(),0,1).getDay(),firstWeekStartOffset=(startDay-startOfYearDay+7)%7,startOffset=new Date(date.getFullYear(),0,firstWeekStartOffset+1);return startOffset<=date?Math.floor(dayOfYear(date,startOffset)/7)+1:0}__name(weekOfYear,"weekOfYear");var SUNDAY=0,MONDAY=1,THURSDAY=4;function isoWeekOfYear(date,year2=date.getFullYear()){const firstOfYearDay=new Date(year2,0,1).getDay(),firstThursdayOffset=(THURSDAY-firstOfYearDay+7)%7,startOffset=new Date(year2,0,firstThursdayOffset-(THURSDAY-MONDAY)+1);return startOffset<=date?Math.floor(dayOfYear(date,startOffset)/7)+1:isoWeekOfYear(date,year2-1)}__name(isoWeekOfYear,"isoWeekOfYear");function timezone(date){const offset4=date.getTimezoneOffset(),unsignedOffset=Math.abs(offset4);return`${offset4>0?"-":"+"}${pad(Math.floor(unsignedOffset/60),2,"0")}${pad(Math.floor(unsignedOffset%60),2,"0")}`}__name(timezone,"timezone");var FORMATTERS={a:d=>CONSTANTS.shortDays[d.getDay()],A:d=>CONSTANTS.days[d.getDay()],b:d=>CONSTANTS.shortMonths[d.getMonth()],B:d=>CONSTANTS.months[d.getMonth()],c:"%x, %X",d:(d,p)=>pad(d.getDate(),2,p??"0"),e:"%_d",f:(d,p)=>pad(d.getMilliseconds()*1e3,6,p??"0"),H:(d,p)=>pad(d.getHours(),2,p??"0"),I:(d,p)=>{const hours=d.getHours()%12;return hours===0?"12":pad(hours,2,p??"0")},j:(d,p)=>pad(dayOfYear(d)+1,3,p??"0"),m:(d,p)=>pad(d.getMonth()+1,2,p??"0"),M:(d,p)=>pad(d.getMinutes(),2,p??"0"),L:(d,p)=>pad(d.getMilliseconds(),3,p??"0"),p:d=>d.getHours()<12?"AM":"PM",Q:d=>String(d.getTime()),s:d=>String(Math.floor(d.getTime()/1e3)),S:(d,p)=>pad(d.getSeconds(),2,p??"0"),u:d=>{let day2=d.getDay();return day2<1&&(day2+=7),String(day2%7)},U:(d,p)=>pad(weekOfYear(d,SUNDAY),2,p??"0"),V:(d,p)=>pad(isoWeekOfYear(d),2,p??"0"),w:(d,p)=>pad(d.getDay(),2,p??"0"),W:(d,p)=>pad(weekOfYear(d,MONDAY),2,p??"0"),x:"%-m/%-d/%Y",X:"%-I:%M:%S %p",y:(d,p)=>pad(d.getFullYear()%100,2,p??"0"),Y:(d,p)=>pad(d.getFullYear(),4,p??"0"),Z:d=>timezone(d),"%":()=>"%"},PADS={_:" ",0:"0","-":""};function pad(value,size,padChar){const output=String(Math.floor(value));return output.length>=size?output:`${padChar.repeat(size-output.length)}${output}`}__name(pad,"pad");function buildFormatter(formatString){const formatParts=[];for(;formatString.length>0;){let nextEscapeIdx=formatString.indexOf("%");if(nextEscapeIdx!==0){const literalPart=nextEscapeIdx>0?formatString.substring(0,nextEscapeIdx):formatString;formatParts.push(literalPart)}if(nextEscapeIdx<0)break;const maybePadSpecifier=formatString[nextEscapeIdx+1],maybePad=PADS[maybePadSpecifier];maybePad!=null&&nextEscapeIdx++;const maybeFormatterSpecifier=formatString[nextEscapeIdx+1],maybeFormatter=FORMATTERS[maybeFormatterSpecifier];if(typeof maybeFormatter=="function")formatParts.push([maybeFormatter,maybePad]);else if(typeof maybeFormatter=="string"){const formatter=buildFormatter(maybeFormatter);formatParts.push([formatter,maybePad])}else formatParts.push(`${maybePad??""}${maybeFormatterSpecifier}`);formatString=formatString.substring(nextEscapeIdx+2)}return dateTime=>{const dateTimeAsDate=typeof dateTime=="number"?new Date(dateTime):dateTime;return formatParts.map(c=>typeof c=="string"?c:c[0](dateTimeAsDate,c[1])).join("")}}__name(buildFormatter,"buildFormatter");var formatStrings={0:".%L",1:":%S",2:"%I:%M",3:"%I %p",4:"%a",5:"%b %d",6:"%B",7:"%y",8:"%Y"};function toNumber(x){return x instanceof Date?x.getTime():x}__name(toNumber,"toNumber");var _a42,TimeScale=(_a42=class extends ContinuousScale{constructor(){super([],[0,1]),this.type="time",this.year=year_default,this.month=month_default,this.week=week_default,this.day=day_default,this.hour=hour_default,this.minute=minute_default,this.second=second_default,this.millisecond=millisecond_default,this.tickIntervals=[[this.second,1,durationSecond],[this.second,5,5*durationSecond],[this.second,15,15*durationSecond],[this.second,30,30*durationSecond],[this.minute,1,durationMinute],[this.minute,5,5*durationMinute],[this.minute,15,15*durationMinute],[this.minute,30,30*durationMinute],[this.hour,1,durationHour],[this.hour,3,3*durationHour],[this.hour,6,6*durationHour],[this.hour,12,12*durationHour],[this.day,1,durationDay],[this.day,2,2*durationDay],[this.week,1,durationWeek],[this.week,2,2*durationWeek],[this.week,3,3*durationWeek],[this.month,1,durationMonth],[this.month,2,2*durationMonth],[this.month,3,3*durationMonth],[this.month,4,4*durationMonth],[this.month,6,6*durationMonth],[this.year,1,durationYear]]}toDomain(d){return new Date(d)}calculateDefaultTickFormat(ticks=[]){let defaultTimeFormat=8;const updateFormat=__name(format2=>{format2<defaultTimeFormat&&(defaultTimeFormat=format2)},"updateFormat");for(const value of ticks){const format2=this.getLowestGranularityFormat(value);updateFormat(format2)}const firstTick=toNumber(ticks[0]),lastTick=toNumber(ticks.at(-1)),startYear=new Date(firstTick).getFullYear(),yearChange=new Date(lastTick).getFullYear()-startYear>0;return this.buildFormatString(defaultTimeFormat,yearChange)}buildFormatString(defaultTimeFormat,yearChange){let formatStringArray=[formatStrings[defaultTimeFormat]],timeEndIndex=0;const domain=this.getDomain(),extent2=findRangeExtent(domain.map(toNumber));switch(defaultTimeFormat){case 1:extent2/durationMinute>1&&formatStringArray.push(formatStrings[2]);case 2:extent2/durationHour>1&&formatStringArray.push(formatStrings[3]);case 3:timeEndIndex=formatStringArray.length,extent2/durationDay>1&&formatStringArray.push(formatStrings[4]);case 4:if(extent2/durationWeek>1||yearChange){const weekDayIndex=formatStringArray.indexOf(formatStrings[4]);weekDayIndex>-1&&formatStringArray.splice(weekDayIndex,1,formatStrings[5])}case 5:case 6:(extent2/durationYear>1||yearChange)&&formatStringArray.push(formatStrings[8])}return timeEndIndex<formatStringArray.length&&(formatStringArray=[...formatStringArray.slice(0,timeEndIndex),formatStringArray.slice(timeEndIndex).join(" ")]),timeEndIndex>0&&(formatStringArray=[...formatStringArray.slice(0,timeEndIndex).reverse(),...formatStringArray.slice(timeEndIndex)],timeEndIndex<formatStringArray.length&&formatStringArray.splice(timeEndIndex,0," ")),formatStringArray.join("")}getLowestGranularityFormat(value){return this.second.floor(value)<value?0:this.minute.floor(value)<value?1:this.hour.floor(value)<value?2:this.day.floor(value)<value?3:this.month.floor(value)<value?this.week.floor(value)<value?4:5:this.year.floor(value)<value?6:8}defaultTickFormat(ticks){const formatString=this.calculateDefaultTickFormat(ticks);return date=>buildFormatter(formatString)(date)}getTickInterval({start,stop,count:count2,minCount,maxCount}){const{tickIntervals}=this;let countableTimeInterval,step;const tickCount=count2??ContinuousScale.defaultTickCount,target=Math.abs(stop-start)/Math.max(tickCount,1);let i=0;for(;i<tickIntervals.length&&target>tickIntervals[i][2];)i++;if(i===0)step=Math.max(tickStep(start,stop,tickCount,minCount,maxCount),1),countableTimeInterval=this.millisecond;else if(i===tickIntervals.length){const y0=start/durationYear,y1=stop/durationYear;step=tickStep(y0,y1,tickCount,minCount,maxCount),countableTimeInterval=this.year}else{const diff0=target-tickIntervals[i-1][2],diff1=tickIntervals[i][2]-target,index=diff0<diff1?i-1:i;[countableTimeInterval,step]=tickIntervals[index]}return countableTimeInterval.every(step)}invert(y){return new Date(super.invert(y))}ticks(){if(!this.domain||this.domain.length<2)return[];this.refresh();const[t0,t1]=this.getDomain().map(toNumber),start=Math.min(t0,t1),stop=Math.max(t0,t1);if(this.interval!==void 0)return this.getTicksForInterval({start,stop});if(this.nice){const{tickCount}=this;if(tickCount===2)return this.niceDomain;if(tickCount===1)return this.niceDomain.slice(0,1)}return this.getDefaultTicks({start,stop})}getDefaultTicks({start,stop}){const t=this.getTickInterval({start,stop,count:this.tickCount,minCount:this.minTickCount,maxCount:this.maxTickCount});return t?t.range(new Date(start),new Date(stop)):[]}getTicksForInterval({start,stop}){const{interval,tickIntervals}=this;if(!interval)return[];if(interval instanceof TimeInterval){const ticks2=interval.range(new Date(start),new Date(stop));return this.isDenseInterval({start,stop,interval,count:ticks2.length})?this.getDefaultTicks({start,stop}):ticks2}const absInterval=Math.abs(interval);if(this.isDenseInterval({start,stop,interval:absInterval}))return this.getDefaultTicks({start,stop});const reversedInterval=[...tickIntervals];reversedInterval.reverse();const timeInterval=reversedInterval.find(tickInterval=>absInterval%tickInterval[2]===0);if(timeInterval)return timeInterval[0].every(absInterval/(timeInterval[2]/timeInterval[1])).range(new Date(start),new Date(stop));let date=new Date(start);const stopDate=new Date(stop),ticks=[];for(;date<=stopDate;)ticks.push(date),date=new Date(date),date.setMilliseconds(date.getMilliseconds()+absInterval);return ticks}tickFormat({ticks,specifier}){return specifier==null?this.defaultTickFormat(ticks):buildFormatter(specifier)}update(){!this.domain||this.domain.length<2||this.nice&&this.updateNiceDomain()}updateNiceDomain(){let[d0,d1]=this.domain;for(let i=0;i<4;i++){this.updateNiceDomainIteration(d0,d1);const[n0,n1]=this.niceDomain;if(toNumber(d0)===toNumber(n0)&&toNumber(d1)===toNumber(n1))break;d0=n0,d1=n1}}updateNiceDomainIteration(d0,d1){const start=Math.min(toNumber(d0),toNumber(d1)),stop=Math.max(toNumber(d0),toNumber(d1)),isReversed=d0>d1,{interval}=this;let i;if(interval instanceof TimeInterval)i=interval;else{const tickCount=typeof interval=="number"?(stop-start)/Math.max(interval,1):this.tickCount;i=this.getTickInterval({start,stop,count:tickCount,minCount:this.minTickCount,maxCount:this.maxTickCount})}if(i){const intervalRange=i.range(new Date(start),new Date(stop),!0),domain=isReversed?[...intervalRange].reverse():intervalRange,n0=domain[0],n1=domain.at(-1);this.niceDomain=[n0,n1]}}},__name(_a42,"TimeScale"),_a42),_a43,Selection=(_a43=class{constructor(parentNode,classOrFactory,autoCleanup=!0){this.parentNode=parentNode,this.autoCleanup=autoCleanup,this.garbageBin=new Set,this._nodesMap=new Map,this._nodes=[],this.data=[],this.debug=Debug.create(!0,"scene","scene:selections"),this.nodeFactory=Object.prototype.isPrototypeOf.call(Node,classOrFactory)?()=>new classOrFactory:classOrFactory}static select(parent,classOrFactory,garbageCollection=!0){return new _a43(parent,classOrFactory,garbageCollection)}static selectAll(parent,predicate){const results=[],traverse=__name(node=>{predicate(node)&&results.push(node),node.children.forEach(traverse)},"traverse");return traverse(parent),results}static selectByClass(node,Class){return _a43.selectAll(node,node2=>node2 instanceof Class)}static selectByTag(node,tag){return _a43.selectAll(node,node2=>node2.tag===tag)}createNode(datum,initializer,idx){const node=this.nodeFactory(datum);return node.datum=datum,initializer==null||initializer(node),idx!=null?this._nodes.splice(idx,0,node):this._nodes.push(node),this.parentNode.appendChild(node),node}update(data,initializer,getDatumId){if(this.garbageBin.size>0&&this.debug(`Selection - update() called with pending garbage: ${data}`),getDatumId){const dataMap=new Map(data.map((datum,idx)=>[getDatumId(datum),[datum,idx]]));for(const[node,datumId]of this._nodesMap.entries())if(dataMap.has(datumId)){const[newDatum]=dataMap.get(datumId);node.datum=newDatum,this.garbageBin.delete(node),dataMap.delete(datumId)}else this.garbageBin.add(node);for(const[datumId,[datum,idx]]of dataMap.entries())this._nodesMap.set(this.createNode(datum,initializer,idx),datumId)}else{const maxLength=Math.max(data.length,this.data.length);for(let i=0;i<maxLength;i++)i>=data.length?this.garbageBin.add(this._nodes[i]):i>=this._nodes.length?this.createNode(data[i],initializer):(this._nodes[i].datum=data[i],this.garbageBin.delete(this._nodes[i]))}return this.data=data.slice(),this.autoCleanup&&this.cleanup(),this}cleanup(){return this.garbageBin.size===0?this:(this._nodes=this._nodes.filter(node=>this.garbageBin.has(node)?(this._nodesMap.delete(node),this.garbageBin.delete(node),this.parentNode.removeChild(node),!1):!0),this)}clear(){return this.update([]),this}isGarbage(node){return this.garbageBin.has(node)}hasGarbage(){return this.garbageBin.size>0}each(iterate){return this._nodes.forEach((node,i)=>iterate(node,node.datum,i)),this}*[Symbol.iterator](){for(let index=0;index<this._nodes.length;index++){const node=this._nodes[index],datum=this._nodes[index].datum;yield{node,datum,index}}}select(predicate){return _a43.selectAll(this.parentNode,predicate)}selectByClass(Class){return _a43.selectByClass(this.parentNode,Class)}selectByTag(tag){return _a43.selectByTag(this.parentNode,tag)}nodes(){return this._nodes}},__name(_a43,"_Selection"),_a43),_a44,Line=(_a44=class extends Shape{constructor(opts={}){super(opts),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.restoreOwnStyles()}set x(value){this.x1=value,this.x2=value}set y(value){this.y1=value,this.y2=value}computeBBox(){return new BBox(Math.min(this.x1,this.x2),Math.min(this.y1,this.y2),Math.abs(this.x2-this.x1),Math.abs(this.y2-this.y1))}isPointInPath(px,py){if(this.x1===this.x2||this.y1===this.y2){const{x,y}=this.transformPoint(px,py);return this.computeBBox().grow(this.strokeWidth/2).containsPoint(x,y)}return!1}render(renderCtx){var _a201;const{ctx,forceRender,stats,devicePixelRatio}=renderCtx;if(this.dirty===0&&!forceRender){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}this.computeTransformMatrix(),this.matrix.toContext(ctx);let{x1,y1,x2,y2}=this;if(x1===x2){const{strokeWidth}=this,x=Math.round(x1*devicePixelRatio)/devicePixelRatio+Math.trunc(strokeWidth*devicePixelRatio)%2/(devicePixelRatio*2);x1=x,x2=x}else if(y1===y2){const{strokeWidth}=this,y=Math.round(y1*devicePixelRatio)/devicePixelRatio+Math.trunc(strokeWidth*devicePixelRatio)%2/(devicePixelRatio*2);y1=y,y2=y}ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y2),this.fillStroke(ctx),(_a201=this.fillShadow)==null||_a201.markClean(),super.render(renderCtx)}},__name(_a44,"Line"),_a44);Line.className="Line";Line.defaultStyles=Object.assign({},Shape.defaultStyles,{fill:void 0,strokeWidth:1});__decorateClass([SceneChangeDetection({redraw:3})],Line.prototype,"x1",2);__decorateClass([SceneChangeDetection({redraw:3})],Line.prototype,"y1",2);__decorateClass([SceneChangeDetection({redraw:3})],Line.prototype,"x2",2);__decorateClass([SceneChangeDetection({redraw:3})],Line.prototype,"y2",2);function circleRectOverlap(c,x,y,w,h){let edgeX=c.x;c.x<x?edgeX=x:c.x>x+w&&(edgeX=x+w);let edgeY=c.y;c.y<y?edgeY=y:c.y>y+h&&(edgeY=y+h);const dx=c.x-edgeX,dy=c.y-edgeY;return Math.sqrt(dx*dx+dy*dy)<=c.size*.5}__name(circleRectOverlap,"circleRectOverlap");function rectRectOverlap(r1,x2,y2,w2,h2){const xOverlap=r1.x+r1.width>x2&&r1.x<x2+w2,yOverlap=r1.y+r1.height>y2&&r1.y<y2+h2;return xOverlap&&yOverlap}__name(rectRectOverlap,"rectRectOverlap");function rectContainsRect(r1,r2x,r2y,r2w,r2h){return r2x+r2w<r1.x+r1.width&&r2x>r1.x&&r2y>r1.y&&r2y+r2h<r1.y+r1.height}__name(rectContainsRect,"rectContainsRect");function isPointLabelDatum(x){return x!=null&&typeof x.point=="object"&&typeof x.label=="object"}__name(isPointLabelDatum,"isPointLabelDatum");function placeLabels(data,bounds,padding=5){const result=[];data=data.map(d=>d.slice().sort((a,b)=>b.point.size-a.point.size));for(let j=0;j<data.length;j++){const labels=result[j]=[],datum=data[j];if(datum!=null&&datum.length&&datum[0].label)for(let i=0,ln=datum.length;i<ln;i++){const d=datum[i],l=d.label,r=d.point.size*.5,x=d.point.x-l.width*.5,y=d.point.y-r-l.height-padding,{width,height}=l;!(!bounds||rectContainsRect(bounds,x,y,width,height))||data.some(datum2=>datum2.some(d2=>circleRectOverlap(d2.point,x,y,width,height)))||result.some(labels2=>labels2.some(l2=>rectRectOverlap(l2,x,y,width,height)))||labels.push({index:i,text:l.text,x,y,width,height,datum:d})}}return result}__name(placeLabels,"placeLabels");function axisLabelsOverlap(data,padding){const result=[];for(let i=0;i<data.length;i++){const datum=data[i],{point:{x,y},label:{text}}=datum;let{label:{width,height}}=datum;if(width+=padding??0,height+=padding??0,result.some(l=>rectRectOverlap(l,x,y,width,height)))return!0;result.push({index:i,text,x,y,width,height,datum})}return!1}__name(axisLabelsOverlap,"axisLabelsOverlap");function areArrayNumbersEqual(arrA,arrB){return arrA.length===arrB.length&&arrA.every((item,i)=>Number(item)===Number(arrB[i]))}__name(areArrayNumbersEqual,"areArrayNumbersEqual");var GRID_STYLE_KEYS=["stroke","lineDash"],GRID_STYLE=ARRAY_OF(value=>isObject(value)&&Object.keys(value).every(key=>GRID_STYLE_KEYS.includes(key)),"objects with gridline style properties such as 'stroke' or 'lineDash'"),_a45,AxisGridLine=(_a45=class{constructor(){this.enabled=!0,this.width=1,this.style=[{stroke:void 0,lineDash:[]}]}},__name(_a45,"AxisGridLine"),_a45);__decorateClass([Validate(BOOLEAN)],AxisGridLine.prototype,"enabled",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisGridLine.prototype,"width",2);__decorateClass([Validate(GRID_STYLE)],AxisGridLine.prototype,"style",2);function Default(defaultValue,replaces=[void 0]){return addTransformToInstanceProperty((_,__,v)=>replaces.includes(v)?isFunction(defaultValue)?defaultValue(v):defaultValue:v)}__name(Default,"Default");var _a46,AxisLabel=(_a46=class{constructor(){this.enabled=!0,this.autoWrap=!1,this.maxWidth=void 0,this.maxHeight=void 0,this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif",this.padding=5,this.minSpacing=NaN,this.color="rgba(87, 87, 87, 1)",this.rotation=void 0,this.avoidCollisions=!0,this.mirrored=!1,this.parallel=!1,this.formatter=void 0}getSideFlag(){return this.mirrored?1:-1}getFont(){return getFont(this)}},__name(_a46,"AxisLabel"),_a46);__decorateClass([Validate(BOOLEAN)],AxisLabel.prototype,"enabled",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],AxisLabel.prototype,"autoWrap",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],AxisLabel.prototype,"maxWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],AxisLabel.prototype,"maxHeight",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],AxisLabel.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT2,{optional:!0})],AxisLabel.prototype,"fontWeight",2);__decorateClass([Validate(NUMBER.restrict({min:1}))],AxisLabel.prototype,"fontSize",2);__decorateClass([Validate(STRING)],AxisLabel.prototype,"fontFamily",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisLabel.prototype,"padding",2);__decorateClass([Validate(NUMBER_OR_NAN),Default(NaN)],AxisLabel.prototype,"minSpacing",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],AxisLabel.prototype,"color",2);__decorateClass([Validate(DEGREE,{optional:!0})],AxisLabel.prototype,"rotation",2);__decorateClass([Validate(BOOLEAN)],AxisLabel.prototype,"avoidCollisions",2);__decorateClass([Validate(BOOLEAN)],AxisLabel.prototype,"mirrored",2);__decorateClass([Validate(BOOLEAN)],AxisLabel.prototype,"parallel",2);__decorateClass([Validate(STRING,{optional:!0})],AxisLabel.prototype,"format",2);var _a47,AxisLine=(_a47=class{constructor(){this.enabled=!0,this.width=1,this.color=void 0}},__name(_a47,"AxisLine"),_a47);__decorateClass([Validate(BOOLEAN)],AxisLine.prototype,"enabled",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisLine.prototype,"width",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],AxisLine.prototype,"color",2);var TICK_INTERVAL=predicateWithMessage(value=>isFiniteNumber(value)&&value>0||value instanceof TimeInterval,"a non-zero positive Number value or, for a time axis, a Time Interval such as 'agCharts.time.month'"),_a48,AxisTick=(_a48=class{constructor(){this.enabled=!0,this.width=1,this.size=6,this.color=void 0,this.interval=void 0,this.values=void 0,this.minSpacing=NaN}},__name(_a48,"AxisTick"),_a48);__decorateClass([Validate(BOOLEAN)],AxisTick.prototype,"enabled",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisTick.prototype,"width",2);__decorateClass([Validate(POSITIVE_NUMBER)],AxisTick.prototype,"size",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],AxisTick.prototype,"color",2);__decorateClass([Validate(TICK_INTERVAL,{optional:!0})],AxisTick.prototype,"interval",2);__decorateClass([Validate(ARRAY,{optional:!0})],AxisTick.prototype,"values",2);__decorateClass([Validate(MIN_SPACING),Default(NaN)],AxisTick.prototype,"minSpacing",2);function prepareAxisAnimationContext(axis){const[requestedRangeMin,requestedRangeMax]=findMinMax(axis.range),min=Math.floor(requestedRangeMin),max=Math.ceil(requestedRangeMax);return{min,max,visible:min!==max}}__name(prepareAxisAnimationContext,"prepareAxisAnimationContext");var fullCircle=Math.PI*2,halfCircle=fullCircle/2;function normaliseEndRotation(start,end){return Math.abs(end-start)<halfCircle?end:start>end?end+fullCircle:end-fullCircle}__name(normaliseEndRotation,"normaliseEndRotation");function prepareAxisAnimationFunctions(ctx){const outOfBounds=__name((y,range3)=>{const[min=ctx.min,max=ctx.max]=findMinMax(range3??[]);return y<min||y>max},"outOfBounds");return{tick:{fromFn(node,datum,status){let y=node.y1+node.translationY,opacity=node.opacity;return(status==="added"||outOfBounds(node.datum.translationY,node.datum.range))&&(y=datum.translationY,opacity=0),{y:0,translationY:y,opacity,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]}},toFn(_node,datum,status){const y=datum.translationY;let opacity=1;return status==="removed"&&(opacity=0),{y:0,translationY:y,opacity,finish:{y,translationY:0}}},intermediateFn(node,_datum,_status){return{visible:!outOfBounds(node.y)}}},line:{fromFn(node,datum){var _a201;return __spreadProps(__spreadValues({},(_a201=node.previousDatum)!=null?_a201:datum),{phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.updated})},toFn(_node,datum){return __spreadValues({},datum)}},label:{fromFn(node,newDatum,status){var _a201;const datum=(_a201=node.previousDatum)!=null?_a201:newDatum,x=datum.x,y=datum.y,rotationCenterX=datum.rotationCenterX;let translationY=Math.round(node.translationY),rotation=datum.rotation,opacity=node.opacity;return status==="removed"||outOfBounds(datum.y,datum.range)||(status==="added"||outOfBounds(node.datum.y,node.datum.range))&&(translationY=Math.round(datum.translationY),opacity=0,rotation=newDatum.rotation),{x,y,rotationCenterX,translationY,rotation,opacity,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]}},toFn(node,datum,status){var _a201,_b;const x=datum.x,y=datum.y,rotationCenterX=datum.rotationCenterX,translationY=Math.round(datum.translationY);let rotation=0,opacity=1;return status==="added"?(opacity=1,rotation=datum.rotation):status==="removed"?(opacity=0,rotation=datum.rotation):rotation=normaliseEndRotation((_b=(_a201=node.previousDatum)==null?void 0:_a201.rotation)!=null?_b:datum.rotation,datum.rotation),{x,y,rotationCenterX,translationY,rotation,opacity,finish:{rotation:datum.rotation}}}},group:{fromFn(group3,_datum){const{rotation,translationX,translationY}=group3;return{rotation,translationX,translationY,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.updated}},toFn(_group,datum){const{rotation,translationX,translationY}=datum;return{rotation,translationX,translationY}}}}}__name(prepareAxisAnimationFunctions,"prepareAxisAnimationFunctions");function resetAxisGroupFn(){return(_node,datum)=>({rotation:datum.rotation,rotationCenterX:datum.rotationCenterX,rotationCenterY:datum.rotationCenterY,translationX:datum.translationX,translationY:datum.translationY})}__name(resetAxisGroupFn,"resetAxisGroupFn");function resetAxisSelectionFn(ctx){const{visible:rangeVisible,min,max}=ctx;return(_node,datum)=>{const y=datum.translationY,visible=rangeVisible&&y>=min&&y<=max;return{y,translationY:0,opacity:1,visible}}}__name(resetAxisSelectionFn,"resetAxisSelectionFn");function resetAxisLabelSelectionFn(){return(_node,datum)=>({x:datum.x,y:datum.y,translationY:datum.translationY,rotation:datum.rotation,rotationCenterX:datum.rotationCenterX})}__name(resetAxisLabelSelectionFn,"resetAxisLabelSelectionFn");function resetAxisLineSelectionFn(){return(_node,datum)=>__spreadValues({},datum)}__name(resetAxisLineSelectionFn,"resetAxisLineSelectionFn");var Tags=(Tags2=>(Tags2[Tags2.TickLine=0]="TickLine",Tags2[Tags2.TickLabel=1]="TickLabel",Tags2[Tags2.GridLine=2]="GridLine",Tags2[Tags2.GridArc=3]="GridArc",Tags2[Tags2.AxisLine=4]="AxisLine",Tags2))(Tags||{}),_a49,_Axis=(_a49=class{constructor(moduleCtx,scale2,options){this.moduleCtx=moduleCtx,this.scale=scale2,this.id=createId(this),this.nice=!0,this.reverse=!1,this.keys=[],this.dataDomain={domain:[],clipped:!1},this.boundSeries=[],this.includeInvisibleDomains=!1,this.interactionEnabled=!0,this.axisGroup=new Group({name:`${this.id}-axis`,zIndex:2}),this.lineNode=this.axisGroup.appendChild(new Line),this.tickLineGroup=this.axisGroup.appendChild(new Group({name:`${this.id}-Axis-tick-lines`,zIndex:2})),this.tickLabelGroup=this.axisGroup.appendChild(new Group({name:`${this.id}-Axis-tick-labels`,zIndex:2})),this.crossLineGroup=new Group({name:`${this.id}-CrossLines`}),this.gridGroup=new Group({name:`${this.id}-Axis-grid`}),this.gridLineGroup=this.gridGroup.appendChild(new Group({name:`${this.id}-gridLines`,zIndex:1})),this.tickLineGroupSelection=Selection.select(this.tickLineGroup,Line,!1),this.tickLabelGroupSelection=Selection.select(this.tickLabelGroup,Text,!1),this.gridLineGroupSelection=Selection.select(this.gridLineGroup,Line,!1),this.line=new AxisLine,this.tick=this.createTick(),this.gridLine=new AxisGridLine,this.label=this.createLabel(),this.defaultTickMinSpacing=_a49.defaultTickMinSpacing,this.translation={x:0,y:0},this.rotation=0,this.layout={label:{fractionDigits:0,padding:this.label.padding,format:this.label.format}},this.destroyFns=[],this.range=[0,1],this.visibleRange=[0,1],this.title=void 0,this._titleCaption=new Caption,this.gridLength=0,this.fractionDigits=0,this.gridPadding=0,this.seriesAreaPadding=0,this.tickGenerationResult=void 0,this.maxThickness=1/0,this.moduleMap=new ModuleMap,this.refreshScale(),this._titleCaption.registerInteraction(this.moduleCtx),this._titleCaption.node.rotation=-Math.PI/2,this.axisGroup.appendChild(this._titleCaption.node),this.destroyFns.push(moduleCtx.interactionManager.addListener("hover",e=>this.checkAxisHover(e))),this.animationManager=moduleCtx.animationManager,this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:()=>this.resetSelectionNodes()},reset:"empty"},ready:{update:data=>this.animateReadyUpdate(data),resize:()=>this.resetSelectionNodes(),reset:"empty"}}),this._crossLines=[],this.assignCrossLineArrayConstructor(this._crossLines);let previousSize;this.destroyFns.push(moduleCtx.layoutService.addListener("layout-complete",e=>{previousSize!=null&&jsonDiff(e.chart,previousSize)!=null&&this.animationState.transition("resize"),previousSize=__spreadValues({},e.chart)})),(options==null?void 0:options.respondsToZoom)!==!1&&this.destroyFns.push(moduleCtx.updateService.addListener("update-complete",e=>{this.minRect=e.minRect}))}get type(){var _a201;return(_a201=this.constructor.type)!=null?_a201:""}set crossLines(value){var _a201,_b;(_a201=this._crossLines)==null||_a201.forEach(crossLine=>this.detachCrossLine(crossLine)),value&&this.assignCrossLineArrayConstructor(value),this._crossLines=value,(_b=this._crossLines)==null||_b.forEach(crossLine=>{this.attachCrossLine(crossLine),this.initCrossLine(crossLine)})}get crossLines(){return this._crossLines}resetAnimation(phase){phase==="initial"&&this.animationState.transition("reset")}attachCrossLine(crossLine){this.crossLineGroup.appendChild(crossLine.group),this.crossLineGroup.appendChild(crossLine.labelGroup)}detachCrossLine(crossLine){this.crossLineGroup.removeChild(crossLine.group),this.crossLineGroup.removeChild(crossLine.labelGroup)}destroy(){this.moduleMap.destroy(),this.destroyFns.forEach(f=>f())}refreshScale(){var _a201;this.range=this.scale.range.slice(),(_a201=this.crossLines)==null||_a201.forEach(this.initCrossLine,this)}updateRange(){var _a201;const{range:rr,visibleRange:vr,scale:scale2}=this,span=(rr[1]-rr[0])/(vr[1]-vr[0]),shift=span*vr[0],start=rr[0]-shift;scale2.range=[start,start+span],(_a201=this.crossLines)==null||_a201.forEach(crossLine=>{crossLine.clippedRange=[rr[0],rr[1]]})}setCrossLinesVisible(visible){this.crossLineGroup.visible=visible}attachAxis(axisNode,gridNode){gridNode.appendChild(this.gridGroup),axisNode.appendChild(this.axisGroup),axisNode.appendChild(this.crossLineGroup)}detachAxis(axisNode,gridNode){gridNode.removeChild(this.gridGroup),axisNode.removeChild(this.axisGroup),axisNode.removeChild(this.crossLineGroup)}inRange(x,width=0,tolerance=0){const[min,max]=findMinMax(this.range);return x+width>=min-tolerance&&x<=max+tolerance}onLabelFormatChange(ticks,format2){const{scale:scale2,fractionDigits}=this,defaultLabelFormatter=!(scale2 instanceof LogScale)&&fractionDigits>0?x=>typeof x=="number"?x.toFixed(fractionDigits):String(x):x=>String(x);if(format2&&scale2&&scale2.tickFormat)try{this.labelFormatter=scale2.tickFormat({ticks,specifier:format2})}catch{this.labelFormatter=defaultLabelFormatter,Logger.warnOnce(`the axis label format string ${format2} is invalid. No formatting will be applied`)}else this.labelFormatter=defaultLabelFormatter}setTickInterval(interval){var _a201;this.scale.interval=(_a201=this.tick.interval)!=null?_a201:interval}setTickCount(count2,minTickCount,maxTickCount){const{scale:scale2}=this;if(count2&&ContinuousScale.is(scale2)){if(typeof count2=="number"){scale2.tickCount=count2,scale2.minTickCount=minTickCount??0,scale2.maxTickCount=maxTickCount??1/0;return}scale2 instanceof TimeScale&&this.setTickInterval(count2)}}onGridLengthChange(value,prevValue){var _a201;(prevValue&&!value||!prevValue&&value)&&this.onGridVisibilityChange(),(_a201=this.crossLines)==null||_a201.forEach(this.initCrossLine,this)}onGridVisibilityChange(){this.gridLineGroupSelection.clear()}createTick(){return new AxisTick}createLabel(){return new AxisLabel}checkAxisHover(event){!this.interactionEnabled||!this.computeBBox().containsPoint(event.offsetX,event.offsetY)||this.moduleCtx.chartEventManager.axisHover(this.id,this.direction)}update(_primaryTickCount=0,animated=!0){if(!this.tickGenerationResult)return;const{rotation,parallelFlipRotation,regularFlipRotation}=this.calculateRotations(),sideFlag=this.label.getSideFlag();this.updatePosition();const lineData=this.getAxisLineCoordinates(),{tickData,combinedRotation,textBaseline,textAlign,primaryTickCount}=this.tickGenerationResult,previousTicks=this.tickLabelGroupSelection.nodes().map(node=>node.datum.tickId);if(this.updateSelections(lineData,tickData.ticks,{combinedRotation,textAlign,textBaseline,range:this.scale.range}),!animated||this.animationManager.isSkipped())this.resetSelectionNodes();else{const diff2=this.calculateUpdateDiff(previousTicks,tickData);this.animationState.transition("update",diff2)}return this.updateAxisLine(),this.updateLabels(),this.updateVisibility(),this.updateGridLines(sideFlag),this.updateTickLines(),this.updateTitle({anyTickVisible:tickData.ticks.length>0}),this.updateCrossLines({rotation,parallelFlipRotation,regularFlipRotation}),this.updateLayoutState(),primaryTickCount}getAxisLineCoordinates(){const[min,max]=findMinMax(this.range);return{x:0,y1:min,y2:max}}getTickLineCoordinates(datum){const x=this.label.getSideFlag()*this.getTickSize(),x1=Math.min(0,x),x2=x1+Math.abs(x),y=datum.translationY;return{x1,x2,y}}getTickLabelProps(datum,params){const{label}=this,{combinedRotation,textBaseline,textAlign,range:range3}=params,text=datum.tickLabel,labelX=label.getSideFlag()*(this.getTickSize()+label.padding+this.seriesAreaPadding),visible=text!==""&&text!=null;return{tickId:datum.tickId,translationY:datum.translationY,fill:label.color,fontFamily:label.fontFamily,fontSize:label.fontSize,fontStyle:label.fontStyle,fontWeight:label.fontWeight,rotation:combinedRotation,rotationCenterX:labelX,text,textAlign,textBaseline,visible,x:labelX,y:0,range:range3}}getTickSize(){return this.tick.enabled?this.tick.size:this.createTick().size}setTitleProps(caption,params){var _a201;const{title}=this;if(!title){caption.enabled=!1;return}if(caption.color=title.color,caption.fontFamily=title.fontFamily,caption.fontSize=title.fontSize,caption.fontStyle=title.fontStyle,caption.fontWeight=title.fontWeight,caption.enabled=title.enabled,caption.wrapping=title.wrapping,title.enabled){const titleNode=caption.node,padding=((_a201=title.spacing)!=null?_a201:0)+params.spacing,sideFlag=this.label.getSideFlag(),parallelFlipRotation=normalizeAngle360(this.rotation),titleRotationFlag=sideFlag===-1&&parallelFlipRotation>Math.PI&&parallelFlipRotation<Math.PI*2?-1:1,rotation=titleRotationFlag*sideFlag*Math.PI/2,textBaseline=titleRotationFlag===1?"bottom":"top",{range:range3}=this,x=Math.floor(titleRotationFlag*sideFlag*(range3[0]+range3[1])/2),y=Math.floor(sideFlag===-1?titleRotationFlag*-padding:-padding),{callbackCache}=this.moduleCtx,{formatter=__name(params2=>params2.defaultValue,"formatter")}=title,text=callbackCache.call(formatter,this.getTitleFormatterParams());titleNode.setProperties({rotation,text,textBaseline,visible:!0,x,y})}}calculateLayout(primaryTickCount){var _b,_c;const{rotation,parallelFlipRotation,regularFlipRotation}=this.calculateRotations(),sideFlag=this.label.getSideFlag(),labelX=sideFlag*(this.getTickSize()+this.label.padding+this.seriesAreaPadding);this.updateScale(),this.tickGenerationResult=this.generateTicks({primaryTickCount,parallelFlipRotation,regularFlipRotation,labelX,sideFlag}),this.updateLayoutState();const _a201=this.tickGenerationResult,{tickData,combinedRotation,textBaseline,textAlign}=_a201,ticksResult=__objRest(_a201,["tickData","combinedRotation","textBaseline","textAlign"]),boxes=[],{x,y1,y2}=this.getAxisLineCoordinates(),lineBox=new BBox(x+Math.min(sideFlag*this.seriesAreaPadding,0),y1,this.seriesAreaPadding,y2-y1);if(boxes.push(lineBox),this.tick.enabled&&tickData.ticks.forEach(datum=>{const{x1,x2,y}=this.getTickLineCoordinates(datum),tickLineBox=new BBox(x1,y,x2-x1,0);boxes.push(tickLineBox)}),this.label.enabled){const tempText=new Text;tickData.ticks.forEach(datum=>{const labelProps=this.getTickLabelProps(datum,{combinedRotation,textAlign,textBaseline,range:this.scale.range});if(!labelProps.visible)return;tempText.setProperties(__spreadProps(__spreadValues({},labelProps),{translationY:Math.round(datum.translationY)}));const box=tempText.computeTransformedBBox();box&&boxes.push(box)})}const getTransformBox=__name(bbox2=>{const matrix=new Matrix,{rotation:axisRotation,translationX,translationY,rotationCenterX,rotationCenterY}=this.getAxisTransform();return Matrix.updateTransformMatrix(matrix,1,1,axisRotation,translationX,translationY,{scalingCenterX:0,scalingCenterY:0,rotationCenterX,rotationCenterY}),matrix.transformBBox(bbox2)},"getTransformBox");if((_b=this.title)!=null&&_b.enabled){const caption=new Caption,spacing=BBox.merge(boxes).width;this.setTitleProps(caption,{spacing});const titleBox=caption.node.computeTransformedBBox();titleBox&&boxes.push(titleBox)}const bbox=BBox.merge(boxes),transformedBBox=getTransformBox(bbox),anySeriesActive=this.isAnySeriesActive();return(_c=this.crossLines)==null||_c.forEach(crossLine=>{var _a210;crossLine.sideFlag=-sideFlag,crossLine.direction=rotation===-Math.PI/2?"x":"y",crossLine instanceof CartesianCrossLine&&(crossLine.label.parallel=(_a210=crossLine.label.parallel)!=null?_a210:this.label.parallel),crossLine.parallelFlipRotation=parallelFlipRotation,crossLine.regularFlipRotation=regularFlipRotation,crossLine.calculateLayout(anySeriesActive,this.reverse)}),primaryTickCount=ticksResult.primaryTickCount,{primaryTickCount,bbox:transformedBBox}}updateLayoutState(){this.layout.label={fractionDigits:this.fractionDigits,padding:this.label.padding,format:this.label.format}}setDomain(domain){this.dataDomain=this.normaliseDataDomain(domain),this.reverse&&this.dataDomain.domain.reverse(),this.scale.domain=this.dataDomain.domain}updateScale(){this.updateRange(),this.calculateDomain(),this.setTickInterval(this.tick.interval);const{scale:scale2,nice}=this;ContinuousScale.is(scale2)&&(scale2.nice=nice,scale2.update())}calculateRotations(){const rotation=toRadians(this.rotation),parallelFlipRotation=normalizeAngle360(rotation),regularFlipRotation=normalizeAngle360(rotation-Math.PI/2);return{rotation,parallelFlipRotation,regularFlipRotation}}generateTicks({primaryTickCount,parallelFlipRotation,regularFlipRotation,labelX,sideFlag}){var _a201;const{scale:scale2,tick,label:{parallel,rotation,fontFamily,fontSize,fontStyle,fontWeight}}=this,secondaryAxis=primaryTickCount!==void 0,{defaultRotation,configuredRotation,parallelFlipFlag,regularFlipFlag}=calculateLabelRotation({rotation,parallel,regularFlipRotation,parallelFlipRotation}),initialRotation=configuredRotation+defaultRotation,labelMatrix=new Matrix,{maxTickCount}=this.estimateTickCount({minSpacing:tick.minSpacing,maxSpacing:(_a201=tick.maxSpacing)!=null?_a201:NaN}),maxIterations=!ContinuousScale.is(scale2)||isNaN(maxTickCount)?10:maxTickCount;let textAlign=getTextAlign(parallel,configuredRotation,0,sideFlag,regularFlipFlag);const textBaseline=getTextBaseline(parallel,configuredRotation,sideFlag,parallelFlipFlag),textProps={fontFamily,fontSize,fontStyle,fontWeight,textBaseline,textAlign};let tickData={rawTicks:[],ticks:[],labelCount:0},index=0,autoRotation=0,labelOverlap=!0,terminate=!1;for(;labelOverlap&&index<=maxIterations&&!terminate;){autoRotation=0,textAlign=getTextAlign(parallel,configuredRotation,0,sideFlag,regularFlipFlag);const tickStrategies=this.getTickStrategies({secondaryAxis,index});for(const strategy of tickStrategies){({tickData,index,autoRotation,terminate}=strategy({index,tickData,textProps,labelOverlap,terminate,primaryTickCount}));const rotated=configuredRotation!==0||autoRotation!==0,rotation2=initialRotation+autoRotation;textAlign=getTextAlign(parallel,configuredRotation,autoRotation,sideFlag,regularFlipFlag),labelOverlap=this.checkLabelOverlap(rotation2,rotated,labelMatrix,tickData.ticks,labelX,__spreadProps(__spreadValues({},textProps),{textAlign}))}}const combinedRotation=defaultRotation+configuredRotation+autoRotation;return!secondaryAxis&&tickData.rawTicks.length>0&&(primaryTickCount=tickData.rawTicks.length),{tickData,primaryTickCount,combinedRotation,textBaseline,textAlign}}getTickStrategies({index,secondaryAxis}){const{scale:scale2,label,tick}=this,continuous=ContinuousScale.is(scale2),avoidLabelCollisions=label.enabled&&label.avoidCollisions,filterTicks=!continuous&&index!==0&&avoidLabelCollisions,autoRotate=label.autoRotate===!0&&label.rotation===void 0,strategies=[];let tickGenerationType;this.tick.values?tickGenerationType=3:secondaryAxis?tickGenerationType=1:filterTicks?tickGenerationType=2:tickGenerationType=0;const tickGenerationStrategy=__name(({index:index2,tickData,primaryTickCount,terminate})=>this.createTickData(tickGenerationType,index2,tickData,terminate,primaryTickCount),"tickGenerationStrategy");if(strategies.push(tickGenerationStrategy),!continuous&&!isNaN(tick.minSpacing)){const tickFilterStrategy=__name(({index:index2,tickData,primaryTickCount,terminate})=>this.createTickData(2,index2,tickData,terminate,primaryTickCount),"tickFilterStrategy");strategies.push(tickFilterStrategy)}if(!avoidLabelCollisions)return strategies;if(label.autoWrap){const autoWrapStrategy=__name(({index:index2,tickData,textProps})=>this.wrapLabels(tickData,index2,textProps),"autoWrapStrategy");strategies.push(autoWrapStrategy)}else if(autoRotate){const autoRotateStrategy=__name(({index:index2,tickData,labelOverlap,terminate})=>({index:index2,tickData,autoRotation:this.getAutoRotation(labelOverlap),terminate}),"autoRotateStrategy");strategies.push(autoRotateStrategy)}return strategies}createTickData(tickGenerationType,index,tickData,terminate,primaryTickCount){var _a201;const{scale:scale2,tick}=this,{maxTickCount,minTickCount,defaultTickCount}=this.estimateTickCount({minSpacing:tick.minSpacing,maxSpacing:(_a201=tick.maxSpacing)!=null?_a201:NaN}),continuous=ContinuousScale.is(scale2),maxIterations=!continuous||isNaN(maxTickCount)?10:maxTickCount;let tickCount=continuous?Math.max(defaultTickCount-index,minTickCount):maxTickCount;const regenerateTicks=tick.interval===void 0&&tick.values===void 0&&tickCount>minTickCount&&(continuous||tickGenerationType===2);let unchanged=!0;for(;unchanged&&index<=maxIterations;){const prevTicks=tickData.rawTicks;tickCount=continuous?Math.max(defaultTickCount-index,minTickCount):maxTickCount;const{rawTicks,ticks,labelCount}=this.getTicks({tickGenerationType,previousTicks:prevTicks,tickCount,minTickCount,maxTickCount,primaryTickCount});tickData.rawTicks=rawTicks,tickData.ticks=ticks,tickData.labelCount=labelCount,unchanged=regenerateTicks?areArrayNumbersEqual(rawTicks,prevTicks):!1,index++}const shouldTerminate=tick.interval!==void 0||tick.values!==void 0;return terminate||(terminate=shouldTerminate),{tickData,index,autoRotation:0,terminate}}checkLabelOverlap(rotation,rotated,labelMatrix,tickData,labelX,textProps){Matrix.updateTransformMatrix(labelMatrix,1,1,rotation,0,0);const labelData=this.createLabelData(tickData,labelX,textProps,labelMatrix),labelSpacing=getLabelSpacing(this.label.minSpacing,rotated);return axisLabelsOverlap(labelData,labelSpacing)}createLabelData(tickData,labelX,textProps,labelMatrix){const labelData=[];for(const tickDatum of tickData){const{tickLabel,translationY}=tickDatum;if(tickLabel===""||tickLabel==null)continue;const lines=splitText(tickLabel),{width,height}=measureText(lines,labelX,translationY,textProps),bbox=new BBox(labelX,translationY,width,height),labelDatum=calculateLabelBBox(tickLabel,bbox,labelX,translationY,labelMatrix);labelData.push(labelDatum)}return labelData}getAutoRotation(labelOverlap){var _a201;return labelOverlap?normalizeAngle360(toRadians((_a201=this.label.autoRotateAngle)!=null?_a201:0)):0}getTicks({tickGenerationType,previousTicks,tickCount,minTickCount,maxTickCount,primaryTickCount}){var _a201;const{range:range3,scale:scale2,visibleRange}=this;let rawTicks;switch(tickGenerationType){case 3:if(ContinuousScale.is(scale2)){const scaleDomain=scale2.getDomain(),start2=scale2.fromDomain(scaleDomain[0]),stop=scale2.fromDomain(scaleDomain[1]),d0=Math.min(start2,stop),d1=Math.max(start2,stop);rawTicks=this.tick.values.filter(value=>value>=d0&&value<=d1).sort((a,b)=>a-b)}else rawTicks=this.tick.values;break;case 1:rawTicks=this.updateSecondaryAxisTicks(primaryTickCount);break;case 2:rawTicks=this.filterTicks(previousTicks,tickCount);break;default:rawTicks=this.createTicks(tickCount,minTickCount,maxTickCount);break}this.fractionDigits=rawTicks.fractionDigits>=0?rawTicks.fractionDigits:0,this.onLabelFormatChange(rawTicks,this.label.format);const halfBandwidth=((_a201=scale2.bandwidth)!=null?_a201:0)/2,ticks=[];let labelCount=0;const tickIdCounts=new Map,start=Math.max(0,Math.floor(visibleRange[0]*rawTicks.length)),end=Math.min(rawTicks.length,Math.ceil(visibleRange[1]*rawTicks.length));for(let i=start;i<end;i++){const rawTick=rawTicks[i],translationY=scale2.convert(rawTick)+halfBandwidth;if(range3.length>0&&!this.inRange(translationY,0,.001))continue;const tickLabel=this.formatTick(rawTick,i);let tickId=tickLabel;if(tickIdCounts.has(tickId)){const count2=tickIdCounts.get(tickId);tickIdCounts.set(tickId,count2+1),tickId=`${tickId}_${count2}`}else tickIdCounts.set(tickId,1);ticks.push({tick:rawTick,tickId,tickLabel,translationY}),!(tickLabel===""||tickLabel==null)&&labelCount++}return{rawTicks,ticks,labelCount}}filterTicks(ticks,tickCount){var _a201;const keepEvery=!isNaN(this.tick.minSpacing)||!isNaN((_a201=this.tick.maxSpacing)!=null?_a201:NaN)?Math.ceil(ticks.length/tickCount):2;return ticks.filter((_,i)=>i%keepEvery===0)}createTicks(tickCount,minTickCount,maxTickCount){var _a201,_b,_c;return this.setTickCount(tickCount,minTickCount,maxTickCount),(_c=(_b=(_a201=this.scale).ticks)==null?void 0:_b.call(_a201))!=null?_c:[]}estimateTickCount({minSpacing,maxSpacing}){const{minRect}=this,rangeWithBleed=this.calculateRangeWithBleed(),defaultMinSpacing=Math.max(this.defaultTickMinSpacing,rangeWithBleed/ContinuousScale.defaultMaxTickCount);let clampMaxTickCount=!isNaN(maxSpacing);isNaN(minSpacing)&&(minSpacing=defaultMinSpacing),isNaN(maxSpacing)&&(maxSpacing=rangeWithBleed),minSpacing>maxSpacing&&(minSpacing===defaultMinSpacing?minSpacing=maxSpacing:maxSpacing=minSpacing);const minRectDistance=minRect?this.direction==="x"?minRect.width:minRect.height:1;clampMaxTickCount&&(clampMaxTickCount=minRectDistance<defaultMinSpacing);const maxTickCount=clamp(1,Math.floor(rangeWithBleed/minSpacing),clampMaxTickCount?Math.floor(rangeWithBleed/minRectDistance):1/0),minTickCount=Math.min(maxTickCount,Math.ceil(rangeWithBleed/maxSpacing)),defaultTickCount=clamp(minTickCount,ContinuousScale.defaultTickCount,maxTickCount);return{minTickCount,maxTickCount,defaultTickCount}}updateVisibility(){this.moduleCtx.animationManager.isSkipped()&&this.resetSelectionNodes(),this.tickLineGroup.visible=this.tick.enabled,this.gridLineGroup.visible=this.gridLine.enabled,this.tickLabelGroup.visible=this.label.enabled}updateCrossLines({rotation,parallelFlipRotation,regularFlipRotation}){var _a201;const sideFlag=this.label.getSideFlag(),anySeriesActive=this.isAnySeriesActive();(_a201=this.crossLines)==null||_a201.forEach(crossLine=>{var _a210;crossLine.sideFlag=-sideFlag,crossLine.direction=rotation===-Math.PI/2?"x":"y",crossLine instanceof CartesianCrossLine&&(crossLine.label.parallel=(_a210=crossLine.label.parallel)!=null?_a210:this.label.parallel),crossLine.parallelFlipRotation=parallelFlipRotation,crossLine.regularFlipRotation=regularFlipRotation,crossLine.update(anySeriesActive)})}updateTickLines(){const{tick,label}=this,sideFlag=label.getSideFlag();this.tickLineGroupSelection.each(line=>{line.strokeWidth=tick.width,line.stroke=tick.color,line.x1=sideFlag*this.getTickSize(),line.x2=0})}calculateAvailableRange(){return findRangeExtent(this.range)}calculateRangeWithBleed(){const visibleScale=1/findRangeExtent(this.visibleRange);return round(this.calculateAvailableRange()*visibleScale,2)}calculateDomain(){const domains=this.boundSeries.filter(s=>this.includeInvisibleDomains||s.isEnabled()).flatMap(series=>series.getDomain(this.direction));this.setDomain(domains)}getAxisTransform(){return{rotation:toRadians(this.rotation),rotationCenterX:0,rotationCenterY:0,translationX:Math.floor(this.translation.x),translationY:Math.floor(this.translation.y)}}updatePosition(){const{crossLineGroup,axisGroup,gridGroup,translation,gridLineGroupSelection,gridPadding,gridLength}=this,{rotation}=this.calculateRotations(),sideFlag=this.label.getSideFlag(),translationX=Math.floor(translation.x),translationY=Math.floor(translation.y);crossLineGroup.setProperties({rotation,translationX,translationY}),gridGroup.setProperties({rotation,translationX,translationY}),axisGroup.datum=this.getAxisTransform(),gridLineGroupSelection.each(line=>{line.x1=gridPadding,line.x2=-sideFlag*gridLength+gridPadding})}updateSecondaryAxisTicks(_primaryTickCount){throw new Error("AG Charts - unexpected call to updateSecondaryAxisTicks() - check axes configuration.")}updateSelections(lineData,data,params){this.lineNode.datum=lineData,this.gridLineGroupSelection.update(this.gridLength?data:[],group2=>group2.append(new Line({tag:2})),datum=>datum.tickId),this.tickLineGroupSelection.update(data,group2=>group2.appendChild(new Line({tag:0})),datum=>datum.tickId),this.tickLabelGroupSelection.update(data.map(d=>this.getTickLabelProps(d,params)),group2=>group2.appendChild(new Text({tag:1})),datum=>datum.tickId)}updateAxisLine(){const{line}=this,strokeWidth=line.enabled?line.width:0;this.lineNode.setProperties({stroke:line.color,strokeWidth})}updateGridLines(sideFlag){const{gridLine:{style,width},gridPadding,gridLength}=this;gridLength===0||style.length===0||this.gridLineGroupSelection.each((line,_,index)=>{const{stroke,lineDash}=style[index%style.length];line.setProperties({x1:gridPadding,x2:-sideFlag*gridLength+gridPadding,fill:void 0,stroke,strokeWidth:width,lineDash})})}updateLabels(){const{label}=this;label.enabled&&this.tickLabelGroupSelection.each((node,datum)=>{node.setProperties(datum,["fill","fontFamily","fontSize","fontStyle","fontWeight","text","textAlign","textBaseline"])})}wrapLabels(tickData,index,labelProps){const{parallel,maxWidth,maxHeight}=this.label;let defaultMaxWidth=this.maxThickness,defaultMaxHeight=Math.round(this.calculateAvailableRange()/tickData.labelCount);return parallel&&([defaultMaxWidth,defaultMaxHeight]=[defaultMaxHeight,defaultMaxWidth]),tickData.ticks.forEach(tickDatum=>{const{text}=Text.wrap(tickDatum.tickLabel,maxWidth??defaultMaxWidth,maxHeight??defaultMaxHeight,labelProps,"hyphenate");tickDatum.tickLabel=text}),{tickData,index,autoRotation:0,terminate:!0}}updateTitle(params){const{rotation,title,_titleCaption,lineNode,tickLineGroup,tickLabelGroup}=this;if(!title){_titleCaption.enabled=!1;return}let spacing=0;if(title.enabled&&params.anyTickVisible){const tickBBox=Group.computeBBox([tickLineGroup,tickLabelGroup,lineNode]),tickWidth=rotation===0?tickBBox.width:tickBBox.height;spacing+=tickWidth+(this.tickLabelGroup.visible?0:this.seriesAreaPadding)}this.setTitleProps(_titleCaption,{spacing})}formatTick(datum,index){var _a201,_b;const{label,labelFormatter,fractionDigits,moduleCtx:{callbackCache}}=this;if(label.formatter){const value=fractionDigits>0?datum:String(datum);return(_a201=callbackCache.call(label.formatter,{value,index,fractionDigits,formatter:labelFormatter}))!=null?_a201:value}else if(labelFormatter)return(_b=callbackCache.call(labelFormatter,datum))!=null?_b:String(datum);return String(datum)}formatDatum(datum){return String(datum)}computeBBox(){return this.axisGroup.computeBBox()}initCrossLine(crossLine){crossLine.scale=this.scale,crossLine.gridLength=this.gridLength}isAnySeriesActive(){return this.boundSeries.some(s=>this.includeInvisibleDomains||s.isEnabled())}clipTickLines(x,y,width,height){this.tickLineGroup.setClipRectInGroupCoordinateSpace(new BBox(x,y,width,height))}clipGrid(x,y,width,height){this.gridGroup.setClipRectInGroupCoordinateSpace(new BBox(x,y,width,height))}calculatePadding(min,max,reverse){const padding=Math.abs(reverse?max:min)*.01;return[padding,padding]}getTitleFormatterParams(){var _a201;const boundSeries=this.boundSeries.reduce((acc,next)=>{const keys=next.getKeys(this.direction),names=next.getNames(this.direction);for(let idx=0;idx<keys.length;idx++)acc.push({key:keys[idx],name:names[idx]});return acc},[]);return{direction:this.direction,boundSeries,defaultValue:(_a201=this.title)==null?void 0:_a201.text}}normaliseDataDomain(d){return{domain:[...d],clipped:!1}}getLayoutState(){return __spreadValues({rect:this.computeBBox(),gridPadding:this.gridPadding,seriesAreaPadding:this.seriesAreaPadding,tickSize:this.getTickSize()},this.layout)}getModuleMap(){return this.moduleMap}createModuleContext(){var _a201;return(_a201=this.axisContext)!=null||(this.axisContext=this.createAxisContext()),__spreadProps(__spreadValues({},this.moduleCtx),{parent:this.axisContext})}createAxisContext(){return{axisId:this.id,direction:this.direction,continuous:ContinuousScale.is(this.scale),keys:()=>this.boundSeries.flatMap(s=>s.getKeys(this.direction)),scaleValueFormatter:specifier=>{var _a201,_b;return(_b=(_a201=this.scale).tickFormat)==null?void 0:_b.call(_a201,{specifier})},scaleBandwidth:()=>{var _a201;return(_a201=this.scale.bandwidth)!=null?_a201:0},scaleConvert:val=>this.scale.convert(val),scaleInvert:val=>{var _a201,_b;return(_b=(_a201=this.scale).invert)==null?void 0:_b.call(_a201,val)}}}animateReadyUpdate(diff2){const{animationManager}=this.moduleCtx,selectionCtx=prepareAxisAnimationContext(this),fns=prepareAxisAnimationFunctions(selectionCtx);fromToMotion(this.id,"axis-group",animationManager,[this.axisGroup],fns.group),fromToMotion(this.id,"line",animationManager,[this.lineNode],fns.line),fromToMotion(this.id,"line-paths",animationManager,[this.gridLineGroupSelection,this.tickLineGroupSelection],fns.tick,(_,d)=>d.tickId,diff2),fromToMotion(this.id,"tick-labels",animationManager,[this.tickLabelGroupSelection],fns.label,(_,d)=>d.tickId,diff2)}resetSelectionNodes(){const{gridLineGroupSelection,tickLineGroupSelection,tickLabelGroupSelection,lineNode}=this,selectionCtx=prepareAxisAnimationContext(this);resetMotion([this.axisGroup],resetAxisGroupFn()),resetMotion([gridLineGroupSelection,tickLineGroupSelection],resetAxisSelectionFn(selectionCtx)),resetMotion([tickLabelGroupSelection],resetAxisLabelSelectionFn()),resetMotion([lineNode],resetAxisLineSelectionFn())}calculateUpdateDiff(previous,tickData){const added=new Set,removed=new Set,tickCount=Math.max(previous.length,tickData.ticks.length);for(let i=0;i<tickCount;i++){const tickDatum=tickData.ticks[i],prev=previous[i],tick=tickDatum==null?void 0:tickDatum.tickId;prev!==tick&&(removed.has(tick)?removed.delete(tick):tick&&added.add(tick),added.has(prev)?added.delete(prev):prev&&removed.add(prev))}return{changed:added.size>0||removed.size>0,added:Array.from(added.values()),removed:Array.from(removed.values())}}isReversed(){return this.reverse}},__name(_a49,"_Axis"),_a49);_Axis.defaultTickMinSpacing=50;__decorateClass([Validate(BOOLEAN)],_Axis.prototype,"nice",2);__decorateClass([Validate(BOOLEAN)],_Axis.prototype,"reverse",2);__decorateClass([Validate(STRING_ARRAY)],_Axis.prototype,"keys",2);__decorateClass([Validate(predicateWithMessage(title=>typeof title=="object","Title object"),{optional:!0})],_Axis.prototype,"title",2);__decorateClass([ObserveChanges((target,value,oldValue)=>target.onGridLengthChange(value,oldValue))],_Axis.prototype,"gridLength",2);var Axis=_Axis,_a50,CartesianAxisLabel=(_a50=class extends AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}},__name(_a50,"CartesianAxisLabel"),_a50);__decorateClass([Validate(BOOLEAN,{optional:!0})],CartesianAxisLabel.prototype,"autoRotate",2);__decorateClass([Validate(DEGREE)],CartesianAxisLabel.prototype,"autoRotateAngle",2);var _a51,_CartesianAxis=(_a51=class extends Axis{constructor(){super(...arguments),this.thickness=0,this.position="left"}static is(value){return value instanceof _a51}get direction(){return["top","bottom"].includes(this.position)?"x":"y"}updateDirection(){switch(this.position){case"top":this.rotation=-90,this.label.mirrored=!0,this.label.parallel=!0;break;case"right":this.rotation=0,this.label.mirrored=!0,this.label.parallel=!1;break;case"bottom":this.rotation=-90,this.label.mirrored=!1,this.label.parallel=!0;break;case"left":this.rotation=0,this.label.mirrored=!1,this.label.parallel=!1;break}this.axisContext&&(this.axisContext.position=this.position,this.axisContext.direction=this.direction)}update(primaryTickCount,animated){return this.updateDirection(),super.update(primaryTickCount,animated)}calculateLayout(primaryTickCount){return this.updateDirection(),super.calculateLayout(primaryTickCount)}createAxisContext(){return __spreadProps(__spreadValues({},super.createAxisContext()),{position:this.position})}assignCrossLineArrayConstructor(crossLines){assignJsonApplyConstructedArray(crossLines,CartesianCrossLine)}createLabel(){return new CartesianAxisLabel}},__name(_a51,"_CartesianAxis"),_a51);__decorateClass([Validate(POSITIVE_NUMBER)],_CartesianAxis.prototype,"thickness",2);__decorateClass([Validate(POSITION2)],_CartesianAxis.prototype,"position",2);var CartesianAxis=_CartesianAxis,_a52,CategoryAxis=(_a52=class extends CartesianAxis{constructor(moduleCtx){super(moduleCtx,new BandScale),this._paddingOverrideEnabled=!1,this.groupPaddingInner=.1,this.includeInvisibleDomains=!0}set paddingInner(value){this._paddingOverrideEnabled=!0,this.scale.paddingInner=value}get paddingInner(){return this._paddingOverrideEnabled=!0,this.scale.paddingInner}set paddingOuter(value){this.scale.paddingOuter=value}get paddingOuter(){return this.scale.paddingOuter}normaliseDataDomain(d){const domain=[],uniqueValues=new Set;for(const v of d){const key=v instanceof Date?v.getTime():v;uniqueValues.has(key)||(uniqueValues.add(key),domain.push(v))}return{domain,clipped:!1}}calculateDomain(){if(!this._paddingOverrideEnabled){const paddings=this.boundSeries.map(s=>{var _a201;return(_a201=s.getBandScalePadding)==null?void 0:_a201.call(s)}).filter(p=>p!=null);paddings.length>0&&(this.scale.paddingInner=Math.min(...paddings.map(p=>p.inner)),this.scale.paddingOuter=Math.max(...paddings.map(p=>p.outer)))}return super.calculateDomain()}},__name(_a52,"CategoryAxis"),_a52);CategoryAxis.className="CategoryAxis";CategoryAxis.type="category";__decorateClass([Validate(RATIO)],CategoryAxis.prototype,"groupPaddingInner",2);var _a53,TreeNode=(_a53=class{constructor(label="",parent,number=0){this.x=0,this.y=0,this.subtreeLeft=NaN,this.subtreeRight=NaN,this.screenX=0,this.screenY=0,this.children=[],this.leafCount=0,this.prelim=0,this.mod=0,this.ancestor=this,this.change=0,this.shift=0,this.label=label,this.parent=parent,this.depth=parent?parent.depth+1:0,this.number=number}getLeftSibling(){return this.number>0&&this.parent?this.parent.children[this.number-1]:void 0}getLeftmostSibling(){return this.number>0&&this.parent?this.parent.children[0]:void 0}nextLeft(){return this.children?this.children[0]:this.thread}nextRight(){return this.children?this.children[this.children.length-1]:this.thread}getSiblings(){return this.parent?this.parent.children.filter((_,i)=>i!==this.number):[]}},__name(_a53,"TreeNode"),_a53);function ticksToTree(ticks,pad2=!0){const root=new TreeNode;let depth=0;return pad2&&ticks.forEach(tick=>depth=Math.max(depth,tick.labels.length)),ticks.forEach(tick=>{if(pad2)for(;tick.labels.length<depth;)tick.labels.unshift("");insertTick(root,tick)}),root}__name(ticksToTree,"ticksToTree");function insertTick(root,tick){const pathParts=tick.labels.slice().reverse(),lastPartIndex=pathParts.length-1;pathParts.forEach((pathPart,partIndex)=>{const children=root.children,existingNode=children.find(child=>child.label===pathPart),isNotLeaf=partIndex!==lastPartIndex;if(existingNode&&isNotLeaf)root=existingNode;else{const node=new TreeNode(pathPart,root);node.number=children.length,children.push(node),isNotLeaf&&(root=node)}})}__name(insertTick,"insertTick");function moveSubtree(wm,wp,shift){const subtrees=wp.number-wm.number,ratio=shift/subtrees;wp.change-=ratio,wp.shift+=shift,wm.change+=ratio,wp.prelim+=shift,wp.mod+=shift}__name(moveSubtree,"moveSubtree");function ancestor(vim,v,defaultAncestor){return v.getSiblings().indexOf(vim.ancestor)>=0?vim.ancestor:defaultAncestor}__name(ancestor,"ancestor");function executeShifts(v){const children=v.children;if(children){let shift=0,change=0;for(let i=children.length-1;i>=0;i--){const w=children[i];w.prelim+=shift,w.mod+=shift,change+=w.change,shift+=w.shift+change}}}__name(executeShifts,"executeShifts");function apportion(v,defaultAncestor,distance2){const w=v.getLeftSibling();if(w){let vop=v,vip=v,vim=w,vom=vip.getLeftmostSibling(),sip=vip.mod,sop=vop.mod,sim=vim.mod,som=vom.mod;for(;vim.nextRight()&&vip.nextLeft();){vim=vim.nextRight(),vip=vip.nextLeft(),vom=vom.nextLeft(),vop=vop.nextRight(),vop.ancestor=v;const shift=vim.prelim+sim-(vip.prelim+sip)+distance2;shift>0&&(moveSubtree(ancestor(vim,v,defaultAncestor),v,shift),sip+=shift,sop+=shift),sim+=vim.mod,sip+=vip.mod,som+=vom.mod,sop+=vop.mod}vim.nextRight()&&!vop.nextRight()?(vop.thread=vim.nextRight(),vop.mod+=sim-sop):(vip.nextLeft()&&!vom.nextLeft()&&(vom.thread=vip.nextLeft(),vom.mod+=sip-som),defaultAncestor=v)}return defaultAncestor}__name(apportion,"apportion");function firstWalk(node,distance2){const children=node.children;if(children.length){let defaultAncestor=children[0];children.forEach(child=>{firstWalk(child,distance2),defaultAncestor=apportion(child,defaultAncestor,distance2)}),executeShifts(node);const midpoint=(children[0].prelim+children.at(-1).prelim)/2,leftSibling=node.getLeftSibling();leftSibling?(node.prelim=leftSibling.prelim+distance2,node.mod=node.prelim-midpoint):node.prelim=midpoint}else{const leftSibling=node.getLeftSibling();node.prelim=leftSibling?leftSibling.prelim+distance2:0}}__name(firstWalk,"firstWalk");var _a54,Dimensions=(_a54=class{constructor(){this.top=1/0,this.right=-1/0,this.bottom=-1/0,this.left=1/0}update(node,xy){const{x,y}=xy(node);x>this.right&&(this.right=x),x<this.left&&(this.left=x),y>this.bottom&&(this.bottom=y),y<this.top&&(this.top=y)}},__name(_a54,"Dimensions"),_a54);function secondWalk(v,m,layout){v.x=v.prelim+m,v.y=v.depth,layout.update(v),v.children.forEach(w=>secondWalk(w,m+v.mod,layout))}__name(secondWalk,"secondWalk");function thirdWalk(v){const children=v.children;let leafCount=0;children.forEach(w=>{thirdWalk(w),w.children.length?leafCount+=w.leafCount:leafCount++}),v.leafCount=leafCount,children.length?(v.subtreeLeft=children[0].subtreeLeft,v.subtreeRight=children[v.children.length-1].subtreeRight,v.x=(v.subtreeLeft+v.subtreeRight)/2):(v.subtreeLeft=v.x,v.subtreeRight=v.x)}__name(thirdWalk,"thirdWalk");function treeLayout(root){const layout=new TreeLayout;return firstWalk(root,1),secondWalk(root,-root.prelim,layout),thirdWalk(root),layout}__name(treeLayout,"treeLayout");var _a55,TreeLayout=(_a55=class{constructor(){this.dimensions=new Dimensions,this.leafCount=0,this.nodes=[],this.leafNodes=[],this.nonLeafNodes=[],this.depth=0}update(node){this.dimensions.update(node,node2=>({x:node2.x,y:node2.y})),node.children.length?this.nonLeafNodes.push(node):(this.leafCount++,this.leafNodes.push(node)),node.depth>this.depth&&(this.depth=node.depth),this.nodes.push(node)}resize(width,height,shiftX=0,shiftY=0,flipX=!1){const xSteps=this.leafCount-1,ySteps=this.depth,dimensions=this.dimensions;let scalingX=1,scalingY=1;if(width>0&&xSteps){const existingSpacingX=(dimensions.right-dimensions.left)/xSteps;scalingX=width/xSteps/existingSpacingX,flipX&&(scalingX=-scalingX)}if(height>0&&ySteps){const existingSpacingY=(dimensions.bottom-dimensions.top)/ySteps;scalingY=height/ySteps/existingSpacingY}const screenDimensions=new Dimensions;this.nodes.forEach(node=>{node.screenX=node.x*scalingX,node.screenY=node.y*scalingY,screenDimensions.update(node,node2=>({x:node2.screenX,y:node2.screenY}))});const offsetX=-screenDimensions.left,offsetY=-screenDimensions.top;this.nodes.forEach(node=>{node.screenX+=offsetX+shiftX,node.screenY+=offsetY+shiftY})}},__name(_a55,"TreeLayout"),_a55),_a56,GroupedCategoryAxisLabel=(_a56=class extends AxisLabel{constructor(){super(...arguments),this.grid=!1}},__name(_a56,"GroupedCategoryAxisLabel"),_a56);__decorateClass([Validate(BOOLEAN)],GroupedCategoryAxisLabel.prototype,"grid",2);var _a57,GroupedCategoryAxis=(_a57=class extends CartesianAxis{constructor(moduleCtx){super(moduleCtx,new BandScale),this.tickScale=new BandScale,this.line=new AxisLine,this.label=new GroupedCategoryAxisLabel,this.labelColor="rgba(87, 87, 87, 1)",this.includeInvisibleDomains=!0;const{tickLineGroup,tickLabelGroup,gridLineGroup,tickScale,scale:scale2}=this;scale2.paddingOuter=.1,scale2.paddingInner=scale2.paddingOuter*2,this.refreshScale(),tickScale.paddingInner=1,tickScale.paddingOuter=0,this.gridLineSelection=Selection.select(gridLineGroup,Line),this.axisLineSelection=Selection.select(tickLineGroup,Line),this.separatorSelection=Selection.select(tickLineGroup,Line),this.labelSelection=Selection.select(tickLabelGroup,Text)}updateRange(){const{range:rr,visibleRange:vr,scale:scale2}=this,span=(rr[1]-rr[0])/(vr[1]-vr[0]),shift=span*vr[0],start=rr[0]-shift;this.tickScale.range=scale2.range=[start,start+span],this.resizeTickTree()}resizeTickTree(){var _a201;const s=this.scale,range3=s.domain.length?[s.convert(s.domain[0]),s.convert(s.domain[s.domain.length-1])]:s.range,layout=this.tickTreeLayout,lineHeight=this.lineHeight;layout&&layout.resize(Math.abs(range3[1]-range3[0]),layout.depth*lineHeight,(Math.min(range3[0],range3[1])||0)+((_a201=s.bandwidth)!=null?_a201:0)/2,-layout.depth*lineHeight,range3[1]-range3[0]<0)}get lineHeight(){return this.label.fontSize*1.5}onGridVisibilityChange(){this.gridLineSelection.clear(),this.labelSelection.clear()}calculateDomain(){var _a201;const{direction}=this;let isNumericX=null;const flatDomains=this.boundSeries.filter(s=>s.visible).flatMap(series=>{if(direction==="y"||isNumericX)return series.getDomain(direction);if(isNumericX===null){const domain2=series.getDomain(direction);return isNumericX=isNumber(domain2[0]),domain2}return[]});this.setDomain((_a201=extent(flatDomains))!=null?_a201:unique(flatDomains));const{domain}=this.dataDomain;this.tickTreeLayout=treeLayout(ticksToTree(domain)),this.tickScale.domain=domain.concat(""),this.resizeTickTree()}update(){this.computedLayout&&(this.updatePosition(),this.updateTitleCaption(),this.updateCategoryLabels(),this.updateSeparators(),this.updateAxisLines(),this.updateCategoryGridLines(),this.resetSelectionNodes())}updateTitleCaption(){const{_titleCaption}=this;_titleCaption.node.visible=!1}updateCategoryLabels(){if(!this.computedLayout)return;const{tickLabelLayout}=this.computedLayout;this.labelSelection.update(tickLabelLayout).each((node,datum)=>{node.setProperties(datum)})}updateSeparators(){if(!this.computedLayout)return;const{separatorLayout}=this.computedLayout,{range:range3}=this,epsilon2=1e-7;this.separatorSelection.update(separatorLayout).each((line,datum)=>{line.x1=datum.x1,line.x2=datum.x2,line.y1=datum.y,line.y2=datum.y,line.visible=datum.y>=range3[0]-epsilon2&&datum.y<=range3[1]+epsilon2,line.stroke=this.tick.color,line.fill=void 0,line.strokeWidth=1})}updateAxisLines(){if(!this.computedLayout)return;const{axisLineLayout}=this.computedLayout;this.axisLineSelection.update(axisLineLayout).each((line,datum)=>{line.setProperties(__spreadProps(__spreadValues({},datum),{stroke:this.line.color,strokeWidth:this.line.width})),line.x1=datum.x,line.x2=datum.x,line.y1=datum.y1,line.y2=datum.y2,line.strokeWidth=this.line.width,line.stroke=this.line.color})}updateCategoryGridLines(){const{gridLength,gridLine,label,range:range3,tickScale}=this,ticks=tickScale.ticks(),sideFlag=label.getSideFlag(),gridSelection=this.gridLineSelection.update(gridLength?ticks:[]);if(gridLength){const{width,style}=gridLine,styleCount=style.length;gridSelection.each((line,datum,index)=>{const y=Math.round(tickScale.convert(datum));line.x1=0,line.x2=-sideFlag*gridLength,line.y1=y,line.y2=y,line.visible=y>=range3[0]&&y<=range3[1];const{stroke,lineDash}=style[index%styleCount];line.stroke=stroke,line.strokeWidth=width,line.lineDash=lineDash,line.fill=void 0})}}computeLayout(){this.updateDirection(),this.calculateDomain(),this.updateRange();const{scale:scale2,label,label:{parallel},moduleCtx:{callbackCache},range:range3,title,title:{formatter=__name(p=>p.defaultValue,"formatter")}={}}=this,rangeStart=scale2.range[0],rangeEnd=scale2.range[1],bandwidth=Math.abs(rangeEnd-rangeStart)/scale2.domain.length||0,keepEvery=Math.ceil(label.fontSize/bandwidth),rotation=toRadians(this.rotation),isHorizontal=Math.abs(Math.cos(rotation))<1e-8,sideFlag=label.getSideFlag(),lineHeight=this.lineHeight,tickTreeLayout=this.tickTreeLayout,labels=scale2.ticks(),treeLabels=tickTreeLayout?tickTreeLayout.nodes:[],isLabelTree=tickTreeLayout?tickTreeLayout.depth>1:!1,{defaultRotation,configuredRotation,parallelFlipFlag}=calculateLabelRotation({rotation:label.rotation,parallel,regularFlipRotation:normalizeAngle360(rotation-Math.PI/2),parallelFlipRotation:normalizeAngle360(rotation)}),tickLabelLayout=[],copyLabelProps=__name(node=>({fill:node.fill,fontFamily:node.fontFamily,fontSize:node.fontSize,fontStyle:node.fontStyle,fontWeight:node.fontWeight,rotation:node.rotation,rotationCenterX:node.rotationCenterX,rotationCenterY:node.rotationCenterY,text:node.text,textAlign:node.textAlign,textBaseline:node.textBaseline,translationX:node.translationX,translationY:node.translationY,visible:node.visible,x:node.x,y:node.y}),"copyLabelProps"),labelBBoxes=new Map;let maxLeafLabelWidth=0;const tempText=new Text,setLabelProps=__name((datum,index)=>{var _a201;if(tempText.setProperties({fill:label.color,fontFamily:label.fontFamily,fontSize:label.fontSize,fontStyle:label.fontStyle,fontWeight:label.fontWeight,textAlign:"center",textBaseline:parallelFlipFlag===-1?"bottom":"hanging",translationX:datum.screenY-label.fontSize*.25,translationY:datum.screenX}),index===0){if(!((title==null?void 0:title.enabled)&&labels.length>0))return!1;const text=callbackCache.call(formatter,this.getTitleFormatterParams());tempText.setProperties({fill:title.color,fontFamily:title.fontFamily,fontSize:title.fontSize,fontStyle:title.fontStyle,fontWeight:title.fontWeight,text,textBaseline:"hanging",translationX:datum.screenY-label.fontSize*.25,translationY:datum.screenX})}else{if(index%keepEvery!==0)return!1;if(!(datum.screenX>=range3[0]&&datum.screenX<=range3[1]))return!1;label.formatter?tempText.text=(_a201=callbackCache.call(label.formatter,{value:String(datum.label),index}))!=null?_a201:String(datum.label):tempText.text=String(datum.label)}return!0},"setLabelProps");treeLabels.forEach((datum,index)=>{if(!setLabelProps(datum,index))return;const bbox2=tempText.computeTransformedBBox();if(!bbox2)return;labelBBoxes.set(index,bbox2),!datum.children.length&&bbox2.width>maxLeafLabelWidth&&(maxLeafLabelWidth=bbox2.width)});const labelX=sideFlag*label.padding,labelGrid=this.label.grid,separatorData=[];treeLabels.forEach((datum,index)=>{let visible=setLabelProps(datum,index);const id=index;tempText.x=labelX,tempText.rotationCenterX=labelX;const isLeaf=!datum.children.length;if(isLeaf)tempText.rotation=configuredRotation,tempText.textAlign="end",tempText.textBaseline="middle";else{tempText.translationX-=maxLeafLabelWidth-lineHeight+this.label.padding;const availableRange=datum.leafCount*bandwidth,bbox2=labelBBoxes.get(id);bbox2&&bbox2.width>availableRange?(visible=!1,labelBBoxes.delete(id)):isHorizontal?tempText.rotation=defaultRotation:tempText.rotation=-Math.PI/2}if(datum.parent&&isLabelTree){const y=isLeaf?datum.screenX-bandwidth/2:datum.screenX-datum.leafCount*bandwidth/2;if(isLeaf)(datum.number!==datum.children.length-1||labelGrid)&&separatorData.push({y,x1:0,x2:-maxLeafLabelWidth-this.label.padding*2});else{const x=-maxLeafLabelWidth-this.label.padding*2+datum.screenY;separatorData.push({y,x1:x+lineHeight,x2:x})}}let props;if(visible){const bbox2=tempText.computeTransformedBBox();bbox2&&labelBBoxes.set(index,bbox2),props=__spreadProps(__spreadValues({},copyLabelProps(tempText)),{visible})}else labelBBoxes.delete(index),props={visible};tickLabelLayout.push(props)});let minX=0;separatorData.forEach(d=>minX=Math.min(minX,d.x2)),separatorData.push({y:Math.max(rangeStart,rangeEnd),x1:0,x2:minX});const separatorLayout=[],separatorBoxes=[],epsilon2=1e-7;separatorData.forEach(datum=>{if(datum.y>=range3[0]-epsilon2&&datum.y<=range3[1]+epsilon2){const{x1,x2,y}=datum,separatorBox=new BBox(Math.min(x1,x2),y,Math.abs(x1-x2),0);separatorBoxes.push(separatorBox),separatorLayout.push({x1,x2,y})}});const axisLineLayout=[],axisLineBoxes=[],lineCount=tickTreeLayout?tickTreeLayout.depth+1:1;for(let i=0;i<lineCount;i++){const visible=labels.length>0&&(i===0||labelGrid&&isLabelTree),x=i>0?-maxLeafLabelWidth-this.label.padding*2-(i-1)*lineHeight:0,lineBox=new BBox(x,Math.min(...range3),0,Math.abs(range3[1]-range3[0]));axisLineBoxes.push(lineBox),axisLineLayout.push({x,y1:range3[0],y2:range3[1],visible})}const getTransformBox=__name(bbox2=>{const matrix=new Matrix,{rotation:axisRotation,translationX,translationY,rotationCenterX,rotationCenterY}=this.getAxisTransform();return Matrix.updateTransformMatrix(matrix,1,1,axisRotation,translationX,translationY,{scalingCenterX:0,scalingCenterY:0,rotationCenterX,rotationCenterY}),matrix.transformBBox(bbox2)},"getTransformBox"),bbox=BBox.merge([...labelBBoxes.values(),...separatorBoxes,...axisLineBoxes]);return{bbox:getTransformBox(bbox),tickLabelLayout,separatorLayout,axisLineLayout}}calculateLayout(){const{axisLineLayout,separatorLayout,tickLabelLayout,bbox}=this.computeLayout();return this.computedLayout={axisLineLayout,separatorLayout,tickLabelLayout},{bbox,primaryTickCount:void 0}}},__name(_a57,"GroupedCategoryAxis"),_a57);GroupedCategoryAxis.className="GroupedCategoryAxis";GroupedCategoryAxis.type="grouped-category";__decorateClass([Validate(COLOR_STRING,{optional:!0})],GroupedCategoryAxis.prototype,"labelColor",2);var _a58,HdpiOffscreenCanvas=(_a58=class{constructor({width=600,height=300,overrideDevicePixelRatio}){this.enabled=!0,this._pixelRatio=NaN,this._width=0,this._height=0,this.canvas=new OffscreenCanvas(width,height),this.realContext=this.canvas.getContext("2d"),this.imageSource=this.canvas.transferToImageBitmap(),this.context=this.setPixelRatio(overrideDevicePixelRatio),this.resize(width,height)}static isSupported(){return typeof OffscreenCanvas<"u"&&OffscreenCanvas.prototype.transferToImageBitmap!=null}snapshot(){this.imageSource.close(),this.imageSource=this.canvas.transferToImageBitmap()}destroy(){this.imageSource.close(),this.canvas.width=0,this.canvas.height=0,this.context.clearRect(0,0,0,0)}clear(){this.context.save(),this.context.resetTransform(),this.context.clearRect(0,0,this.width,this.height),this.context.restore()}get pixelRatio(){return this._pixelRatio}setPixelRatio(ratio){let pixelRatio=ratio??window.devicePixelRatio;return hasConstrainedCanvasMemory()&&(pixelRatio=1),this._pixelRatio=pixelRatio,HdpiCanvas.overrideScale(this.realContext,pixelRatio)}get width(){return this._width}get height(){return this._height}resize(width,height){if(!(width>0&&height>0))return;const{canvas,context,pixelRatio}=this;canvas.width=Math.round(width*pixelRatio),canvas.height=Math.round(height*pixelRatio),context.resetTransform(),this._width=width,this._height=height}},__name(_a58,"HdpiOffscreenCanvas"),_a58),advancedCompositeIdentifier="adv-composite",domCompositeIdentifier="dom-composite",_a59,Scene=(_a59=class{constructor(opts){this.id=createId(this),this.layers=[],this._nextZIndex=0,this._nextLayerId=0,this._dirty=!1,this._root=null,this.debug=Debug.create(!0,"scene");var _a201;const{document:document2,window:window2,mode=(_a201=windowValue("agChartsSceneRenderModel"))!=null?_a201:advancedCompositeIdentifier,width,height,overrideDevicePixelRatio=void 0}=opts;this.overrideDevicePixelRatio=overrideDevicePixelRatio,this.opts={document:document2,window:window2,mode},this.canvas=new HdpiCanvas({document:document2,window:window2,width,height,overrideDevicePixelRatio})}set container(value){this.canvas.container=value}get container(){return this.canvas.container}download(fileName,fileFormat){this.canvas.download(fileName,fileFormat)}getDataURL(type){return this.canvas.getDataURL(type)}get width(){return this.pendingSize?this.pendingSize[0]:this.canvas.width}get height(){return this.pendingSize?this.pendingSize[1]:this.canvas.height}resize(width,height){width=Math.round(width),height=Math.round(height);const lessThanZero=width<=0||height<=0,nan=isNaN(width)||isNaN(height);return width===this.width&&height===this.height||nan||lessThanZero?!1:(this.pendingSize=[width,height],this.markDirty(),!0)}addLayer(opts){var _a201;const{mode}=this.opts;if(!["composite",domCompositeIdentifier,advancedCompositeIdentifier].includes(mode))return;const{zIndex=this._nextZIndex++,name,zIndexSubOrder,getComputedOpacity,getVisibility}=opts,{width,height,overrideDevicePixelRatio}=this,domLayer=mode===domCompositeIdentifier,canvas=!(mode===advancedCompositeIdentifier)||!HdpiOffscreenCanvas.isSupported()?new HdpiCanvas({document:this.opts.document,window:this.opts.window,width,height,domLayer,zIndex,name,overrideDevicePixelRatio}):new HdpiOffscreenCanvas({width,height,overrideDevicePixelRatio}),newLayer={id:this._nextLayerId++,name,zIndex,zIndexSubOrder,canvas,getComputedOpacity,getVisibility};if(zIndex>=this._nextZIndex&&(this._nextZIndex=zIndex+1),this.layers.push(newLayer),this.sortLayers(),domLayer){const domCanvases=this.layers.map(v=>v.canvas).filter(v=>v instanceof HdpiCanvas),newLayerIndex=domCanvases.findIndex(v=>v===canvas);((_a201=domCanvases[newLayerIndex-1])!=null?_a201:this.canvas).element.insertAdjacentElement("afterend",canvas.element)}return this.debug("Scene.addLayer() - layers",this.layers),newLayer.canvas}removeLayer(canvas){const index=this.layers.findIndex(l=>l.canvas===canvas);index>=0&&(this.layers.splice(index,1),canvas.destroy(),this.markDirty(),this.debug("Scene.removeLayer() -  layers",this.layers))}moveLayer(canvas,newZIndex,newZIndexSubOrder){const layer=this.layers.find(l=>l.canvas===canvas);layer&&(layer.zIndex=newZIndex,layer.zIndexSubOrder=newZIndexSubOrder,this.sortLayers(),this.markDirty(),this.debug("Scene.moveLayer() -  layers",this.layers))}sortLayers(){this.layers.sort((a,b)=>{var _a201,_b;return compoundAscending([a.zIndex,...(_a201=a.zIndexSubOrder)!=null?_a201:[void 0,void 0],a.id],[b.zIndex,...(_b=b.zIndexSubOrder)!=null?_b:[void 0,void 0],b.id],ascendingStringNumberUndefined)})}markDirty(){this._dirty=!0}get dirty(){return this._dirty}set root(node){var _a201;node!==this._root&&((_a201=this._root)==null||_a201._setLayerManager(),this._root=node,node&&node._setLayerManager({addLayer:opts=>this.addLayer(opts),moveLayer:(...opts)=>this.moveLayer(...opts),removeLayer:(...opts)=>this.removeLayer(...opts),markDirty:()=>this.markDirty(),canvas:this.canvas,debug:Debug.create("scene")}),this.markDirty())}get root(){return this._root}strip(){const{layers}=this;for(const layer of layers)layer.canvas.destroy(),delete layer.canvas;layers.splice(0,layers.length),this.root=null,this._dirty=!1,this.canvas.context.resetTransform()}destroy(){this.container=void 0,this.strip(),this.canvas.destroy(),Object.assign(this,{canvas:void 0,ctx:void 0})}render(opts){return __async(this,null,function*(){var _a201,_b;const{debugSplitTimes={start:performance.now()},extraDebugStats={}}=opts??{},{canvas,canvas:{context:ctx},root,layers,pendingSize,opts:{mode}}=this;if(pendingSize&&(this.canvas.resize(...pendingSize),this.layers.forEach(layer=>layer.canvas.resize(...pendingSize)),this.pendingSize=void 0),root&&!root.visible){this._dirty=!1;return}if(root&&!this.dirty){this.debug("Scene.render() - no-op",{redrawType:RedrawType[root.dirty],tree:this.buildTree(root)}),this.debugStats(debugSplitTimes,ctx,void 0,extraDebugStats);return}const renderCtx={ctx,devicePixelRatio:(_a201=this.canvas.pixelRatio)!=null?_a201:1,forceRender:!0,resized:!!pendingSize,debugNodes:{}};Debug.check("scene:stats:verbose")&&(renderCtx.stats={layersRendered:0,layersSkipped:0,nodesRendered:0,nodesSkipped:0});let canvasCleared=!1;if((!root||root.dirty>=1)&&(canvasCleared=!0,canvas.clear()),root&&Debug.check("scene:dirtyTree")){const{dirtyTree,paths}=this.buildDirtyTree(root);Debug.create("scene:dirtyTree")("Scene.render() - dirtyTree",{dirtyTree,paths})}root&&canvasCleared&&(this.debug("Scene.render() - before",{redrawType:RedrawType[root.dirty],canvasCleared,tree:this.buildTree(root)}),root.visible&&(ctx.save(),root.render(renderCtx),ctx.restore())),debugSplitTimes[""]=performance.now(),mode!==domCompositeIdentifier&&layers.length>0&&canvasCleared&&(this.sortLayers(),ctx.save(),ctx.setTransform(1/canvas.pixelRatio,0,0,1/canvas.pixelRatio,0,0),layers.forEach(({canvas:{imageSource,enabled},getComputedOpacity,getVisibility})=>{!enabled||!getVisibility()||(ctx.globalAlpha=getComputedOpacity(),ctx.drawImage(imageSource,0,0))}),ctx.restore(),debugSplitTimes[""]=performance.now()),(_b=ctx.verifyDepthZero)==null||_b.call(ctx),this._dirty=!1,this.debugStats(debugSplitTimes,ctx,renderCtx.stats,extraDebugStats),this.debugSceneNodeHighlight(ctx,renderCtx.debugNodes),root&&this.debug("Scene.render() - after",{redrawType:RedrawType[root.dirty],canvasCleared,tree:this.buildTree(root)})})}debugStats(debugSplitTimes,ctx,renderCtxStats,extraDebugStats={}){if(Debug.check("scene:stats","scene:stats:verbose")){const end=performance.now(),start=debugSplitTimes.start;debugSplitTimes.end=performance.now();const pct=__name((rendered,skipped)=>{const total=rendered+skipped;return`${rendered} / ${total} (${Math.round(100*rendered/total)}%)`},"pct"),time=__name((name,start2,end2)=>`${name}: ${Math.round((end2-start2)*100)/100}ms`,"time"),{layersRendered=0,layersSkipped=0,nodesRendered=0,nodesSkipped=0}=renderCtxStats??{};let lastSplit=0;const splits=Object.entries(debugSplitTimes).filter(([n])=>n!=="end").map(([n,t],i)=>{const result=i>0?time(n,lastSplit,t):null;return lastSplit=t,result}).filter(v=>v!=null).join(" + "),extras=Object.entries(extraDebugStats).map(([k,v])=>`${k}: ${v}`).join(" ; "),detailedStats=Debug.check("scene:stats:verbose"),statsSize=[`${time("",start,end)} (${splits})`,`${extras}`,`Layers: ${detailedStats?pct(layersRendered,layersSkipped):this.layers.length}`,detailedStats?`Nodes: ${pct(nodesRendered,nodesSkipped)}`:null].filter(v=>v!=null).map(t=>[t,HdpiCanvas.getTextSize(t,ctx.font)]),width=Math.max(...statsSize.map(([,{width:width2}])=>width2)),height=statsSize.reduce((total,[,{height:height2}])=>total+height2,0);ctx.save(),ctx.fillStyle="white",ctx.fillRect(0,0,width,height),ctx.fillStyle="black";let y=0;for(const[stat,size]of statsSize)y+=size.height,ctx.fillText(stat,2,y);ctx.restore()}}debugSceneNodeHighlight(ctx,debugNodes){var _a201;const regexpPredicate=__name(matcher=>n=>matcher.test(n.id)?!0:n instanceof Group&&n.name!=null&&matcher.test(n.name),"regexpPredicate"),stringPredicate=__name(match=>n=>match===n.id?!0:n instanceof Group&&n.name!=null&&match===n.name,"stringPredicate"),sceneNodeHighlight=toArray(windowValue("agChartsSceneDebug")).flatMap(name=>name==="layout"?["seriesRoot","legend","root",/.*Axis-\d+-axis.*/]:name);for(const next of sceneNodeHighlight){if(typeof next=="string"&&debugNodes[next]!=null)continue;const predicate=typeof next=="string"?stringPredicate(next):regexpPredicate(next),nodes=(_a201=this.root)==null?void 0:_a201.findNodes(predicate);if(!nodes||nodes.length===0){Logger.log(`Scene.render() - no debugging node with id [${next}] in scene graph.`);continue}for(const node of nodes)node instanceof Group&&node.name?debugNodes[node.name]=node:debugNodes[node.id]=node}ctx.save();for(const[name,node]of Object.entries(debugNodes)){const bbox=node.computeTransformedBBox();if(!bbox){Logger.log(`Scene.render() - no bbox for debugged node [${name}].`);continue}ctx.globalAlpha=.8,ctx.strokeStyle="red",ctx.lineWidth=1,ctx.strokeRect(bbox.x,bbox.y,bbox.width,bbox.height),ctx.fillStyle="red",ctx.strokeStyle="white",ctx.font="16px sans-serif",ctx.textBaseline="top",ctx.textAlign="left",ctx.lineWidth=2,ctx.strokeText(name,bbox.x,bbox.y,bbox.width),ctx.fillText(name,bbox.x,bbox.y,bbox.width)}ctx.restore()}buildTree(node){var _a201,_b;const name=(_a201=node instanceof Group?node.name:null)!=null?_a201:node.id;return this.debug.check()?__spreadValues(__spreadValues({name,node,dirty:RedrawType[node.dirty]},(_b=node.parent)!=null&&_b.isVirtual?{virtualParentDirty:RedrawType[node.parent.dirty],virtualParent:node.parent}:{}),node.children.map(c=>this.buildTree(c)).reduce((result,childTree)=>{let{name:treeNodeName}=childTree;const{node:{visible,opacity,zIndex,zIndexSubOrder},node:childNode,virtualParent}=childTree;(!visible||opacity<=0)&&(treeNodeName=`(${treeNodeName})`),childNode instanceof Group&&childNode.isLayer()&&(treeNodeName=`*${treeNodeName}*`);const key=[`${treeNodeName??"<unknown>"}`,`z: ${zIndex}`,zIndexSubOrder&&`zo: ${zIndexSubOrder.map(v=>typeof v=="function"?`${v()} (fn)`:v).join(" / ")}`,virtualParent&&"(virtual parent)"].filter(v=>!!v).join(" ");let selectedKey=key,index=1;for(;result[selectedKey]!=null&&index<100;)selectedKey=`${key} (${index++})`;return result[selectedKey]=childTree,result},{})):{}}buildDirtyTree(node){var _a201;if(node.dirty===0)return{dirtyTree:{},paths:[]};const childrenDirtyTree=node.children.map(c=>this.buildDirtyTree(c)).filter(c=>c.paths.length>0),name=(_a201=node instanceof Group?node.name:null)!=null?_a201:node.id,paths=childrenDirtyTree.length===0?[name]:childrenDirtyTree.map(c=>c.paths).reduce((r,p)=>r.concat(p),[]).map(p=>`${name}.${p}`);return{dirtyTree:__spreadValues({name,node,dirty:RedrawType[node.dirty]},childrenDirtyTree.map(c=>c.dirtyTree).filter(t=>t.dirty!==void 0).reduce((result,childTree)=>{var _a210;return result[(_a210=childTree.name)!=null?_a210:"<unknown>"]=childTree,result},{})),paths}}},__name(_a59,"Scene"),_a59);Scene.className="Scene";function sleep(sleepTimeoutMs){return new Promise(resolve=>{setTimeout(()=>resolve(void 0),sleepTimeoutMs)})}__name(sleep,"sleep");var _a60,CallbackCache=(_a60=class{constructor(){this.cache=new WeakMap}call(fn,...params){let serialisedParams,paramCache=this.cache.get(fn);const invoke=__name(()=>{try{const result=fn(...params);return paramCache&&serialisedParams!=null&&paramCache.set(serialisedParams,result),result}catch(e){Logger.warnOnce("User callback errored, ignoring",e);return}},"invoke");try{serialisedParams=JSON.stringify(params)}catch{return invoke()}return paramCache==null&&(paramCache=new Map,this.cache.set(fn,paramCache)),paramCache.has(serialisedParams)?paramCache.get(serialisedParams):invoke()}invalidateCache(){this.cache=new WeakMap}},__name(_a60,"CallbackCache"),_a60),_a61,Mutex=(_a61=class{constructor(){this.available=!0,this.acquireQueue=[]}acquire(cb){return new Promise(resolve=>{this.acquireQueue.push([cb,resolve]),this.available&&this.dispatchNext()})}acquireImmediately(cb){return __async(this,null,function*(){return this.available?(yield this.acquire(cb),!0):!1})}waitForClearAcquireQueue(){return __async(this,null,function*(){return this.acquire(()=>__async(this,null,function*(){}))})}dispatchNext(){return __async(this,null,function*(){var _a201,_b;this.available=!1;let[next,done]=(_a201=this.acquireQueue.shift())!=null?_a201:[];for(;next;){try{yield next(),done==null||done()}catch(error){Logger.error("mutex callback error",error),done==null||done()}[next,done]=(_b=this.acquireQueue.shift())!=null?_b:[]}this.available=!0})}},__name(_a61,"Mutex"),_a61),_a62,Observable=(_a62=class{constructor(){this.eventListeners=new Map}addEventListener(eventType,listener){if(typeof listener!="function")throw new Error("AG Charts - listener must be a Function");const eventTypeListeners=this.eventListeners.get(eventType);eventTypeListeners?eventTypeListeners.add(listener):this.eventListeners.set(eventType,new Set([listener]))}removeEventListener(type,listener){var _a201;(_a201=this.eventListeners.get(type))==null||_a201.delete(listener),this.eventListeners.size===0&&this.eventListeners.delete(type)}hasEventListener(type){return this.eventListeners.has(type)}clearEventListeners(){this.eventListeners.clear()}fireEvent(event){var _a201;(_a201=this.eventListeners.get(event.type))==null||_a201.forEach(listener=>listener(event))}},__name(_a62,"Observable"),_a62),_a63,Padding=(_a63=class extends BaseProperties{constructor(top=0,right=top,bottom=top,left=right){super(),this.top=top,this.right=right,this.bottom=bottom,this.left=left}clear(){this.top=this.right=this.bottom=this.left=0}},__name(_a63,"Padding"),_a63);__decorateClass([Validate(POSITIVE_NUMBER)],Padding.prototype,"top",2);__decorateClass([Validate(POSITIVE_NUMBER)],Padding.prototype,"right",2);__decorateClass([Validate(POSITIVE_NUMBER)],Padding.prototype,"bottom",2);__decorateClass([Validate(POSITIVE_NUMBER)],Padding.prototype,"left",2);function debouncedAnimationFrame(cb){return buildScheduler((cb2,_delayMs)=>requestAnimationFrame(cb2),cb)}__name(debouncedAnimationFrame,"debouncedAnimationFrame");function debouncedCallback(cb){return buildScheduler((cb2,delayMs=0)=>setTimeout(cb2,delayMs),cb)}__name(debouncedCallback,"debouncedCallback");function buildScheduler(scheduleFn,cb){let scheduleCount=0,promiseRunning=!1,awaitingPromise,awaitingDone;const busy=__name(()=>promiseRunning,"busy"),done=__name(()=>{promiseRunning=!1,awaitingDone==null||awaitingDone(),awaitingDone=void 0,awaitingPromise=void 0,scheduleCount>0&&scheduleFn(scheduleCb)},"done"),scheduleCb=__name(()=>{const count2=scheduleCount;scheduleCount=0,promiseRunning=!0;const maybePromise=cb({count:count2});if(!maybePromise){done();return}maybePromise.then(done,done)},"scheduleCb");return{schedule(delayMs){scheduleCount===0&&!busy()&&scheduleFn(scheduleCb,delayMs),scheduleCount++},await(){return __async(this,null,function*(){if(busy())for(awaitingPromise==null&&(awaitingPromise=new Promise(resolve=>{awaitingDone=resolve}));busy();)yield awaitingPromise})}}}__name(buildScheduler,"buildScheduler");var _a64,_SizeMonitor=(_a64=class{static init(document2){if(typeof ResizeObserver>"u"){for(const[element2,entry]of this.elements)this.checkClientSize(element2,entry);return}this.resizeObserver=new ResizeObserver(entries=>{for(const entry of entries){const{width,height}=entry.contentRect;this.checkSize(this.elements.get(entry.target),entry.target,width,height)}}),this.ownerDocument=document2,this.ready=!0,this.documentReady=document2.readyState!=="loading",this.documentReady||document2.addEventListener("DOMContentLoaded",this.onContentLoaded)}static destroy(){var _a201,_b;(_a201=this.ownerDocument)==null||_a201.removeEventListener("DOMContentLoaded",this.onContentLoaded),(_b=this.resizeObserver)==null||_b.disconnect(),delete this.resizeObserver,delete this.ownerDocument,this.ready=!1}static checkSize(entry,element2,width,height){var _a201,_b;entry&&(width!==((_a201=entry.size)==null?void 0:_a201.width)||height!==((_b=entry.size)==null?void 0:_b.height))&&(entry.size={width,height},entry.cb(entry.size,element2))}static observe(element2,cb){var _a201;if(this.ready||this.init(element2.ownerDocument),!this.documentReady){this.queuedObserveRequests.push([element2,cb]);return}this.elements.has(element2)?this.removeFromQueue(element2):(_a201=this.resizeObserver)==null||_a201.observe(element2),this.elements.set(element2,{cb})}static unobserve(element2){var _a201;(_a201=this.resizeObserver)==null||_a201.unobserve(element2),this.elements.delete(element2),this.removeFromQueue(element2),this.elements.size||this.destroy()}static removeFromQueue(element2){this.queuedObserveRequests=this.queuedObserveRequests.filter(([el])=>el!==element2)}static checkClientSize(element2,entry){var _a201,_b;const width=(_a201=element2.clientWidth)!=null?_a201:0,height=(_b=element2.clientHeight)!=null?_b:0;this.checkSize(entry,element2,width,height)}},__name(_a64,"_SizeMonitor"),_a64);_SizeMonitor.elements=new Map;_SizeMonitor.ready=!1;_SizeMonitor.documentReady=!1;_SizeMonitor.queuedObserveRequests=[];_SizeMonitor.onContentLoaded=()=>{var _a201;const newState=((_a201=_SizeMonitor.ownerDocument)==null?void 0:_a201.readyState)!=="loading",oldState=_SizeMonitor.documentReady;_SizeMonitor.documentReady=newState,newState&&newState!==oldState&&(_SizeMonitor.queuedObserveRequests.forEach(([el,cb])=>_SizeMonitor.observe(el,cb)),_SizeMonitor.queuedObserveRequests=[])};var SizeMonitor=_SizeMonitor,_a65,ChartHighlight=(_a65=class{constructor(){this.range="tooltip"}},__name(_a65,"ChartHighlight"),_a65);__decorateClass([Validate(UNION(["tooltip","node"],"a range"))],ChartHighlight.prototype,"range",2);var ChartUpdateType=(ChartUpdateType2=>(ChartUpdateType2[ChartUpdateType2.FULL=0]="FULL",ChartUpdateType2[ChartUpdateType2.UPDATE_DATA=1]="UPDATE_DATA",ChartUpdateType2[ChartUpdateType2.PROCESS_DATA=2]="PROCESS_DATA",ChartUpdateType2[ChartUpdateType2.PERFORM_LAYOUT=3]="PERFORM_LAYOUT",ChartUpdateType2[ChartUpdateType2.SERIES_UPDATE=4]="SERIES_UPDATE",ChartUpdateType2[ChartUpdateType2.TOOLTIP_RECALCULATION=5]="TOOLTIP_RECALCULATION",ChartUpdateType2[ChartUpdateType2.SCENE_RENDER=6]="SCENE_RENDER",ChartUpdateType2[ChartUpdateType2.NONE=7]="NONE",ChartUpdateType2))(ChartUpdateType||{}),_a66,DataDomain=(_a66=class{constructor(type){this.type=type,this.continuousDomain=[1/0,-1/0],this.discreteDomain=new Set}extend(val){this.type==="discrete"?this.discreteDomain.add(val):this.type==="continuous"&&(this.continuousDomain[0]>val&&(this.continuousDomain[0]=val),this.continuousDomain[1]<val&&(this.continuousDomain[1]=val))}getDomain(){if(this.type==="discrete")return this.discreteDomain;if(this.type==="continuous")return this.continuousDomain;throw new Error("AG Charts - Unsupported data domain type: "+this.type)}},__name(_a66,"DataDomain"),_a66);function extendDomain(values,domain=[1/0,-1/0]){for(const value of values)typeof value=="number"&&(value<domain[0]&&(domain[0]=value),value>domain[1]&&(domain[1]=value));return domain}__name(extendDomain,"extendDomain");function toKeyString(keys){return keys.map(key=>isObject(key)?JSON.stringify(key):key).join("-")}__name(toKeyString,"toKeyString");function round2(val){return Number.isInteger(val)?val:Math.abs(val)>1e4?Math.trunc(val):Math.round(val*1e4)/1e4}__name(round2,"round2");function fixNumericExtentInternal(extent2){if(extent2===void 0)return[];let[min,max]=extent2;return min=Number(min),max=Number(max),min===0&&max===0?[0,1]:min===1/0&&max===-1/0?[]:(min===1/0&&(min=0),max===-1/0&&(max=0),isFiniteNumber(min)&&isFiniteNumber(max)?[min,max]:[])}__name(fixNumericExtentInternal,"fixNumericExtentInternal");function fixNumericExtent(extent2,axis){var _a201;const fixedExtent=fixNumericExtentInternal(extent2);if(fixedExtent.length===0)return fixedExtent;let[min,max]=fixedExtent;if(min===max){const[paddingMin,paddingMax]=(_a201=axis==null?void 0:axis.calculatePadding(min,max,axis.isReversed()))!=null?_a201:[1,1];min-=paddingMin,max+=paddingMax}return[min,max]}__name(fixNumericExtent,"fixNumericExtent");function defaultMissMap(){return new Map([[void 0,0]])}__name(defaultMissMap,"defaultMissMap");function getMissCount(scopeProvider,missMap){var _a201;return missMap===void 0?0:(_a201=missMap.get(scopeProvider.id))!=null?_a201:0}__name(getMissCount,"getMissCount");var INVALID_VALUE=Symbol("invalid"),_a67,DataModel=(_a67=class{constructor(opts){this.debug=Debug.create(!0,"data-model");const{props,mode="standalone"}=opts;this.mode=mode;let keys=!0;for(const next of props){if(next.type==="key"&&!keys)throw new Error("AG Charts - internal config error: keys must come before values.");next.type==="value"&&keys&&(keys=!1)}this.opts=__spreadValues({dataVisible:!0},opts),this.keys=props.filter(def=>def.type==="key").map((def,index)=>__spreadProps(__spreadValues({},def),{index,missing:defaultMissMap()})),this.values=props.filter(def=>def.type==="value").map((def,index)=>__spreadProps(__spreadValues({},def),{index,missing:defaultMissMap()})),this.aggregates=props.filter(def=>def.type==="aggregate").map((def,index)=>__spreadProps(__spreadValues({},def),{index})),this.groupProcessors=props.filter(def=>def.type==="group-value-processor").map((def,index)=>__spreadProps(__spreadValues({},def),{index})),this.propertyProcessors=props.filter(def=>def.type==="property-value-processor").map((def,index)=>__spreadProps(__spreadValues({},def),{index})),this.reducers=props.filter(def=>def.type==="reducer").map((def,index)=>__spreadProps(__spreadValues({},def),{index})),this.processors=props.filter(def=>def.type==="processor").map((def,index)=>__spreadProps(__spreadValues({},def),{index}));for(const def of this.values)if(def.property==null)throw new Error(`AG Charts - internal config error: no properties specified for value definitions: ${JSON.stringify(def)}`);const verifyMatchGroupId=__name(({matchGroupIds})=>{for(const matchGroupId of matchGroupIds??[])if(!this.values.some(def=>def.groupId===matchGroupId))throw new Error(`AG Charts - internal config error: matchGroupIds properties must match defined groups (${matchGroupId}).`)},"verifyMatchGroupId"),verifyMatchIds=__name(({matchIds})=>{for(const matchId of matchIds??[])if(!this.values.some(def=>{var _a201;return(_a201=def.ids)==null?void 0:_a201.some(([scope,id])=>scope===matchId[0]&&id===matchId[1])}))throw new Error(`AG Charts - internal config error: matchGroupIds properties must match defined groups (${matchId}).`)},"verifyMatchIds");for(const def of[...this.groupProcessors,...this.aggregates])verifyMatchIds(def),verifyMatchGroupId(def)}resolveProcessedDataIndexById(scope,searchId){var _a201;const{index,def}=(_a201=this.resolveProcessedDataDefById(scope,searchId))!=null?_a201:{};return{index,def}}resolveProcessedDataIndicesById(scope,searchId){return this.resolveProcessedDataDefsById(scope,searchId).map(({index,def})=>({index,def}))}resolveProcessedDataDefById(scope,searchId){return this.resolveProcessedDataDefsById(scope,searchId)[0]}resolveProcessedDataDefsByIds(scope,searchIds){const defs=[];for(const searchId of searchIds)defs.push([searchId,this.resolveProcessedDataDefsById(scope,searchId)]);return defs}resolveProcessedDataDefsValues(defs,{keys,values}){const result={};for(const[searchId,[{index,def}]]of defs){const processedData=def.type==="key"?keys:values;result[searchId]=processedData[index]}return result}resolveProcessedDataDefsById(searchScope,searchId){const{keys,values,aggregates,groupProcessors,reducers}=this,match=__name(prop=>{const{ids,scopes}=prop;return ids==null||searchScope!=null&&!(scopes!=null&&scopes.some(scope=>scope===searchScope.id))?!1:ids.some(([scope,id])=>scope===searchScope.id&&(typeof searchId=="string"?id===searchId:searchId.test(id)))},"match"),allDefs=[keys,values,aggregates,groupProcessors,reducers],result=[];for(const defs of allDefs)result.push(...defs.filter(match).map(def=>({index:def.index,def})));if(result.length>0)return result;throw new Error(`AG Charts - didn't find property definition for [${searchId}, ${searchScope.id}]`)}getDomain(scope,searchId,type="value",processedData){var _a201,_b,_c,_d;let matches;try{matches=this.resolveProcessedDataIndicesById(scope,searchId)}catch(e){if(typeof searchId!="string"&&/didn't find property definition/.test(e.message))return[];throw e}let domainProp;switch(type){case"key":domainProp="keys";break;case"value":domainProp="values";break;case"aggregate":domainProp="aggValues";break;case"group-value-processor":domainProp="groups";break;default:return[]}const firstMatch=(_b=(_a201=processedData.domain[domainProp])==null?void 0:_a201[matches[0].index])!=null?_b:[];if(matches.length===1)return firstMatch;const result=[...firstMatch];for(const idx of matches.slice(1))extendDomain((_d=(_c=processedData.domain[domainProp])==null?void 0:_c[idx.index])!=null?_d:[],result);return result}processData(data,sources){const{opts:{groupByKeys,groupByFn},aggregates,groupProcessors,reducers,processors,propertyProcessors}=this,start=performance.now();if(groupByKeys&&this.keys.length===0)return;let processedData=this.extractData(data,sources);groupByKeys?processedData=this.groupData(processedData):groupByFn&&(processedData=this.groupData(processedData,groupByFn(processedData))),groupProcessors.length>0&&this.postProcessGroups(processedData),aggregates.length>0&&this.aggregateData(processedData),propertyProcessors.length>0&&this.postProcessProperties(processedData),reducers.length>0&&this.reduceData(processedData),processors.length>0&&this.postProcessData(processedData);for(const def of[...this.keys,...this.values])if(data.length>0){for(const[scope,missCount]of def.missing)if(missCount>=data.length){const scopeHint=scope===void 0?"":` for ${scope}`;Logger.warnOnce(`the key '${def.property}' was not found in any data element${scopeHint}.`)}}const end=performance.now();return processedData.time=end-start,this.debug.check()&&logProcessedData(processedData),processedData}valueGroupIdxLookup({matchGroupIds,matchIds}){return this.values.map((def,index)=>({def,index})).filter(({def})=>matchGroupIds&&(def.groupId==null||!matchGroupIds.includes(def.groupId))?!1:matchIds?def.ids==null?!1:matchIds.some(([matchScope,matchId])=>{var _a201;return(_a201=def.ids)==null?void 0:_a201.some(([defScope,defId])=>defScope===matchScope&&defId===matchId)}):!0).map(({index})=>index)}valueIdxLookup(scopes,prop){const noScopesToMatch=scopes==null||scopes.length===0,scopeMatch=__name(compareTo=>{if(compareTo==null)return!0;const noScopes=compareTo==null||compareTo.length===0;return noScopesToMatch===noScopes?!0:compareTo==null?void 0:compareTo.some(s=>scopes.includes(s))},"scopeMatch"),propId=typeof prop=="string"?prop:prop.id,idMatch=__name(([scope,id])=>scopeMatch([scope])&&id===propId,"idMatch"),result=this.values.findIndex(def=>{var _a201;return scopeMatch(def.scopes)&&(((_a201=def.ids)==null?void 0:_a201.some(id=>idMatch(id)))||def.property===propId||def.id===propId)});if(result>=0)return result;throw new Error(`AG Charts - configuration error, unknown property ${JSON.stringify(prop)} in scope(s) ${JSON.stringify(scopes)}`)}extractData(data,sources){var _a201,_b,_c,_d,_e,_f;const{keys:keyDefs,values:valueDefs,opts:{dataVisible}}=this,{dataDomain,processValue,scopes,allScopesHaveSameDefs}=this.initDataDomainProcessor(),resultData=new Array(dataVisible?data.length:0);let resultDataIdx=0,partialValidDataCount=0;for(const[datumIdx,datum]of data.entries()){const sourceDatums={},validScopes=scopes.size>0?new Set(scopes):void 0,keys=dataVisible?new Array(keyDefs.length):void 0;let keyIdx=0,key;for(const def of keyDefs){if(key=processValue(def,datum,key),key===INVALID_VALUE)break;keys&&(keys[keyIdx++]=key)}if(key===INVALID_VALUE)continue;const values=dataVisible&&valueDefs.length>0?new Array(valueDefs.length):void 0;let value;const sourcesById={};for(const source of sources??[])sourcesById[source.id]=source;for(const[valueDefIdx,def]of valueDefs.entries()){for(const scope of(_a201=def.scopes)!=null?_a201:scopes){const source=sourcesById[scope],valueDatum=(_b=source==null?void 0:source.data[datumIdx])!=null?_b:datum;value=processValue(def,valueDatum,value,scope),!(value===INVALID_VALUE||!values)&&(source!==void 0&&((_d=sourceDatums[_c=source.id])!=null||(sourceDatums[_c]={}),sourceDatums[source.id][def.property]=value),def.useScopedValues?((_e=values[valueDefIdx])!=null||(values[valueDefIdx]={}),values[valueDefIdx][scope]=value):values[valueDefIdx]=value)}if(value===INVALID_VALUE){if(allScopesHaveSameDefs)break;for(const scope of(_f=def.scopes)!=null?_f:scopes)validScopes==null||validScopes.delete(scope);if((validScopes==null?void 0:validScopes.size)===0)break}}if(!(value===INVALID_VALUE&&allScopesHaveSameDefs)&&(validScopes==null?void 0:validScopes.size)!==0&&dataVisible){const result={datum:__spreadValues(__spreadValues({},datum),sourceDatums),keys,values};!allScopesHaveSameDefs&&validScopes&&validScopes.size<scopes.size&&(partialValidDataCount++,result.validScopes=[...validScopes]),resultData[resultDataIdx++]=result}}resultData.length=resultDataIdx;const propertyDomain=__name(def=>{const result=dataDomain.get(def).getDomain();return Array.isArray(result)&&result[0]>result[1]?[]:[...result]},"propertyDomain");return{type:"ungrouped",input:{count:data.length},data:resultData,domain:{keys:keyDefs.map(def=>propertyDomain(def)),values:valueDefs.map(def=>propertyDomain(def))},defs:{allScopesHaveSameDefs,keys:keyDefs,values:valueDefs},partialValidDataCount,time:0}}groupData(data,groupingFn){var _a201,_b,_c,_d;const processedData=new Map;for(const dataEntry of data.data){const{keys,values,datum,validScopes}=dataEntry,group2=groupingFn?groupingFn(dataEntry):keys,groupStr=toKeyString(group2);if(processedData.has(groupStr)){const existingData=processedData.get(groupStr);if(existingData.values.push(values),existingData.datum.push(datum),validScopes!=null)for(let index=0;index<((_b=(_a201=existingData.validScopes)==null?void 0:_a201.length)!=null?_b:0);index++){const scope=(_c=existingData.validScopes)==null?void 0:_c[index];validScopes.some(s=>s===scope)||(_d=existingData.validScopes)==null||_d.splice(index,1)}}else processedData.set(groupStr,{keys:group2,values:[values],datum:[datum],validScopes})}const resultData=new Array(processedData.size),resultGroups=new Array(processedData.size);let dataIndex=0;for(const[,{keys,values,datum,validScopes}]of processedData.entries())(validScopes==null?void 0:validScopes.length)!==0&&(resultGroups[dataIndex]=keys,resultData[dataIndex++]={keys,values,datum,validScopes});return __spreadProps(__spreadValues({},data),{type:"grouped",data:resultData,domain:__spreadProps(__spreadValues({},data.domain),{groups:resultGroups})})}aggregateData(processedData){var _a201,_b,_c,_d,_e,_f,_g,_h;const{aggregates:aggDefs}=this;if(!aggDefs)return;const resultAggValues=aggDefs.map(()=>[1/0,-1/0]),resultAggValueIndices=aggDefs.map(def=>this.valueGroupIdxLookup(def)),resultAggFns=aggDefs.map(def=>def.aggregateFunction),resultGroupAggFns=aggDefs.map(def=>def.groupAggregateFunction),resultFinalFns=aggDefs.map(def=>def.finalFunction);for(const group2 of processedData.data){let{values}=group2;const{validScopes}=group2;(_a201=group2.aggValues)!=null||(group2.aggValues=new Array(resultAggValueIndices.length)),processedData.type==="ungrouped"&&(values=[values]);let resultIdx=0;for(const indices of resultAggValueIndices){if(!((_b=validScopes==null?void 0:validScopes.some(s=>{var _a210;return(_a210=aggDefs[resultIdx].matchScopes)==null?void 0:_a210.some(as=>s===as)}))!=null?_b:!0)){resultIdx++;continue}let groupAggValues=(_d=(_c=resultGroupAggFns[resultIdx])==null?void 0:_c.call(resultGroupAggFns))!=null?_d:extendDomain([]);for(const distinctValues of values){const valuesToAgg=indices.map(valueIdx=>distinctValues[valueIdx]),valuesAgg=resultAggFns[resultIdx](valuesToAgg,group2.keys);valuesAgg&&(groupAggValues=(_f=(_e=resultGroupAggFns[resultIdx])==null?void 0:_e.call(resultGroupAggFns,valuesAgg,groupAggValues))!=null?_f:extendDomain(valuesAgg,groupAggValues))}const finalValues=((_h=(_g=resultFinalFns[resultIdx])==null?void 0:_g.call(resultFinalFns,groupAggValues))!=null?_h:groupAggValues).map(v=>round2(v));extendDomain(finalValues,resultAggValues[resultIdx]),group2.aggValues[resultIdx++]=finalValues}}processedData.domain.aggValues=resultAggValues}postProcessGroups(processedData){var _a201,_b,_c,_d,_e;const{groupProcessors}=this;if(!groupProcessors)return;const affectedIndices=new Set,updatedDomains=new Map,groupProcessorIndices=new Map,groupProcessorInitFns=new Map;for(const processor of groupProcessors){const indices=this.valueGroupIdxLookup(processor);groupProcessorIndices.set(processor,indices),groupProcessorInitFns.set(processor,processor.adjust());for(const idx of indices){const valueDef=this.values[idx];affectedIndices.add(idx),updatedDomains.set(idx,new DataDomain(valueDef.valueType==="category"?"discrete":"continuous"))}}const updateDomains=__name(values=>{var _a210;for(const valueIndex of affectedIndices)(_a210=updatedDomains.get(valueIndex))==null||_a210.extend(values[valueIndex])},"updateDomains");for(const group2 of processedData.data){for(const processor of groupProcessors){if(!((_b=(_a201=group2.validScopes)==null?void 0:_a201.some(s=>{var _a210;return(_a210=processor.matchScopes)==null?void 0:_a210.some(as=>s===as)}))!=null?_b:!0))continue;const valueIndexes=(_c=groupProcessorIndices.get(processor))!=null?_c:[],adjustFn=(_e=(_d=groupProcessorInitFns.get(processor))==null?void 0:_d())!=null?_e:()=>{};if(processedData.type==="grouped"){for(const values of group2.values)values&&adjustFn(values,valueIndexes);continue}group2.values&&adjustFn(group2.values,valueIndexes)}if(processedData.type==="grouped")for(const values of group2.values)updateDomains(values);else updateDomains(group2.values)}for(const[idx,dataDomain]of updatedDomains)processedData.domain.values[idx]=[...dataDomain.getDomain()]}postProcessProperties(processedData){const{propertyProcessors}=this;if(propertyProcessors)for(const{adjust,property,scopes}of propertyProcessors)adjust()(processedData,this.valueIdxLookup(scopes??[],property))}reduceData(processedData){var _a201,_b,_c;const{reducers:reducerDefs}=this,scopes=reducerDefs.map(def=>def.scopes),reducers=reducerDefs.map(def=>def.reducer()),accValues=reducerDefs.map(def=>def.initialValue);for(const group2 of processedData.data){let reducerIndex=0;for(const reducer of reducers){if(!((_b=(_a201=group2.validScopes)==null?void 0:_a201.some(s=>{var _a210;return(_a210=scopes[reducerIndex])==null?void 0:_a210.some(as=>s===as)}))!=null?_b:!0)){reducerIndex++;continue}accValues[reducerIndex]=reducer(accValues[reducerIndex],group2),reducerIndex++}}for(let accIdx=0;accIdx<accValues.length;accIdx++)(_c=processedData.reduced)!=null||(processedData.reduced={}),processedData.reduced[reducerDefs[accIdx].property]=accValues[accIdx]}postProcessData(processedData){var _a201;const{processors:processorDefs}=this;for(const def of processorDefs)(_a201=processedData.reduced)!=null||(processedData.reduced={}),processedData.reduced[def.property]=def.calculate(processedData)}initDataDomainProcessor(){var _a201;const{keys:keyDefs,values:valueDefs}=this,scopes=new Set;for(const valueDef of valueDefs)for(const scope of(_a201=valueDef.scopes)!=null?_a201:[])scopes.add(scope);const scopesCount=scopes.size,dataDomain=new Map,processorFns=new Map;let allScopesHaveSameDefs=!0;const initDataDomainKey=__name((key,type,updateDataDomain=dataDomain)=>{var _a210;type==="category"?updateDataDomain.set(key,new DataDomain("discrete")):(updateDataDomain.set(key,new DataDomain("continuous")),allScopesHaveSameDefs&&(allScopesHaveSameDefs=((_a210=key.scopes)!=null?_a210:[]).length===scopesCount))},"initDataDomainKey"),initDataDomain=__name(()=>{keyDefs.forEach(def=>initDataDomainKey(def,def.valueType)),valueDefs.forEach(def=>initDataDomainKey(def,def.valueType))},"initDataDomain");initDataDomain();const accessors=this.buildAccessors(...keyDefs,...valueDefs);return{dataDomain,processValue:__name((def,datum,previousDatum,scope)=>{var _a210,_b,_c,_d,_e;const hasAccessor=def.property in accessors;let valueInDatum=!1,value;if(hasAccessor){try{value=accessors[def.property](datum)}catch{}valueInDatum=value!==void 0}else valueInDatum=def.property in datum,value=valueInDatum?datum[def.property]:def.missingValue;def.forceValue!=null&&(value=valueInDatum&&isNegative(value)?-1*def.forceValue:def.forceValue,valueInDatum=!0);const missingValueDef="missingValue"in def;if(!valueInDatum&&!missingValueDef){const missCount=(_a210=def.missing.get(scope))!=null?_a210:0;def.missing.set(scope,missCount+1)}if(dataDomain.has(def)||initDataDomain(),valueInDatum&&!((_c=(_b=def.validation)==null?void 0:_b.call(def,value,datum))!=null?_c:!0))if("invalidValue"in def)value=def.invalidValue;else return this.mode!=="integrated"&&Logger.warnOnce(`invalid value of type [${typeof value}] ignored:`,`[${value}]`),INVALID_VALUE;return def.processor&&(processorFns.has(def)||processorFns.set(def,def.processor()),value=(_d=processorFns.get(def))==null?void 0:_d(value,previousDatum!==INVALID_VALUE?previousDatum:void 0)),(_e=dataDomain.get(def))==null||_e.extend(value),value},"processValue"),initDataDomain,scopes,allScopesHaveSameDefs}}buildAccessors(...defs){const result={};if(this.mode==="integrated")return result;for(const def of defs){if(!(def.property.indexOf(".")>=0||def.property.indexOf("[")>=0))continue;let fnBody;def.property.startsWith("[")?fnBody=`return datum${def.property};`:fnBody=`return datum.${def.property};`,result[def.property]=new Function("datum",fnBody)}return result}},__name(_a67,"DataModel"),_a67);function logProcessedData(processedData){var _a201,_b;const logValues=__name((name,data)=>{data.length>0&&(Logger.log(`DataModel.processData() - ${name}`),Logger.table(data))},"logValues");if(Logger.log("DataModel.processData() - processedData",processedData),logValues("Key Domains",processedData.domain.keys),logValues("Group Domains",(_a201=processedData.domain.groups)!=null?_a201:[]),logValues("Value Domains",processedData.domain.values),logValues("Aggregate Domains",(_b=processedData.domain.aggValues)!=null?_b:[]),processedData.type==="grouped"){const flattenedValues=processedData.data.reduce((acc,next)=>{var _a210,_b2;const keys=(_a210=next.keys)!=null?_a210:[],aggValues=(_b2=next.aggValues)!=null?_b2:[],skipKeys=next.keys.map(()=>{}),skipAggValues=aggValues==null?void 0:aggValues.map(()=>{});return acc.push(...next.values.map((v,i)=>[...i===0?keys:skipKeys,...v??[],...i==0?aggValues:skipAggValues])),acc},[]);logValues("Values",flattenedValues)}else{const flattenedValues=processedData.data.reduce((acc,next)=>{var _a210;const aggValues=(_a210=next.aggValues)!=null?_a210:[];return acc.push([...next.keys,...next.values,...aggValues]),acc},[]);logValues("Values",flattenedValues)}}__name(logProcessedData,"logProcessedData");var _a68,DataController=(_a68=class{constructor(mode){this.mode=mode,this.debug=Debug.create(!0,"data-model"),this.requested=[],this.status="setup"}request(id,data,opts){return __async(this,null,function*(){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");return new Promise((resolve,reject)=>{this.requested.push({id,opts,data,resultCb:resolve,reject})})})}execute(){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");this.status="executed",this.debug("DataController.execute() - requested",this.requested);const{valid,invalid}=this.validateRequests(this.requested);this.debug("DataController.execute() - validated",valid);const merged=this.mergeRequested(valid);this.debug("DataController.execute() - merged",merged),this.debug.check()&&(window.processedData=[]);const multipleSources=valid.some(v=>v.data!=null);for(const{opts,data,resultCbs,rejects,ids}of merged){const needsValueExtraction=multipleSources||opts.props.some(p=>{var _a201;return p.type!=="value"&&p.type!=="key"?!1:(_a201=p.useScopedValues)!=null?_a201:!1});try{const dataModel=new DataModel(__spreadProps(__spreadValues({},opts),{mode:this.mode})),processedData=dataModel.processData(data,valid);this.debug.check()&&window.processedData.push(processedData),processedData&&processedData.partialValidDataCount===0?resultCbs.forEach((cb,requestIdx)=>{const id=ids[requestIdx];let requestProcessedData=processedData;needsValueExtraction&&(requestProcessedData=this.extractScopedData(id,processedData)),cb({dataModel,processedData:requestProcessedData})}):processedData?this.splitResult(dataModel,processedData,ids,resultCbs):rejects.forEach(cb=>cb(new Error("AG Charts - no processed data generated")))}catch(error){rejects.forEach(cb=>cb(error))}}invalid.forEach(({error,reject})=>reject(error))}extractScopedData(id,processedData){const extractDatum=__name(datum=>Array.isArray(datum)?datum.map(extractDatum):__spreadValues(__spreadValues({},datum),datum[id]),"extractDatum"),extractValues=__name(values=>{var _a201;return Array.isArray(values)?values.map(extractValues):(_a201=values==null?void 0:values[id])!=null?_a201:values},"extractValues");return __spreadProps(__spreadValues({},processedData),{data:processedData.data.map(datum=>__spreadProps(__spreadValues({},datum),{datum:extractDatum(datum.datum),values:datum.values.map(extractValues)}))})}validateRequests(requested){const valid=[],invalid=[];for(const[index,request]of requested.entries())index>0&&request.data.length!==requested[0].data.length&&request.opts.groupByData===!1?invalid.push(__spreadProps(__spreadValues({},request),{error:new Error("all series[].data arrays must be of the same length and have matching keys.")})):valid.push(request);return{valid,invalid}}mergeRequested(requested){const grouped=[],keys=__name(props=>props.filter(p=>p.type==="key").map(p=>p.property).join(";"),"keys"),groupMatch=__name(({opts,data})=>gr=>(opts.groupByData===!1||gr[0].data===data)&&gr[0].opts.groupByKeys===opts.groupByKeys&&gr[0].opts.dataVisible===opts.dataVisible&&gr[0].opts.groupByFn===opts.groupByFn&&keys(gr[0].opts.props)===keys(opts.props),"groupMatch"),propMatch=__name(prop=>existing=>{var _a201;if(existing.type!==prop.type)return!1;const diff2=(_a201=jsonDiff(existing,prop))!=null?_a201:{};return delete diff2.scopes,delete diff2.id,delete diff2.ids,"useScopedValues"in diff2&&delete diff2.useScopedValues,Object.keys(diff2).length===0},"propMatch"),updateKeyValueOpts=__name(prop=>{var _a201;if(prop.type!=="key"&&prop.type!=="value")return;const uniqueScopes=new Set((_a201=prop.scopes)!=null?_a201:[]);prop.useScopedValues=uniqueScopes.size>1},"updateKeyValueOpts"),mergeOpts=__name(opts=>__spreadProps(__spreadValues({},opts[0]),{props:opts.reduce((result,next)=>{var _a201,_b,_c,_d,_e,_f;for(const prop of next.props){if(prop.id!=null){(_a201=prop.ids)!=null||(prop.ids=[]);for(const scope of(_b=prop.scopes)!=null?_b:[])prop.ids.push([scope,prop.id])}const match=result.find(propMatch(prop));if(!match){updateKeyValueOpts(prop),result.push(prop);continue}(_c=match.scopes)!=null||(match.scopes=[]),match.scopes.push(...(_d=prop.scopes)!=null?_d:[]),updateKeyValueOpts(prop),(match.type==="key"||match.type==="value")&&((_e=prop.ids)!=null&&_e.length)&&((_f=match.ids)==null||_f.push(...prop.ids))}return result},[])}),"mergeOpts"),merge=__name(props=>({ids:props.map(({id})=>id),resultCbs:props.map(({resultCb})=>resultCb),rejects:props.map(({reject})=>reject),data:props[0].data,opts:mergeOpts(props.map(({opts})=>opts))}),"merge");for(const request of requested){const match=grouped.find(groupMatch(request));match?match.push(request):grouped.push([request])}return grouped.map(merge)}splitResult(dataModel,processedData,scopes,resultCbs){for(let index=0;index<scopes.length;index++){const scope=scopes[index],resultCb=resultCbs[index];resultCb({dataModel,processedData:__spreadProps(__spreadValues({},processedData),{data:processedData.data.filter(({validScopes})=>validScopes==null||validScopes.some(s=>s===scope))})})}}},__name(_a68,"DataController"),_a68),_a69,Listeners=(_a69=class{constructor(){this.registeredListeners=new Map}addListener(eventType,handler){const record={symbol:Symbol(eventType),handler};return this.registeredListeners.has(eventType)?this.registeredListeners.get(eventType).push(record):this.registeredListeners.set(eventType,[record]),()=>this.removeListener(record.symbol)}removeListener(eventSymbol){for(const[type,listeners]of this.registeredListeners.entries()){const matchIndex=listeners.findIndex(listener=>listener.symbol===eventSymbol);if(matchIndex>=0){listeners.splice(matchIndex,1),listeners.length===0&&this.registeredListeners.delete(type);break}}}dispatch(eventType,...params){for(const listener of this.getListenersByType(eventType))try{listener.handler(...params)}catch(e){Logger.errorOnce(e)}}dispatchWrapHandlers(eventType,wrapFn,...params){for(const listener of this.getListenersByType(eventType))try{wrapFn(listener.handler,...params)}catch(e){Logger.errorOnce(e)}}getListenersByType(eventType){var _a201;return(_a201=this.registeredListeners.get(eventType))!=null?_a201:[]}destroy(){this.registeredListeners.clear()}},__name(_a69,"Listeners"),_a69),_a70,DataService=(_a70=class extends Listeners{constructor(animationManager){super(),this.animationManager=animationManager,this.dispatchOnlyLatest=!0,this.dispatchThrottle=0,this.requestThrottle=300,this.isLoadingInitialData=!1,this.freshRequests=[],this.requestCounter=0,this.debug=Debug.create(!0,"data-model","data-source"),this.throttledFetch=this.createThrottledFetch(this.requestThrottle),this.throttledDispatch=this.createThrottledDispatch(this.dispatchThrottle)}updateCallback(dataSourceCallback){typeof dataSourceCallback=="function"&&(this.debug("DataService - updated data source callback"),this.dataSourceCallback=dataSourceCallback,this.isLoadingInitialData=!0,this.animationManager.skip(),this.dispatch("data-source-change"))}clearCallback(){this.dataSourceCallback=void 0}load(params){this.throttledFetch(params)}isLazy(){return this.dataSourceCallback!=null}isLoading(){return this.isLazy()&&(this.isLoadingInitialData||this.freshRequests.length>0)}createThrottledFetch(requestThrottle){return throttle(params=>this.fetch(params),requestThrottle,{leading:!1,trailing:!0})}createThrottledDispatch(dispatchThrottle){return throttle((id,data)=>{this.debug(`DataService - dispatching 'data-load' | ${id}`),this.dispatch("data-load",{type:"data-load",data})},dispatchThrottle,{leading:!0,trailing:!0})}fetch(params){return __async(this,null,function*(){if(!this.dataSourceCallback)throw new Error("DataService - [dataSource.getData] callback not initialised");const start=performance.now(),id=this.requestCounter++;this.debug(`DataService - requesting | ${id}`),this.freshRequests.push(id);let response;try{response=yield this.dataSourceCallback(params),this.debug(`DataService - response | ${performance.now()-start}ms | ${id}`)}catch(error){this.debug(`DataService - request failed | ${id}`),Logger.errorOnce(`DataService - request failed | [${error}]`)}this.isLoadingInitialData=!1;const requestIndex=this.freshRequests.findIndex(rid=>rid===id);if(requestIndex===-1||this.dispatchOnlyLatest&&requestIndex!==this.freshRequests.length-1){this.debug(`DataService - discarding stale request | ${id}`);return}this.freshRequests=this.freshRequests.slice(requestIndex+1),Array.isArray(response)?this.throttledDispatch(id,response):this.dispatch("data-error")})}},__name(_a70,"DataService"),_a70);__decorateClass([ActionOnSet({newValue(dispatchThrottle){this.throttledDispatch=this.createThrottledDispatch(dispatchThrottle)}})],DataService.prototype,"dispatchThrottle",2);__decorateClass([ActionOnSet({newValue(requestThrottle){this.throttledFetch=this.createThrottledFetch(requestThrottle)}})],DataService.prototype,"requestThrottle",2);var DEBUG_SELECTORS=[!0,"animation"],_a71,AnimationBatch=(_a71=class{constructor(){this.stoppedCbs=new Set,this.controllers=new Map,this.debug=Debug.create(...DEBUG_SELECTORS),this.currentPhase=0,this.phases=new Map(ANIMATION_PHASE_ORDER.map(p=>[p,[]])),this.skipAnimations=!1}get size(){return this.controllers.size}isActive(){return this.controllers.size>0}getActiveControllers(){var _a201;return(_a201=this.phases.get(ANIMATION_PHASE_ORDER[this.currentPhase]))!=null?_a201:[]}checkOverlappingId(id){id!=null&&this.controllers.has(id)&&(this.controllers.get(id).stop(),this.debug(`Skipping animation batch due to update of existing animation: ${id}`),this.skip())}addAnimation(animation){var _a201;if(animation.isComplete)return;if(ANIMATION_PHASE_ORDER.indexOf(animation.phase)<this.currentPhase){this.debug("Skipping animation due to being for an earlier phase",animation.id),animation.stop();return}this.controllers.set(animation.id,animation),(_a201=this.phases.get(animation.phase))==null||_a201.push(animation)}removeAnimation(animation){this.controllers.delete(animation.id);const phase=this.phases.get(animation.phase),index=phase==null?void 0:phase.indexOf(animation);index!=null&&index>=0&&(phase==null||phase.splice(index,1))}progress(deltaTime){const phase=ANIMATION_PHASE_ORDER[this.currentPhase];let phaseControllers=[...this.getActiveControllers()];const total=this.controllers.size;this.debug(`AnimationBatch - progressing by ${deltaTime}; current phase ${phase} with ${phaseControllers==null?void 0:phaseControllers.length} active controllers of ${total} total`,this.phases);let unusedTime=deltaTime===0?.01:deltaTime;const arePhasesComplete=__name(()=>ANIMATION_PHASE_ORDER[this.currentPhase]==null,"arePhasesComplete"),progressPhase=__name(()=>{for(phaseControllers=[...this.getActiveControllers()];!arePhasesComplete()&&phaseControllers.length===0;)this.currentPhase++,phaseControllers=[...this.getActiveControllers()],this.debug(`AnimationBatch - phase changing to ${ANIMATION_PHASE_ORDER[this.currentPhase]}`,{unusedTime},phaseControllers)},"progressPhase");for(;unusedTime>0&&!arePhasesComplete();){progressPhase();const phaseDeltaTime=unusedTime;let completeCount=0;for(const controller of phaseControllers)unusedTime=Math.min(controller.update(phaseDeltaTime),unusedTime),controller.isComplete&&(completeCount++,this.removeAnimation(controller));this.debug(`AnimationBatch - updated ${phaseControllers.length} controllers; ${completeCount} completed`)}}skip(skip=!0){if(this.skipAnimations===!1&&skip===!0){for(const controller of this.controllers.values())controller.stop();this.controllers.clear()}this.skipAnimations=skip}play(){for(const controller of this.controllers.values())controller.play()}pause(){for(const controller of this.controllers.values())controller.pause()}stop(){for(const controller of this.controllers.values())try{controller.stop(),this.removeAnimation(controller)}catch(error){Logger.error("Error during animation stop",error)}this.dispatchStopped()}stopByAnimationId(id){if(id!=null&&this.controllers.has(id)){const controller=this.controllers.get(id);controller&&(controller.stop(),this.removeAnimation(controller))}}stopByAnimationGroupId(id){for(const controller of this.controllers.values())controller.groupId===id&&this.stopByAnimationId(controller.id)}dispatchStopped(){this.stoppedCbs.forEach(cb=>cb()),this.stoppedCbs.clear()}isSkipped(){return this.skipAnimations}destroy(){}},__name(_a71,"AnimationBatch"),_a71),_a72,BaseManager=(_a72=class{constructor(){this.listeners=new Listeners}addListener(type,handler){return this.listeners.addListener(type,handler)}removeListener(listenerSymbol){this.listeners.removeListener(listenerSymbol)}destroy(){this.listeners.destroy()}},__name(_a72,"BaseManager"),_a72),INTERACTION_TYPES=["click","dblclick","contextmenu","hover","drag-start","drag","drag-end","leave","page-left","wheel"],WINDOW_EVENT_HANDLERS=["pagehide","mousemove","mouseup"],EVENT_HANDLERS=["click","dblclick","contextmenu","mousedown","mouseout","mouseenter","touchstart","touchmove","touchend","touchcancel","wheel"],CSS=`
.ag-chart-wrapper {
    touch-action: none;
}
`,InteractionState=(InteractionState2=>(InteractionState2[InteractionState2.Default=8]="Default",InteractionState2[InteractionState2.ZoomDrag=4]="ZoomDrag",InteractionState2[InteractionState2.ContextMenu=2]="ContextMenu",InteractionState2[InteractionState2.Animation=1]="Animation",InteractionState2[InteractionState2.All=15]="All",InteractionState2))(InteractionState||{}),DEBUG_SELECTORS2=[!0,"interaction"],_a73,_InteractionManager=(_a73=class extends BaseManager{constructor(element2,document2,window2){super(),this.debug=Debug.create(...DEBUG_SELECTORS2),this.eventHandler=event=>this.processEvent(event),this.mouseDown=!1,this.touchDown=!1,this.stateQueue=8,this.rootElement=document2.body,this.element=element2,this.window=window2;for(const type of EVENT_HANDLERS)type.startsWith("touch")?element2.addEventListener(type,this.eventHandler,{passive:!0}):type==="wheel"?element2.addEventListener(type,this.eventHandler,{passive:!1}):element2.addEventListener(type,this.eventHandler);for(const type of WINDOW_EVENT_HANDLERS)this.window.addEventListener(type,this.eventHandler);_a73.interactionDocuments.includes(document2)||(injectStyle(document2,CSS),_a73.interactionDocuments.push(document2))}destroy(){super.destroy();for(const type of WINDOW_EVENT_HANDLERS)this.window.removeEventListener(type,this.eventHandler);for(const type of EVENT_HANDLERS)this.element.removeEventListener(type,this.eventHandler)}addListener(type,handler,triggeringStates=8){return super.addListener(type,e=>{this.getState()&triggeringStates&&handler(e)})}pushState(state){this.stateQueue|=state}popState(state){this.stateQueue&=~state}getState(){return this.stateQueue&-this.stateQueue}processEvent(event){const types=this.decideInteractionEventTypes(event);types.length>0&&this.dispatchEvent(event,types).catch(e=>Logger.errorOnce(e))}dispatchEvent(event,types){return __async(this,null,function*(){const coords=this.calculateCoordinates(event);if(coords!=null)for(const type of types)this.listeners.dispatchWrapHandlers(type,(handler,interactionEvent)=>{interactionEvent.consumed||handler(interactionEvent)},this.buildEvent(__spreadValues({type,event},coords)))})}decideInteractionEventTypes(event){const dragStart="drag-start";switch(event.type){case"click":case"dblclick":case"contextmenu":case"wheel":return[event.type];case"mousedown":return this.mouseDown=!0,this.dragStartElement=event.target,[dragStart];case"touchstart":return this.touchDown=!0,this.dragStartElement=event.target,[dragStart];case"touchmove":case"mousemove":return!this.mouseDown&&!this.touchDown&&!this.isEventOverElement(event)?[]:this.mouseDown||this.touchDown?["drag"]:["hover"];case"mouseup":return!this.mouseDown&&!this.isEventOverElement(event)?[]:(this.mouseDown=!1,this.dragStartElement=void 0,["drag-end"]);case"touchend":return!this.touchDown&&!this.isEventOverElement(event)?[]:(this.touchDown=!1,this.dragStartElement=void 0,["drag-end"]);case"mouseout":case"touchcancel":return["leave"];case"mouseenter":const mouseButtonDown=event instanceof MouseEvent&&(event.buttons&1)===1;return this.mouseDown!==mouseButtonDown?(this.mouseDown=mouseButtonDown,[mouseButtonDown?dragStart:"drag-end"]):[];case"pagehide":return["page-left"]}return[]}isEventOverElement(event){var _a201;return event.target===this.element||((_a201=event.target)==null?void 0:_a201.parentElement)===this.element}calculateCoordinates(event){var _a201;if(event instanceof MouseEvent)return this.getMouseEventCoords(event);if(typeof TouchEvent<"u"&&event instanceof TouchEvent){const lastTouch=(_a201=event.touches[0])!=null?_a201:event.changedTouches[0],{clientX,clientY,pageX,pageY}=lastTouch;return __spreadProps(__spreadValues({},_a73.NULL_COORDS),{clientX,clientY,pageX,pageY})}else if(event instanceof PageTransitionEvent)return event.persisted?void 0:_a73.NULL_COORDS}getMouseEventCoords(event){const{clientX,clientY,pageX,pageY}=event;let{offsetX,offsetY}=event;const offsets=__name(el=>{let x=0,y=0;for(;el;)x+=el.offsetLeft,y+=el.offsetTop,el=el.offsetParent;return{x,y}},"offsets");if(this.dragStartElement!=null&&event.target!==this.dragStartElement){const offsetDragStart=offsets(this.dragStartElement),offsetEvent=offsets(event.target);offsetX-=offsetDragStart.x-offsetEvent.x,offsetY-=offsetDragStart.y-offsetEvent.y}return{clientX,clientY,pageX,pageY,offsetX,offsetY}}isWheelEvent(event){return event.type==="wheel"}buildEvent(opts){const{type,event,clientX,clientY}=opts;let{offsetX,offsetY,pageX,pageY}=opts;if(!isFiniteNumber(offsetX)||!isFiniteNumber(offsetY)){const rect=this.element.getBoundingClientRect();offsetX=clientX-rect.left,offsetY=clientY-rect.top}if(!isFiniteNumber(pageX)||!isFiniteNumber(pageY)){const pageRect=this.rootElement.getBoundingClientRect();pageX=clientX-pageRect.left,pageY=clientY-pageRect.top}const deltaFactor=__name(input=>{const sign=Math.sign(input);return(Math.log10(Math.abs(input)/60+.1)*3+3)*sign},"deltaFactor");let[deltaX,deltaY]=[NaN,NaN];if(this.isWheelEvent(event)){const factorFn=event.deltaMode===0?deltaFactor:x=>x;deltaX=factorFn(event.deltaX),deltaY=factorFn(event.deltaY)}const builtEvent={type,offsetX,offsetY,pageX,pageY,deltaX,deltaY,sourceEvent:event,consumed:!1,consume(){builtEvent.consumed=!0}};return this.debug("InteractionManager - builtEvent: ",builtEvent),builtEvent}},__name(_a73,"_InteractionManager"),_a73);_InteractionManager.interactionDocuments=[];_InteractionManager.NULL_COORDS={clientX:-1/0,clientY:-1/0,pageX:-1/0,pageY:-1/0,offsetX:-1/0,offsetY:-1/0};var InteractionManager=_InteractionManager,DEBUG_SELECTORS3=[!0,"animation"],_a74,AnimationManager=(_a74=class extends BaseManager{constructor(interactionManager,chartUpdateMutex){super(),this.interactionManager=interactionManager,this.chartUpdateMutex=chartUpdateMutex,this.defaultDuration=1e3,this.batch=new AnimationBatch,this.debug=Debug.create(...DEBUG_SELECTORS3),this.rafAvailable=typeof requestAnimationFrame<"u",this.isPlaying=!1,this.requestId=null,this.skipAnimations=!1}animate(_a201){var _b=_a201,opts=__objRest(_b,["disableInteractions"]),_a210;const batch=this.batch;try{batch.checkOverlappingId(opts.id)}catch(error){this.failsafeOnError(error);return}const id=(_a210=opts.id)!=null?_a210:Math.random().toString(),skip=this.isSkipped();skip&&this.debug("AnimationManager - skipping animation");const animation=new Animation(__spreadProps(__spreadValues({},opts),{id,skip,autoplay:this.isPlaying?opts.autoplay:!1,phase:opts.phase,defaultDuration:this.defaultDuration}));if(!this.forceTimeJump(animation,this.defaultDuration))return this.batch.addAnimation(animation),animation}play(){if(!this.isPlaying){this.isPlaying=!0,this.debug("AnimationManager.play()");try{this.batch.play()}catch(error){this.failsafeOnError(error)}this.requestAnimation()}}pause(){if(this.isPlaying){this.isPlaying=!1,this.cancelAnimation(),this.debug("AnimationManager.pause()");try{this.batch.pause()}catch(error){this.failsafeOnError(error)}}}stop(){this.isPlaying=!1,this.cancelAnimation(),this.debug("AnimationManager.stop()"),this.batch.stop()}stopByAnimationId(id){try{this.batch.stopByAnimationId(id)}catch(error){this.failsafeOnError(error)}}stopByAnimationGroupId(id){try{this.batch.stopByAnimationGroupId(id)}catch(error){this.failsafeOnError(error)}}reset(){this.isPlaying?(this.stop(),this.play()):this.stop()}skip(skip=!0){this.skipAnimations=skip}isSkipped(){return!this.rafAvailable||this.skipAnimations||this.batch.isSkipped()}isActive(){return this.isPlaying&&this.batch.isActive()}skipCurrentBatch(){this.debug.check()&&this.debug("AnimationManager - skipCurrentBatch()",{stack:new Error().stack}),this.batch.skip()}isSkippingFrames(){return!0}scheduleAnimationFrame(cb){this.requestId=requestAnimationFrame(cb)}forceTimeJump(_animation,_defaultDuration){return!1}requestAnimation(){if(!this.rafAvailable||!this.batch.isActive()||this.requestId!==null)return;let prevTime;const onAnimationFrame=__name(time=>__async(this,null,function*(){const executeAnimationFrame=__name(()=>__async(this,null,function*(){const deltaTime=time-(prevTime??time);prevTime=time,this.debug("AnimationManager - onAnimationFrame()",{controllersCount:this.batch.size,deltaTime}),this.interactionManager.pushState(1);try{this.batch.progress(deltaTime)}catch(error){this.failsafeOnError(error)}this.listeners.dispatch("animation-frame",{type:"animation-frame",deltaMs:deltaTime})}),"executeAnimationFrame");this.isSkippingFrames()?yield this.chartUpdateMutex.acquireImmediately(executeAnimationFrame):yield this.chartUpdateMutex.acquire(executeAnimationFrame),this.batch.isActive()?this.scheduleAnimationFrame(onAnimationFrame):this.batch.stop()}),"onAnimationFrame");this.scheduleAnimationFrame(onAnimationFrame)}cancelAnimation(){this.requestId!==null&&(cancelAnimationFrame(this.requestId),this.requestId=null,this.startBatch())}failsafeOnError(error,cancelAnimation=!0){Logger.error("Error during animation, skipping animations",error),cancelAnimation&&this.cancelAnimation()}startBatch(skipAnimations){this.debug(`AnimationManager - startBatch() with skipAnimations=${skipAnimations}.`),this.reset(),this.batch.stop(),this.batch.destroy(),this.batch=new AnimationBatch,skipAnimations===!0&&this.batch.skip()}endBatch(){this.debug(`AnimationManager - endBatch() with ${this.batch.size} animations; skipped: ${this.batch.isSkipped()}.`),this.batch.isActive()||this.interactionManager.popState(1),this.batch.isSkipped()&&!this.batch.isActive()&&this.batch.skip(!1),this.requestAnimation()}onBatchStop(cb){this.batch.stoppedCbs.add(cb)}},__name(_a74,"AnimationManager"),_a74),_a75,ChartEventManager=(_a75=class extends BaseManager{legendItemClick(series,itemId,enabled,legendItemName){const event={type:"legend-item-click",series,itemId,enabled,legendItemName};this.listeners.dispatch("legend-item-click",event)}legendItemDoubleClick(series,itemId,enabled,numVisibleItems,legendItemName){const event={type:"legend-item-double-click",series,itemId,enabled,legendItemName,numVisibleItems};this.listeners.dispatch("legend-item-double-click",event)}axisHover(axisId,direction){const event={type:"axis-hover",axisId,direction};this.listeners.dispatch("axis-hover",event)}},__name(_a75,"ChartEventManager"),_a75),_a76,ContextMenuRegistry=(_a76=class{constructor(){this.defaultActions=[],this.disabledActions=new Set}copyDefaultAction(){return[...this.defaultActions]}registerDefaultAction(action){action.id&&this.defaultActions.find(({id})=>id===action.id)||this.defaultActions.push(action)}enableAction(actionId){this.disabledActions.delete(actionId)}disableAction(actionId){this.disabledActions.add(actionId)}isDisabled(actionId){return this.disabledActions.has(actionId)}},__name(_a76,"ContextMenuRegistry"),_a76),_a77,CursorManager=(_a77=class{constructor(element2){this.states={},this.element=element2}updateCursor(callerId,style){delete this.states[callerId],style!=null&&(this.states[callerId]={style}),this.applyStates()}applyStates(){let styleToApply="default";Object.entries(this.states).reverse().slice(0,1).forEach(([_,{style}])=>styleToApply=style),this.element.style.cursor=styleToApply}getCursor(){return this.element.style.cursor}},__name(_a77,"CursorManager"),_a77);function distanceSquared(finger1,finger2){const dx=finger1.screenX-finger2.screenX,dy=finger1.screenY-finger2.screenY;return dx*dx+dy*dy}__name(distanceSquared,"distanceSquared");function distance(finger1,finger2){return Math.sqrt(distanceSquared(finger1,finger2))}__name(distance,"distance");var MIN_DISTANCE_TO_START_PINCH=1,_a78,GestureDetector=(_a78=class extends BaseManager{constructor(element2){super(),this.touchstart=event=>this.onTouchStart(event),this.touchmove=event=>this.onTouchMove(event),this.touchend=event=>this.onTouchEnd(event),this.touchcancel=event=>this.onTouchCancel(event),this.pinch={finger1:{identifier:NaN,screenX:NaN,screenY:NaN},finger2:{identifier:NaN,screenX:NaN,screenY:NaN},origin:{x:NaN,y:NaN},distance:NaN,status:0},this.element=element2,element2.addEventListener("touchstart",this.touchstart,{passive:!0}),element2.addEventListener("touchmove",this.touchmove,{passive:!0}),element2.addEventListener("touchend",this.touchend),element2.addEventListener("touchcancel",this.touchcancel)}destroy(){const{element:element2}=this;element2.removeEventListener("touchstart",this.touchstart),element2.removeEventListener("touchmove",this.touchmove),element2.removeEventListener("touchend",this.touchend),element2.removeEventListener("touchcancel",this.touchcancel)}findPinchTouches(moveEvent){const{touches}=moveEvent,{finger1,finger2}=this.pinch;if(this.pinch.status!==0&&touches.length===2){if(touches[0].identifier===finger1.identifier&&touches[1].identifier===finger2.identifier)return[touches[0],touches[1]];if(touches[0].identifier===finger2.identifier&&touches[1].identifier===finger1.identifier)return[touches[1],touches[0]]}}copyTouchData(event){const keys=["identifier","screenX","screenY"];partialAssign(keys,this.pinch.finger1,event.touches[0]),partialAssign(keys,this.pinch.finger2,event.touches[1]),this.pinch.distance=distance(this.pinch.finger1,this.pinch.finger2)}dispatchPinchEvent(type,deltaDistance){const{finger1,finger2,origin}=this.pinch,newEvent={type,finger1,finger2,deltaDistance,origin};this.listeners.dispatch(type,newEvent)}onTouchStart(event){this.stopPinchTracking();const{pinch}=this;event.touches.length===2&&(pinch.status=1,this.copyTouchData(event),pinch.origin.x=(event.touches[0].clientX+event.touches[1].clientX)/2,pinch.origin.y=(event.touches[0].clientY+event.touches[1].clientY)/2)}onTouchMove(event){const pinchTouches=this.findPinchTouches(event);if(pinchTouches!==void 0){const[touch1,touch2]=pinchTouches,{pinch}=this,newDistance=distance(touch1,touch2),deltaDistance=newDistance-pinch.distance;pinch.status===1?Math.abs(deltaDistance)>MIN_DISTANCE_TO_START_PINCH&&(pinch.status=2,this.copyTouchData(event),this.dispatchPinchEvent("pinch-start",0)):pinch.status===2?(pinch.distance=newDistance,this.copyTouchData(event),this.dispatchPinchEvent("pinch-move",deltaDistance)):Logger.error(`unexpected pinch.status: ${pinch.status}`)}}onTouchEnd(_event){this.stopPinchTracking()}onTouchCancel(_event){this.stopPinchTracking()}stopPinchTracking(){const{pinch}=this;pinch.status===2&&this.dispatchPinchEvent("pinch-end",0),this.pinch.status=0}},__name(_a78,"GestureDetector"),_a78),_a79,HighlightManager=(_a79=class extends BaseManager{constructor(){super(...arguments),this.highlightStates=new Map,this.pickedStates=new Map}updateHighlight(callerId,highlightedDatum){this.highlightStates.delete(callerId),highlightedDatum!=null&&this.highlightStates.set(callerId,highlightedDatum),this.applyHighlightStates()}getActiveHighlight(){return this.activeHighlight}updatePicked(callerId,clickableDatum){this.pickedStates.delete(callerId),clickableDatum!=null&&this.pickedStates.set(callerId,clickableDatum),this.applyPickedStates()}getActivePicked(){return this.activePicked}applyHighlightStates(){const{activeHighlight:previousHighlight}=this;this.activeHighlight=Array.from(this.highlightStates.values()).pop(),this.isEqual(this.activeHighlight,previousHighlight)||this.listeners.dispatch("highlight-change",{type:"highlight-change",currentHighlight:this.activeHighlight,previousHighlight})}applyPickedStates(){this.activePicked=Array.from(this.pickedStates.values()).pop()}isEqual(a,b){return a===b||(a==null?void 0:a.series)===(b==null?void 0:b.series)&&(a==null?void 0:a.itemId)===(b==null?void 0:b.itemId)&&(a==null?void 0:a.datum)===(b==null?void 0:b.datum)}},__name(_a79,"HighlightManager"),_a79);function nodeContainsPoint(node,x,y){var _a201,_b;return(_b=(_a201=node.bbox.computeBBox())==null?void 0:_a201.containsPoint(x,y))!=null?_b:!1}__name(nodeContainsPoint,"nodeContainsPoint");function nodeArea(node){var _a201;const{width=0,height=0}=(_a201=node.bbox.computeBBox())!=null?_a201:{};return width*height}__name(nodeArea,"nodeArea");var _a80,BBoxSet=(_a80=class{constructor(){this.nodes=[]}add(value,bbox){this.nodes.push({value,bbox})}find(x,y){return this.nodes.filter(node=>nodeContainsPoint(node,x,y)).sort((a,b)=>nodeArea(a)-nodeArea(b)).map(node=>node.value)}*[Symbol.iterator](){for(const{value}of Object.values(this.nodes))yield value}clear(){this.nodes.length=0}},__name(_a80,"BBoxSet"),_a80),_a81,RegionListeners=(_a81=class extends Listeners{},__name(_a81,"RegionListeners"),_a81),_a82,RegionManager=(_a82=class{constructor(interactionManager){this.interactionManager=interactionManager,this.eventHandler=event=>this.processEvent(event),this.regions=new BBoxSet,this.destroyFns=[],INTERACTION_TYPES.forEach(t=>this.destroyFns.push(interactionManager.addListener(t,this.eventHandler,15)))}destroy(){this.destroyFns.forEach(fn=>fn()),this.currentRegion=void 0;for(const region of this.regions)region.listeners.destroy();this.regions.clear()}pushRegion(name,bboxprovider){const region={name,listeners:new RegionListeners};return this.regions.add(region,bboxprovider),region}addRegion(name,bboxprovider){const region=this.pushRegion(name,bboxprovider),{interactionManager}=this,_ObservableRegionImplementation=class _ObservableRegionImplementation{addListener(type,handler,triggeringStates=8){return region.listeners.addListener(type,e=>{e.consumed||interactionManager.getState()&triggeringStates&&handler(e)})}};__name(_ObservableRegionImplementation,"ObservableRegionImplementation");let ObservableRegionImplementation=_ObservableRegionImplementation;return new ObservableRegionImplementation}processEvent(event){const{currentRegion}=this,newRegion=this.pickRegion(event.offsetX,event.offsetY);currentRegion!==void 0&&(newRegion==null?void 0:newRegion.name)!==currentRegion.name&&(currentRegion==null||currentRegion.listeners.dispatch("leave",__spreadProps(__spreadValues({},event),{type:"leave"}))),newRegion!==void 0&&__name(()=>__async(this,null,function*(){return newRegion.listeners.dispatch(event.type,event)}),"dispatcher")().catch(e=>Logger.errorOnce(e)),this.currentRegion=newRegion}pickRegion(x,y){const matchingRegions=this.regions.find(x,y);return matchingRegions.length>0?matchingRegions[0]:void 0}},__name(_a82,"RegionManager"),_a82),_a83,_SyncManager=(_a83=class extends BaseManager{constructor(chart){super(),this.chart=chart}subscribe(groupId=_a83.DEFAULT_GROUP){let syncGroup=this.get(groupId);return syncGroup||(syncGroup=new Set,_a83.chartsGroups.set(groupId,syncGroup)),syncGroup.add(this.chart),this}unsubscribe(groupId=_a83.DEFAULT_GROUP){var _a201;return(_a201=this.get(groupId))==null||_a201.delete(this.chart),this}getChart(){return this.chart}getGroup(groupId=_a83.DEFAULT_GROUP){const syncGroup=this.get(groupId);return syncGroup?Array.from(syncGroup):[]}getGroupSiblings(groupId=_a83.DEFAULT_GROUP){return this.getGroup(groupId).filter(chart=>chart!==this.chart)}get(groupId){return _a83.chartsGroups.get(groupId)}},__name(_a83,"_SyncManager"),_a83);_SyncManager.chartsGroups=new Map;_SyncManager.DEFAULT_GROUP=Symbol("sync-group-default");var SyncManager=_SyncManager,_a84,TooltipManager=(_a84=class{constructor(tooltip,interactionManager){this.states={},this.exclusiveAreas={},this.destroyFns=[],this.tooltip=tooltip,this.destroyFns.push(interactionManager.addListener("hover",e=>this.checkExclusiveRects(e)))}getRange(){return this.tooltip.range}updateTooltip(callerId,meta,content){var _a201;content==null&&(content=(_a201=this.states[callerId])==null?void 0:_a201.content),this.states[callerId]={content,meta},this.applyStates()}updateExclusiveRect(callerId,area2){area2?this.exclusiveAreas[callerId]=area2:delete this.exclusiveAreas[callerId]}removeTooltip(callerId){delete this.states[callerId],this.applyStates()}getTooltipMeta(callerId){var _a201;return(_a201=this.states[callerId])==null?void 0:_a201.meta}destroy(){for(const destroyFn of this.destroyFns)destroyFn()}checkExclusiveRects(e){let newAppliedExclusiveArea;for(const[entryId,area2]of Object.entries(this.exclusiveAreas))if(area2.containsPoint(e.offsetX,e.offsetY)){newAppliedExclusiveArea=entryId;break}newAppliedExclusiveArea!==this.appliedExclusiveArea&&(this.appliedExclusiveArea=newAppliedExclusiveArea,this.applyStates())}applyStates(){var _a201;const ids=this.appliedExclusiveArea?[this.appliedExclusiveArea]:Object.keys(this.states);let contentToApply,metaToApply;if(ids.reverse(),ids.slice(0,1).forEach(id=>{var _a210;const{content,meta}=(_a210=this.states[id])!=null?_a210:{};contentToApply=content,metaToApply=meta}),metaToApply===void 0||contentToApply===void 0){this.appliedState=void 0,this.tooltip.toggle(!1);return}if(((_a201=this.appliedState)==null?void 0:_a201.content)===contentToApply){const renderInstantly=this.tooltip.isVisible();this.tooltip.show(metaToApply,void 0,renderInstantly)}else this.tooltip.show(metaToApply,contentToApply);this.appliedState={content:contentToApply,meta:metaToApply}}static makeTooltipMeta(event,datum){var _a201,_b,_c,_d;const{offsetX,offsetY}=event,{tooltip}=datum.series.properties,position={xOffset:tooltip.position.xOffset,yOffset:tooltip.position.yOffset},meta={offsetX,offsetY,lastPointerEvent:{offsetX,offsetY},showArrow:tooltip.showArrow,position},refPoint=(_b=(_a201=datum.yBar)==null?void 0:_a201.upperPoint)!=null?_b:datum.midPoint;if(tooltip.position.type==="node"&&refPoint){const{x,y}=refPoint,point=datum.series.contentGroup.inverseTransformPoint(x,y);return __spreadProps(__spreadValues({},meta),{offsetX:Math.round(point.x),offsetY:Math.round(point.y)})}return meta.enableInteraction=(_d=(_c=tooltip.interaction)==null?void 0:_c.enabled)!=null?_d:!1,meta}},__name(_a84,"TooltipManager"),_a84),_a85,ZoomManager=(_a85=class extends BaseManager{constructor(){super(...arguments),this.axisZoomManagers=new Map}updateAxes(axes){var _a201;const zoomManagers=new Map(axes.map(axis=>[axis.id,this.axisZoomManagers.get(axis.id)]));this.axisZoomManagers.clear();for(const axis of axes)this.axisZoomManagers.set(axis.id,(_a201=zoomManagers.get(axis.id))!=null?_a201:new AxisZoomManager(axis));this.initialZoom&&(this.updateZoom(this.initialZoom),this.initialZoom=void 0)}updateZoom(newZoom){if(this.axisZoomManagers.size===0){this.initialZoom=newZoom;return}this.axisZoomManagers.forEach(axis=>{axis.updateZoom(newZoom==null?void 0:newZoom[axis.getDirection()])}),this.applyChanges()}updateAxisZoom(axisId,newZoom){var _a201;(_a201=this.axisZoomManagers.get(axisId))==null||_a201.updateZoom(newZoom),this.applyChanges()}getZoom(){let x,y;if(this.axisZoomManagers.forEach(axis=>{axis.getDirection()==="x"?x??(x=axis.getZoom()):axis.getDirection()==="y"&&(y??(y=axis.getZoom()))}),x||y)return{x,y}}getAxisZoom(axisId){var _a201,_b;return(_b=(_a201=this.axisZoomManagers.get(axisId))==null?void 0:_a201.getZoom())!=null?_b:{min:0,max:1}}getAxisZooms(){const axes={};for(const[axisId,axis]of this.axisZoomManagers.entries())axes[axisId]={direction:axis.getDirection(),zoom:axis.getZoom()};return axes}applyChanges(){if(!Array.from(this.axisZoomManagers.values()).map(axis=>axis.applyChanges()).some(Boolean))return;const axes={};for(const[axisId,axis]of this.axisZoomManagers.entries())axes[axisId]=axis.getZoom();this.listeners.dispatch("zoom-change",__spreadProps(__spreadValues({type:"zoom-change"},this.getZoom()),{axes}))}},__name(_a85,"ZoomManager"),_a85),_a86,AxisZoomManager=(_a86=class{constructor(axis){this.pendingZoom=null,this.axis=axis;const[min=0,max=1]=axis.visibleRange;this.initialZoom=this.currentZoom={min,max}}getDirection(){return this.axis.direction}updateZoom(newZoom){this.pendingZoom=newZoom?__spreadValues({},newZoom):null}getZoom(){return deepClone(this.currentZoom)}applyChanges(){var _a201;const prevZoom=this.currentZoom;return this.currentZoom=(_a201=this.pendingZoom)!=null?_a201:this.initialZoom,prevZoom.min!==this.currentZoom.min||prevZoom.max!==this.currentZoom.max}},__name(_a86,"AxisZoomManager"),_a86),_a87,LayoutService=(_a87=class extends Listeners{constructor(){super(...arguments),this.layoutComplete="layout-complete"}addListener(eventType,handler){if(this.isLayoutStage(eventType)||this.isLayoutComplete(eventType))return super.addListener(eventType,handler);throw new Error(`AG Charts - unsupported listener type: ${eventType}`)}dispatchPerformLayout(stage,ctx){return this.isLayoutStage(stage)?this.getListenersByType(stage).reduce((result,listener)=>{try{return listener.handler(result)}catch(e){return Logger.errorOnce(e),result}},ctx):ctx}dispatchLayoutComplete(event){this.dispatch(this.layoutComplete,event)}isLayoutStage(eventType){return eventType!==this.layoutComplete}isLayoutComplete(eventType){return eventType===this.layoutComplete}},__name(_a87,"LayoutService"),_a87);function gridLayout({orientation,bboxes,maxHeight,maxWidth,itemPaddingY=0,itemPaddingX=0,forceResult=!1}){const horizontal=orientation==="horizontal",primary={max:horizontal?maxWidth:maxHeight,fn:horizontal?b=>b.width:b=>b.height,padding:horizontal?itemPaddingX:itemPaddingY},secondary={max:horizontal?maxHeight:maxWidth,fn:horizontal?b=>b.height:b=>b.width,padding:horizontal?itemPaddingY:itemPaddingX};let processedBBoxCount=0;const rawPages=[];for(;processedBBoxCount<bboxes.length;){const unprocessedBBoxes=bboxes.slice(processedBBoxCount),result=processBBoxes(unprocessedBBoxes,processedBBoxCount,primary,secondary,forceResult);if(!result)return;processedBBoxCount+=result.processedBBoxCount,rawPages.push(result.pageIndices)}return buildPages(rawPages,orientation,bboxes,itemPaddingY,itemPaddingX)}__name(gridLayout,"gridLayout");function processBBoxes(bboxes,indexOffset,primary,secondary,forceResult){let startingGuess=estimateStartingGuess(bboxes,primary);if(startingGuess<1){if(!forceResult)return;startingGuess=1}for(let guess=startingGuess;guess>=1;guess--){const pageIndices=calculatePage(bboxes,indexOffset,guess,primary,secondary,forceResult);if(pageIndices==null&&guess<=1)return;if(pageIndices==null)continue;if(typeof pageIndices=="number"){if(pageIndices<=1)return;guess=pageIndices<guess&&pageIndices>1?pageIndices:guess;continue}return{processedBBoxCount:pageIndices.length*pageIndices[0].length,pageIndices}}}__name(processBBoxes,"processBBoxes");function calculatePage(bboxes,indexOffset,primaryCount,primary,secondary,forceResult){var _a201;const result=[];let sumSecondary=0,currentMaxSecondary=0,currentPrimaryIndices=[];const maxPrimaryValues=[];for(let bboxIndex=0;bboxIndex<bboxes.length;bboxIndex++){const primaryValueIdx=(bboxIndex+primaryCount)%primaryCount;primaryValueIdx===0&&(sumSecondary+=currentMaxSecondary,currentMaxSecondary=0,currentPrimaryIndices.length>0&&result.push(currentPrimaryIndices),currentPrimaryIndices=[]);const primaryValue=primary.fn(bboxes[bboxIndex])+primary.padding;maxPrimaryValues[primaryValueIdx]=Math.max((_a201=maxPrimaryValues[primaryValueIdx])!=null?_a201:0,primaryValue),currentMaxSecondary=Math.max(currentMaxSecondary,secondary.fn(bboxes[bboxIndex])+secondary.padding);const currentSecondaryDimension=sumSecondary+currentMaxSecondary,returnResult=!forceResult||result.length>0;if(currentSecondaryDimension>secondary.max&&returnResult){currentPrimaryIndices=[];break}if(maxPrimaryValues.reduce((sum2,next)=>sum2+next,0)>primary.max&&!forceResult)return maxPrimaryValues.length<primaryCount?maxPrimaryValues.length:void 0;currentPrimaryIndices.push(bboxIndex+indexOffset)}return currentPrimaryIndices.length>0&&result.push(currentPrimaryIndices),result.length>0?result:void 0}__name(calculatePage,"calculatePage");function buildPages(rawPages,orientation,bboxes,itemPaddingY,itemPaddingX){let maxPageWidth=0,maxPageHeight=0;return{pages:rawPages.map(indices=>{orientation==="horizontal"&&(indices=transpose(indices));let endIndex=0;const columns=indices.map(colIndices=>{const colBBoxes=colIndices.map(bboxIndex=>(endIndex=Math.max(bboxIndex,endIndex),bboxes[bboxIndex]));let columnHeight=0,columnWidth=0;return colBBoxes.forEach(bbox=>{columnHeight+=bbox.height+itemPaddingY,columnWidth=Math.max(columnWidth,bbox.width+itemPaddingX)}),{indices:colIndices,bboxes:colBBoxes,columnHeight:Math.ceil(columnHeight),columnWidth:Math.ceil(columnWidth)}});let pageWidth=0,pageHeight=0;return columns.forEach(column=>{pageWidth+=column.columnWidth,pageHeight=Math.max(pageHeight,column.columnHeight)}),maxPageWidth=Math.max(pageWidth,maxPageWidth),maxPageHeight=Math.max(pageHeight,maxPageHeight),{columns,startIndex:indices[0][0],endIndex,pageWidth,pageHeight}}),maxPageWidth,maxPageHeight}}__name(buildPages,"buildPages");function transpose(data){const result=[];for(const _ of data[0])result.push([]);return data.forEach((innerData,dataIdx)=>{innerData.forEach((item,itemIdx)=>{result[itemIdx][dataIdx]=item})}),result}__name(transpose,"transpose");function estimateStartingGuess(bboxes,primary){const n=bboxes.length;let primarySum=0;for(let bboxIndex=0;bboxIndex<n;bboxIndex++)if(primarySum+=primary.fn(bboxes[bboxIndex])+primary.padding,primarySum>primary.max)return n/bboxIndex<2?Math.ceil(n/2):bboxIndex;return n}__name(estimateStartingGuess,"estimateStartingGuess");function linearRoot(a,b){const t=-b/a;return a!==0&&t>=0&&t<=1?[t]:[]}__name(linearRoot,"linearRoot");function quadraticRoots(a,b,c){if(a===0)return linearRoot(b,c);const D=b*b-4*a*c,roots=[];if(D===0){const t=-b/(2*a);t>=0&&t<=1&&roots.push(t)}else if(D>0){const rD=Math.sqrt(D),t1=(-b-rD)/(2*a),t2=(-b+rD)/(2*a);t1>=0&&t1<=1&&roots.push(t1),t2>=0&&t2<=1&&roots.push(t2)}return roots}__name(quadraticRoots,"quadraticRoots");function cubicRoots(a,b,c,d){if(a===0)return quadraticRoots(b,c,d);const A=b/a,B=c/a,C=d/a,Q=(3*B-A*A)/9,R=(9*A*B-27*C-2*A*A*A)/54,D=Q*Q*Q+R*R,third=1/3,roots=[];if(D>=0){const rD=Math.sqrt(D),S=Math.sign(R+rD)*Math.pow(Math.abs(R+rD),third),T=Math.sign(R-rD)*Math.pow(Math.abs(R-rD),third),Im=Math.abs(Math.sqrt(3)*(S-T)/2),t=-third*A+(S+T);if(t>=0&&t<=1&&roots.push(t),Im===0){const t2=-third*A-(S+T)/2;t2>=0&&t2<=1&&roots.push(t2)}}else{const theta=Math.acos(R/Math.sqrt(-Q*Q*Q)),thirdA=third*A,twoSqrtQ=2*Math.sqrt(-Q),t1=twoSqrtQ*Math.cos(third*theta)-thirdA,t2=twoSqrtQ*Math.cos(third*(theta+2*Math.PI))-thirdA,t3=twoSqrtQ*Math.cos(third*(theta+4*Math.PI))-thirdA;t1>=0&&t1<=1&&roots.push(t1),t2>=0&&t2<=1&&roots.push(t2),t3>=0&&t3<=1&&roots.push(t3)}return roots}__name(cubicRoots,"cubicRoots");function segmentIntersection(ax1,ay1,ax2,ay2,bx1,by1,bx2,by2){const d=(ax2-ax1)*(by2-by1)-(ay2-ay1)*(bx2-bx1);if(d===0)return null;const ua=((bx2-bx1)*(ay1-by1)-(ax1-bx1)*(by2-by1))/d,ub=((ax2-ax1)*(ay1-by1)-(ay2-ay1)*(ax1-bx1))/d;return ua>=0&&ua<=1&&ub>=0&&ub<=1?{x:ax1+ua*(ax2-ax1),y:ay1+ua*(ay2-ay1)}:null}__name(segmentIntersection,"segmentIntersection");function cubicSegmentIntersections(px1,py1,px2,py2,px3,py3,px4,py4,x1,y1,x2,y2){const intersections=[],A=y1-y2,B=x2-x1,C=x1*(y2-y1)-y1*(x2-x1),bx=bezierCoefficients(px1,px2,px3,px4),by=bezierCoefficients(py1,py2,py3,py4),a=A*bx[0]+B*by[0],b=A*bx[1]+B*by[1],c=A*bx[2]+B*by[2],d=A*bx[3]+B*by[3]+C,roots=cubicRoots(a,b,c,d);for(const t of roots){const tt=t*t,ttt=t*tt,x=bx[0]*ttt+bx[1]*tt+bx[2]*t+bx[3],y=by[0]*ttt+by[1]*tt+by[2]*t+by[3];let s;x1!==x2?s=(x-x1)/(x2-x1):s=(y-y1)/(y2-y1),s>=0&&s<=1&&intersections.push({x,y})}return intersections}__name(cubicSegmentIntersections,"cubicSegmentIntersections");function bezierCoefficients(P1,P2,P3,P4){return[-P1+3*P2-3*P3+P4,3*P1-6*P2+3*P3,-3*P1+3*P2,P1]}__name(bezierCoefficients,"bezierCoefficients");function arcIntersections(cx,cy,r,startAngle,endAngle,counterClockwise,x1,y1,x2,y2){const k=(y2-y1)/(x2-x1),y0=y1-k*x1,a=Math.pow(k,2)+1,b=2*(k*(y0-cy)-cx),c=Math.pow(cx,2)+Math.pow(y0-cy,2)-Math.pow(r,2),d=Math.pow(b,2)-4*a*c;if(d<0)return[];const i1x=(-b+Math.sqrt(d))/2/a,i2x=(-b-Math.sqrt(d))/2/a,intersections=[];return[i1x,i2x].forEach(x=>{if(!(x>=Math.min(x1,x2)&&x<=Math.max(x1,x2)))return;const y=k*x+y0,a1=normalizeAngle360(startAngle);let a2=normalizeAngle360(endAngle),a3=normalizeAngle360(Math.atan2(y,x));a2<=a1&&(a2+=2*Math.PI),a3<a1&&(a3+=2*Math.PI),counterClockwise!==(a3>=a1&&a3<=a2)&&intersections.push({x,y})}),intersections}__name(arcIntersections,"arcIntersections");var _a88,Path2D=(_a88=class{constructor(){this.previousCommands=[],this.previousParams=[],this.previousClosedPath=!1,this.commands=[],this.params=[],this._closedPath=!1}isDirty(){if(this._closedPath!==this.previousClosedPath||this.previousCommands.length!==this.commands.length||this.previousParams.length!==this.params.length)return!0;for(let i=0;i<this.commands.length;i++)if(this.commands[i]!==this.previousCommands[i])return!0;for(let i=0;i<this.params.length;i++)if(this.params[i]!==this.previousParams[i])return!0;return!1}draw(ctx){const commands=this.commands,params=this.params;let j=0;ctx.beginPath();for(const command of commands)switch(command){case 0:ctx.moveTo(params[j++],params[j++]);break;case 1:ctx.lineTo(params[j++],params[j++]);break;case 3:ctx.bezierCurveTo(params[j++],params[j++],params[j++],params[j++],params[j++],params[j++]);break;case 2:ctx.arc(params[j++],params[j++],params[j++],params[j++],params[j++],params[j++]===1);break;case 4:ctx.closePath();break}commands.length===0&&ctx.closePath()}moveTo(x,y){this.xy?(this.xy[0]=x,this.xy[1]=y):this.xy=[x,y],this.commands.push(0),this.params.push(x,y)}lineTo(x,y){this.xy?(this.commands.push(1),this.params.push(x,y),this.xy[0]=x,this.xy[1]=y):this.moveTo(x,y)}rect(x,y,width,height){this.moveTo(x,y),this.lineTo(x+width,y),this.lineTo(x+width,y+height),this.lineTo(x,y+height),this.closePath()}roundRect(x,y,width,height,radii){radii=Math.min(radii,width/2,height/2),this.moveTo(x,y+radii),this.arc(x+radii,y+radii,radii,Math.PI,3*Math.PI/2),this.lineTo(x+radii,y),this.lineTo(x+width-radii,y),this.arc(x+width-radii,y+radii,radii,3*Math.PI/2,2*Math.PI),this.lineTo(x+width,y+radii),this.lineTo(x+width,y+height-radii),this.arc(x+width-radii,y+height-radii,radii,0,Math.PI/2),this.lineTo(x+width-radii,y+height),this.lineTo(x+radii,y+height),this.arc(x+ +radii,y+height-radii,radii,Math.PI/2,Math.PI),this.lineTo(x,y+height-radii),this.closePath()}arc(x,y,r,sAngle,eAngle,antiClockwise=!1){const endX=x+r*Math.cos(eAngle),endY=y+r*Math.sin(eAngle);this.xy?(this.xy[0]=endX,this.xy[1]=endY):this.xy=[endX,endY],this.commands.push(2),this.params.push(x,y,r,sAngle,eAngle,antiClockwise?1:0)}cubicCurveTo(cx1,cy1,cx2,cy2,x,y){this.xy||this.moveTo(cx1,cy1),this.commands.push(3),this.params.push(cx1,cy1,cx2,cy2,x,y),this.xy&&(this.xy[0]=x,this.xy[1]=y)}get closedPath(){return this._closedPath}closePath(){this.xy&&(this.xy=void 0,this.commands.push(4),this._closedPath=!0)}clear({trackChanges}={trackChanges:!1}){trackChanges?(this.previousCommands=this.commands,this.previousParams=this.params,this.previousClosedPath=this._closedPath,this.commands=[],this.params=[]):(this.commands.length=0,this.params.length=0),this.xy=void 0,this._closedPath=!1}isPointInPath(x,y){const commands=this.commands,params=this.params,cn=commands.length,ox=-1e4,oy=-1e4;let sx=NaN,sy=NaN,px=0,py=0,intersectionCount=0;for(let ci=0,pi=0;ci<cn;ci++)switch(commands[ci]){case 0:!isNaN(sx)&&segmentIntersection(sx,sy,px,py,ox,oy,x,y)&&intersectionCount++,px=params[pi++],sx=px,py=params[pi++],sy=py;break;case 1:segmentIntersection(px,py,params[pi++],params[pi++],ox,oy,x,y)&&intersectionCount++,px=params[pi-2],py=params[pi-1];break;case 3:intersectionCount+=cubicSegmentIntersections(px,py,params[pi++],params[pi++],params[pi++],params[pi++],params[pi++],params[pi++],ox,oy,x,y).length,px=params[pi-2],py=params[pi-1];break;case 2:const cx=params[pi++],cy=params[pi++],r=params[pi++],startAngle=params[pi++],endAngle=params[pi++],counterClockwise=!!params[pi++];intersectionCount+=arcIntersections(cx,cy,r,startAngle,endAngle,counterClockwise,ox,oy,x,y).length,px=cx+Math.cos(endAngle)*r,py=cy+Math.sin(endAngle)*r;break;case 4:!isNaN(sx)&&segmentIntersection(sx,sy,px,py,ox,oy,x,y)&&intersectionCount++;break}return intersectionCount%2===1}getPoints(){const{commands,params}=this,coords=[];let pi=0;for(let ci=0;ci<commands.length;ci++)switch(commands[ci]){case 0:case 1:coords.push({x:params[pi++],y:params[pi++]});break;case 3:pi+=4,coords.push({x:params[pi++],y:params[pi++]});break;case 2:coords.push({x:params[pi++],y:params[pi++]}),pi+=4;break}return coords}},__name(_a88,"Path2D"),_a88);function ScenePathChangeDetection(opts){const{redraw=3,changeCb,convertor}=opts??{};return SceneChangeDetection({redraw,type:"path",convertor,changeCb})}__name(ScenePathChangeDetection,"ScenePathChangeDetection");var _a89,Path=(_a89=class extends Shape{constructor(){super(...arguments),this.path=new Path2D,this._clipX=NaN,this._clipY=NaN,this._dirtyPath=!0}set clipX(value){this._clipX=value,this.dirtyPath=!0}set clipY(value){this._clipY=value,this.dirtyPath=!0}set dirtyPath(value){this._dirtyPath!==value&&(this._dirtyPath=value,value&&this.markDirty(this,3))}get dirtyPath(){return this._dirtyPath}checkPathDirty(){var _a201,_b,_c,_d;this._dirtyPath||(this.dirtyPath=this.path.isDirty()||((_b=(_a201=this.fillShadow)==null?void 0:_a201.isDirty())!=null?_b:!1)||((_d=(_c=this._clipPath)==null?void 0:_c.isDirty())!=null?_d:!1))}isPointInPath(x,y){const point=this.transformPoint(x,y);return this.path.closedPath&&this.path.isPointInPath(point.x,point.y)}isDirtyPath(){return!1}updatePath(){}render(renderCtx){var _a201,_b,_c,_d,_e;const{ctx,forceRender,stats}=renderCtx;if(this.dirty===0&&!forceRender){stats&&(stats.nodesSkipped+=this.nodeCount.count);return}if(this.computeTransformMatrix(),this.matrix.toContext(ctx),(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),!isNaN(this._clipX)&&!isNaN(this._clipY)&&this.clipMode!=null){ctx.save();const margin=this.strokeWidth/2;if((_a201=this._clipPath)!=null||(this._clipPath=new Path2D),this._clipPath.clear(),this._clipPath.rect(-margin,-margin,this._clipX+margin,this._clipY+margin+margin),this.clipMode==="normal"&&((_b=this._clipPath)==null||_b.draw(ctx),ctx.clip()),this._clipX>0&&this._clipY>0&&(this.path.draw(ctx),this.fillStroke(ctx)),this.clipMode==="punch-out"){(_c=this._clipPath)==null||_c.draw(ctx),ctx.clip();const{x=-1e4,y=-1e4,width=2e4,height=2e4}=(_d=this.computeBBox())!=null?_d:{};ctx.clearRect(x,y,width,height)}ctx.restore()}else this.path.draw(ctx),this.fillStroke(ctx);(_e=this.fillShadow)==null||_e.markClean(),super.render(renderCtx)}},__name(_a89,"Path"),_a89);Path.className="Path";__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipMode",2);__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipX",1);__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipY",1);var _a90,Marker=(_a90=class extends Path{constructor(){super(...arguments),this.x=0,this.y=0,this.size=12}computeBBox(){const{x,y,size}=this,half=size/2;return new BBox(x-half,y-half,size,size)}applyPath(s,moves){const{path}=this;let{x,y}=this;path.clear();for(const{x:mx,y:my,t}of moves)x+=mx*s,y+=my*s,t==="move"?path.moveTo(x,y):path.lineTo(x,y);path.closePath()}},__name(_a90,"Marker"),_a90);__decorateClass([ScenePathChangeDetection()],Marker.prototype,"x",2);__decorateClass([ScenePathChangeDetection()],Marker.prototype,"y",2);__decorateClass([ScenePathChangeDetection({convertor:Math.abs})],Marker.prototype,"size",2);var _a91,Circle=(_a91=class extends Marker{updatePath(){const{x,y,path,size}=this,r=size/2;path.clear(),path.arc(x,y,r,0,Math.PI*2),path.closePath()}},__name(_a91,"Circle"),_a91);Circle.className="Circle";var _a92,_Cross=(_a92=class extends Marker{updatePath(){const s=this.size/4.2;super.applyPath(s,_a92.moves)}},__name(_a92,"_Cross"),_a92);_Cross.className="Cross";_Cross.moves=[{x:-1,y:0,t:"move"},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:-1,y:1},{x:-1,y:-1}];var Cross=_Cross,_a93,_Diamond=(_a93=class extends Marker{updatePath(){const s=this.size/2;super.applyPath(s,_a93.moves)}},__name(_a93,"_Diamond"),_a93);_Diamond.className="Diamond";_Diamond.moves=[{x:0,y:-1,t:"move"},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}];var Diamond=_Diamond,_a94,Heart=(_a94=class extends Marker{rad(degree){return degree/180*Math.PI}updatePath(){const{x,path,size,rad}=this,r=size/4,y=this.y+r/2;path.clear(),path.arc(x-r,y-r,r,rad(130),rad(330)),path.arc(x+r,y-r,r,rad(220),rad(50)),path.lineTo(x,y+r),path.closePath()}},__name(_a94,"Heart"),_a94);Heart.className="Heart";var _a95,_Plus=(_a95=class extends Marker{updatePath(){const s=this.size/3;super.applyPath(s,_a95.moves)}},__name(_a95,"_Plus"),_a95);_Plus.className="Plus";_Plus.moves=[{x:-.5,y:-.5,t:"move"},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1},{x:-1,y:0},{x:0,y:-1}];var Plus=_Plus,_a96,Square=(_a96=class extends Marker{updatePath(){const{path,x,y}=this,hs=this.size/2;path.clear(),path.moveTo(this.align(x-hs),this.align(y-hs)),path.lineTo(this.align(x+hs),this.align(y-hs)),path.lineTo(this.align(x+hs),this.align(y+hs)),path.lineTo(this.align(x-hs),this.align(y+hs)),path.closePath()}},__name(_a96,"Square"),_a96);Square.className="Square";var _a97,_Triangle=(_a97=class extends Marker{updatePath(){const s=this.size*1.1;super.applyPath(s,_a97.moves)}},__name(_a97,"_Triangle"),_a97);_Triangle.className="Triangle";_Triangle.moves=[{x:0,y:-.48,t:"move"},{x:.5,y:.87},{x:-1,y:0}];var Triangle=_Triangle,MARKER_SHAPES={circle:Circle,cross:Cross,diamond:Diamond,heart:Heart,plus:Plus,square:Square,triangle:Triangle},MARKER_SUPPORTED_SHAPES=Object.keys(MARKER_SHAPES);function isMarkerShape(shape){return typeof shape=="string"&&MARKER_SUPPORTED_SHAPES.includes(shape)}__name(isMarkerShape,"isMarkerShape");function getMarker(shape=Square){return isMarkerShape(shape)?MARKER_SHAPES[shape]:typeof shape=="function"?shape:Square}__name(getMarker,"getMarker");var _a98,MarkerLabel=(_a98=class extends Group{constructor(){super({name:"markerLabelGroup"}),this.label=new Text,this.line=new Line,this._marker=new Square,this._markerSize=15,this._spacing=8;const{marker,label,line}=this;label.textBaseline="middle",label.fontSize=12,label.fontFamily="Verdana, sans-serif",label.fill="black",label.y=HdpiCanvas.has.textMetrics?1:0,this.append([line,marker,label]),this.update()}set marker(value){this._marker!==value&&(this.removeChild(this._marker),this._marker=value,this.appendChild(value),this.update())}get marker(){return this._marker}set markerSize(value){this._markerSize!==value&&(this._markerSize=value,this.update())}get markerSize(){return this._markerSize}set spacing(value){this._spacing!==value&&(this._spacing=value,this.update())}get spacing(){return this._spacing}setSeriesStrokeOffset(xOff){const offset4=this.marker.size/2+xOff;this.line.x1=-offset4,this.line.x2=offset4,this.line.y1=0,this.line.y2=0,this.line.markDirtyTransform(),this.update()}update(){this.marker.size=this.markerSize;const lineEnd=this.line.visible?this.line.x2:-1/0,markerEnd=this.markerSize/2;this.label.x=Math.max(lineEnd,markerEnd)+this.spacing}render(renderCtx){this.marker.opacity=this.opacity,this.label.opacity=this.opacity,this.line.opacity=this.opacity,super.render(renderCtx)}},__name(_a98,"MarkerLabel"),_a98);MarkerLabel.className="MarkerLabel";__decorateClass([ProxyPropertyOnWrite("label")],MarkerLabel.prototype,"text",2);__decorateClass([ProxyPropertyOnWrite("label")],MarkerLabel.prototype,"fontStyle",2);__decorateClass([ProxyPropertyOnWrite("label")],MarkerLabel.prototype,"fontWeight",2);__decorateClass([ProxyPropertyOnWrite("label")],MarkerLabel.prototype,"fontSize",2);__decorateClass([ProxyPropertyOnWrite("label")],MarkerLabel.prototype,"fontFamily",2);__decorateClass([ProxyPropertyOnWrite("label","fill")],MarkerLabel.prototype,"color",2);__decorateClass([ProxyPropertyOnWrite("marker","fill")],MarkerLabel.prototype,"markerFill",2);__decorateClass([ProxyPropertyOnWrite("marker","stroke")],MarkerLabel.prototype,"markerStroke",2);__decorateClass([ProxyPropertyOnWrite("marker","strokeWidth")],MarkerLabel.prototype,"markerStrokeWidth",2);__decorateClass([ProxyPropertyOnWrite("marker","fillOpacity")],MarkerLabel.prototype,"markerFillOpacity",2);__decorateClass([ProxyPropertyOnWrite("marker","strokeOpacity")],MarkerLabel.prototype,"markerStrokeOpacity",2);__decorateClass([ProxyPropertyOnWrite("marker","visible")],MarkerLabel.prototype,"markerVisible",2);__decorateClass([ProxyPropertyOnWrite("line","stroke")],MarkerLabel.prototype,"lineStroke",2);__decorateClass([ProxyPropertyOnWrite("line","strokeWidth")],MarkerLabel.prototype,"lineStrokeWidth",2);__decorateClass([ProxyPropertyOnWrite("line","strokeOpacity")],MarkerLabel.prototype,"lineStrokeOpacity",2);__decorateClass([ProxyPropertyOnWrite("line","lineDash")],MarkerLabel.prototype,"lineLineDash",2);__decorateClass([ProxyPropertyOnWrite("line","visible")],MarkerLabel.prototype,"lineVisible",2);var _a99,PaginationLabel=(_a99=class extends BaseProperties{constructor(){super(...arguments),this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}},__name(_a99,"PaginationLabel"),_a99);__decorateClass([Validate(COLOR_STRING)],PaginationLabel.prototype,"color",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],PaginationLabel.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT2,{optional:!0})],PaginationLabel.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationLabel.prototype,"fontSize",2);__decorateClass([Validate(STRING)],PaginationLabel.prototype,"fontFamily",2);var _a100,PaginationMarkerStyle=(_a100=class extends BaseProperties{constructor(){super(...arguments),this.size=15,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=1,this.strokeOpacity=1}},__name(_a100,"PaginationMarkerStyle"),_a100);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationMarkerStyle.prototype,"size",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],PaginationMarkerStyle.prototype,"fill",2);__decorateClass([Validate(RATIO,{optional:!0})],PaginationMarkerStyle.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],PaginationMarkerStyle.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationMarkerStyle.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],PaginationMarkerStyle.prototype,"strokeOpacity",2);var _a101,PaginationMarker=(_a101=class extends BaseProperties{constructor(parent){super(),this.parent=parent,this.shape=Triangle,this.size=15,this.padding=8}},__name(_a101,"PaginationMarker"),_a101);__decorateClass([ActionOnSet({changeValue(){this.parent.marker===this&&this.parent.onMarkerShapeChange()}})],PaginationMarker.prototype,"shape",2);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationMarker.prototype,"size",2);__decorateClass([Validate(POSITIVE_NUMBER)],PaginationMarker.prototype,"padding",2);var _a102,Pagination=(_a102=class extends BaseProperties{constructor(chartUpdateCallback,pageUpdateCallback,regionManager,cursorManager){super(),this.chartUpdateCallback=chartUpdateCallback,this.pageUpdateCallback=pageUpdateCallback,this.regionManager=regionManager,this.cursorManager=cursorManager,this.id=createId(this),this.marker=new PaginationMarker(this),this.activeStyle=new PaginationMarkerStyle,this.inactiveStyle=new PaginationMarkerStyle,this.highlightStyle=new PaginationMarkerStyle,this.label=new PaginationLabel,this.group=new Group({name:"pagination"}),this.labelNode=new Text,this.destroyFns=[],this.totalPages=0,this.currentPage=0,this.translationX=0,this.translationY=0,this.nextButtonDisabled=!1,this.previousButtonDisabled=!1,this._visible=!0,this._enabled=!0,this._orientation="vertical",this._nextButton=new Triangle,this._previousButton=new Triangle,this.labelNode.setProperties({textBaseline:"middle",fontSize:12,fontFamily:"Verdana, sans-serif",fill:"black",y:HdpiCanvas.has.textMetrics?1:0}),this.group.append([this.nextButton,this.previousButton,this.labelNode]);const region=this.regionManager.addRegion("pagination",this.group);this.destroyFns.push(region.addListener("click",event=>this.onPaginationClick(event)),region.addListener("hover",event=>this.onPaginationMouseMove(event))),this.update(),this.updateMarkers()}destroy(){this.destroyFns.forEach(f=>f())}set visible(value){this._visible=value,this.updateGroupVisibility()}get visible(){return this._visible}set enabled(value){this._enabled=value,this.updateGroupVisibility()}get enabled(){return this._enabled}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible}set orientation(value){switch(this._orientation=value,value){case"horizontal":{this.previousButton.rotation=-Math.PI/2,this.nextButton.rotation=Math.PI/2;break}case"vertical":default:this.previousButton.rotation=0,this.nextButton.rotation=Math.PI}}get orientation(){return this._orientation}set nextButton(value){this._nextButton!==value&&(this.group.removeChild(this._nextButton),this._nextButton=value,this.group.appendChild(value))}get nextButton(){return this._nextButton}set previousButton(value){this._previousButton!==value&&(this.group.removeChild(this._previousButton),this._previousButton=value,this.group.appendChild(value))}get previousButton(){return this._previousButton}update(){this.updateLabel(),this.updatePositions(),this.enableOrDisableButtons()}updatePositions(){this.group.translationX=this.translationX,this.group.translationY=this.translationY,this.updateLabelPosition(),this.updateNextButtonPosition()}updateLabelPosition(){const{size:markerSize,padding:markerPadding}=this.marker;this.nextButton.size=markerSize,this.previousButton.size=markerSize,this.labelNode.x=markerSize/2+markerPadding}updateNextButtonPosition(){const labelBBox=this.labelNode.computeBBox();this.nextButton.translationX=labelBBox.x+labelBBox.width+this.marker.size/2+this.marker.padding}updateLabel(){const{currentPage,totalPages:pages,labelNode,label:{color,fontStyle,fontWeight,fontSize,fontFamily}}=this;labelNode.text=`${currentPage+1} / ${pages}`,labelNode.fill=color,labelNode.fontStyle=fontStyle,labelNode.fontWeight=fontWeight,labelNode.fontSize=fontSize,labelNode.fontFamily=fontFamily}updateMarkers(){const{nextButton,previousButton,nextButtonDisabled,previousButtonDisabled,activeStyle,inactiveStyle,highlightStyle,highlightActive}=this,buttonStyle=__name((button,disabled)=>disabled?inactiveStyle:button===highlightActive?highlightStyle:activeStyle,"buttonStyle");this.updateMarker(nextButton,buttonStyle("next",nextButtonDisabled)),this.updateMarker(previousButton,buttonStyle("previous",previousButtonDisabled))}updateMarker(marker,style){var _a201;const{size}=this.marker;marker.size=size,marker.fill=style.fill,marker.fillOpacity=(_a201=style.fillOpacity)!=null?_a201:1,marker.stroke=style.stroke,marker.strokeWidth=style.strokeWidth,marker.strokeOpacity=style.strokeOpacity}enableOrDisableButtons(){const{currentPage,totalPages}=this,zeroPagesToDisplay=totalPages===0,onLastPage=currentPage===totalPages-1,onFirstPage=currentPage===0;this.nextButtonDisabled=onLastPage||zeroPagesToDisplay,this.previousButtonDisabled=onFirstPage||zeroPagesToDisplay}nextButtonContainsPoint(offsetX,offsetY){return!this.nextButtonDisabled&&this.nextButton.containsPoint(offsetX,offsetY)}previousButtonContainsPoint(offsetX,offsetY){return!this.previousButtonDisabled&&this.previousButton.containsPoint(offsetX,offsetY)}onPaginationClick(event){const{offsetX,offsetY}=event;this.nextButtonContainsPoint(offsetX,offsetY)?(this.incrementPage(),this.onPaginationChanged(),event.consume()):this.previousButtonContainsPoint(offsetX,offsetY)&&(this.decrementPage(),this.onPaginationChanged(),event.consume())}onPaginationMouseMove(event){const{offsetX,offsetY}=event;this.nextButtonContainsPoint(offsetX,offsetY)?(this.cursorManager.updateCursor(this.id,"pointer"),this.highlightActive="next"):this.previousButtonContainsPoint(offsetX,offsetY)?(this.cursorManager.updateCursor(this.id,"pointer"),this.highlightActive="previous"):(this.cursorManager.updateCursor(this.id),this.highlightActive=void 0),this.updateMarkers(),this.chartUpdateCallback(6)}onPaginationChanged(){this.pageUpdateCallback(this.currentPage)}incrementPage(){this.currentPage=Math.min(this.currentPage+1,this.totalPages-1)}decrementPage(){this.currentPage=Math.max(this.currentPage-1,0)}onMarkerShapeChange(){const Marker2=getMarker(this.marker.shape||Triangle);this.previousButton=new Marker2,this.nextButton=new Marker2,this.updatePositions(),this.updateMarkers(),this.chartUpdateCallback(6)}attachPagination(node){node.append(this.group)}computeBBox(){return this.group.computeBBox()}},__name(_a102,"Pagination"),_a102);Pagination.className="Pagination";__decorateClass([Validate(OBJECT)],Pagination.prototype,"marker",2);__decorateClass([Validate(OBJECT)],Pagination.prototype,"activeStyle",2);__decorateClass([Validate(OBJECT)],Pagination.prototype,"inactiveStyle",2);__decorateClass([Validate(OBJECT)],Pagination.prototype,"highlightStyle",2);__decorateClass([Validate(OBJECT)],Pagination.prototype,"label",2);var _a103,LegendLabel=(_a103=class extends BaseProperties{constructor(){super(...arguments),this.maxLength=void 0,this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif",this.formatter=void 0}},__name(_a103,"LegendLabel"),_a103);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendLabel.prototype,"maxLength",2);__decorateClass([Validate(COLOR_STRING)],LegendLabel.prototype,"color",2);__decorateClass([Validate(FONT_STYLE,{optional:!0})],LegendLabel.prototype,"fontStyle",2);__decorateClass([Validate(FONT_WEIGHT2,{optional:!0})],LegendLabel.prototype,"fontWeight",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendLabel.prototype,"fontSize",2);__decorateClass([Validate(STRING)],LegendLabel.prototype,"fontFamily",2);__decorateClass([Validate(FUNCTION,{optional:!0})],LegendLabel.prototype,"formatter",2);var _a104,LegendMarker=(_a104=class extends BaseProperties{constructor(){super(...arguments),this.size=15,this.padding=8,this.enabled=!0}},__name(_a104,"LegendMarker"),_a104);__decorateClass([ObserveChanges(target=>{var _a201;return(_a201=target.parent)==null?void 0:_a201.onMarkerShapeChange()})],LegendMarker.prototype,"shape",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendMarker.prototype,"size",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendMarker.prototype,"padding",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendMarker.prototype,"strokeWidth",2);__decorateClass([Validate(BOOLEAN)],LegendMarker.prototype,"enabled",2);var _a105,LegendLine=(_a105=class extends BaseProperties{},__name(_a105,"LegendLine"),_a105);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendLine.prototype,"strokeWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendLine.prototype,"length",2);var _a106,LegendItem=(_a106=class extends BaseProperties{constructor(){super(...arguments),this.paddingX=16,this.paddingY=8,this.toggleSeriesVisible=!0,this.showSeriesStroke=!1,this.marker=new LegendMarker,this.label=new LegendLabel,this.line=new LegendLine}},__name(_a106,"LegendItem"),_a106);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],LegendItem.prototype,"maxWidth",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendItem.prototype,"paddingX",2);__decorateClass([Validate(POSITIVE_NUMBER)],LegendItem.prototype,"paddingY",2);__decorateClass([Validate(BOOLEAN)],LegendItem.prototype,"toggleSeriesVisible",2);__decorateClass([Validate(BOOLEAN)],LegendItem.prototype,"showSeriesStroke",2);__decorateClass([Validate(OBJECT)],LegendItem.prototype,"marker",2);__decorateClass([Validate(OBJECT)],LegendItem.prototype,"label",2);__decorateClass([Validate(OBJECT)],LegendItem.prototype,"line",2);var _a107,LegendListeners=(_a107=class extends BaseProperties{},__name(_a107,"LegendListeners"),_a107);__decorateClass([Validate(FUNCTION,{optional:!0})],LegendListeners.prototype,"legendItemClick",2);__decorateClass([Validate(FUNCTION,{optional:!0})],LegendListeners.prototype,"legendItemDoubleClick",2);var _a108,Legend=(_a108=class extends BaseProperties{constructor(ctx){super(),this.ctx=ctx,this.id=createId(this),this.group=new Group({name:"legend",layer:!0,zIndex:9}),this.itemSelection=Selection.select(this.group,MarkerLabel),this.oldSize=[0,0],this.pages=[],this.maxPageSize=[0,0],this.paginationTrackingIndex=0,this.truncatedItems=new Set,this._data=[],this.item=new LegendItem,this.listeners=new LegendListeners,this.enabled=!0,this.position="bottom",this.spacing=20,this.characterWidths=new Map,this.destroyFns=[],this.size=[0,0],this._visible=!0,this.item.marker.parent=this,this.pagination=new Pagination(type=>ctx.updateService.update(type),page=>this.updatePageNumber(page),ctx.regionManager,ctx.cursorManager),this.pagination.attachPagination(this.group),this.item.marker.parent=this;const animationState=9,region=ctx.regionManager.addRegion("legend",this.group);this.destroyFns.push(region.addListener("click",e=>this.checkLegendClick(e),animationState),region.addListener("dblclick",e=>this.checkLegendDoubleClick(e),animationState),region.addListener("hover",e=>this.handleLegendMouseMove(e)),region.addListener("leave",e=>this.handleLegendMouseExit(e)),ctx.layoutService.addListener("start-layout",e=>this.positionLegend(e.shrinkRect)),()=>this.detachLegend())}set data(value){this._data=value,this.updateGroupVisibility()}get data(){return this._data}destroy(){this.destroyFns.forEach(f=>f()),this.pagination.destroy()}onMarkerShapeChange(){this.itemSelection.clear(),this.group.markDirty(this.group,2)}getOrientation(){if(this.orientation!==void 0)return this.orientation;switch(this.position){case"right":case"left":return"vertical";case"bottom":case"top":return"horizontal"}}getCharacterWidths(font){const{characterWidths}=this;if(characterWidths.has(font))return characterWidths.get(font);const cw={"...":HdpiCanvas.getTextSize("...",font).width};return characterWidths.set(font,cw),cw}set visible(value){this._visible=value,this.updateGroupVisibility()}get visible(){return this._visible}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible&&this.data.length>0}attachLegend(node){node.append(this.group)}detachLegend(){var _a201;(_a201=this.group.parent)==null||_a201.removeChild(this.group)}getItemLabel(datum){const{ctx:{callbackCache}}=this,{formatter}=this.item.label;return formatter?callbackCache.call(formatter,{itemId:datum.itemId,value:datum.label.text,seriesId:datum.seriesId}):datum.label.text}performLayout(width,height){const{paddingX,paddingY,label,maxWidth,marker:{size:markerSize,padding:markerPadding,shape:markerShape},label:{maxLength=1/0,fontStyle,fontWeight,fontSize,fontFamily},line:itemLine,showSeriesStroke}=this.item,data=[...this.data];this.reverseOrder&&data.reverse(),this.itemSelection.update(data);const bboxes=[],font=getFont(label),maxItemWidth=maxWidth??width*.8,paddedMarkerWidth=markerSize+markerPadding+paddingX;if(this.itemSelection.each((markerLabel,datum)=>{var _a201,_b,_c;const Marker2=getMarker(markerShape??datum.marker.shape),markerEnabled=(_a201=datum.marker.enabled)!=null?_a201:this.item.marker.enabled;markerLabel.marker&&markerLabel.marker instanceof Marker2||(markerLabel.marker=new Marker2),markerLabel.markerSize=markerSize,markerLabel.spacing=markerPadding,markerLabel.fontStyle=fontStyle,markerLabel.fontWeight=fontWeight,markerLabel.fontSize=fontSize,markerLabel.fontFamily=fontFamily;const id=(_b=datum.itemId)!=null?_b:datum.id,labelText=this.getItemLabel(datum),text=(labelText??"<unknown>").replace(/\r?\n/g," ");markerLabel.text=this.truncate(text,maxLength,maxItemWidth,paddedMarkerWidth,font,id),showSeriesStroke&&datum.line!==void 0?(markerLabel.lineVisible=!0,markerLabel.markerVisible=markerEnabled,markerLabel.setSeriesStrokeOffset((_c=itemLine.length)!=null?_c:5)):(markerLabel.lineVisible=!1,markerLabel.markerVisible=!0),bboxes.push(markerLabel.computeBBox())}),width=Math.max(1,width),height=Math.max(1,height),!isFinite(width))return!1;const size=this.size,oldSize=this.oldSize;size[0]=width,size[1]=height,(size[0]!==oldSize[0]||size[1]!==oldSize[1])&&(oldSize[0]=size[0],oldSize[1]=size[1]);const{pages,maxPageHeight,maxPageWidth}=this.updatePagination(bboxes,width,height);this.pages=pages,this.maxPageSize=[maxPageWidth-paddingX,maxPageHeight-paddingY];const pageNumber=this.pagination.currentPage,page=this.pages[pageNumber];if(this.pages.length<1||!page){this.visible=!1;return}this.visible=!0,this.updatePositions(pageNumber),this.update()}truncate(text,maxCharLength,maxItemWidth,paddedMarkerWidth,font,id){const ellipsis2="...",textChars=text.split("");let addEllipsis=!1;if(text.length>maxCharLength&&(text=`${text.substring(0,maxCharLength)}`,addEllipsis=!0),Math.floor(paddedMarkerWidth+HdpiCanvas.getTextSize(text,font).width)>maxItemWidth){let truncatedText="";const characterWidths=this.getCharacterWidths(font);let cumulativeWidth=paddedMarkerWidth+characterWidths[ellipsis2];for(const char of textChars){if(characterWidths[char]||(characterWidths[char]=HdpiCanvas.getTextSize(char,font).width),cumulativeWidth+=characterWidths[char],cumulativeWidth>maxItemWidth)break;truncatedText+=char}text=truncatedText,addEllipsis=!0}return addEllipsis?(text+=ellipsis2,this.truncatedItems.add(id)):this.truncatedItems.delete(id),text}updatePagination(bboxes,width,height){const orientation=this.getOrientation(),trackingIndex=Math.min(this.paginationTrackingIndex,bboxes.length);this.pagination.orientation=orientation,this.pagination.translationX=0,this.pagination.translationY=0;const{pages,maxPageHeight,maxPageWidth,paginationBBox,paginationVertical}=this.calculatePagination(bboxes,width,height),newCurrentPage=pages.findIndex(p=>p.endIndex>=trackingIndex);this.pagination.currentPage=clamp(0,newCurrentPage,pages.length-1);const{paddingX:itemPaddingX,paddingY:itemPaddingY}=this.item,paginationComponentPadding=8,legendItemsWidth=maxPageWidth-itemPaddingX,legendItemsHeight=maxPageHeight-itemPaddingY;let paginationX=0,paginationY=-paginationBBox.y-this.item.marker.size/2;return paginationVertical?paginationY+=legendItemsHeight+paginationComponentPadding:(paginationX+=-paginationBBox.x+legendItemsWidth+paginationComponentPadding,paginationY+=(legendItemsHeight-paginationBBox.height)/2),this.pagination.translationX=paginationX,this.pagination.translationY=paginationY,this.pagination.update(),this.pagination.updateMarkers(),{maxPageHeight,maxPageWidth,pages}}calculatePagination(bboxes,width,height){var _a201,_b,_c;const{paddingX:itemPaddingX,paddingY:itemPaddingY}=this.item,orientation=this.getOrientation(),paginationVertical=["left","right"].includes(this.position);let paginationBBox=this.pagination.computeBBox(),lastPassPaginationBBox=new BBox(0,0,0,0),pages=[],maxPageWidth=0,maxPageHeight=0,count2=0;const stableOutput=__name(lastPassPaginationBBox2=>{const{width:width2,height:height2}=lastPassPaginationBBox2;return width2===paginationBBox.width&&height2===paginationBBox.height},"stableOutput"),forceResult=this.maxWidth!==void 0||this.maxHeight!==void 0;do{if(count2++>10){Logger.warn("unable to find stable legend layout.");break}paginationBBox=lastPassPaginationBBox;const maxWidth=width-(paginationVertical?0:paginationBBox.width),maxHeight=height-(paginationVertical?paginationBBox.height:0),layout=gridLayout({orientation,bboxes,maxHeight,maxWidth,itemPaddingY,itemPaddingX,forceResult});pages=(_a201=layout==null?void 0:layout.pages)!=null?_a201:[],maxPageWidth=(_b=layout==null?void 0:layout.maxPageWidth)!=null?_b:0,maxPageHeight=(_c=layout==null?void 0:layout.maxPageHeight)!=null?_c:0;const totalPages=pages.length;if(this.pagination.visible=totalPages>1,this.pagination.totalPages=totalPages,this.pagination.update(),lastPassPaginationBBox=this.pagination.computeBBox(),!this.pagination.visible)break}while(!stableOutput(lastPassPaginationBBox));return{maxPageWidth,maxPageHeight,pages,paginationBBox,paginationVertical}}updatePositions(pageNumber=0){const{item:{paddingY},itemSelection,pages}=this;if(pages.length<1||!pages[pageNumber])return;const{columns,startIndex:visibleStart,endIndex:visibleEnd}=pages[pageNumber];let x=0,y=0;const columnCount=columns.length,rowCount=columns[0].indices.length,horizontal=this.getOrientation()==="horizontal",itemHeight=columns[0].bboxes[0].height+paddingY,rowSumColumnWidths=[];itemSelection.each((markerLabel,_,i)=>{var _a201,_b;if(i<visibleStart||i>visibleEnd){markerLabel.visible=!1;return}const pageIndex=i-visibleStart;let columnIndex=0,rowIndex=0;horizontal?(columnIndex=pageIndex%columnCount,rowIndex=Math.floor(pageIndex/columnCount)):(columnIndex=Math.floor(pageIndex/rowCount),rowIndex=pageIndex%rowCount),markerLabel.visible=!0;const column=columns[columnIndex];column&&(y=itemHeight*rowIndex,x=(_a201=rowSumColumnWidths[rowIndex])!=null?_a201:0,rowSumColumnWidths[rowIndex]=((_b=rowSumColumnWidths[rowIndex])!=null?_b:0)+column.columnWidth,markerLabel.translationX=Math.floor(x),markerLabel.translationY=Math.floor(y))})}updatePageNumber(pageNumber){const{pages}=this,{startIndex,endIndex}=pages[pageNumber];startIndex===0?this.paginationTrackingIndex=0:pageNumber===pages.length-1?this.paginationTrackingIndex=endIndex:this.paginationTrackingIndex=Math.floor((startIndex+endIndex)/2),this.pagination.update(),this.pagination.updateMarkers(),this.updatePositions(pageNumber),this.ctx.updateService.update(6)}update(){const{label:{color},marker:itemMarker,line:itemLine,showSeriesStroke}=this.item;this.itemSelection.each((markerLabel,datum)=>{var _a201,_b;const marker=datum.marker;markerLabel.markerFill=marker.fill,markerLabel.markerStroke=marker.stroke,markerLabel.markerStrokeWidth=(_a201=itemMarker.strokeWidth)!=null?_a201:Math.min(2,marker.strokeWidth),markerLabel.markerFillOpacity=marker.fillOpacity,markerLabel.markerStrokeOpacity=marker.strokeOpacity,markerLabel.opacity=datum.enabled?1:.5,markerLabel.color=color;const{line}=datum;showSeriesStroke&&line!==void 0&&(markerLabel.lineStroke=line.stroke,markerLabel.lineStrokeOpacity=line.strokeOpacity,markerLabel.lineStrokeWidth=(_b=itemLine.strokeWidth)!=null?_b:Math.min(2,line.strokeWidth),markerLabel.lineLineDash=line.lineDash)})}getDatumForPoint(x,y){const visibleChildBBoxes=[],closestLeftTop={dist:1/0,datum:void 0};for(const child of this.group.children){if(!child.visible||!(child instanceof MarkerLabel))continue;const childBBox=child.computeBBox();if(childBBox.grow(this.item.paddingX/2,"horizontal"),childBBox.grow(this.item.paddingY/2,"vertical"),childBBox.containsPoint(x,y))return child.datum;const distX=x-childBBox.x-this.item.paddingX/2,distY=y-childBBox.y-this.item.paddingY/2,dist=__pow(distX,2)+__pow(distY,2);distX>=0&&distY>=0&&dist<closestLeftTop.dist&&(closestLeftTop.dist=dist,closestLeftTop.datum=child.datum),visibleChildBBoxes.push(childBBox)}if(BBox.merge(visibleChildBBoxes).containsPoint(x,y))return closestLeftTop.datum}computePagedBBox(){const actualBBox=this.group.computeBBox();if(this.pages.length<=1)return actualBBox;const[maxPageWidth,maxPageHeight]=this.maxPageSize;return actualBBox.height=Math.max(maxPageHeight,actualBBox.height),actualBBox.width=Math.max(maxPageWidth,actualBBox.width),actualBBox}checkLegendClick(event){const{listeners:{legendItemClick},ctx:{chartService,highlightManager},item:{toggleSeriesVisible},preventHidingAll}=this,datum=this.getDatumForPoint(event.offsetX,event.offsetY);if(!datum)return;const{id,itemId,enabled}=datum,series=chartService.series.find(s=>s.id===id);if(!series)return;event.consume();let newEnabled=enabled;toggleSeriesVisible&&(newEnabled=!enabled,preventHidingAll&&!newEnabled&&chartService.series.flatMap(series2=>series2.getLegendData("category")).filter(datum2=>datum2.enabled).length<2&&(newEnabled=!0),this.ctx.chartEventManager.legendItemClick(series,itemId,newEnabled,datum.legendItemName)),newEnabled?highlightManager.updateHighlight(this.id,{series,itemId,datum:void 0}):highlightManager.updateHighlight(this.id),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),legendItemClick==null||legendItemClick({type:"click",enabled:newEnabled,itemId,seriesId:series.id})}checkLegendDoubleClick(event){var _a201;const{listeners:{legendItemDoubleClick},ctx:{chartService},item:{toggleSeriesVisible}}=this;if(chartService.mode==="integrated")return;const datum=this.getDatumForPoint(event.offsetX,event.offsetY);if(!datum)return;const{id,itemId,seriesId}=datum,series=chartService.series.find(s=>s.id===id);if(series){if(event.consume(),toggleSeriesVisible){const legendData=chartService.series.flatMap(series2=>series2.getLegendData("category")),numVisibleItems=legendData.filter(datum2=>datum2.enabled).length,clickedItem=legendData.find(d=>d.itemId===itemId&&d.seriesId===seriesId);this.ctx.chartEventManager.legendItemDoubleClick(series,itemId,(_a201=clickedItem==null?void 0:clickedItem.enabled)!=null?_a201:!1,numVisibleItems,clickedItem==null?void 0:clickedItem.legendItemName)}this.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),legendItemDoubleClick==null||legendItemDoubleClick({type:"dblclick",enabled:!0,itemId,seriesId:series.id})}}handleLegendMouseMove(event){var _a201;const{enabled,item:{toggleSeriesVisible},listeners}=this;if(!enabled)return;const{offsetX,offsetY}=event;event.consume();const datum=this.getDatumForPoint(offsetX,offsetY);if(datum===void 0){this.ctx.cursorManager.updateCursor(this.id),this.ctx.highlightManager.updateHighlight(this.id);return}const series=datum?this.ctx.chartService.series.find(series2=>series2.id===(datum==null?void 0:datum.id)):void 0;datum&&this.truncatedItems.has((_a201=datum.itemId)!=null?_a201:datum.id)?this.ctx.tooltipManager.updateTooltip(this.id,{offsetX,offsetY,lastPointerEvent:event,showArrow:!1,addCustomClass:!1},toTooltipHtml({content:this.getItemLabel(datum)})):this.ctx.tooltipManager.removeTooltip(this.id),(toggleSeriesVisible||listeners.legendItemClick!=null||listeners.legendItemDoubleClick!=null)&&this.ctx.cursorManager.updateCursor(this.id,"pointer"),datum!=null&&datum.enabled&&series?this.ctx.highlightManager.updateHighlight(this.id,{series,itemId:datum==null?void 0:datum.itemId,datum:void 0}):this.ctx.highlightManager.updateHighlight(this.id)}handleLegendMouseExit(_event){this.ctx.cursorManager.updateCursor(this.id),this.ctx.highlightManager.updateHighlight(this.id),this.ctx.tooltipManager.removeTooltip(this.id)}positionLegend(shrinkRect){const newShrinkRect=shrinkRect.clone();if(!this.enabled||!this.data.length)return{shrinkRect:newShrinkRect};const[legendWidth,legendHeight]=this.calculateLegendDimensions(shrinkRect);this.group.translationX=0,this.group.translationY=0,this.performLayout(legendWidth,legendHeight);const legendBBox=this.computePagedBBox(),calculateTranslationPerpendicularDimension=__name(()=>{switch(this.position){case"top":case"left":return 0;case"bottom":return shrinkRect.height-legendBBox.height;case"right":default:return shrinkRect.width-legendBBox.width}},"calculateTranslationPerpendicularDimension");if(this.visible){let translationX,translationY;switch(this.position){case"top":case"bottom":translationX=(shrinkRect.width-legendBBox.width)/2,translationY=calculateTranslationPerpendicularDimension(),newShrinkRect.shrink(legendBBox.height,this.position);break;case"left":case"right":default:translationX=calculateTranslationPerpendicularDimension(),translationY=(shrinkRect.height-legendBBox.height)/2,newShrinkRect.shrink(legendBBox.width,this.position)}this.group.translationX=Math.floor(-legendBBox.x+shrinkRect.x+translationX),this.group.translationY=Math.floor(-legendBBox.y+shrinkRect.y+translationY)}if(this.visible&&this.enabled&&this.data.length){const legendPadding=this.spacing;newShrinkRect.shrink(legendPadding,this.position);const legendPositionedBBox=legendBBox.clone();legendPositionedBBox.x+=this.group.translationX,legendPositionedBBox.y+=this.group.translationY,this.ctx.tooltipManager.updateExclusiveRect(this.id,legendPositionedBBox)}else this.ctx.tooltipManager.updateExclusiveRect(this.id);return{shrinkRect:newShrinkRect}}calculateLegendDimensions(shrinkRect){const{width,height}=shrinkRect,aspectRatio=width/height,maxCoefficient=.5,minHeightCoefficient=.2,minWidthCoefficient=.25;let legendWidth,legendHeight;switch(this.position){case"top":case"bottom":const heightCoefficient=aspectRatio<1?Math.min(maxCoefficient,minHeightCoefficient*(1/aspectRatio)):minHeightCoefficient;legendWidth=this.maxWidth?Math.min(this.maxWidth,width):width,legendHeight=this.maxHeight?Math.min(this.maxHeight,height):Math.round(height*heightCoefficient);break;case"left":case"right":default:const widthCoefficient=aspectRatio>1?Math.min(maxCoefficient,minWidthCoefficient*aspectRatio):minWidthCoefficient;legendWidth=this.maxWidth?Math.min(this.maxWidth,width):Math.round(width*widthCoefficient),legendHeight=this.maxHeight?Math.min(this.maxHeight,height):height}return[legendWidth,legendHeight]}},__name(_a108,"Legend"),_a108);Legend.className="Legend";__decorateClass([Validate(OBJECT)],Legend.prototype,"pagination",2);__decorateClass([Validate(OBJECT)],Legend.prototype,"item",2);__decorateClass([Validate(OBJECT)],Legend.prototype,"listeners",2);__decorateClass([ObserveChanges(target=>target.updateGroupVisibility()),Validate(BOOLEAN)],Legend.prototype,"enabled",2);__decorateClass([Validate(POSITION2)],Legend.prototype,"position",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Legend.prototype,"maxWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Legend.prototype,"maxHeight",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],Legend.prototype,"reverseOrder",2);__decorateClass([Validate(UNION(["horizontal","vertical"],"an orientation"),{optional:!0})],Legend.prototype,"orientation",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],Legend.prototype,"preventHidingAll",2);__decorateClass([Validate(POSITIVE_NUMBER)],Legend.prototype,"spacing",2);var CARTESIAN_AXIS_POSITIONS=["top","right","bottom","left"],CARTESIAN_AXIS_TYPES=["category","grouped-category","number","log","time"];function hasCartesianAxisPosition(axis){return CARTESIAN_AXIS_TYPES.includes(axis.type)}__name(hasCartesianAxisPosition,"hasCartesianAxisPosition");function isCartesianAxisOptions(options){return CARTESIAN_AXIS_TYPES.includes(options.type)}__name(isCartesianAxisOptions,"isCartesianAxisOptions");function isAxisPosition(position){return typeof position=="string"&&CARTESIAN_AXIS_POSITIONS.includes(position)}__name(isAxisPosition,"isAxisPosition");var _a109,AxisPositionGuesser=(_a109=class{constructor(){this.result=[],this.valid=[],this.invalid=[]}push(axis,options){const{result,valid,invalid}=this;isCartesianAxisOptions(options)&&(isAxisPosition(options.position)?valid.push(axis):invalid.push(axis)),result.push(axis)}guessInvalidPositions(){const takenPosition=this.valid.filter(v=>hasCartesianAxisPosition(v)).map(v=>v.position).filter(v=>v!==void 0),guesses=["top","right","bottom","left"];for(const invalidAxis of this.invalid){let nextGuess=guesses.pop();for(;takenPosition.includes(nextGuess)&&nextGuess!==void 0;)nextGuess=guesses.pop();if(nextGuess===void 0)break;invalidAxis.position=nextGuess}return this.result}},__name(_a109,"AxisPositionGuesser"),_a109);function matchSeriesOptions(series,optSeries,oldOptsSeries){var _a201,_b,_c;const keysToConsider=["direction","xKey","yKey","sizeKey","angleKey","radiusKey","normalizedTo"],generateKey=__name((type,i)=>{const result=[type];for(const key of keysToConsider)key in i&&i[key]!=null&&result.push(`${key}=${i[key]}`);return result.join(";")},"generateKey"),seriesMap=new Map;let idx=0;for(const s of series){const key=generateKey(s.type,s.properties);seriesMap.has(key)||seriesMap.set(key,[]),(_a201=seriesMap.get(key))==null||_a201.push([s,idx++])}const optsMap=new Map;for(const o of optSeries){const key=generateKey(o.type,o);optsMap.has(key)||optsMap.set(key,[]),(_b=optsMap.get(key))==null||_b.push(o)}if(![...seriesMap.keys()].some(k=>optsMap.has(k)))return{status:"no-overlap",oldKeys:seriesMap.keys(),newKeys:optsMap.keys()};const changes=[];let targetIdx=-1;for(const[key,optArray]of optsMap.entries())for(const opts of optArray){targetIdx++;const seriesArray=seriesMap.get(key);if(seriesArray==null||seriesArray.length<1){changes.push({opts,idx:targetIdx,status:"add"}),seriesMap.delete(key);continue}const[series2,idx2]=seriesArray.shift(),previousOpts=(_c=oldOptsSeries==null?void 0:oldOptsSeries[idx2])!=null?_c:{},diff2=jsonDiff(previousOpts,opts??{});diff2?changes.push({opts,series:series2,diff:diff2,idx:idx2,status:"update"}):changes.push({opts,series:series2,idx:idx2,status:"no-op"}),seriesArray.length===0&&seriesMap.delete(key)}for(const seriesArray of seriesMap.values())for(const[series2,idx2]of seriesArray)changes.push({series:series2,idx:idx2,status:"remove"});return{status:"overlap",changes}}__name(matchSeriesOptions,"matchSeriesOptions");var DEFAULT_OVERLAY_CLASS="ag-chart-overlay",DEFAULT_OVERLAY_DARK_CLASS="ag-chart-dark-overlay",_a110,Overlay=(_a110=class{constructor(className,parentElement,animationManager){this.className=className,this.parentElement=parentElement,this.animationManager=animationManager,this.darkTheme=!1}show(rect){var _a201,_b;this.element||(this.element=this.createElement("div"),this.element.classList.add(this.className,DEFAULT_OVERLAY_CLASS)),this.element.classList.toggle(DEFAULT_OVERLAY_DARK_CLASS,this.darkTheme);const{element:element2}=this;if(element2.style.position="absolute",element2.style.left=`${rect.x}px`,element2.style.top=`${rect.y}px`,element2.style.width=`${rect.width}px`,element2.style.height=`${rect.height}px`,this.renderer)element2.innerHTML=this.renderer();else{const content=this.createElement("div");content.style.alignItems="center",content.style.boxSizing="border-box",content.style.display="flex",content.style.justifyContent="center",content.style.margin="8px",content.style.height="100%",content.style.font="12px Verdana, sans-serif",content.innerText=(_a201=this.text)!=null?_a201:"No data to display",element2.replaceChildren(content),this.animationManager.animate({from:0,to:1,phase:"add",id:"overlay",groupId:"opacity",onUpdate(value){element2.style.opacity=String(value)},onStop(){element2.style.opacity="1"}})}(_b=this.parentElement)==null||_b.append(element2)}hide(){if(!this.element)return;const element2=this.element;this.animationManager.animate({from:1,to:0,phase:"remove",id:"overlay",groupId:"opacity",onUpdate(value){element2.style.opacity=String(value)},onStop(){element2.remove()}}),this.element=void 0}createElement(tagName,options){return this.parentElement.ownerDocument.createElement(tagName,options)}},__name(_a110,"Overlay"),_a110);__decorateClass([Validate(FUNCTION,{optional:!0})],Overlay.prototype,"renderer",2);__decorateClass([Validate(STRING,{optional:!0})],Overlay.prototype,"text",2);__decorateClass([Validate(BOOLEAN)],Overlay.prototype,"darkTheme",2);var defaultOverlayCss=`
.${DEFAULT_OVERLAY_CLASS} {
    color: #181d1f;
}

.${DEFAULT_OVERLAY_CLASS}.${DEFAULT_OVERLAY_DARK_CLASS} {
    color: #ffffff;
}

.${DEFAULT_OVERLAY_CLASS}--loading {
    color: rgb(140, 140, 140); /* DEFAULT_MUTED_LABEL_COLOUR */
}

.${DEFAULT_OVERLAY_CLASS}__loading-background {
    background: white; /* DEFAULT_BACKGROUND_FILL */
}

.${DEFAULT_OVERLAY_CLASS}.${DEFAULT_OVERLAY_DARK_CLASS} .${DEFAULT_OVERLAY_CLASS}__loading-background {
    background: #192232; /* DEFAULT_DARK_BACKGROUND_FILL */
}
`,_a111,_ChartOverlays=(_a111=class{constructor(parent,animationManager){this.loading=new Overlay("ag-chart-loading-overlay",parent,animationManager),this.loading.text="Loading data...",this.loading.renderer=()=>this.renderLoadingSpinner(parent,animationManager),this.noData=new Overlay("ag-chart-no-data-overlay",parent,animationManager),this.noVisibleSeries=new Overlay("ag-chart-no-visible-series",parent,animationManager),this.noVisibleSeries.text="No visible series",_a111.overlayDocuments.indexOf(parent.ownerDocument)<0&&(injectStyle(parent.ownerDocument,defaultOverlayCss),_a111.overlayDocuments.push(parent.ownerDocument))}destroy(){this.loading.hide(),this.noData.hide(),this.noVisibleSeries.hide()}renderLoadingSpinner(parent,animationManager){var _a201;const container=this.createElement(parent,"div");container.className=`${DEFAULT_OVERLAY_CLASS}--loading`,container.style.display="flex",container.style.alignItems="center",container.style.justifyContent="center",container.style.flexDirection="column",container.style.height="100%",container.style.boxSizing="border-box",container.style.font="13px Verdana, sans-serif",container.style.userSelect="none",container.style.animation=`ag-charts-loading ${ADD_PHASE.animationDuration*animationManager.defaultDuration}ms linear 50ms both`;const matrix=this.createElement(container,"span");matrix.style.width="45px",matrix.style.height="40px",matrix.style.backgroundImage=`${["linear-gradient(#0000 calc(1 * 100% / 6), #ccc 0 calc(3 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(2 * 100% / 6), #ccc 0 calc(4 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(3 * 100% / 6), #ccc 0 calc(5 * 100% / 6), #0000 0)"].join("")}`,matrix.style.backgroundSize="10px 400%",matrix.style.backgroundRepeat="no-repeat",matrix.style.animation="ag-charts-loading-matrix 1s infinite linear";const label=this.createElement(container,"p");label.style.marginTop="1em",label.innerText=(_a201=this.loading.text)!=null?_a201:"Loading data...";const background=this.createElement(parent,"div");background.className=`${DEFAULT_OVERLAY_CLASS}__loading-background`,background.style.position="absolute",background.style.top="0",background.style.right="0",background.style.bottom="0",background.style.left="0",background.style.opacity="0.5",background.style.zIndex="-1";const animationStyles=this.createElement(container,"style");return animationStyles.innerText=["@keyframes ag-charts-loading { from { opacity: 0 } to { opacity: 1 } }","@keyframes ag-charts-loading-matrix {","0% { background-position: 0% 0%, 50% 0%, 100% 0%; }","100% { background-position: 0% 100%, 50% 100%, 100% 100%; }","}"].join(" "),container.replaceChildren(animationStyles,matrix,label,background),container.outerHTML}createElement(parent,tagName,options){return parent.ownerDocument.createElement(tagName,options)}},__name(_a111,"_ChartOverlays"),_a111);_ChartOverlays.overlayDocuments=[];var ChartOverlays=_ChartOverlays;function sumValues(values,accumulator=[0,0]){for(const value of values)typeof value=="number"&&(value<0&&(accumulator[0]+=value),value>0&&(accumulator[1]+=value));return accumulator}__name(sumValues,"sumValues");function sum(scope,id,matchGroupId){return{id,scopes:[scope.id],matchGroupIds:[matchGroupId],type:"aggregate",aggregateFunction:values=>sumValues(values)}}__name(sum,"sum");function groupSum(scope,id,matchGroupId){return{id,scopes:[scope.id],type:"aggregate",matchGroupIds:matchGroupId?[matchGroupId]:void 0,aggregateFunction:values=>sumValues(values),groupAggregateFunction:(next,acc=[0,0])=>{var _a201,_b;return acc[0]+=(_a201=next==null?void 0:next[0])!=null?_a201:0,acc[1]+=(_b=next==null?void 0:next[1])!=null?_b:0,acc}}}__name(groupSum,"groupSum");function range2(scope,id,matchGroupId){return{id,scopes:[scope.id],matchGroupIds:[matchGroupId],type:"aggregate",aggregateFunction:values=>extendDomain(values)}}__name(range2,"range2");function count(scope,id){return{id,scopes:[scope.id],type:"aggregate",aggregateFunction:()=>[0,1]}}__name(count,"count");function groupCount(scope,id){return{id,scopes:[scope.id],type:"aggregate",aggregateFunction:()=>[0,1],groupAggregateFunction:(next,acc=[0,0])=>{var _a201,_b;return acc[0]+=(_a201=next==null?void 0:next[0])!=null?_a201:0,acc[1]+=(_b=next==null?void 0:next[1])!=null?_b:0,acc}}}__name(groupCount,"groupCount");function average(scope,id,matchGroupId){return{id,scopes:[scope.id],matchGroupIds:[matchGroupId],type:"aggregate",aggregateFunction:values=>sumValues(values).map(v=>v/values.length)}}__name(average,"average");function groupAverage(scope,id,matchGroupId){return{id,scopes:[scope.id],matchGroupIds:matchGroupId?[matchGroupId]:void 0,type:"aggregate",aggregateFunction:values=>sumValues(values),groupAggregateFunction:(next,acc=[0,0,-1])=>{var _a201,_b;return acc[0]+=(_a201=next==null?void 0:next[0])!=null?_a201:0,acc[1]+=(_b=next==null?void 0:next[1])!=null?_b:0,acc[2]++,acc},finalFunction:(acc=[0,0,0])=>{const result2=acc[0]+acc[1];return result2>=0?[0,result2/acc[2]]:[result2/acc[2],0]}}}__name(groupAverage,"groupAverage");function area(scope,id,aggFn,matchGroupId){const result={id,scopes:[scope.id],matchGroupIds:matchGroupId?[matchGroupId]:void 0,type:"aggregate",aggregateFunction:(values,keyRange=[])=>{const keyWidth=keyRange[1]-keyRange[0];return aggFn.aggregateFunction(values).map(v=>v/keyWidth)}};return aggFn.groupAggregateFunction&&(result.groupAggregateFunction=aggFn.groupAggregateFunction),result}__name(area,"area");function accumulatedValue(onlyPositive){return()=>{let value=0;return datum=>isFiniteNumber(datum)?(value+=onlyPositive?Math.max(0,datum):datum,value):datum}}__name(accumulatedValue,"accumulatedValue");function trailingAccumulatedValue(){return()=>{let value=0;return datum=>{if(!isFiniteNumber(datum))return datum;const trailingValue2=value;return value+=datum,trailingValue2}}}__name(trailingAccumulatedValue,"trailingAccumulatedValue");var memorizedFns=new Map;function memo(params,fnGenerator){var _a201,_b,_c;const serialisedParams=JSON.stringify(params,null,0);return memorizedFns.has(fnGenerator)||memorizedFns.set(fnGenerator,new Map),(_a201=memorizedFns.get(fnGenerator))!=null&&_a201.has(serialisedParams)||(_b=memorizedFns.get(fnGenerator))==null||_b.set(serialisedParams,fnGenerator(params)),(_c=memorizedFns.get(fnGenerator))==null?void 0:_c.get(serialisedParams)}__name(memo,"memo");var SMALLEST_KEY_INTERVAL={type:"reducer",property:"smallestKeyInterval",initialValue:1/0,reducer:()=>{let prevX=NaN;return(smallestSoFar=1/0,next)=>{const nextX=next.keys[0],interval=Math.abs(nextX-prevX);return prevX=nextX,!isNaN(interval)&&interval>0&&interval<smallestSoFar?interval:smallestSoFar}}},AGG_VALUES_EXTENT={type:"processor",property:"aggValuesExtent",calculate:processedData=>{var _a201,_b,_c,_d;const result=[...(_b=(_a201=processedData.domain.aggValues)==null?void 0:_a201[0])!=null?_b:[0,0]];for(const[min,max]of(_d=(_c=processedData.domain.aggValues)==null?void 0:_c.slice(1))!=null?_d:[])min<result[0]&&(result[0]=min),max>result[1]&&(result[1]=max);return result}},SORT_DOMAIN_GROUPS={type:"processor",property:"sortedGroupDomain",calculate:({domain:{groups}})=>{if(groups!=null)return[...groups].sort((a,b)=>{for(let i=0;i<a.length;i++){const result=a[i]-b[i];if(result!==0)return result}return 0})}};function normaliseFnBuilder({normaliseTo,mode}){const normalise=__name((val,extent2)=>{const result=val*normaliseTo/extent2;return result>=0?Math.min(normaliseTo,result):Math.max(-normaliseTo,result)},"normalise");return()=>()=>(values,valueIndexes)=>{const valuesExtent=[0,0];for(const valueIdx of valueIndexes){const value=values[valueIdx],valIdx=value<0?0:1;mode==="sum"?valuesExtent[valIdx]+=value:valIdx===0?valuesExtent[valIdx]=Math.min(valuesExtent[valIdx],value):valuesExtent[valIdx]=Math.max(valuesExtent[valIdx],value)}const extent2=Math.max(Math.abs(valuesExtent[0]),valuesExtent[1]);for(const valueIdx of valueIndexes)values[valueIdx]=normalise(values[valueIdx],extent2)}}__name(normaliseFnBuilder,"normaliseFnBuilder");function normaliseGroupTo(scope,matchGroupIds,normaliseTo,mode="sum"){return{scopes:[scope.id],type:"group-value-processor",matchGroupIds,adjust:memo({normaliseTo,mode},normaliseFnBuilder)}}__name(normaliseGroupTo,"normaliseGroupTo");function normalisePropertyFnBuilder({normaliseTo,zeroDomain,rangeMin,rangeMax}){const normaliseSpan=normaliseTo[1]-normaliseTo[0],normalise=__name((val,start,span)=>{const result=normaliseTo[0]+(val-start)/span*normaliseSpan;return span===0?zeroDomain:result>=normaliseTo[1]?normaliseTo[1]:result<normaliseTo[0]?normaliseTo[0]:result},"normalise");return()=>(pData,pIdx)=>{let[start,end]=pData.domain.values[pIdx];rangeMin!=null&&(start=rangeMin),rangeMax!=null&&(end=rangeMax);const span=end-start;pData.domain.values[pIdx]=[normaliseTo[0],normaliseTo[1]];for(const group2 of pData.data){let groupValues=group2.values;pData.type==="ungrouped"&&(groupValues=[groupValues]);for(const values of groupValues)values[pIdx]=normalise(values[pIdx],start,span)}}}__name(normalisePropertyFnBuilder,"normalisePropertyFnBuilder");function normalisePropertyTo(scope,property,normaliseTo,zeroDomain,rangeMin,rangeMax){return{scopes:[scope.id],type:"property-value-processor",property,adjust:memo({normaliseTo,rangeMin,rangeMax,zeroDomain},normalisePropertyFnBuilder)}}__name(normalisePropertyTo,"normalisePropertyTo");function animationValidation(scope,valueKeyIds=[]){return{type:"processor",scopes:[scope.id],property:"animationValidation",calculate(result){var _a201;const{keys,values}=result.defs,{input,data}=result;let uniqueKeys=!0,orderedKeys=!0;const valueKeys=[];for(let k=0;k<values.length;k++)(_a201=values[k].scopes)!=null&&_a201.some(s=>s===scope.id)&&valueKeyIds.some(v=>values[k].id===v)&&valueKeys.push([k,values[k]]);const processKey=__name((idx,def,type)=>{var _a210;if(def.valueType==="category"){const keyValues=result.domain[type][idx];uniqueKeys&&(uniqueKeys=keyValues.length===input.count);return}let lastValue=(_a210=data[0])==null?void 0:_a210[type][idx];for(let d=1;(uniqueKeys||orderedKeys)&&d<data.length;d++){const keyValue=data[d][type][idx];orderedKeys&&(orderedKeys=lastValue<=keyValue),uniqueKeys&&(uniqueKeys=lastValue!==keyValue),lastValue=keyValue}},"processKey");for(let k=0;(uniqueKeys||orderedKeys)&&k<keys.length;k++)processKey(k,keys[k],"keys");for(let k=0;(uniqueKeys||orderedKeys)&&k<valueKeys.length;k++){const[idx,key]=valueKeys[k];processKey(idx,key,"values")}return{uniqueKeys,orderedKeys}}}}__name(animationValidation,"animationValidation");function buildGroupAccFn({mode,separateNegative}){return()=>()=>(values,valueIndexes)=>{const acc=[0,0];for(const valueIdx of valueIndexes){const currentVal=values[valueIdx],accIndex=isNegative(currentVal)&&separateNegative?0:1;isFiniteNumber(currentVal)&&(mode==="normal"&&(acc[accIndex]+=currentVal),values[valueIdx]=acc[accIndex],mode==="trailing"&&(acc[accIndex]+=currentVal))}}}__name(buildGroupAccFn,"buildGroupAccFn");function buildGroupWindowAccFn({mode,sum:sum2}){return()=>{const lastValues=[];let firstRow=!0;return()=>(values,valueIndexes)=>{let acc=0;for(const valueIdx of valueIndexes){const currentVal=values[valueIdx],lastValue=firstRow&&sum2==="current"?0:lastValues[valueIdx];lastValues[valueIdx]=currentVal;const sumValue=sum2==="current"?currentVal:lastValue;if(!isFiniteNumber(currentVal)||!isFiniteNumber(lastValue)){values[valueIdx]=acc;continue}mode==="normal"&&(acc+=sumValue),values[valueIdx]=acc,mode==="trailing"&&(acc+=sumValue)}firstRow=!1}}}__name(buildGroupWindowAccFn,"buildGroupWindowAccFn");function accumulateGroup(scope,matchGroupId,mode,sum2,separateNegative=!1){let adjust;if(mode.startsWith("window")){const modeParam=mode.endsWith("-trailing")?"trailing":"normal";adjust=memo({mode:modeParam,sum:sum2},buildGroupWindowAccFn)}else adjust=memo({mode,separateNegative},buildGroupAccFn);return{scopes:[scope.id],type:"group-value-processor",matchGroupIds:[matchGroupId],adjust}}__name(accumulateGroup,"accumulateGroup");function diff(previousData,updateMovedDatums=!0){return{type:"processor",property:"diff",calculate:processedData=>{const diff2={changed:!1,moved:[],added:[],updated:[],removed:[],addedIndices:[],updatedIndices:[],removedIndices:[]},moved=new Map,added=new Map,updated=new Map,removed=new Map,addedIndices=new Map,updatedIndices=new Map,removedIndices=new Map;for(let i=0;i<Math.max(previousData.data.length,processedData.data.length);i++){const prev=previousData.data[i],datum=processedData.data[i],prevId=prev?createDatumId(prev.keys):"",datumId=datum?createDatumId(datum.keys):"";if(prevId===datumId){arraysEqual(prev.values,datum.values)||(updated.set(datumId,datum),updatedIndices.set(datumId,i));continue}removed.has(datumId)?((updateMovedDatums||!arraysEqual(removed.get(datumId).values,datum.values))&&(updated.set(datumId,datum),updatedIndices.set(datumId,i),moved.set(datumId,datum)),removed.delete(datumId),removedIndices.delete(datumId)):datum&&(added.set(datumId,datum),addedIndices.set(datumId,i)),added.has(prevId)?((updateMovedDatums||!arraysEqual(added.get(prevId).values,prev.values))&&(updated.set(prevId,prev),updatedIndices.set(prevId,i),moved.set(prevId,prev)),added.delete(prevId),addedIndices.delete(prevId)):prev&&(updated.delete(prevId),updatedIndices.delete(prevId),removed.set(prevId,prev),removedIndices.set(prevId,i))}return diff2.added=Array.from(added.keys()),diff2.updated=Array.from(updated.keys()),diff2.removed=Array.from(removed.keys()),diff2.moved=Array.from(moved.keys()),diff2.addedIndices=Array.from(addedIndices.values()),diff2.updatedIndices=Array.from(updatedIndices.values()),diff2.removedIndices=Array.from(removedIndices.values()),diff2.changed=diff2.added.length>0||diff2.updated.length>0||diff2.removed.length>0,diff2}}}__name(diff,"diff");function createDatumId(keys){return isArray(keys)?keys.map(key=>transformIntegratedCategoryValue(key)).join("___"):transformIntegratedCategoryValue(keys)}__name(createDatumId,"createDatumId");var SeriesNodePickMode=(SeriesNodePickMode2=>(SeriesNodePickMode2[SeriesNodePickMode2.EXACT_SHAPE_MATCH=0]="EXACT_SHAPE_MATCH",SeriesNodePickMode2[SeriesNodePickMode2.NEAREST_BY_MAIN_AXIS_FIRST=1]="NEAREST_BY_MAIN_AXIS_FIRST",SeriesNodePickMode2[SeriesNodePickMode2.NEAREST_BY_MAIN_CATEGORY_AXIS_FIRST=2]="NEAREST_BY_MAIN_CATEGORY_AXIS_FIRST",SeriesNodePickMode2[SeriesNodePickMode2.NEAREST_NODE=3]="NEAREST_NODE",SeriesNodePickMode2))(SeriesNodePickMode||{});function basicContinuousCheckDatumValidation(v){return checkDatum(v,!0)!=null}__name(basicContinuousCheckDatumValidation,"basicContinuousCheckDatumValidation");function basicDiscreteCheckDatumValidation(v){return checkDatum(v,!1)!=null}__name(basicDiscreteCheckDatumValidation,"basicDiscreteCheckDatumValidation");function keyProperty(scope,propName,continuous,opts={}){return __spreadValues({scopes:[scope.id],property:propName,type:"key",valueType:continuous?"range":"category",validation:continuous?basicContinuousCheckDatumValidation:basicDiscreteCheckDatumValidation},opts)}__name(keyProperty,"keyProperty");function valueProperty(scope,propName,continuous,opts={}){return __spreadValues({scopes:[scope.id],property:propName,type:"value",valueType:continuous?"range":"category",validation:continuous?basicContinuousCheckDatumValidation:basicDiscreteCheckDatumValidation},opts)}__name(valueProperty,"valueProperty");function rangedValueProperty(scope,propName,opts={}){const _a201=opts,{min=-1/0,max=1/0}=_a201,defOpts=__objRest(_a201,["min","max"]);return __spreadValues({scopes:[scope.id],type:"value",property:propName,valueType:"range",validation:basicContinuousCheckDatumValidation,processor:()=>datum=>isFiniteNumber(datum)?clamp(min,datum,max):datum},defOpts)}__name(rangedValueProperty,"rangedValueProperty");function trailingValueProperty(scope,propName,continuous,opts={}){return __spreadProps(__spreadValues({},valueProperty(scope,propName,continuous,opts)),{processor:trailingValue()})}__name(trailingValueProperty,"trailingValueProperty");function trailingValue(){return()=>{let value=0;return datum=>{const trailingValue2=value;return value=datum,trailingValue2}}}__name(trailingValue,"trailingValue");function accumulativeValueProperty(scope,propName,continuous,opts={}){const _a201=opts,{onlyPositive}=_a201,defOpts=__objRest(_a201,["onlyPositive"]);return __spreadProps(__spreadValues({},valueProperty(scope,propName,continuous,defOpts)),{processor:accumulatedValue(onlyPositive)})}__name(accumulativeValueProperty,"accumulativeValueProperty");function trailingAccumulatedValueProperty(scope,propName,continuous,opts={}){return __spreadProps(__spreadValues({},valueProperty(scope,propName,continuous,opts)),{processor:trailingAccumulatedValue()})}__name(trailingAccumulatedValueProperty,"trailingAccumulatedValueProperty");function groupAccumulativeValueProperty(scope,propName,continuous,mode,sum2="current",opts){return[valueProperty(scope,propName,continuous,opts),accumulateGroup(scope,opts.groupId,mode,sum2,opts.separateNegative),...opts.rangeId!=null?[range2(scope,opts.rangeId,opts.groupId)]:[]]}__name(groupAccumulativeValueProperty,"groupAccumulativeValueProperty");var _a112,SeriesNodeClickEvent=(_a112=class{constructor(type,event,{datum},series){this.type=type,this.event=event,this.datum=datum,this.seriesId=series.id}},__name(_a112,"SeriesNodeClickEvent"),_a112),_a113,SeriesGroupingChangedEvent=(_a113=class{constructor(series,seriesGrouping,oldGrouping){this.series=series,this.seriesGrouping=seriesGrouping,this.oldGrouping=oldGrouping,this.type="groupingChanged"}},__name(_a113,"SeriesGroupingChangedEvent"),_a113),_a114,Series=(_a114=class extends Observable{constructor(seriesOpts){super(),this.destroyFns=[],this.seriesGrouping=void 0,this.NodeClickEvent=SeriesNodeClickEvent,this.internalId=createId(this),this.rootGroup=new Group({name:"seriesRoot",isVirtual:!0}),this.axes={x:void 0,y:void 0},this.directions=["x","y"],this.nodeDataRefresh=!0,this.moduleMap=new ModuleMap,this._declarationOrder=-1,this.seriesListeners=new Listeners;const{moduleCtx,useLabelLayer=!1,pickModes=[1],directionKeys={},directionNames={},contentGroupVirtual=!0,canHaveAxes=!1}=seriesOpts;this.ctx=moduleCtx,this.directionKeys=directionKeys,this.directionNames=directionNames,this.canHaveAxes=canHaveAxes,this.contentGroup=this.rootGroup.appendChild(new Group({name:`${this.internalId}-content`,layer:!contentGroupVirtual,isVirtual:contentGroupVirtual,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("data")})),this.highlightGroup=new Group({name:`${this.internalId}-highlight`,layer:!contentGroupVirtual,isVirtual:contentGroupVirtual,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("highlight")}),this.highlightNode=this.highlightGroup.appendChild(new Group({name:"highlightNode",zIndex:0})),this.highlightLabel=this.highlightGroup.appendChild(new Group({name:"highlightLabel",zIndex:10})),this.pickModes=pickModes,this.labelGroup=this.rootGroup.appendChild(new Group({name:`${this.internalId}-series-labels`,layer:useLabelLayer,zIndex:7})),this.annotationGroup=new Group({name:`${this.id}-annotation`,layer:!contentGroupVirtual,isVirtual:contentGroupVirtual,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("annotation")})}get id(){var _a201,_b;return(_b=(_a201=this.properties)==null?void 0:_a201.id)!=null?_b:this.internalId}get type(){var _a201;return(_a201=this.constructor.type)!=null?_a201:""}set data(input){this._data=input,this.onDataChange()}get data(){var _a201;return(_a201=this._data)!=null?_a201:this._chartData}set visible(value){this.properties.visible=value,this.visibleChanged()}get visible(){return this.properties.visible}onDataChange(){this.nodeDataRefresh=!0}setChartData(input){this._chartData=input,this.data===input&&this.onDataChange()}onSeriesGroupingChange(prev,next){const{internalId,type,visible}=this;prev&&this.ctx.seriesStateManager.deregisterSeries({id:internalId,type}),next&&this.ctx.seriesStateManager.registerSeries({id:internalId,type,visible,seriesGrouping:next}),this.fireEvent(new SeriesGroupingChangedEvent(this,next,prev))}getBandScalePadding(){return{inner:1,outer:0}}getGroupZIndexSubOrder(type,subIndex=0){let mainAdjust=0;switch(type){case"data":case"paths":break;case"labels":mainAdjust+=2e4;break;case"marker":mainAdjust+=1e4;break;case"highlight":subIndex+=15e3;break;case"annotation":mainAdjust+=15e3;break}return[__name(()=>this._declarationOrder+mainAdjust,"main"),subIndex]}addListener(type,listener){return this.seriesListeners.addListener(type,listener)}dispatch(type,event){this.seriesListeners.dispatch(type,event)}addChartEventListeners(){}destroy(){this.destroyFns.forEach(f=>f()),this.destroyFns=[],this.ctx.seriesStateManager.deregisterSeries(this)}getDirectionValues(direction,properties){const resolvedDirection=this.resolveKeyDirection(direction),keys=properties==null?void 0:properties[resolvedDirection],values=[];if(!keys)return values;const addValues=__name((...items)=>{for(const value of items)Array.isArray(value)?addValues(...value):typeof value=="object"?addValues(...Object.values(value)):values.push(value)},"addValues");return addValues(...keys.map(key=>this.properties[key])),values}getKeys(direction){return this.getDirectionValues(direction,this.directionKeys)}getNames(direction){return this.getDirectionValues(direction,this.directionNames)}resolveKeyDirection(direction){return direction}getDomain(direction){const seriesDomain=this.getSeriesDomain(direction),moduleDomains=this.moduleMap.mapValues(module=>module.getDomain(direction));return seriesDomain.concat(moduleDomains.flat())}markNodeDataDirty(){this.nodeDataRefresh=!0}visibleChanged(){this.ctx.seriesStateManager.registerSeries(this)}getOpacity(){const{dimOpacity=1,enabled=!0}=this.properties.highlightStyle.series;if(!enabled||dimOpacity===1)return 1;switch(this.isItemIdHighlighted()){case 0:case 1:return 1;case 2:default:return dimOpacity}}getStrokeWidth(defaultStrokeWidth){const{strokeWidth,enabled=!0}=this.properties.highlightStyle.series;if(!enabled||strokeWidth===void 0)return defaultStrokeWidth;switch(this.isItemIdHighlighted()){case 1:return strokeWidth;case 0:case 2:return defaultStrokeWidth}}isItemIdHighlighted(){var _a201,_b;const{series}=(_b=(_a201=this.ctx.highlightManager)==null?void 0:_a201.getActiveHighlight())!=null?_b:{};return series==null?0:series!==this?2:1}getModuleTooltipParams(){return this.moduleMap.mapValues(module=>module.getTooltipParams()).reduce((total,current)=>__spreadValues(__spreadValues({},current),total),{})}pickNode(point,limitPickModes){const{pickModes,visible,rootGroup}=this;if(!(!visible||!rootGroup.visible))for(const pickMode of pickModes){if(limitPickModes&&!limitPickModes.includes(pickMode))continue;let match;switch(pickMode){case 0:match=this.pickNodeExactShape(point);break;case 1:case 2:match=this.pickNodeMainAxisFirst(point,pickMode===2);break;case 3:match=this.pickNodeClosestDatum(point);break}if(match)return{pickMode,match:match.datum,distance:match.distance}}}pickNodeExactShape(point){const match=this.contentGroup.pickNode(point.x,point.y);return match&&{datum:match.datum,distance:0}}pickNodeClosestDatum(_point){throw new Error("AG Charts - Series.pickNodeClosestDatum() not implemented")}pickNodeMainAxisFirst(_point,_requireCategoryAxis){throw new Error("AG Charts - Series.pickNodeMainAxisFirst() not implemented")}fireNodeClickEvent(event,datum){this.fireEvent(new this.NodeClickEvent("nodeClick",event,datum,this))}fireNodeDoubleClickEvent(event,datum){this.fireEvent(new this.NodeClickEvent("nodeDoubleClick",event,datum,this))}toggleSeriesItem(itemId,enabled){this.visible=enabled,this.nodeDataRefresh=!0,this.dispatch("visibility-changed",{itemId,enabled})}isEnabled(){return this.visible}getModuleMap(){return this.moduleMap}createModuleContext(){return __spreadProps(__spreadValues({},this.ctx),{series:this})}getLabelText(label,params,defaultFormatter=String){var _a201;return label.formatter&&(_a201=this.ctx.callbackCache.call(label.formatter,__spreadValues({seriesId:this.id},params)))!=null?_a201:defaultFormatter(params.value)}getMarkerStyle(marker,params,defaultStyle=marker.getStyle()){var _a201,_b;const defaultSize={size:(_b=(_a201=params.datum.point)==null?void 0:_a201.size)!=null?_b:0},markerStyle=mergeDefaults(defaultSize,defaultStyle);if(marker.formatter){const style=this.ctx.callbackCache.call(marker.formatter,__spreadProps(__spreadValues(__spreadValues({seriesId:this.id},markerStyle),params),{datum:params.datum.datum}));return mergeDefaults(style,markerStyle)}return markerStyle}updateMarkerStyle(markerNode,marker,params,defaultStyle=marker.getStyle(),{applyTranslation=!0}={}){const{point}=params.datum,activeStyle=this.getMarkerStyle(marker,params,defaultStyle),visible=this.visible&&activeStyle.size>0&&point&&!isNaN(point.x)&&!isNaN(point.y);applyTranslation?markerNode.setProperties(__spreadProps(__spreadValues({visible},activeStyle),{translationX:point==null?void 0:point.x,translationY:point==null?void 0:point.y})):markerNode.setProperties(__spreadValues({visible},activeStyle)),typeof marker.shape=="function"&&!markerNode.dirtyPath&&(markerNode.path.clear({trackChanges:!0}),markerNode.updatePath(),markerNode.checkPathDirty())}getMinRect(){}get nodeDataDependencies(){var _a201;return(_a201=this._nodeDataDependencies)!=null?_a201:{seriesRectWidth:NaN,seriesRectHeight:NaN}}checkResize(newSeriesRect){const{width:seriesRectWidth,height:seriesRectHeight}=newSeriesRect??{width:NaN,height:NaN},newNodeDataDependencies=newSeriesRect?{seriesRectWidth,seriesRectHeight}:void 0,resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;return resize&&(this._nodeDataDependencies=newNodeDataDependencies,this.markNodeDataDirty()),resize}},__name(_a114,"Series"),_a114);Series.highlightedZIndex=1e12;__decorateClass([ActionOnSet({changeValue:function(newVal,oldVal){this.onSeriesGroupingChange(oldVal,newVal)}})],Series.prototype,"seriesGrouping",2);var SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION=30,_a115,SeriesLayerManager=(_a115=class{constructor(rootGroup){this.groups={},this.series={},this.expectedSeriesCount=1,this.mode="normal",this.rootGroup=rootGroup}setSeriesCount(count2){this.expectedSeriesCount=count2}requestGroup(seriesConfig){var _a201,_b,_c,_d;const{internalId,type,rootGroup:seriesRootGroup,highlightGroup:seriesHighlightGroup,annotationGroup:seriesAnnotationGroup,seriesGrouping}=seriesConfig,{groupIndex=internalId}=seriesGrouping??{};if(this.series[internalId]!=null)throw new Error(`AG Charts - series already has an allocated layer: ${this.series[internalId]}`);Object.keys(this.series).length===0&&(this.mode=this.expectedSeriesCount>=SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION?"aggressive-grouping":"normal"),(_b=(_a201=this.groups)[type])!=null||(_a201[type]={});const lookupIndex=this.lookupIdx(groupIndex);let groupInfo=this.groups[type][lookupIndex];return groupInfo||(groupInfo=(_d=(_c=this.groups[type])[lookupIndex])!=null?_d:_c[lookupIndex]={seriesIds:[],group:this.rootGroup.appendChild(new Group({name:`${type}-content`,layer:!0,zIndex:4,zIndexSubOrder:seriesConfig.getGroupZIndexSubOrder("data")})),highlight:this.rootGroup.appendChild(new Group({name:`${type}-highlight`,layer:!0,zIndex:4,zIndexSubOrder:seriesConfig.getGroupZIndexSubOrder("highlight")})),annotation:this.rootGroup.appendChild(new Group({name:`${type}-annotation`,layer:!0,zIndex:4,zIndexSubOrder:seriesConfig.getGroupZIndexSubOrder("annotation")}))}),this.series[internalId]={layerState:groupInfo,seriesConfig},groupInfo.seriesIds.push(internalId),groupInfo.group.appendChild(seriesRootGroup),groupInfo.highlight.appendChild(seriesHighlightGroup),groupInfo.annotation.appendChild(seriesAnnotationGroup),groupInfo.group}changeGroup(seriesConfig){var _a201,_b;const{internalId,seriesGrouping,type,rootGroup,highlightGroup,annotationGroup,oldGrouping}=seriesConfig,{groupIndex=internalId}=seriesGrouping??{};(_b=(_a201=this.groups[type])==null?void 0:_a201[groupIndex])!=null&&_b.seriesIds.includes(internalId)||(this.series[internalId]!=null&&this.releaseGroup({internalId,seriesGrouping:oldGrouping,type,rootGroup,highlightGroup,annotationGroup}),this.requestGroup(seriesConfig))}releaseGroup(seriesConfig){var _a201,_b,_c,_d,_e;const{internalId,seriesGrouping,rootGroup,highlightGroup,annotationGroup,type}=seriesConfig,{groupIndex=internalId}=seriesGrouping??{};if(this.series[internalId]==null)throw new Error(`AG Charts - series doesn't have an allocated layer: ${internalId}`);const lookupIndex=this.lookupIdx(groupIndex),groupInfo=(_c=(_a201=this.groups[type])==null?void 0:_a201[lookupIndex])!=null?_c:(_b=this.series[internalId])==null?void 0:_b.layerState;if(groupInfo&&(groupInfo.seriesIds=groupInfo.seriesIds.filter(v=>v!==internalId),groupInfo.group.removeChild(rootGroup),groupInfo.highlight.removeChild(highlightGroup),groupInfo.annotation.removeChild(annotationGroup)),(groupInfo==null?void 0:groupInfo.seriesIds.length)===0)this.rootGroup.removeChild(groupInfo.group),this.rootGroup.removeChild(groupInfo.highlight),this.rootGroup.removeChild(groupInfo.annotation),delete this.groups[type][lookupIndex],delete this.groups[type][internalId];else if((groupInfo==null?void 0:groupInfo.seriesIds.length)>0){const leadSeriesConfig=(_e=this.series[(_d=groupInfo==null?void 0:groupInfo.seriesIds)==null?void 0:_d[0]])==null?void 0:_e.seriesConfig;groupInfo.group.zIndexSubOrder=leadSeriesConfig==null?void 0:leadSeriesConfig.getGroupZIndexSubOrder("data"),groupInfo.highlight.zIndexSubOrder=leadSeriesConfig==null?void 0:leadSeriesConfig.getGroupZIndexSubOrder("highlight"),groupInfo.annotation.zIndexSubOrder=leadSeriesConfig==null?void 0:leadSeriesConfig.getGroupZIndexSubOrder("annotation")}delete this.series[internalId]}lookupIdx(groupIndex){return this.mode==="normal"?groupIndex:typeof groupIndex=="string"&&(groupIndex=Number(groupIndex.split("-").slice(-1)[0]),!groupIndex)?0:Math.floor(Math.max(Math.min(groupIndex/this.expectedSeriesCount,1),0)*SERIES_THRESHOLD_FOR_AGGRESSIVE_LAYER_REDUCTION)}destroy(){for(const groups of Object.values(this.groups))for(const groupInfo of Object.values(groups))this.rootGroup.removeChild(groupInfo.group),this.rootGroup.removeChild(groupInfo.highlight),this.rootGroup.removeChild(groupInfo.annotation);this.groups={},this.series={}}},__name(_a115,"SeriesLayerManager"),_a115),_a116,SeriesStateManager=(_a116=class{constructor(){this.groups={}}registerSeries({id,seriesGrouping,visible,type}){var _a201,_b;seriesGrouping&&((_b=(_a201=this.groups)[type])!=null||(_a201[type]={}),this.groups[type][id]={grouping:seriesGrouping,visible})}deregisterSeries({id,type}){this.groups[type]&&delete this.groups[type][id],this.groups[type]&&Object.keys(this.groups[type]).length===0&&delete this.groups[type]}getVisiblePeerGroupIndex({type,seriesGrouping,visible}){var _a201;if(!seriesGrouping)return{visibleGroupCount:visible?1:0,visibleSameStackCount:visible?1:0,index:0};const visibleGroupsSet=new Set,visibleSameStackSet=new Set;for(const[_,entry]of Object.entries((_a201=this.groups[type])!=null?_a201:{}))entry.visible&&(visibleGroupsSet.add(entry.grouping.groupIndex),entry.grouping.groupIndex===seriesGrouping.groupIndex&&visibleSameStackSet.add(entry.grouping.stackIndex));const visibleGroups=[...visibleGroupsSet.values()];return visibleGroups.sort((a,b)=>a-b),{visibleGroupCount:visibleGroups.length,visibleSameStackCount:visibleSameStackSet.size,index:visibleGroups.indexOf(seriesGrouping.groupIndex)}}},__name(_a116,"SeriesStateManager"),_a116),_a117,BaseLayoutProcessor=(_a117=class{constructor(chartLike,layoutService){this.chartLike=chartLike,this.layoutService=layoutService,this.destroyFns=[],this.destroyFns.push(this.layoutService.addListener("layout-complete",e=>this.layoutComplete(e)),this.layoutService.addListener("start-layout",e=>this.positionPadding(e.shrinkRect)),this.layoutService.addListener("start-layout",e=>this.positionCaptions(e.shrinkRect)))}destroy(){this.destroyFns.forEach(cb=>cb())}layoutComplete({clipSeries,series:{paddedRect}}){const{seriesArea,seriesRoot}=this.chartLike;seriesArea.clip||clipSeries?seriesRoot.setClipRectInGroupCoordinateSpace(paddedRect):seriesRoot.setClipRectInGroupCoordinateSpace()}positionPadding(shrinkRect){const{padding}=this.chartLike;return shrinkRect.shrink(padding.left,"left"),shrinkRect.shrink(padding.top,"top"),shrinkRect.shrink(padding.right,"right"),shrinkRect.shrink(padding.bottom,"bottom"),{shrinkRect}}positionCaptions(shrinkRect){var _a201,_b,_c,_d;const{title,subtitle,footnote}=this.chartLike,newShrinkRect=shrinkRect.clone(),updateCaption=__name(caption=>{var _a210;const defaultCaptionHeight=shrinkRect.height/10,captionLineHeight=(_a210=caption.lineHeight)!=null?_a210:caption.fontSize*Text.defaultLineHeightRatio,maxWidth=shrinkRect.width,maxHeight=Math.max(captionLineHeight,defaultCaptionHeight);caption.computeTextWrap(maxWidth,maxHeight)},"updateCaption"),computeX=__name(align=>align==="left"?newShrinkRect.x:align==="right"?newShrinkRect.x+newShrinkRect.width:(align!=="center"&&Logger.error(`invalid textAlign value: ${align}`),newShrinkRect.x+newShrinkRect.width/2),"computeX"),positionTopAndShrinkBBox=__name((caption,spacing)=>{const baseY=newShrinkRect.y;caption.node.x=computeX(caption.textAlign),caption.node.y=baseY,caption.node.textBaseline="top",updateCaption(caption);const bbox=caption.node.computeBBox(),bboxHeight=Math.ceil(bbox.y-baseY+bbox.height+spacing);newShrinkRect.shrink(bboxHeight,"top")},"positionTopAndShrinkBBox"),positionBottomAndShrinkBBox=__name((caption,spacing)=>{const baseY=newShrinkRect.y+newShrinkRect.height;caption.node.x=computeX(caption.textAlign),caption.node.y=baseY,caption.node.textBaseline="bottom",updateCaption(caption);const bbox=caption.node.computeBBox(),bboxHeight=Math.ceil(baseY-bbox.y+spacing);newShrinkRect.shrink(bboxHeight,"bottom")},"positionBottomAndShrinkBBox");if(subtitle&&(subtitle.node.visible=(_a201=subtitle.enabled)!=null?_a201:!1),title&&(title.node.visible=title.enabled,title.node.visible)){const defaultTitleSpacing=subtitle!=null&&subtitle.node.visible?Caption.SMALL_PADDING:Caption.LARGE_PADDING,spacing=(_b=title.spacing)!=null?_b:defaultTitleSpacing;positionTopAndShrinkBBox(title,spacing)}return subtitle&&subtitle.node.visible&&positionTopAndShrinkBBox(subtitle,(_c=subtitle.spacing)!=null?_c:0),footnote&&(footnote.node.visible=footnote.enabled,footnote.node.visible&&positionBottomAndShrinkBBox(footnote,(_d=footnote.spacing)!=null?_d:0)),{shrinkRect:newShrinkRect}}},__name(_a117,"BaseLayoutProcessor"),_a117),_a118,DataWindowProcessor=(_a118=class{constructor(chart,dataService,updateService,zoomManager){this.chart=chart,this.dataService=dataService,this.updateService=updateService,this.zoomManager=zoomManager,this.dirtyZoom=!1,this.dirtyDataSource=!1,this.lastAxisZooms=new Map,this.destroyFns=[],this.destroyFns.push(this.dataService.addListener("data-source-change",()=>this.onDataSourceChange()),this.dataService.addListener("data-load",()=>this.onDataLoad()),this.dataService.addListener("data-error",()=>this.onDataError()),this.updateService.addListener("update-complete",()=>this.onUpdateComplete()),this.zoomManager.addListener("zoom-change",()=>this.onZoomChange()))}destroy(){this.destroyFns.forEach(cb=>cb())}onDataLoad(){this.updateService.update(1)}onDataError(){this.updateService.update(3)}onDataSourceChange(){this.dirtyDataSource=!0}onUpdateComplete(){!this.dirtyZoom&&!this.dirtyDataSource||this.updateWindow()}onZoomChange(){this.dirtyZoom=!0}updateWindow(){return __async(this,null,function*(){if(!this.dataService.isLazy())return;const axis=this.getValidAxis();let window2,shouldRefresh=!0;if(axis){const zoom=this.zoomManager.getAxisZoom(axis.id);window2=this.getAxisWindow(axis,zoom),shouldRefresh=this.shouldRefresh(axis,zoom)}this.dirtyZoom=!1,this.dirtyDataSource=!1,shouldRefresh&&this.dataService.load({windowStart:window2==null?void 0:window2.min,windowEnd:window2==null?void 0:window2.max})})}getValidAxis(){return this.chart.axes.find(axis=>axis.type==="time")}shouldRefresh(axis,zoom){if(this.dirtyDataSource)return!0;if(!this.dirtyZoom)return!1;const lastZoom=this.lastAxisZooms.get(axis.id);return lastZoom&&zoom.min===lastZoom.min&&zoom.max===lastZoom.max?!1:(this.lastAxisZooms.set(axis.id,zoom),!0)}getAxisWindow(axis,zoom){var _a201,_b;const domain=(_b=(_a201=axis.scale).getDomain)==null?void 0:_b.call(_a201);if(!zoom||!domain||domain.length===0||isNaN(Number(domain[0])))return;const diff2=Number(domain[1])-Number(domain[0]),min=new Date(Number(domain[0])+diff2*zoom.min),max=new Date(Number(domain[0])+diff2*zoom.max);return{min,max}}},__name(_a118,"DataWindowProcessor"),_a118),_a119,OverlaysProcessor=(_a119=class{constructor(chartLike,overlays,dataService,layoutService){this.chartLike=chartLike,this.overlays=overlays,this.dataService=dataService,this.layoutService=layoutService,this.destroyFns=[],this.destroyFns.push(this.layoutService.addListener("layout-complete",ctx=>this.onLayoutComplete(ctx)))}destroy(){this.destroyFns.forEach(cb=>cb())}onLayoutComplete({series:{rect}}){const isLoading=this.dataService.isLoading(),hasData=this.chartLike.series.some(s=>{var _a201;return(_a201=s.data)==null?void 0:_a201.length}),anySeriesVisible=this.chartLike.series.some(s=>s.visible);this.toggleOverlay(this.overlays.loading,rect,isLoading),this.toggleOverlay(this.overlays.noData,rect,!isLoading&&!hasData),this.toggleOverlay(this.overlays.noVisibleSeries,rect,hasData&&!anySeriesVisible)}toggleOverlay(overlay,seriesRect,visible){visible&&seriesRect?overlay.show(seriesRect):overlay.hide()}},__name(_a119,"OverlaysProcessor"),_a119),_a120,UpdateService=(_a120=class extends Listeners{constructor(updateCallback){super(),this.updateCallback=updateCallback}update(type=0,options){this.updateCallback(type,options)}dispatchUpdateComplete(minRect){this.dispatch("update-complete",{type:"update-complete",minRect})}},__name(_a120,"UpdateService"),_a120),debug=Debug.create(!0,"opts"),_a121,SeriesArea=(_a121=class extends BaseProperties{constructor(){super(...arguments),this.padding=new Padding(0)}},__name(_a121,"SeriesArea"),_a121);__decorateClass([Validate(BOOLEAN,{optional:!0})],SeriesArea.prototype,"clip",2);__decorateClass([Validate(OBJECT)],SeriesArea.prototype,"padding",2);var _a122,_Chart=(_a122=class extends Observable{constructor(options,resources){var _a201;super(),this.id=createId(this),this.seriesRoot=new Group({name:`${this.id}-Series-root`}),this.debug=Debug.create(),this.extraDebugStats={},this.data=[],this._firstAutoSize=!0,this.padding=new Padding(20),this.seriesArea=new SeriesArea,this.mode="standalone",this.destroyed=!1,this._skipSync=!1,this._destroyFns=[],this.chartAnimationPhase="initial",this.highlightManager=new HighlightManager,this.syncManager=new SyncManager(this),this.zoomManager=new ZoomManager,this.modules=new Map,this.legends=new Map,this.processors=[],this.processedOptions={},this.userOptions={},this.queuedUserOptions=[],this._pendingFactoryUpdatesCount=0,this._performUpdateNoRenderCount=0,this._performUpdateSkipAnimations=!1,this.performUpdateType=7,this.updateShortcutCount=0,this.seriesToUpdate=new Set,this.updateMutex=new Mutex,this.updateRequestors={},this.performUpdateTrigger=debouncedCallback(_0=>__async(this,[_0],function*({count:count2}){this.destroyed||this.updateMutex.acquire(()=>__async(this,null,function*(){try{yield this.performUpdate(count2)}catch(error){Logger.error("update error",error)}}))})),this.axes=[],this.series=[],this.lastInteractionEvent=void 0,this.pointerScheduler=debouncedAnimationFrame(()=>{this.lastInteractionEvent&&(this.handlePointer(this.lastInteractionEvent,!1),this.lastInteractionEvent=void 0)}),this.onSeriesNodeClick=event=>{const seriesNodeClickEvent=__spreadProps(__spreadValues({},event),{type:"seriesNodeClick"});Object.defineProperty(seriesNodeClickEvent,"series",{enumerable:!1,get:()=>event.series}),this.fireEvent(seriesNodeClickEvent)},this.onSeriesNodeDoubleClick=event=>{const seriesNodeDoubleClick=__spreadProps(__spreadValues({},event),{type:"seriesNodeDoubleClick"});this.fireEvent(seriesNodeDoubleClick)},this.seriesGroupingChanged=event=>{if(!(event instanceof SeriesGroupingChangedEvent))return;const{series,seriesGrouping,oldGrouping}=event;series.rootGroup.parent!=null&&this.seriesLayerManager.changeGroup({internalId:series.internalId,type:series.type,rootGroup:series.rootGroup,highlightGroup:series.highlightGroup,annotationGroup:series.annotationGroup,getGroupZIndexSubOrder:type=>series.getGroupZIndexSubOrder(type),seriesGrouping,oldGrouping})},this.chartOptions=options;const{window:window2,document:document2}=options.specialOverrides,scene=resources==null?void 0:resources.scene,element2=(_a201=resources==null?void 0:resources.element)!=null?_a201:document2.createElement("div"),container=resources==null?void 0:resources.container,root=new Group({name:"root"});root.visible=!1,root.append(this.seriesRoot),this.axisGridGroup=new Group({name:"Axes-Grids",layer:!0,zIndex:1}),root.appendChild(this.axisGridGroup),this.axisGroup=new Group({name:"Axes",layer:!0,zIndex:2}),root.appendChild(this.axisGroup),this.element=element2,element2.classList.add("ag-chart-wrapper"),element2.style.position="relative",this.scene=scene??new Scene(this.chartOptions.specialOverrides),this.scene.root=root,this.scene.container=element2,this.autoSize=!0,this.chartEventManager=new ChartEventManager,this.contextMenuRegistry=new ContextMenuRegistry,this.cursorManager=new CursorManager(element2),this.highlightManager=new HighlightManager,this.interactionManager=new InteractionManager(element2,document2,window2),this.regionManager=new RegionManager(this.interactionManager),this.gestureDetector=new GestureDetector(element2),this.layoutService=new LayoutService,this.updateService=new UpdateService((type=0,options2)=>this.update(type,options2)),this.seriesStateManager=new SeriesStateManager,this.seriesLayerManager=new SeriesLayerManager(this.seriesRoot),this.callbackCache=new CallbackCache,this.animationManager=new AnimationManager(this.interactionManager,this.updateMutex),this.animationManager.skip(),this.animationManager.play(),this.dataService=new DataService(this.animationManager),this.overlays=new ChartOverlays(this.element,this.animationManager),this.processors=[new BaseLayoutProcessor(this,this.layoutService),new DataWindowProcessor(this,this.dataService,this.updateService,this.zoomManager),new OverlaysProcessor(this,this.overlays,this.dataService,this.layoutService)],this.tooltip=new Tooltip(this.scene.canvas.element,document2,window2,document2.body),this.tooltipManager=new TooltipManager(this.tooltip,this.interactionManager),this.highlight=new ChartHighlight,this.container=container,this.attachLegend("category",Legend),this.legend=this.legends.get("category");const{All}=InteractionState;SizeMonitor.observe(this.element,size=>this.rawResize(size)),this._destroyFns.push(this.dataService.addListener("data-load",event=>{this.data=event.data}),this.interactionManager.addListener("click",event=>this.onClick(event)),this.interactionManager.addListener("dblclick",event=>this.onDoubleClick(event)),this.interactionManager.addListener("hover",event=>this.onMouseMove(event)),this.interactionManager.addListener("leave",event=>this.onLeave(event)),this.interactionManager.addListener("page-left",()=>this.destroy()),this.interactionManager.addListener("wheel",()=>this.resetPointer()),this.interactionManager.addListener("drag",()=>this.resetPointer()),this.interactionManager.addListener("contextmenu",event=>this.onContextMenu(event),All),this.animationManager.addListener("animation-frame",()=>{this.update(6)}),this.highlightManager.addListener("highlight-change",event=>this.changeHighlightDatum(event)),this.zoomManager.addListener("zoom-change",()=>this.update(2,{forceNodeDataRefresh:!0,skipAnimations:!0})))}static getInstance(element2){return _a122.chartsInstances.get(element2)}onAutoSizeChange(value){const{style}=this.element;if(value){if(style.display="block",style.width="100%",style.height="100%",!this._lastAutoSize)return;this.resize(void 0,void 0,"autoSize option")}else style.display="inline-block",style.width="auto",style.height="auto"}download(fileName,fileFormat){this.scene.download(fileName,fileFormat)}getOptions(){var _a201;return(_a201=this.queuedUserOptions.at(-1))!=null?_a201:this.userOptions}addModule(module){if(this.modules.has(module.optionsKey))throw new Error(`AG Charts - module already initialised: ${module.optionsKey}`);const moduleInstance=new module.instanceConstructor(this.getModuleContext());if(module.type==="legend"){const legend=moduleInstance;this.legends.set(module.identifier,legend),legend.attachLegend(this.scene.root)}this.modules.set(module.optionsKey,moduleInstance)}removeModule(module){var _a201;module.type==="legend"&&this.legends.delete(module.identifier),(_a201=this.modules.get(module.optionsKey))==null||_a201.destroy(),this.modules.delete(module.optionsKey)}attachLegend(legendType,legendConstructor){const legend=new legendConstructor(this.getModuleContext());this.legends.set(legendType,legend),legend.attachLegend(this.scene.root)}isModuleEnabled(module){return this.modules.has(module.optionsKey)}getModuleContext(){return{window:this.chartOptions.specialOverrides.window,document:this.chartOptions.specialOverrides.document,scene:this.scene,animationManager:this.animationManager,chartEventManager:this.chartEventManager,contextMenuRegistry:this.contextMenuRegistry,cursorManager:this.cursorManager,highlightManager:this.highlightManager,interactionManager:this.interactionManager,regionManager:this.regionManager,gestureDetector:this.gestureDetector,tooltipManager:this.tooltipManager,syncManager:this.syncManager,zoomManager:this.zoomManager,chartService:this,dataService:this.dataService,layoutService:this.layoutService,updateService:this.updateService,seriesStateManager:this.seriesStateManager,callbackCache:this.callbackCache}}resetAnimations(){var _a201;this.chartAnimationPhase="initial";for(const series of this.series)series.resetAnimation(this.chartAnimationPhase);for(const axis of this.axes)axis.resetAnimation(this.chartAnimationPhase);this.animationRect=void 0,(_a201=this.animationManager)==null||_a201.reset()}skipAnimations(){this.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0}destroy(opts){if(this.destroyed)return;const keepTransferableResources=opts==null?void 0:opts.keepTransferableResources;let result;this.performUpdateType=7,this._destroyFns.forEach(fn=>fn()),this.processors.forEach(p=>p.destroy()),this.tooltipManager.destroy(),this.tooltip.destroy(),this.legends.forEach(legend=>legend.destroy()),this.legends.clear(),this.overlays.destroy(),SizeMonitor.unobserve(this.element);for(const moduleInstance of this.modules.values())moduleInstance==null||moduleInstance.destroy();return this.modules.clear(),this.regionManager.destroy(),this.interactionManager.destroy(),this.animationManager.stop(),this.animationManager.destroy(),this.chartEventManager.destroy(),this.highlightManager.destroy(),this.zoomManager.destroy(),keepTransferableResources?(this.scene.strip(),result={container:this.container,scene:this.scene,element:this.element}):(this.scene.destroy(),this.container=void 0),this.destroySeries(this.series),this.seriesLayerManager.destroy(),this.axes.forEach(a=>a.destroy()),this.axes=[],this.callbackCache.invalidateCache(),this.animationRect=void 0,this.animationManager.reset(),this.syncManager.destroy(),this.destroyed=!0,Object.freeze(this),result}resetPointer(highlightOnly=!1){highlightOnly||this.tooltipManager.removeTooltip(this.id),this.highlightManager.updateHighlight(this.id),this.lastInteractionEvent=void 0}requestFactoryUpdate(cb){this.destroyed||(this._pendingFactoryUpdatesCount++,this.updateMutex.acquire(()=>__async(this,null,function*(){this.destroyed||(yield cb(this),!this.destroyed&&this._pendingFactoryUpdatesCount--)})))}update(type=0,opts){var _a201,_b;const{forceNodeDataRefresh=!1,skipAnimations,seriesToUpdate=this.series,newAnimationBatch}=opts??{};forceNodeDataRefresh&&this.series.forEach(series=>series.markNodeDataDirty());for(const series of seriesToUpdate)this.seriesToUpdate.add(series);if(skipAnimations&&(this.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0),newAnimationBatch&&this.animationManager.isActive()&&(this._performUpdateSkipAnimations=!0),this._skipSync=(_a201=opts==null?void 0:opts.skipSync)!=null?_a201:!1,this.debug.check()){let stack=(_b=new Error().stack)!=null?_b:"<unknown>";stack=stack.replace(/\([^)]*/g,""),this.updateRequestors[stack]=type}type<this.performUpdateType&&(this.performUpdateType=type,this.performUpdateTrigger.schedule(opts==null?void 0:opts.backOffMs))}performUpdate(count2){return __async(this,null,function*(){const{performUpdateType,extraDebugStats}=this,seriesToUpdate=[...this.seriesToUpdate];this.performUpdateType=7,this.seriesToUpdate.clear(),this.updateShortcutCount===0&&performUpdateType<6&&(this.animationManager.startBatch(this._performUpdateSkipAnimations),this.animationManager.onBatchStop(()=>this.chartAnimationPhase="ready")),this.debug("Chart.performUpdate() - start",ChartUpdateType[performUpdateType]);const splits={start:performance.now()};switch(performUpdateType){case 0:case 1:yield this.updateData(),splits[""]=performance.now();case 2:yield this.processData(),this.resetPointer(!0),splits[""]=performance.now();case 3:if(this.checkUpdateShortcut(3)||!this.checkFirstAutoSize(seriesToUpdate))break;yield this.processLayout(),splits[""]=performance.now();case 4:if(this.checkUpdateShortcut(4))break;const{seriesRect}=this;yield Promise.all(seriesToUpdate.map(series=>series.update({seriesRect}))),splits[""]=performance.now();case 5:if(this.checkUpdateShortcut(5))break;const tooltipMeta=this.tooltipManager.getTooltipMeta(this.id);performUpdateType<=4&&tooltipMeta!==void 0&&this.handlePointer(tooltipMeta.lastPointerEvent,!0),splits[""]=performance.now();case 6:if(this.checkUpdateShortcut(6))break;extraDebugStats.updateShortcutCount=this.updateShortcutCount,yield this.scene.render({debugSplitTimes:splits,extraDebugStats}),this.extraDebugStats={};case 7:this.updateShortcutCount=0,this.updateRequestors={},this._performUpdateSkipAnimations=!1,this.animationManager.endBatch()}this.updateService.dispatchUpdateComplete(this.getMinRect());const end=performance.now();this.debug("Chart.performUpdate() - end",{chart:this,durationMs:Math.round((end-splits.start)*100)/100,count:count2,performUpdateType:ChartUpdateType[performUpdateType]})})}checkUpdateShortcut(checkUpdateType){return this.updateShortcutCount>3?(Logger.warn("exceeded the maximum number of simultaneous updates (4), discarding changes and rendering",this.updateRequestors),!1):this.performUpdateType<=checkUpdateType?(this.updateShortcutCount++,!0):!1}checkFirstAutoSize(seriesToUpdate){if(this.autoSize&&!this._lastAutoSize){const count2=this._performUpdateNoRenderCount++,backOffMs=__pow(count2,2)*10;if(count2<8)return this.update(3,{seriesToUpdate,backOffMs}),this.debug("Chart.checkFirstAutoSize() - backing off until first size update",backOffMs),!1;this.debug("Chart.checkFirstAutoSize() - timeout for first size update.")}return this._performUpdateNoRenderCount=0,!0}onSeriesChange(newValue,oldValue){var _a201,_b;const seriesToDestroy=(_a201=oldValue==null?void 0:oldValue.filter(series=>!newValue.includes(series)))!=null?_a201:[];this.destroySeries(seriesToDestroy),(_b=this.seriesLayerManager)==null||_b.setSeriesCount(newValue.length);for(const series of newValue){if(oldValue!=null&&oldValue.includes(series))continue;series.rootGroup.parent==null&&this.seriesLayerManager.requestGroup(series);const chart=this;series.chart={get mode(){return chart.mode},get isMiniChart(){return!1},get seriesRect(){return chart.seriesRect},placeLabels(){return chart.placeLabels()}},series.resetAnimation(this.chartAnimationPhase),this.addSeriesListeners(series),series.addChartEventListeners()}}destroySeries(series){series==null||series.forEach(series2=>{series2.removeEventListener("nodeClick",this.onSeriesNodeClick),series2.removeEventListener("nodeDoubleClick",this.onSeriesNodeDoubleClick),series2.removeEventListener("groupingChanged",this.seriesGroupingChanged),series2.destroy(),this.seriesLayerManager.releaseGroup(series2),series2.chart=void 0})}addSeriesListeners(series){this.hasEventListener("seriesNodeClick")&&series.addEventListener("nodeClick",this.onSeriesNodeClick),this.hasEventListener("seriesNodeDoubleClick")&&series.addEventListener("nodeDoubleClick",this.onSeriesNodeDoubleClick),series.addEventListener("groupingChanged",this.seriesGroupingChanged)}updateAllSeriesListeners(){this.series.forEach(series=>{series.removeEventListener("nodeClick",this.onSeriesNodeClick),series.removeEventListener("nodeDoubleClick",this.onSeriesNodeDoubleClick),this.addSeriesListeners(series)})}assignSeriesToAxes(){this.axes.forEach(axis=>{axis.boundSeries=this.series.filter(s=>s.axes[axis.direction]===axis)})}assignAxesToSeries(){const directionToAxesMap=groupBy(this.axes,axis=>axis.direction);this.series.forEach(series=>{series.directions.forEach(direction=>{const directionAxes=directionToAxesMap[direction];if(!directionAxes){Logger.warnOnce(`no available axis for direction [${direction}]; check series and axes configuration.`);return}const seriesKeys=series.getKeys(direction),newAxis=this.findMatchingAxis(directionAxes,seriesKeys);if(!newAxis){Logger.warnOnce(`no matching axis for direction [${direction}] and keys [${seriesKeys}]; check series and axes configuration.`);return}series.axes[direction]=newAxis})})}findMatchingAxis(directionAxes,directionKeys){for(const axis of directionAxes){if(!axis.keys.length)return axis;if(directionKeys){for(const directionKey of directionKeys)if(axis.keys.includes(directionKey))return axis}}}rawResize(size){var _a201;let{width,height}=size;if(width=Math.floor(width),height=Math.floor(height),!this.autoSize||width===0&&height===0)return;const[autoWidth=0,authHeight=0]=(_a201=this._lastAutoSize)!=null?_a201:[];autoWidth===width&&authHeight===height||(this._lastAutoSize=[width,height],this.resize(void 0,void 0,"SizeMonitor"))}resize(width,height,source){var _a201,_b,_c,_d;if(width??(width=(_b=this.width)!=null?_b:this.autoSize?(_a201=this._lastAutoSize)==null?void 0:_a201[0]:this.scene.canvas.width),height??(height=(_d=this.height)!=null?_d:this.autoSize?(_c=this._lastAutoSize)==null?void 0:_c[1]:this.scene.canvas.height),this.debug(`Chart.resize() from ${source}`,{width,height,stack:new Error().stack}),!(!width||!height||!isFiniteNumber(width)||!isFiniteNumber(height))&&this.scene.resize(width,height)){this.resetPointer(),this.animationManager.reset();let skipAnimations=!0;this.autoSize&&this._firstAutoSize&&(skipAnimations=!1,this._firstAutoSize=!1),this.update(3,{forceNodeDataRefresh:!0,skipAnimations})}}updateData(){return __async(this,null,function*(){this.series.forEach(s=>s.setChartData(this.data));const modulePromises=Array.from(this.modules.values(),m=>{var _a201;return(_a201=m.updateData)==null?void 0:_a201.call(m,{data:this.data})});yield Promise.all(modulePromises)})}processData(){return __async(this,null,function*(){if(this.series.some(s=>s.canHaveAxes)){this.assignAxesToSeries(),this.assignSeriesToAxes();const syncModule=this.modules.get("sync");syncModule!=null&&syncModule.enabled&&syncModule.syncAxes(this._skipSync)}const dataController=new DataController(this.mode),seriesPromises=this.series.map(s=>s.processData(dataController)),modulePromises=Array.from(this.modules.values(),m=>{var _a201;return(_a201=m.processData)==null?void 0:_a201.call(m,{dataController})});dataController.execute(),yield Promise.all([...seriesPromises,...modulePromises]),yield this.updateLegend()})}placeLabels(){const visibleSeries=[],data=[];for(const series of this.series){if(!series.visible)continue;const labelData=series.getLabelData();isPointLabelDatum(labelData==null?void 0:labelData[0])&&(data.push(labelData),visibleSeries.push(series))}const{seriesRect}=this,{top,right,bottom,left}=this.seriesArea.padding,labels=seriesRect&&data.length>0?placeLabels(data,{x:-left,y:-top,width:seriesRect.width+left+right,height:seriesRect.height+top+bottom}):[];return new Map(labels.map((l,i)=>[visibleSeries[i],l]))}updateLegend(){return __async(this,null,function*(){this.legends.forEach((legend,legendType)=>{const isCategoryLegendData=__name(data=>data.every(d=>d.legendType==="category"),"isCategoryLegendData"),legendData=this.series.filter(s=>s.properties.showInLegend).flatMap(s=>s.getLegendData(legendType));isCategoryLegendData(legendData)&&this.mode!=="integrated"&&this.validateCategoryLegendData(legendData),legend.data=legendData})})}validateCategoryLegendData(legendData){const labelMarkerFills={};legendData.forEach(d=>{var _a201,_b,_c,_d,_e;const seriesType=(_a201=this.series.find(s=>s.id===d.seriesId))==null?void 0:_a201.type;seriesType&&((_b=labelMarkerFills[seriesType])!=null||(labelMarkerFills[seriesType]={}),(_e=(_c=labelMarkerFills[seriesType])[_d=d.label.text])!=null||(_c[_d]=new Set),d.marker.fill!=null&&labelMarkerFills[seriesType][d.label.text].add(d.marker.fill))});for(const seriesMarkers of Object.values(labelMarkerFills))for(const[name,fills]of Object.entries(seriesMarkers))fills.size>1&&Logger.warnOnce(`legend item '${name}' has multiple fill colors, this may cause unexpected behaviour.`)}processLayout(){return __async(this,null,function*(){var _a201;const oldRect=this.animationRect;yield this.performLayout(),oldRect&&!((_a201=this.animationRect)!=null&&_a201.equals(oldRect))&&this.animationManager.skipCurrentBatch(),this.debug("Chart.performUpdate() - seriesRect",this.seriesRect)})}performLayout(){return __async(this,null,function*(){this.scene.root&&(this.scene.root.visible=!0);const{width,height}=this.scene;let ctx={shrinkRect:new BBox(0,0,width,height)};ctx=this.layoutService.dispatchPerformLayout("start-layout",ctx),ctx=this.layoutService.dispatchPerformLayout("before-series",ctx);const modulePromises=Array.from(this.modules.values(),m=>__async(this,null,function*(){var _a201;m.performLayout!=null&&(ctx=yield(_a201=m.performLayout)==null?void 0:_a201.call(m,ctx))}));return yield Promise.all(modulePromises),ctx.shrinkRect})}pickSeriesNode(point,exactMatchOnly,maxDistance){var _a201,_b;const start=performance.now(),pickModes=exactMatchOnly?[0]:void 0,reverseSeries=[...this.series].reverse();let result;for(const series of reverseSeries){if(!series.visible||!series.rootGroup.visible)continue;const{match,distance:distance2}=(_a201=series.pickNode(point,pickModes))!=null?_a201:{};if(!(!match||distance2==null)&&((!result||result.distance>distance2)&&distance2<=(maxDistance??1/0)&&(result={series,distance:distance2,datum:match}),distance2===0))break}return this.extraDebugStats.pickSeriesNode=Math.round(((_b=this.extraDebugStats.pickSeriesNode)!=null?_b:0)+(performance.now()-start)),result}onMouseMove(event){this.lastInteractionEvent=event,this.pointerScheduler.schedule(),this.extraDebugStats.mouseX=event.offsetX,this.extraDebugStats.mouseY=event.offsetY,this.update(6)}onLeave(event){this.tooltip.pointerLeftOntoTooltip(event)||(this.resetPointer(),this.update(6))}onContextMenu(event){this.tooltipManager.removeTooltip(this.id);const{Default:Default2,ContextMenu}=InteractionState;this.interactionManager.getState()&(Default2|ContextMenu)&&this.checkSeriesNodeRange(event,(_series,datum)=>{this.highlightManager.updateHighlight(this.id,datum)})}handlePointer(event,redisplay){if(this.interactionManager.getState()!==8)return;const{lastPick,hoverRect}=this,{offsetX,offsetY}=event,disablePointer=__name((highlightOnly=!1)=>{lastPick&&this.resetPointer(highlightOnly)},"disablePointer");if(redisplay&&this.animationManager.isActive()){disablePointer();return}if(!(hoverRect!=null&&hoverRect.containsPoint(offsetX,offsetY))){disablePointer();return}this.handlePointerTooltip(event,disablePointer),this.handlePointerNode(event)}handlePointerTooltip(event,disablePointer){const{lastPick,tooltip}=this,{range:range3}=tooltip,{offsetX,offsetY}=event;let pixelRange;isFiniteNumber(range3)&&(pixelRange=range3);const pick=this.pickSeriesNode({x:offsetX,y:offsetY},range3==="exact",pixelRange);if(!pick){this.tooltipManager.removeTooltip(this.id),this.highlight.range==="tooltip"&&disablePointer(!0);return}const isNewDatum=this.highlight.range==="node"||!lastPick||lastPick!==pick.datum;let html;isNewDatum&&(html=pick.series.getTooltipHtml(pick.datum),this.highlight.range==="tooltip"&&this.highlightManager.updateHighlight(this.id,pick.datum));const isPixelRange=pixelRange!=null,tooltipEnabled=this.tooltip.enabled&&pick.series.properties.tooltip.enabled,exactlyMatched=range3==="exact"&&pick.distance===0,shouldUpdateTooltip=tooltipEnabled&&(range3==="nearest"||isPixelRange||exactlyMatched)&&(!isNewDatum||html!==void 0),meta=TooltipManager.makeTooltipMeta(event,pick.datum);shouldUpdateTooltip&&this.tooltipManager.updateTooltip(this.id,meta,html)}handlePointerNode(event){this.checkSeriesNodeRange(event,(series,datum)=>{(series.hasEventListener("nodeClick")||series.hasEventListener("nodeDoubleClick"))&&this.cursorManager.updateCursor("chart","pointer"),this.highlight.range==="node"&&this.highlightManager.updateHighlight(this.id,datum)})||(this.cursorManager.updateCursor("chart"),this.highlight.range==="node"&&this.highlightManager.updateHighlight(this.id))}onClick(event){if(this.checkSeriesNodeClick(event)){this.update(4);return}this.fireEvent({type:"click",event:event.sourceEvent})}onDoubleClick(event){if(this.checkSeriesNodeDoubleClick(event)){this.update(4);return}this.fireEvent({type:"doubleClick",event:event.sourceEvent})}checkSeriesNodeClick(event){return this.checkSeriesNodeRange(event,(series,datum)=>series.fireNodeClickEvent(event.sourceEvent,datum))}checkSeriesNodeDoubleClick(event){return this.checkSeriesNodeRange(event,(series,datum)=>series.fireNodeDoubleClickEvent(event.sourceEvent,datum))}checkSeriesNodeRange(event,callback){const nearestNode=this.pickSeriesNode({x:event.offsetX,y:event.offsetY},!1),datum=nearestNode==null?void 0:nearestNode.datum,nodeClickRange=datum==null?void 0:datum.series.properties.nodeClickRange;let pixelRange;isFiniteNumber(nodeClickRange)&&(pixelRange=nodeClickRange);let pickedNode=this.pickSeriesNode({x:event.offsetX,y:event.offsetY},!0);if(pickedNode?this.highlightManager.updatePicked(this.id,pickedNode.datum):this.highlightManager.updatePicked(this.id),datum&&nodeClickRange==="nearest")return callback(datum.series,datum),!0;if(nodeClickRange!=="exact"&&(pickedNode=this.pickSeriesNode({x:event.offsetX,y:event.offsetY},!1,pixelRange)),!pickedNode)return!1;const isPixelRange=pixelRange!=null,exactlyMatched=nodeClickRange==="exact"&&pickedNode.distance===0;return isPixelRange||exactlyMatched?(callback(pickedNode.series,pickedNode.datum),!0):!1}changeHighlightDatum(event){var _a201,_b;const seriesToUpdate=new Set,{series:newSeries=void 0,datum:newDatum}=(_a201=event.currentHighlight)!=null?_a201:{},{series:lastSeries=void 0,datum:lastDatum}=(_b=event.previousHighlight)!=null?_b:{};lastSeries&&seriesToUpdate.add(lastSeries),newSeries&&seriesToUpdate.add(newSeries),lastSeries!=null&&lastSeries.properties.cursor&&lastDatum&&this.cursorManager.updateCursor(lastSeries.id),newSeries!=null&&newSeries.properties.cursor&&newDatum&&this.cursorManager.updateCursor(newSeries.id,newSeries.properties.cursor),this.lastPick=event.currentHighlight,newSeries==null||lastSeries==null?this.update(4):this.update(4,{seriesToUpdate})}waitForUpdate(timeoutMs=5e3){return __async(this,null,function*(){const start=performance.now();for(this._pendingFactoryUpdatesCount>0&&(yield this.updateMutex.waitForClearAcquireQueue());this.performUpdateType!==7;){if(performance.now()-start>timeoutMs)throw new Error("waitForUpdate() timeout reached.");yield sleep(5)}yield this.updateMutex.waitForClearAcquireQueue()})}getMinRect(){const minRects=this.series.map(series=>series.getMinRect()).filter(rect=>rect!==void 0);if(minRects.length)return new BBox(0,0,minRects.reduce((max,rect)=>Math.max(max,rect.width),0),minRects.reduce((max,rect)=>Math.max(max,rect.height),0))}filterMiniChartSeries(series){return series!=null?series.filter(s=>s.showInMiniChart!==!1):series}applyOptions(chartOptions){var _a201,_b,_c,_d,_e,_f;const oldOpts=this.processedOptions,deltaOptions=chartOptions.diffOptions(oldOpts),userOptions=chartOptions.userOptions;if(deltaOptions==null)return;debug("AgChartV2.updateDelta() - applying delta",deltaOptions);const completeOptions=mergeDefaults(deltaOptions,oldOpts),modulesChanged=this.applyModules(completeOptions),skip=["type","data","series","listeners","theme","legend.listeners","navigator.miniChart.label"];(isAgCartesianChartOptions(deltaOptions)||isAgPolarChartOptions(deltaOptions))&&skip.push("axes"),deltaOptions.listeners&&this.registerListeners(this,deltaOptions.listeners),this.applyOptionValues(this,deltaOptions,{skip});let forceNodeDataRefresh=!1,seriesStatus="no-op";deltaOptions.series&&deltaOptions.series.length>0&&(seriesStatus=this.applySeries(this,deltaOptions.series,oldOpts==null?void 0:oldOpts.series),forceNodeDataRefresh=!0),seriesStatus==="replaced"&&this.resetAnimations(),this.applyAxes(this,completeOptions,oldOpts,seriesStatus)&&(forceNodeDataRefresh=!0);const seriesDataUpdate=!!deltaOptions.data||seriesStatus==="data-change"||seriesStatus==="replaced",legendKeys=getLegendKeys(),optionsHaveLegend=Object.values(legendKeys).some(legendKey=>deltaOptions[legendKey]!=null),otherRefreshUpdate=deltaOptions.title!=null&&deltaOptions.subtitle!=null;forceNodeDataRefresh=forceNodeDataRefresh||seriesDataUpdate||optionsHaveLegend||otherRefreshUpdate,deltaOptions.data&&(this.data=deltaOptions.data),(_a201=deltaOptions.legend)!=null&&_a201.listeners&&Object.assign(this.legend.listeners,deltaOptions.legend.listeners),deltaOptions.listeners&&this.updateAllSeriesListeners(),this.chartOptions=chartOptions,this.processedOptions=completeOptions,this.userOptions=mergeDefaults(userOptions,this.userOptions);const navigatorModule=this.modules.get("navigator"),zoomModule=this.modules.get("zoom");!(navigatorModule!=null&&navigatorModule.enabled)&&!(zoomModule!=null&&zoomModule.enabled)&&this.zoomManager.updateZoom();const miniChart=navigatorModule==null?void 0:navigatorModule.miniChart;if((miniChart==null?void 0:miniChart.enabled)===!0&&(deltaOptions==null?void 0:deltaOptions.series)!=null){const seriesStatus2=this.applySeries(miniChart,this.filterMiniChartSeries(deltaOptions.series),this.filterMiniChartSeries(oldOpts==null?void 0:oldOpts.series));this.applyAxes(miniChart,deltaOptions,oldOpts,seriesStatus2,["axes[].tick","axes[].thickness","axes[].title","axes[].crosshair","axes[].gridLine","axes[].label"]);const axes=miniChart.axes,horizontalAxis=axes.find(axis=>axis.direction==="x");for(const axis of axes)axis.gridLine.enabled=!1,axis.label.enabled=axis===horizontalAxis,axis.tick.enabled=!1,axis.interactionEnabled=!1;if(horizontalAxis!=null){const labelOptions=(_c=(_b=deltaOptions.navigator)==null?void 0:_b.miniChart)==null?void 0:_c.label,intervalOptions=(_f=(_e=(_d=deltaOptions.navigator)==null?void 0:_d.miniChart)==null?void 0:_e.label)==null?void 0:_f.interval;jsonApply(horizontalAxis.label,labelOptions,{path:"navigator.miniChart.label",skip:["navigator.miniChart.label.interval","navigator.miniChart.label.rotation","navigator.miniChart.label.minSpacing","navigator.miniChart.label.autoRotate","navigator.miniChart.label.autoRotateAngle"]}),jsonApply(horizontalAxis.tick,intervalOptions,{path:"navigator.miniChart.interval",skip:["navigator.miniChart.interval.enabled","navigator.miniChart.interval.width","navigator.miniChart.interval.size","navigator.miniChart.interval.color","navigator.miniChart.interval.interval","navigator.miniChart.interval.step"]});const step=intervalOptions==null?void 0:intervalOptions.step;step!=null&&(horizontalAxis.tick.interval=step)}}else(miniChart==null?void 0:miniChart.enabled)===!1&&(miniChart.series=[],miniChart.axes=[]);const updateType=forceNodeDataRefresh||modulesChanged?1:3;debug("AgChartV2.applyChartOptions() - update type",ChartUpdateType[updateType]),this.update(updateType,{forceNodeDataRefresh,newAnimationBatch:!0})}applyModules(options){let modulesChanged=!1;for(const module of REGISTERED_MODULES){if(module.type!=="root"&&module.type!=="legend")continue;const optionsValue=options[module.optionsKey],shouldBeEnabled=module.chartTypes.includes(this.constructor.type)&&optionsValue!=null,isEnabled=this.isModuleEnabled(module);shouldBeEnabled!==isEnabled&&(shouldBeEnabled?(this.addModule(module),this[module.optionsKey]=this.modules.get(module.optionsKey)):(this.removeModule(module),delete this[module.optionsKey]),modulesChanged=!0)}return modulesChanged}applySeries(chart,optSeries,oldOptSeries){if(!optSeries)return"no-change";const matchResult=matchSeriesOptions(chart.series,optSeries,oldOptSeries);if(matchResult.status==="no-overlap")return debug(`AgChartV2.applySeries() - creating new series instances, status: ${matchResult.status}`,matchResult),chart.series=this.createSeries(optSeries),"replaced";debug("AgChartV2.applySeries() - matchResult",matchResult);const seriesInstances=[];for(const change of matchResult.changes){if(change.status==="add"){const newSeries=this.createSeries([change.opts])[0];seriesInstances.push(newSeries),debug("AgChartV2.applySeries() - created new series",newSeries);continue}else if(change.status==="remove"){debug(`AgChartV2.applySeries() - removing series at previous idx ${change.idx}`,change.series);continue}else if(change.status==="no-op"){seriesInstances.push(change.series),debug(`AgChartV2.applySeries() - no change to series at previous idx ${change.idx}`,change.series);continue}const{series,diff:diff2,idx}=change;debug(`AgChartV2.applySeries() - applying series diff previous idx ${idx}`,diff2,series),this.applySeriesValues(series,diff2),series.markNodeDataDirty(),seriesInstances.push(series)}for(let idx=0;idx<seriesInstances.length;idx++)seriesInstances[idx]._declarationOrder=idx;debug("AgChartV2.applySeries() - final series instances",seriesInstances),chart.series=seriesInstances;const dataChanged=matchResult.changes.some(({diff:diff2})=>diff2&&(diff2.seriesGrouping!=null||diff2.data!=null)),noop=matchResult.changes.every(c=>c.status==="no-op");return dataChanged?"data-change":noop?"no-op":"updated"}applyAxes(chart,options,oldOpts,seriesStatus,skip=[]){if(!("axes"in options)||!options.axes)return!1;skip=["axes[].type",...skip];const{axes}=options;return!(seriesStatus==="replaced")&&chart.axes.length===axes.length&&chart.axes.every((a,i)=>a.type===axes[i].type)&&isAgCartesianChartOptions(oldOpts)?(chart.axes.forEach((axis,index)=>{var _a201,_b;const previousOpts=(_b=(_a201=oldOpts.axes)==null?void 0:_a201[index])!=null?_b:{},axisDiff=jsonDiff(previousOpts,axes[index]);debug(`AgChartV2.applyAxes() - applying axis diff idx ${index}`,axisDiff);const path=`axes[${index}]`;this.applyOptionValues(axis,axisDiff,{path,skip})}),!0):(debug(`AgChartV2.applyAxes() - creating new axes instances; seriesStatus: ${seriesStatus}`),chart.axes=this.createAxis(axes,skip),!0)}createSeries(options){var _a201;const series=[],moduleContext=this.getModuleContext();for(const seriesOptions of options??[]){const type=(_a201=seriesOptions.type)!=null?_a201:"unknown";if(isEnterpriseSeriesType(type)&&!isEnterpriseSeriesTypeLoaded(type))continue;const seriesInstance=createSeries(type,moduleContext);this.applySeriesOptionModules(seriesInstance,seriesOptions),this.applySeriesValues(seriesInstance,seriesOptions),series.push(seriesInstance)}return series}applySeriesOptionModules(series,options){const moduleContext=series.createModuleContext(),moduleMap=series.getModuleMap();for(const module of REGISTERED_MODULES)module.type==="series-option"&&module.optionsKey in options&&module.seriesTypes.includes(series.type)&&moduleMap.addModule(module,module2=>new module2.instanceConstructor(moduleContext))}applySeriesValues(target,options){const moduleMap=target.getModuleMap(),_a201=options,{type,data,errorBar,listeners,seriesGrouping,showInMiniChart:_showInMiniChart}=_a201,seriesOptions=__objRest(_a201,["type","data","errorBar","listeners","seriesGrouping","showInMiniChart"]);target.properties.set(seriesOptions),"data"in options&&(target.data=options.data),"errorBar"in options&&moduleMap.isModuleEnabled("errorBar")&&moduleMap.getModule("errorBar").properties.set(options.errorBar),options!=null&&options.listeners&&this.registerListeners(target,options.listeners),seriesGrouping&&(target.seriesGrouping=__spreadValues(__spreadValues({},target.seriesGrouping),seriesGrouping))}createAxis(options,skip){const guesser=new AxisPositionGuesser,moduleContext=this.getModuleContext();let index=0;for(const axisOptions of options??[]){const axis=getAxis(axisOptions.type,moduleContext),path=`axes[${index++}]`;this.applyAxisModules(axis,axisOptions),this.applyOptionValues(axis,axisOptions,{path,skip}),guesser.push(axis,axisOptions)}return guesser.guessInvalidPositions()}applyAxisModules(axis,options){let modulesChanged=!1;const rootModules=REGISTERED_MODULES.filter(m=>m.type==="axis-option"),moduleContext=axis.createModuleContext();for(const module of rootModules){const shouldBeEnabled=options[module.optionsKey]!=null,moduleMap=axis.getModuleMap(),isEnabled=moduleMap.isModuleEnabled(module);shouldBeEnabled!==isEnabled&&(modulesChanged=!0,shouldBeEnabled?(moduleMap.addModule(module,module2=>new module2.instanceConstructor(moduleContext)),axis[module.optionsKey]=moduleMap.getModule(module)):(moduleMap.removeModule(module),delete axis[module.optionsKey]))}return modulesChanged}applyOptionValues(target,options,{skip,path}={}){const moduleContext=this.getModuleContext(),_CaptionWithContext=class _CaptionWithContext extends Caption{constructor(){super(),this.registerInteraction(moduleContext)}};__name(_CaptionWithContext,"CaptionWithContext");let CaptionWithContext=_CaptionWithContext;return jsonApply(target,options,{constructors:__spreadProps(__spreadValues({},JSON_APPLY_OPTIONS.constructors),{title:CaptionWithContext,subtitle:CaptionWithContext,footnote:CaptionWithContext}),constructedArrays:JSON_APPLY_PLUGINS.constructedArrays,allowedTypes:__spreadValues({},JSON_APPLY_OPTIONS.allowedTypes),skip,path})}registerListeners(source,listeners){source.clearEventListeners();for(const[property,listener]of Object.entries(listeners))isFunction(listener)&&source.addEventListener(property,listener)}},__name(_a122,"_Chart"),_a122);_Chart.chartsInstances=new WeakMap;_Chart.NodeValueChangeOptions={newValue(value){var _a201;(_a201=this.scene.root)==null||_a201.appendChild(value.node)},oldValue(oldValue){var _a201;(_a201=this.scene.root)==null||_a201.removeChild(oldValue.node)}};__decorateClass([ActionOnSet({newValue(value){this.destroyed||(value.setAttribute("data-ag-charts",""),value.appendChild(this.element),_Chart.chartsInstances.set(value,this))},oldValue(value){value.removeAttribute("data-ag-charts"),value.removeChild(this.element),_Chart.chartsInstances.delete(value)}})],_Chart.prototype,"container",2);__decorateClass([ActionOnSet({newValue(value){this.resize(value,void 0,"width option")}})],_Chart.prototype,"width",2);__decorateClass([ActionOnSet({newValue(value){this.resize(void 0,value,"height option")}})],_Chart.prototype,"height",2);__decorateClass([ActionOnSet({newValue(value){this.onAutoSizeChange(value)}}),Validate(BOOLEAN)],_Chart.prototype,"autoSize",2);__decorateClass([Validate(OBJECT)],_Chart.prototype,"padding",2);__decorateClass([Validate(OBJECT)],_Chart.prototype,"seriesArea",2);__decorateClass([ActionOnSet(_Chart.NodeValueChangeOptions)],_Chart.prototype,"title",2);__decorateClass([ActionOnSet(_Chart.NodeValueChangeOptions)],_Chart.prototype,"subtitle",2);__decorateClass([ActionOnSet(_Chart.NodeValueChangeOptions)],_Chart.prototype,"footnote",2);__decorateClass([Validate(UNION(["standalone","integrated"],"a chart mode"))],_Chart.prototype,"mode",2);__decorateClass([ActionOnSet({changeValue(newValue,oldValue=[]){for(const axis of oldValue)newValue.includes(axis)||(axis.detachAxis(this.axisGroup,this.axisGridGroup),axis.destroy());for(const axis of newValue)oldValue!=null&&oldValue.includes(axis)||axis.attachAxis(this.axisGroup,this.axisGridGroup);this.zoomManager.updateAxes(newValue)}})],_Chart.prototype,"axes",2);__decorateClass([ActionOnSet({changeValue(newValue,oldValue){this.onSeriesChange(newValue,oldValue)}})],_Chart.prototype,"series",2);var Chart=_Chart,_a123,DataModelSeries=(_a123=class extends Series{isContinuous(){var _a201,_b;const isContinuousX=ContinuousScale.is((_a201=this.axes.x)==null?void 0:_a201.scale),isContinuousY=ContinuousScale.is((_b=this.axes.y)==null?void 0:_b.scale);return{isContinuousX,isContinuousY}}getModulePropertyDefinitions(){return this.moduleMap.mapValues(mod2=>mod2.getPropertyDefinitions(this.isContinuous())).flat()}requestDataModel(dataController,data,opts){return __async(this,null,function*(){opts.props.push(...this.getModulePropertyDefinitions());const{dataModel,processedData}=yield dataController.request(this.id,data??[],opts);return this.dataModel=dataModel,this.processedData=processedData,this.dispatch("data-processed",{dataModel,processedData}),{dataModel,processedData}})}isProcessedDataAnimatable(){var _a201,_b;const validationResults=(_b=(_a201=this.processedData)==null?void 0:_a201.reduced)==null?void 0:_b.animationValidation;if(!validationResults)return!0;const{orderedKeys,uniqueKeys}=validationResults;return orderedKeys&&uniqueKeys}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}},__name(_a123,"DataModelSeries"),_a123),_a124,SeriesItemHighlightStyle=(_a124=class extends BaseProperties{constructor(){super(...arguments),this.fill="rgba(255,255,255, 0.33)",this.stroke="rgba(0, 0, 0, 0.4)",this.strokeWidth=2}},__name(_a124,"SeriesItemHighlightStyle"),_a124);__decorateClass([Validate(COLOR_STRING,{optional:!0})],SeriesItemHighlightStyle.prototype,"fill",2);__decorateClass([Validate(RATIO,{optional:!0})],SeriesItemHighlightStyle.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],SeriesItemHighlightStyle.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],SeriesItemHighlightStyle.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO,{optional:!0})],SeriesItemHighlightStyle.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH,{optional:!0})],SeriesItemHighlightStyle.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],SeriesItemHighlightStyle.prototype,"lineDashOffset",2);var _a125,SeriesHighlightStyle=(_a125=class extends BaseProperties{},__name(_a125,"SeriesHighlightStyle"),_a125);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],SeriesHighlightStyle.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO,{optional:!0})],SeriesHighlightStyle.prototype,"dimOpacity",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],SeriesHighlightStyle.prototype,"enabled",2);var _a126,TextHighlightStyle=(_a126=class extends BaseProperties{constructor(){super(...arguments),this.color="black"}},__name(_a126,"TextHighlightStyle"),_a126);__decorateClass([Validate(COLOR_STRING,{optional:!0})],TextHighlightStyle.prototype,"color",2);var _a127,HighlightStyle=(_a127=class extends BaseProperties{constructor(){super(...arguments),this.item=new SeriesItemHighlightStyle,this.series=new SeriesHighlightStyle,this.text=new TextHighlightStyle}},__name(_a127,"HighlightStyle"),_a127);__decorateClass([Validate(OBJECT)],HighlightStyle.prototype,"item",2);__decorateClass([Validate(OBJECT)],HighlightStyle.prototype,"series",2);__decorateClass([Validate(OBJECT)],HighlightStyle.prototype,"text",2);var _a128,SeriesProperties=(_a128=class extends BaseProperties{constructor(){super(...arguments),this.visible=!0,this.showInLegend=!0,this.cursor="default",this.nodeClickRange="exact",this.highlightStyle=new HighlightStyle}},__name(_a128,"SeriesProperties"),_a128);__decorateClass([Validate(STRING,{optional:!0})],SeriesProperties.prototype,"id",2);__decorateClass([Validate(BOOLEAN)],SeriesProperties.prototype,"visible",2);__decorateClass([Validate(BOOLEAN)],SeriesProperties.prototype,"showInLegend",2);__decorateClass([Validate(STRING)],SeriesProperties.prototype,"cursor",2);__decorateClass([Validate(INTERACTION_RANGE)],SeriesProperties.prototype,"nodeClickRange",2);__decorateClass([Validate(OBJECT)],SeriesProperties.prototype,"highlightStyle",2);var DEFAULT_DIRECTION_KEYS={x:["xKey"],y:["yKey"]},DEFAULT_DIRECTION_NAMES={x:["xName"],y:["yName"]},_a129,CartesianSeriesNodeClickEvent=(_a129=class extends SeriesNodeClickEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.xKey=series.properties.xKey,this.yKey=series.properties.yKey}},__name(_a129,"CartesianSeriesNodeClickEvent"),_a129),_a130,CartesianSeriesProperties=(_a130=class extends SeriesProperties{},__name(_a130,"CartesianSeriesProperties"),_a130);__decorateClass([Validate(STRING,{optional:!0})],CartesianSeriesProperties.prototype,"legendItemName",2);var _a131,CartesianSeries=(_a131=class extends DataModelSeries{constructor(_a201){var _b=_a201,{pathsPerSeries=1,hasMarkers=!1,hasHighlightedLabels=!1,pathsZIndexSubOrderOffset=[],directionKeys=DEFAULT_DIRECTION_KEYS,directionNames=DEFAULT_DIRECTION_NAMES,datumSelectionGarbageCollection=!0,markerSelectionGarbageCollection=!0,animationAlwaysUpdateSelections=!1,animationResetFns}=_b,otherOpts=__objRest(_b,["pathsPerSeries","hasMarkers","hasHighlightedLabels","pathsZIndexSubOrderOffset","directionKeys","directionNames","datumSelectionGarbageCollection","markerSelectionGarbageCollection","animationAlwaysUpdateSelections","animationResetFns"]);super(__spreadValues({directionKeys,directionNames,useSeriesGroupLayer:!0,canHaveAxes:!0},otherOpts)),this._contextNodeData=[],this.NodeClickEvent=CartesianSeriesNodeClickEvent,this.highlightSelection=Selection.select(this.highlightNode,()=>this.opts.hasMarkers?this.markerFactory():this.nodeFactory()),this.highlightLabelSelection=Selection.select(this.highlightLabel,Text),this.annotationSelections=new Set,this.subGroups=[],this.subGroupId=0,this.debug=Debug.create(),this.opts={pathsPerSeries,hasMarkers,hasHighlightedLabels,pathsZIndexSubOrderOffset,directionKeys,directionNames,animationResetFns,animationAlwaysUpdateSelections,datumSelectionGarbageCollection,markerSelectionGarbageCollection},this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:data=>this.animateEmptyUpdateReady(data)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:data=>this.animateReadyHighlight(data),highlightMarkers:data=>this.animateReadyHighlightMarkers(data),resize:data=>this.animateReadyResize(data),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:data=>this.animateWaitingUpdateReady(data)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:data=>this.animateClearingUpdateEmpty(data)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}get contextNodeData(){return this._contextNodeData.slice()}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"&&this.animationState.transition("skip")}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",event=>this.onLegendItemClick(event)),this.ctx.chartEventManager.addListener("legend-item-double-click",event=>this.onLegendItemDoubleClick(event)))}destroy(){super.destroy(),this._contextNodeData.splice(0,this._contextNodeData.length),this.subGroups.splice(0,this.subGroups.length)}update(_0){return __async(this,arguments,function*({seriesRect}){var _a201,_b;const{visible,_contextNodeData:previousContextData}=this,{series}=(_b=(_a201=this.ctx.highlightManager)==null?void 0:_a201.getActiveHighlight())!=null?_b:{},seriesHighlighted=series?series===this:void 0,resize=this.checkResize(seriesRect),highlightItems=yield this.updateHighlightSelection(seriesHighlighted);yield this.updateSelections(visible),yield this.updateNodes(highlightItems,seriesHighlighted,visible);const animationData=this.getAnimationData(seriesRect,previousContextData);resize&&this.animationState.transition("resize",animationData),this.animationState.transition("update",animationData)})}updateSelections(anySeriesItemEnabled){return __async(this,null,function*(){const animationSkipUpdate=!this.opts.animationAlwaysUpdateSelections&&this.ctx.animationManager.isSkipped();if(!(!anySeriesItemEnabled&&animationSkipUpdate)&&!(!this.nodeDataRefresh&&!this.isPathOrSelectionDirty())){if(this.nodeDataRefresh){this.nodeDataRefresh=!1,this.debug("CartesianSeries.updateSelections() - calling createNodeData() for",this.id),this._contextNodeData=yield this.createNodeData();const animationValid=this.isProcessedDataAnimatable();this._contextNodeData.forEach(nodeData=>{var _a201;(_a201=nodeData.animationValid)!=null||(nodeData.animationValid=animationValid)}),yield this.updateSeriesGroups();const{dataModel,processedData}=this;dataModel!==void 0&&processedData!==void 0&&this.dispatch("data-update",{dataModel,processedData})}yield Promise.all(this.subGroups.map((g,i)=>this.updateSeriesGroupSelections(g,i)))}})}updateSeriesGroupSelections(subGroup,seriesIdx,seriesHighlighted){return __async(this,null,function*(){const{datumSelection,labelSelection,markerSelection,paths}=subGroup,contextData=this._contextNodeData[seriesIdx],{nodeData,labelData,itemId}=contextData;yield this.updatePaths({seriesHighlighted,itemId,contextData,paths,seriesIdx}),subGroup.datumSelection=yield this.updateDatumSelection({nodeData,datumSelection,seriesIdx}),subGroup.labelSelection=yield this.updateLabelSelection({labelData,labelSelection,seriesIdx}),markerSelection&&(subGroup.markerSelection=yield this.updateMarkerSelection({nodeData,markerSelection,seriesIdx}))})}markerFactory(){const MarkerShape=getMarker();return new MarkerShape}updateSeriesGroups(){return __async(this,null,function*(){const{_contextNodeData:contextNodeData,contentGroup,subGroups,opts:{pathsPerSeries,hasMarkers,datumSelectionGarbageCollection,markerSelectionGarbageCollection}}=this;if(contextNodeData.length===subGroups.length)return;contextNodeData.length<subGroups.length&&subGroups.splice(contextNodeData.length).forEach(({dataNodeGroup,markerGroup,labelGroup,paths})=>{contentGroup.removeChild(dataNodeGroup),markerGroup&&contentGroup.removeChild(markerGroup),labelGroup&&contentGroup.removeChild(labelGroup);for(const path of paths)contentGroup.removeChild(path)});const totalGroups=contextNodeData.length;for(;totalGroups>subGroups.length;){const subGroupId=this.subGroupId++,dataNodeGroup=new Group({name:`${this.id}-series-sub${subGroupId}-dataNodes`,layer:!1,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("data",subGroupId)}),markerGroup=hasMarkers?new Group({name:`${this.id}-series-sub${this.subGroupId++}-markers`,layer:!1,zIndex:4,zIndexSubOrder:this.getGroupZIndexSubOrder("marker",subGroupId)}):void 0,labelGroup=new Group({name:`${this.id}-series-sub${this.subGroupId++}-labels`,layer:!1,zIndex:7,zIndexSubOrder:this.getGroupZIndexSubOrder("labels",subGroupId)});contentGroup.appendChild(dataNodeGroup),contentGroup.appendChild(labelGroup),markerGroup&&contentGroup.appendChild(markerGroup);const paths=[];for(let index=0;index<pathsPerSeries;index++)paths[index]=new Path,paths[index].zIndex=4,paths[index].zIndexSubOrder=this.getGroupZIndexSubOrder("paths",index),contentGroup.appendChild(paths[index]);subGroups.push({paths,dataNodeGroup,markerGroup,labelGroup,labelSelection:Selection.select(labelGroup,Text),datumSelection:Selection.select(dataNodeGroup,()=>this.nodeFactory(),datumSelectionGarbageCollection),markerSelection:markerGroup?Selection.select(markerGroup,()=>this.markerFactory(),markerSelectionGarbageCollection):void 0})}})}getGroupZIndexSubOrder(type,subIndex=0){var _a201;const result=super.getGroupZIndexSubOrder(type,subIndex);if(type==="paths"){const pathOffset=(_a201=this.opts.pathsZIndexSubOrderOffset[subIndex])!=null?_a201:0,superFn=result[0];typeof superFn=="function"?result[0]=()=>+superFn()+pathOffset:result[0]=+superFn+pathOffset}return result}updateNodes(highlightedItems,seriesHighlighted,anySeriesItemEnabled){return __async(this,null,function*(){var _a201;const{highlightSelection,highlightLabelSelection,opts:{hasMarkers,hasHighlightedLabels}}=this,animationEnabled=!this.ctx.animationManager.isSkipped(),visible=this.visible&&((_a201=this._contextNodeData)==null?void 0:_a201.length)>0&&anySeriesItemEnabled;this.rootGroup.visible=animationEnabled||visible,this.contentGroup.visible=animationEnabled||visible,this.highlightGroup.visible=(animationEnabled||visible)&&!!seriesHighlighted;const subGroupOpacity=this.getOpacity();hasMarkers?(yield this.updateMarkerNodes({markerSelection:highlightSelection,isHighlight:!0,seriesIdx:-1}),this.animationState.transition("highlightMarkers",highlightSelection)):(yield this.updateDatumNodes({datumSelection:highlightSelection,isHighlight:!0,seriesIdx:-1}),this.animationState.transition("highlight",highlightSelection)),hasHighlightedLabels&&(yield this.updateLabelNodes({labelSelection:highlightLabelSelection,seriesIdx:-1})),yield Promise.all(this.subGroups.map((subGroup,seriesIdx)=>__async(this,null,function*(){const{dataNodeGroup,markerGroup,datumSelection,labelSelection,markerSelection,paths,labelGroup}=subGroup,{itemId}=this.contextNodeData[seriesIdx],subGroupVisible=visible;dataNodeGroup.opacity=subGroupOpacity,dataNodeGroup.visible=animationEnabled||subGroupVisible,labelGroup.visible=subGroupVisible,markerGroup&&(markerGroup.opacity=subGroupOpacity,markerGroup.zIndex=dataNodeGroup.zIndex>=4?dataNodeGroup.zIndex:dataNodeGroup.zIndex+1,markerGroup.visible=subGroupVisible),labelGroup&&(labelGroup.opacity=subGroupOpacity),yield this.updatePathNodes({seriesHighlighted,itemId,paths,seriesIdx,opacity:subGroupOpacity,visible:subGroupVisible,animationEnabled}),dataNodeGroup.visible&&(yield this.updateDatumNodes({datumSelection,highlightedItems,isHighlight:!1,seriesIdx}),yield this.updateLabelNodes({labelSelection,seriesIdx}),hasMarkers&&markerSelection&&(yield this.updateMarkerNodes({markerSelection,isHighlight:!1,seriesIdx})))})))})}getHighlightLabelData(labelData,highlightedItem){const labelItems=labelData.filter(ld=>ld.datum===highlightedItem.datum&&ld.itemId===highlightedItem.itemId);return labelItems.length!==0?labelItems:void 0}getHighlightData(_nodeData,highlightedItem){return highlightedItem?[highlightedItem]:void 0}updateHighlightSelection(seriesHighlighted){return __async(this,null,function*(){var _a201;const{highlightSelection,highlightLabelSelection,_contextNodeData:contextNodeData}=this,highlightedDatum=(_a201=this.ctx.highlightManager)==null?void 0:_a201.getActiveHighlight(),item=seriesHighlighted&&(highlightedDatum!=null&&highlightedDatum.datum)?highlightedDatum:void 0;let labelItems,highlightItems;if(item!=null){const labelsEnabled=this.isLabelEnabled();for(const{labelData,nodeData}of contextNodeData)if(highlightItems=this.getHighlightData(nodeData,item),labelItems=labelsEnabled?this.getHighlightLabelData(labelData,item):void 0,(!labelsEnabled||labelItems!=null)&&highlightItems!=null)break}return this.highlightSelection=yield this.updateHighlightSelectionItem({items:highlightItems,highlightSelection}),this.highlightLabelSelection=yield this.updateHighlightSelectionLabel({items:labelItems,highlightLabelSelection}),highlightItems})}pickNodeExactShape(point){var _a201;const result=super.pickNodeExactShape(point);if(result)return result;const{x,y}=point,{opts:{hasMarkers}}=this;for(const{dataNodeGroup,markerGroup}of this.subGroups){let match2=dataNodeGroup.pickNode(x,y);if(!match2&&hasMarkers&&(match2=markerGroup==null?void 0:markerGroup.pickNode(x,y)),match2)break}for(const mod2 of this.moduleMap.modules){const{datum}=(_a201=mod2.pickNodeExact(point))!=null?_a201:{};if(datum!==void 0)return{datum,distance:0}}}pickNodeClosestDatum(point){var _a201,_b;const{x,y}=point,{axes,rootGroup,_contextNodeData:contextNodeData}=this,xAxis=axes.x,yAxis=axes.y,hitPoint=rootGroup.transformPoint(x,y);let minDistance=1/0,closestDatum;for(const context of contextNodeData)for(const datum of context.nodeData){const{point:{x:datumX=NaN,y:datumY=NaN}={}}=datum;if(isNaN(datumX)||isNaN(datumY)||!((xAxis==null?void 0:xAxis.inRange(datumX))&&(yAxis==null?void 0:yAxis.inRange(datumY))))continue;const distance2=Math.max(__pow(hitPoint.x-datumX,2)+__pow(hitPoint.y-datumY,2),0);distance2<minDistance&&(minDistance=distance2,closestDatum=datum)}for(const mod2 of this.moduleMap.modules){const modPick=mod2.pickNodeNearest(point);if(modPick!==void 0&&modPick.distanceSquared<minDistance){minDistance=modPick.distanceSquared,closestDatum=modPick.datum;break}}if(closestDatum){const distance2=Math.max(Math.sqrt(minDistance)-((_b=(_a201=closestDatum.point)==null?void 0:_a201.size)!=null?_b:0),0);return{datum:closestDatum,distance:distance2}}}pickNodeMainAxisFirst(point,requireCategoryAxis){var _a201,_b;const{x,y}=point,{axes,rootGroup,_contextNodeData:contextNodeData}=this,xAxis=axes.x,yAxis=axes.y,directions2=[xAxis,yAxis].filter(a=>a instanceof CategoryAxis).map(a=>a.direction);if(requireCategoryAxis&&directions2.length===0)return;const[primaryDirection="x"]=directions2,hitPoint=rootGroup.transformPoint(x,y),hitPointCoords=primaryDirection==="x"?[hitPoint.x,hitPoint.y]:[hitPoint.y,hitPoint.x],minDistance=[1/0,1/0];let closestDatum;for(const context of contextNodeData)for(const datum of context.nodeData){const{point:{x:datumX=NaN,y:datumY=NaN}={}}=datum;if(isNaN(datumX)||isNaN(datumY)||!((xAxis==null?void 0:xAxis.inRange(datumX))&&(yAxis==null?void 0:yAxis.inRange(datumY))))continue;const point2=primaryDirection==="x"?[datumX,datumY]:[datumY,datumX];let newMinDistance=!0;for(let i=0;i<point2.length;i++){const dist=Math.abs(point2[i]-hitPointCoords[i]);if(dist>minDistance[i]){newMinDistance=!1;break}dist<minDistance[i]&&(minDistance[i]=dist,minDistance.fill(1/0,i+1,minDistance.length))}newMinDistance&&(closestDatum=datum)}if(closestDatum){let closestDistanceSquared=Math.max(__pow(minDistance[0],2)+__pow(minDistance[1],2)-((_b=(_a201=closestDatum.point)==null?void 0:_a201.size)!=null?_b:0),0);for(const mod2 of this.moduleMap.modules){const modPick=mod2.pickNodeMainAxisFirst(point);if(modPick!==void 0&&modPick.distanceSquared<closestDistanceSquared){closestDatum=modPick.datum,closestDistanceSquared=modPick.distanceSquared;break}}return{datum:closestDatum,distance:Math.sqrt(closestDistanceSquared)}}}onLegendItemClick(event){const{legendItemName}=this.properties,{enabled,itemId,series}=event,matchedLegendItemName=legendItemName!=null&&legendItemName===event.legendItemName;(series.id===this.id||matchedLegendItemName)&&this.toggleSeriesItem(itemId,enabled)}onLegendItemDoubleClick(event){const{enabled,itemId,series,numVisibleItems}=event,{legendItemName}=this.properties,matchedLegendItemName=legendItemName!=null&&legendItemName===event.legendItemName;series.id===this.id||matchedLegendItemName?this.toggleSeriesItem(itemId,!0):enabled&&numVisibleItems===1?this.toggleSeriesItem(itemId,!0):this.toggleSeriesItem(itemId,!1)}isPathOrSelectionDirty(){return!1}getLabelData(){return[]}shouldFlipXY(){return!1}getMinRect(){const[context]=this._contextNodeData;if(!(context!=null&&context.nodeData.length))return;const width=context.nodeData.map(({midPoint})=>{var _a201;return(_a201=midPoint==null?void 0:midPoint.x)!=null?_a201:0}).sort((a,b)=>a-b).reduce((max,x,i,array)=>i>0?Math.max(max,x-array[i-1]):max,0),height=context.nodeData.map(({midPoint})=>{var _a201;return(_a201=midPoint==null?void 0:midPoint.y)!=null?_a201:0}).sort((a,b)=>a-b).reduce((max,y,i,array)=>i>0?Math.max(max,y-array[i-1]):max,0);return new BBox(0,0,width,height)}updateHighlightSelectionItem(opts){return __async(this,null,function*(){const{opts:{hasMarkers}}=this,{items,highlightSelection}=opts,nodeData=items??[];if(hasMarkers){const markerSelection=highlightSelection;return this.updateMarkerSelection({nodeData,markerSelection,seriesIdx:-1})}else return this.updateDatumSelection({nodeData,datumSelection:highlightSelection,seriesIdx:-1})})}updateHighlightSelectionLabel(opts){return __async(this,null,function*(){var _a201;return this.updateLabelSelection({labelData:(_a201=opts.items)!=null?_a201:[],labelSelection:opts.highlightLabelSelection,seriesIdx:-1})})}updateDatumSelection(opts){return __async(this,null,function*(){return opts.datumSelection})}updateDatumNodes(_opts){return __async(this,null,function*(){})}updateMarkerSelection(opts){return __async(this,null,function*(){return opts.markerSelection})}updateMarkerNodes(_opts){return __async(this,null,function*(){})}updatePaths(opts){return __async(this,null,function*(){opts.paths.forEach(p=>p.visible=!1)})}updatePathNodes(opts){return __async(this,null,function*(){const{paths,opacity,visible}=opts;for(const path of paths)path.opacity=opacity,path.visible=visible})}resetAllAnimation(data){var _a201,_b;const{path,datum,label,marker}=(_b=(_a201=this.opts)==null?void 0:_a201.animationResetFns)!=null?_b:{};this.ctx.animationManager.stopByAnimationGroupId(this.id),path&&data.paths.forEach(paths=>{resetMotion(paths,path)}),datum&&resetMotion(data.datumSelections,datum),label&&resetMotion(data.labelSelections,label),marker&&resetMotion(data.markerSelections,marker),data.contextData.some(d=>d.animationValid===!1)&&this.ctx.animationManager.skipCurrentBatch()}animateEmptyUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateWaitingUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateReadyHighlight(data){var _a201,_b;const{datum}=(_b=(_a201=this.opts)==null?void 0:_a201.animationResetFns)!=null?_b:{};datum&&resetMotion([data],datum)}animateReadyHighlightMarkers(data){var _a201,_b;const{marker}=(_b=(_a201=this.opts)==null?void 0:_a201.animationResetFns)!=null?_b:{};marker&&resetMotion([data],marker)}animateReadyResize(data){this.resetAllAnimation(data)}animateClearingUpdateEmpty(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animationTransitionClear(){this.animationState.transition("clear",this.getAnimationData())}getAnimationData(seriesRect,previousContextData){return{datumSelections:this.subGroups.map(({datumSelection})=>datumSelection),markerSelections:this.subGroups.filter(({markerSelection})=>markerSelection!==void 0).map(({markerSelection})=>markerSelection),labelSelections:this.subGroups.map(({labelSelection})=>labelSelection),annotationSelections:[...this.annotationSelections],contextData:this._contextNodeData,previousContextData,paths:this.subGroups.map(({paths})=>paths),seriesRect}}calculateScaling(){const result={},addScale=__name(direction=>{const axis=this.axes[direction];if(axis){if(axis.scale instanceof LogScale){const{range:range3,domain}=axis.scale;result[direction]={type:"log",convert:domain2=>axis.scale.convert(domain2),domain:[domain[0],domain[1]],range:[range3[0],range3[1]]}}else if(axis.scale instanceof ContinuousScale){const{range:range3}=axis.scale,domain=axis.scale.getDomain();result[direction]={type:"continuous",domain:[domain[0],domain[1]],range:[range3[0],range3[1]]}}else if(axis.scale){const{domain}=axis.scale;result[direction]={type:"category",domain,range:domain.map(d=>axis.scale.convert(d))}}}},"addScale");return addScale("x"),addScale("y"),result}},__name(_a131,"CartesianSeries"),_a131),directions=["top","right","bottom","left"],_a132,_CartesianChart=(_a132=class extends Chart{constructor(options,resources){super(options,resources),this.paired=!0,this.firstSeriesTranslation=!0,this._lastCrossLineIds=void 0,this._lastAxisWidths={top:0,bottom:0,left:0,right:0},this._lastVisibility={crossLines:!0,series:!0}}destroySeries(series){super.destroySeries(series),this.firstSeriesTranslation=!0}performLayout(){return __async(this,null,function*(){const shrinkRect=yield __superGet(_a132.prototype,this,"performLayout").call(this),{firstSeriesTranslation,seriesRoot}=this,{animationRect,seriesRect,visibility,clipSeries}=this.updateAxes(shrinkRect);this.seriesRoot.visible=visibility.series,this.seriesRect=seriesRect,this.animationRect=animationRect;const{x,y}=seriesRect;if(firstSeriesTranslation)seriesRoot.translationX=Math.floor(x),seriesRoot.translationY=Math.floor(y),this.firstSeriesTranslation=!1;else{const{translationX,translationY}=seriesRoot;staticFromToMotion(this.id,"seriesRect",this.animationManager,[this.seriesRoot],{translationX,translationY},{translationX:Math.floor(x),translationY:Math.floor(y)},{phase:"update"})}const seriesPaddedRect=seriesRect.clone().grow(this.seriesArea.padding);this.hoverRect=seriesPaddedRect,this.layoutService.dispatchLayoutComplete({type:"layout-complete",chart:{width:this.scene.width,height:this.scene.height},clipSeries,series:{rect:seriesRect,paddedRect:seriesPaddedRect,visible:visibility.series,shouldFlipXY:this.shouldFlipXY()},axes:this.axes.map(axis=>__spreadValues({id:axis.id},axis.getLayoutState()))});const modulePromises=Array.from(this.modules.values(),m=>{var _a201;return(_a201=m.performCartesianLayout)==null?void 0:_a201.call(m,{seriesRect})});return yield Promise.all(modulePromises),shrinkRect})}updateAxes(inputShrinkRect){var _a201;const crossLineIds=this.axes.flatMap(axis=>{var _a210;return(_a210=axis.crossLines)!=null?_a210:[]}).map(crossLine=>crossLine.id),axesValid=this._lastCrossLineIds!=null&&this._lastCrossLineIds.length===crossLineIds.length&&this._lastCrossLineIds.every((id,index)=>crossLineIds[index]===id);let axisWidths,visibility;axesValid?(axisWidths=__spreadValues({},this._lastAxisWidths),visibility=__spreadValues({},this._lastVisibility)):(axisWidths={top:0,bottom:0,left:0,right:0},visibility={crossLines:!0,series:!0},this._lastCrossLineIds=crossLineIds);const liveAxisWidths=new Set(this.axes.map(a=>a.position));for(const position of Object.keys(axisWidths))liveAxisWidths.has(position)||delete axisWidths[position];const stableOutputs=__name((otherAxisWidths,otherVisibility)=>Object.keys(otherAxisWidths).some(k=>axisWidths[k]==null)?!1:visibility.crossLines===otherVisibility.crossLines&&visibility.series===otherVisibility.series&&Object.entries(axisWidths).every(([p,w])=>{const otherW=otherAxisWidths[p];return w!=null||otherW!=null?w===otherW:!0}),"stableOutputs"),ceilValues=__name(records=>mapValues(records,value=>value&&Math.abs(value)===1/0?0:value!=null?Math.ceil(value):value),"ceilValues");let lastPassAxisWidths={},lastPassVisibility={},clipSeries=!1,seriesRect=(_a201=this.seriesRect)==null?void 0:_a201.clone(),count2=0,primaryTickCounts={};do{Object.assign(axisWidths,lastPassAxisWidths),Object.assign(visibility,lastPassVisibility);const result=this.updateAxesPass(axisWidths,inputShrinkRect.clone(),seriesRect);if(lastPassAxisWidths=ceilValues(result.axisWidths),lastPassVisibility=result.visibility,clipSeries=result.clipSeries,seriesRect=result.seriesRect,primaryTickCounts=result.primaryTickCounts,count2++>10){Logger.warn("unable to find stable axis layout.");break}}while(!stableOutputs(lastPassAxisWidths,lastPassVisibility));this.axes.forEach(axis=>{axis.update(primaryTickCounts[axis.direction])});const clipRectPadding=5;return this.axes.forEach(axis=>{if(axis.setCrossLinesVisible(visibility.crossLines),!!seriesRect)switch(axis.clipGrid(seriesRect.x,seriesRect.y,seriesRect.width+clipRectPadding,seriesRect.height+clipRectPadding),axis.position){case"left":case"right":axis.clipTickLines(inputShrinkRect.x,seriesRect.y,inputShrinkRect.width+clipRectPadding,seriesRect.height+clipRectPadding);break;case"top":case"bottom":axis.clipTickLines(seriesRect.x,inputShrinkRect.y,seriesRect.width+clipRectPadding,inputShrinkRect.height+clipRectPadding);break}}),this._lastAxisWidths=axisWidths,this._lastVisibility=visibility,{seriesRect,animationRect:inputShrinkRect,visibility,clipSeries}}updateAxesPass(axisWidths,bounds,lastPassSeriesRect){const visited={},newAxisWidths={},visibility={series:!0,crossLines:!0};let clipSeries=!1;const primaryTickCounts={},paddedBounds=this.applySeriesPadding(bounds),crossLinePadding=lastPassSeriesRect?this.buildCrossLinePadding(axisWidths):{},axisBound=this.buildAxisBound(paddedBounds,axisWidths,crossLinePadding,visibility),seriesRect=this.buildSeriesRect(axisBound,axisWidths);return this.axes.forEach(axis=>{var _a201,_b;const{position="left"}=axis,{clipSeries:newClipSeries,axisThickness,axisOffset}=this.calculateAxisDimensions({axis,seriesRect,paddedBounds,axisWidths,newAxisWidths,primaryTickCounts,clipSeries,addInterAxisPadding:((_a201=visited[position])!=null?_a201:0)>0});visited[position]=((_b=visited[position])!=null?_b:0)+1,clipSeries=clipSeries||newClipSeries,this.positionAxis({axis,axisBound,axisOffset,axisThickness,axisWidths,primaryTickCounts,seriesRect})}),{clipSeries,seriesRect,axisWidths:newAxisWidths,visibility,primaryTickCounts}}buildCrossLinePadding(axisWidths){var _a201;const crossLinePadding={};this.axes.forEach(axis=>{axis.crossLines&&axis.crossLines.forEach(crossLine=>{crossLine.calculatePadding(crossLinePadding)})});for(const[side,padding=0]of Object.entries(crossLinePadding))crossLinePadding[side]=Math.max(padding-((_a201=axisWidths[side])!=null?_a201:0),0);return crossLinePadding}applySeriesPadding(bounds){const paddedRect=bounds.clone(),reversedAxes=this.axes.slice().reverse();return directions.forEach(dir=>{const padding=this.seriesArea.padding[dir],axis=reversedAxes.find(axis2=>axis2.position===dir);axis?axis.seriesAreaPadding=padding:paddedRect.shrink(padding,dir)}),paddedRect}buildAxisBound(bounds,axisWidths,crossLinePadding,visibility){var _a201,_b,_c,_d;const result=bounds.clone(),{top=0,right=0,bottom=0,left=0}=crossLinePadding,horizontalPadding=left+right,verticalPadding=top+bottom,totalWidth=((_a201=axisWidths.left)!=null?_a201:0)+((_b=axisWidths.right)!=null?_b:0)+horizontalPadding,totalHeight=((_c=axisWidths.top)!=null?_c:0)+((_d=axisWidths.bottom)!=null?_d:0)+verticalPadding;return result.width<=totalWidth||result.height<=totalHeight?(visibility.crossLines=!1,visibility.series=!1,result):(result.x+=left,result.y+=top,result.width-=horizontalPadding,result.height-=verticalPadding,result)}buildSeriesRect(axisBound,axisWidths){const result=axisBound.clone(),{top,bottom,left,right}=axisWidths;return result.x+=left??0,result.y+=top??0,result.width-=(left??0)+(right??0),result.height-=(top??0)+(bottom??0),result.width=Math.max(0,result.width),result.height=Math.max(0,result.height),result}clampToOutsideSeriesRect(seriesRect,value,dimension,direction){const{x,y,width,height}=seriesRect,compareTo=[x,y,x+width,y+height][(dimension==="x"?0:1)+(direction===1?0:2)];return(direction===1?Math.min:Math.max)(value,compareTo)}calculateAxisDimensions(opts){var _a201,_b,_c,_d,_e;const{axis,seriesRect,paddedBounds,axisWidths,newAxisWidths,primaryTickCounts,addInterAxisPadding}=opts;let{clipSeries}=opts;const{position="left",direction}=axis,axisLeftRightRange=__name(axis2=>axis2 instanceof CategoryAxis||axis2 instanceof GroupedCategoryAxis?[0,seriesRect.height]:[seriesRect.height,0],"axisLeftRightRange"),axisOffset=(_a201=newAxisWidths[position])!=null?_a201:0;switch(position){case"top":case"bottom":axis.range=[0,seriesRect.width],axis.gridLength=seriesRect.height;break;case"right":case"left":axis.range=axisLeftRightRange(axis),axis.gridLength=seriesRect.width;break}const{min,max}=this.zoomManager.getAxisZoom(axis.id);axis.visibleRange=[min,max],clipSeries||(clipSeries=axis.dataDomain.clipped||axis.visibleRange[0]>0||axis.visibleRange[1]<1);let primaryTickCount=axis.nice?primaryTickCounts[direction]:void 0;const isVertical=direction==="y",paddedBoundsCoefficient=.3;axis.maxThickness=axis.thickness||(isVertical?paddedBounds.width:paddedBounds.height)*paddedBoundsCoefficient;const layout=axis.calculateLayout(primaryTickCount);primaryTickCount=layout.primaryTickCount,(_b=primaryTickCounts[direction])!=null||(primaryTickCounts[direction]=primaryTickCount);let axisThickness;if(axis.thickness!=null&&axis.thickness>0)axisThickness=axis.thickness;else{const{bbox}=layout;axisThickness=isVertical?bbox.width:bbox.height}return addInterAxisPadding&&(axisThickness+=15),axisThickness=Math.ceil(axisThickness),newAxisWidths[position]=((_c=newAxisWidths[position])!=null?_c:0)+axisThickness,axis.gridPadding=((_d=axisWidths[position])!=null?_d:0)-((_e=newAxisWidths[position])!=null?_e:0),{clipSeries,axisThickness,axisOffset,primaryTickCount}}positionAxis(opts){var _a201,_b,_c,_d;const{axis,axisBound,axisWidths,seriesRect,axisOffset,axisThickness}=opts,{position}=axis;switch(position){case"top":axis.translation.x=axisBound.x+((_a201=axisWidths.left)!=null?_a201:0),axis.translation.y=this.clampToOutsideSeriesRect(seriesRect,axisBound.y+1+axisOffset+axisThickness,"y",1);break;case"bottom":axis.translation.x=axisBound.x+((_b=axisWidths.left)!=null?_b:0),axis.translation.y=this.clampToOutsideSeriesRect(seriesRect,axisBound.y+axisBound.height+1-axisThickness-axisOffset,"y",-1);break;case"left":axis.translation.y=axisBound.y+((_c=axisWidths.top)!=null?_c:0),axis.translation.x=this.clampToOutsideSeriesRect(seriesRect,axisBound.x+axisOffset+axisThickness,"x",1);break;case"right":axis.translation.y=axisBound.y+((_d=axisWidths.top)!=null?_d:0),axis.translation.x=this.clampToOutsideSeriesRect(seriesRect,axisBound.x+axisBound.width-axisThickness-axisOffset,"x",-1);break}axis.updatePosition({rotation:toRadians(axis.rotation),sideFlag:axis.label.getSideFlag()})}shouldFlipXY(){return!this.series.some(series=>!(series instanceof CartesianSeries&&series.shouldFlipXY()))}},__name(_a132,"_CartesianChart"),_a132);_CartesianChart.className="CartesianChart";_CartesianChart.type="cartesian";var CartesianChart=_CartesianChart,_a133,_AgChartInstanceProxy=(_a133=class{static isInstance(x){var _a201;return x instanceof _a133||((_a201=x.constructor)==null?void 0:_a201.name)==="AgChartInstanceProxy"&&x.chart!=null?!0:x.chart!=null&&this.validateImplementation(x)}static validateImplementation(x){var _a201;const chartProps=["getOptions","destroy"],signatureProps=Object.keys((_a201=Object.getPrototypeOf(x))!=null?_a201:{});return chartProps.every(prop=>signatureProps.includes(prop))}constructor(chart){this.chart=chart}getOptions(){return deepClone(this.chart.getOptions())}resetAnimations(){this.chart.resetAnimations()}skipAnimations(){this.chart.skipAnimations()}destroy(){this.chart.destroy()}},__name(_a133,"_AgChartInstanceProxy"),_a133);_AgChartInstanceProxy.chartInstances=new WeakMap;__decorateClass([ActionOnSet({oldValue(chart){_AgChartInstanceProxy.chartInstances.delete(chart)},newValue(chart){_AgChartInstanceProxy.chartInstances.set(chart,this)}})],_AgChartInstanceProxy.prototype,"chart",2);var AgChartInstanceProxy=_AgChartInstanceProxy,_a134,LinearScale=(_a134=class extends ContinuousScale{constructor(){super([0,1],[0,1]),this.type="linear"}toDomain(d){return d}ticks(){var _a201;const count2=(_a201=this.tickCount)!=null?_a201:ContinuousScale.defaultTickCount;if(!this.domain||this.domain.length<2||count2<1||this.domain.some(d=>!isFinite(d)))return[];this.refresh();const[d0,d1]=this.getDomain(),{interval}=this;if(interval){const step=Math.abs(interval);if(!this.isDenseInterval({start:d0,stop:d1,interval:step}))return range(d0,d1,step)}return ticks_default(d0,d1,count2,this.minTickCount,this.maxTickCount)}update(){!this.domain||this.domain.length<2||this.nice&&this.updateNiceDomain()}getTickStep(start,stop){var _a201,_b;const count2=(_a201=this.tickCount)!=null?_a201:ContinuousScale.defaultTickCount;return(_b=this.interval)!=null?_b:tickStep(start,stop,count2,this.minTickCount,this.maxTickCount)}updateNiceDomain(){var _a201;const count2=(_a201=this.tickCount)!=null?_a201:ContinuousScale.defaultTickCount;if(count2<1){this.niceDomain=[...this.domain];return}let[start,stop]=this.domain;if(count2===1)[start,stop]=singleTickDomain(start,stop);else{const roundStart=start>stop?Math.ceil:Math.floor,roundStop=stop<start?Math.floor:Math.ceil,maxAttempts=4;for(let i=0;i<maxAttempts;i++){const prev0=start,prev1=stop,step=this.getTickStep(start,stop),[d0,d1]=this.domain;if(step>=1)start=roundStart(d0/step)*step,stop=roundStop(d1/step)*step;else{const s=1/step;start=roundStart(d0*s)/s,stop=roundStop(d1*s)/s}if(start===prev0&&stop===prev1)break}}this.niceDomain=[start,stop]}tickFormat({ticks,specifier}){return tickFormat(ticks??this.ticks(),specifier)}},__name(_a134,"LinearScale"),_a134);function calculateNiceSecondaryAxis(domain,primaryTickCount,reverse){let[start,stop]=findMinMax(domain);start=calculateNiceStart(Math.floor(start),stop,primaryTickCount);const step=getTickStep(start,stop,primaryTickCount),segments=primaryTickCount-1;stop=start+segments*step;const d=reverse?[stop,start]:[start,stop],ticks=getTicks(start,step,primaryTickCount);return[d,ticks]}__name(calculateNiceSecondaryAxis,"calculateNiceSecondaryAxis");function calculateNiceStart(a,b,count2){const rawStep=Math.abs(b-a)/(count2-1),order=Math.floor(Math.log10(rawStep)),magnitude=Math.pow(10,order);return Math.floor(a/magnitude)*magnitude}__name(calculateNiceStart,"calculateNiceStart");function getTicks(start,step,count2){const stepPower=Math.floor(Math.log10(step)),fractionDigits=step>0&&step<1?Math.abs(stepPower):0,f=Math.pow(10,fractionDigits),ticks=createNumericTicks(fractionDigits);for(let i=0;i<count2;i++){const tick=start+step*i;ticks[i]=Math.round(tick*f)/f}return ticks}__name(getTicks,"getTicks");function getTickStep(start,stop,count2){const segments=count2-1,rawStep=(stop-start)/segments;return calculateNextNiceStep(rawStep)}__name(getTickStep,"getTickStep");function calculateNextNiceStep(rawStep){const order=Math.floor(Math.log10(rawStep)),magnitude=Math.pow(10,order),step=rawStep/magnitude*10;return step>0&&step<=1?magnitude/10:step>1&&step<=2?2*magnitude/10:step>1&&step<=5?5*magnitude/10:step>5&&step<=10?10*magnitude/10:step>10&&step<=20?20*magnitude/10:step>20&&step<=40?40*magnitude/10:step>40&&step<=50?50*magnitude/10:step>50&&step<=100?100*magnitude/10:step}__name(calculateNextNiceStep,"calculateNextNiceStep");var _a135,NumberAxisTick=(_a135=class extends AxisTick{constructor(){super(...arguments),this.maxSpacing=NaN}},__name(_a135,"NumberAxisTick"),_a135);__decorateClass([Validate(MAX_SPACING),Default(NaN)],NumberAxisTick.prototype,"maxSpacing",2);var _a136,NumberAxis=(_a136=class extends CartesianAxis{constructor(moduleCtx,scale2=new LinearScale){super(moduleCtx,scale2),this.min=NaN,this.max=NaN}normaliseDataDomain(d){const{min,max}=this,{extent:extent2,clipped}=normalisedExtentWithMetadata(d,min,max);return{domain:extent2,clipped}}formatDatum(datum){return typeof datum=="number"?datum.toFixed(2):(Logger.warnOnce("data contains Date objects which are being plotted against a number axis, please only use a number axis for numbers."),String(datum))}createTick(){return new NumberAxisTick}updateSecondaryAxisTicks(primaryTickCount){if(this.dataDomain==null)throw new Error("AG Charts - dataDomain not calculated, cannot perform tick calculation.");if(this.dataDomain.domain.length===0)return[];const[d,ticks]=calculateNiceSecondaryAxis(this.dataDomain.domain,primaryTickCount??0,this.reverse);return this.scale.nice=!1,this.scale.domain=d,this.scale.update(),ticks}},__name(_a136,"NumberAxis"),_a136);NumberAxis.className="NumberAxis";NumberAxis.type="number";__decorateClass([Validate(AND(NUMBER_OR_NAN,LESS_THAN("max"))),Default(NaN)],NumberAxis.prototype,"min",2);__decorateClass([Validate(AND(NUMBER_OR_NAN,GREATER_THAN("min"))),Default(NaN)],NumberAxis.prototype,"max",2);var NON_ZERO_NUMBER=predicateWithMessage(value=>isNumber(value)&&value!==0,"a non-zero number"),_a137,LogAxis=(_a137=class extends NumberAxis{constructor(moduleCtx){super(moduleCtx,new LogScale),this.min=NaN,this.max=NaN}normaliseDataDomain(d){const{min,max}=this,{extent:extent2,clipped}=normalisedExtentWithMetadata(d,min,max),isInverted=extent2[0]>extent2[1],crossesZero=extent2[0]<0&&extent2[1]>0,hasZeroExtent=extent2[0]===0&&extent2[1]===0;return(isInverted||crossesZero||hasZeroExtent)&&(d=[],crossesZero?Logger.warn("the data domain crosses zero, the chart data cannot be rendered. See log axis documentation for more information."):hasZeroExtent&&Logger.warn("the data domain has 0 extent, no data is rendered.")),extent2[0]===0&&(extent2[0]=1),extent2[1]===0&&(extent2[1]=-1),{domain:extent2,clipped}}set base(value){this.scale.base=value}get base(){return this.scale.base}},__name(_a137,"LogAxis"),_a137);LogAxis.className="LogAxis";LogAxis.type="log";__decorateClass([Validate(AND(NUMBER_OR_NAN,NON_ZERO_NUMBER,LESS_THAN("max"))),Default(NaN)],LogAxis.prototype,"min",2);__decorateClass([Validate(AND(NUMBER_OR_NAN,NON_ZERO_NUMBER,GREATER_THAN("min"))),Default(NaN)],LogAxis.prototype,"max",2);var _a138,TimeAxisTick=(_a138=class extends AxisTick{constructor(){super(...arguments),this.maxSpacing=NaN}},__name(_a138,"TimeAxisTick"),_a138);__decorateClass([Validate(MAX_SPACING),Default(NaN)],TimeAxisTick.prototype,"maxSpacing",2);var _a139,TimeAxis=(_a139=class extends CartesianAxis{constructor(moduleCtx){super(moduleCtx,new TimeScale),this.datumFormat="%m/%d/%y, %H:%M:%S",this.min=void 0,this.max=void 0;const{scale:scale2}=this;this.refreshScale(),this.datumFormatter=scale2.tickFormat({specifier:this.datumFormat})}normaliseDataDomain(d){var _a201;let{min,max}=this,clipped=!1;return typeof min=="number"&&(min=new Date(min)),typeof max=="number"&&(max=new Date(max)),d.length>2&&(d=((_a201=extent(d))!=null?_a201:[0,1e3]).map(x=>new Date(x))),min instanceof Date&&(clipped||(clipped=min>d[0]),d=[min,d[1]]),max instanceof Date&&(clipped||(clipped=max<d[1]),d=[d[0],max]),d[0]>d[1]&&(d=[]),{domain:d,clipped}}createTick(){return new TimeAxisTick}onLabelFormatChange(ticks,format2){format2?super.onLabelFormatChange(ticks,format2):this.labelFormatter=this.scale.tickFormat({ticks})}formatDatum(datum){var _a201;return(_a201=this.moduleCtx.callbackCache.call(this.datumFormatter,datum))!=null?_a201:String(datum)}calculatePadding(_min,_max,reverse){return reverse?[1,0]:[0,1]}},__name(_a139,"TimeAxis"),_a139);TimeAxis.className="TimeAxis";TimeAxis.type="time";__decorateClass([Validate(AND(DATE_OR_DATETIME_MS,LESS_THAN("max")),{optional:!0})],TimeAxis.prototype,"min",2);__decorateClass([Validate(AND(DATE_OR_DATETIME_MS,GREATER_THAN("min")),{optional:!0})],TimeAxis.prototype,"max",2);var epsilon=1e-6,cornerEdges=__name((leadingEdge,trailingEdge,leadingInset,trailingInset,cornerRadius)=>{let leadingClipped=!1,trailingClipped=!1,leading0=trailingInset-Math.sqrt(Math.max(__pow(cornerRadius,2)-__pow(leadingInset,2),0)),leading1=0,trailing0=0,trailing1=leadingInset-Math.sqrt(Math.max(__pow(cornerRadius,2)-__pow(trailingInset,2),0));return leading0>leadingEdge?(leadingClipped=!0,leading0=leadingEdge,leading1=leadingInset-Math.sqrt(Math.max(__pow(cornerRadius,2)-__pow(trailingInset-leadingEdge,2)))):leading0<epsilon&&(leading0=0),trailing1>trailingEdge?(trailingClipped=!0,trailing0=trailingInset-Math.sqrt(Math.max(__pow(cornerRadius,2)-__pow(leadingInset-trailingEdge,2))),trailing1=trailingEdge):trailing1<epsilon&&(trailing1=0),{leading0,leading1,trailing0,trailing1,leadingClipped,trailingClipped}},"cornerEdges"),drawCorner=__name((path,{x0,y0,x1,y1,cx,cy},cornerRadius,move)=>{if(move&&path.moveTo(x0,y0),x0!==x1||y0!==y1){const r0=Math.atan2(y0-cy,x0-cx),r1=Math.atan2(y1-cy,x1-cx);path.arc(cx,cy,cornerRadius,r0,r1)}else path.lineTo(x0,y0)},"drawCorner"),insetCornerRadiusRect=__name((path,x,y,width,height,cornerRadii,cornerRadiusBbox)=>{let{topLeft:topLeftCornerRadius,topRight:topRightCornerRadius,bottomRight:bottomRightCornerRadius,bottomLeft:bottomLeftCornerRadius}=cornerRadii;const maxVerticalCornerRadius=Math.max(topLeftCornerRadius+bottomLeftCornerRadius,topRightCornerRadius+bottomRightCornerRadius),maxHorizontalCornerRadius=Math.max(topLeftCornerRadius+topRightCornerRadius,bottomLeftCornerRadius+bottomRightCornerRadius);if(maxVerticalCornerRadius<=0&&maxHorizontalCornerRadius<=0){path.rect(x,y,width,height);return}else if(cornerRadiusBbox==null&&topLeftCornerRadius===topRightCornerRadius&&topLeftCornerRadius===bottomRightCornerRadius&&topLeftCornerRadius===bottomLeftCornerRadius){path.roundRect(x,y,width,height,topLeftCornerRadius);return}if(width<0&&(x+=width,width=Math.abs(width)),height<0&&(y+=height,height=Math.abs(height)),cornerRadiusBbox!=null){const x0=Math.max(x,cornerRadiusBbox.x),x1=Math.min(x+width,cornerRadiusBbox.x+cornerRadiusBbox.width),y0=Math.max(y,cornerRadiusBbox.y),y1=Math.min(y+height,cornerRadiusBbox.y+cornerRadiusBbox.height);x=x0,y=y0,width=x1-x0,height=y1-y0}if(width<=0||height<=0)return;cornerRadiusBbox??(cornerRadiusBbox=new BBox(x,y,width,height));const borderScale=Math.max(maxVerticalCornerRadius/cornerRadiusBbox.height,maxHorizontalCornerRadius/cornerRadiusBbox.width,1);borderScale>1&&(topLeftCornerRadius/=borderScale,topRightCornerRadius/=borderScale,bottomRightCornerRadius/=borderScale,bottomLeftCornerRadius/=borderScale);let drawTopLeftCorner=!0,drawTopRightCorner=!0,drawBottomRightCorner=!0,drawBottomLeftCorner=!0,topLeftCorner,topRightCorner,bottomRightCorner,bottomLeftCorner;if(drawTopLeftCorner){const nodes=cornerEdges(height,width,Math.max(cornerRadiusBbox.x+topLeftCornerRadius-x,0),Math.max(cornerRadiusBbox.y+topLeftCornerRadius-y,0),topLeftCornerRadius);nodes.leadingClipped&&(drawBottomLeftCorner=!1),nodes.trailingClipped&&(drawTopRightCorner=!1);const x0=Math.max(x+nodes.leading1,x),y0=Math.max(y+nodes.leading0,y),x1=Math.max(x+nodes.trailing1,x),y1=Math.max(y+nodes.trailing0,y),cx=cornerRadiusBbox.x+topLeftCornerRadius,cy=cornerRadiusBbox.y+topLeftCornerRadius;topLeftCorner={x0,y0,x1,y1,cx,cy}}if(drawTopRightCorner){const nodes=cornerEdges(width,height,Math.max(cornerRadiusBbox.y+topRightCornerRadius-y,0),Math.max(x+width-(cornerRadiusBbox.x+cornerRadiusBbox.width-topRightCornerRadius),0),topRightCornerRadius);nodes.leadingClipped&&(drawTopLeftCorner=!1),nodes.trailingClipped&&(drawBottomRightCorner=!1);const x0=Math.min(x+width-nodes.leading0,x+width),y0=Math.max(y+nodes.leading1,y),x1=Math.min(x+width-nodes.trailing0,x+width),y1=Math.max(y+nodes.trailing1,y),cx=cornerRadiusBbox.x+cornerRadiusBbox.width-topRightCornerRadius,cy=cornerRadiusBbox.y+topRightCornerRadius;topRightCorner={x0,y0,x1,y1,cx,cy}}if(drawBottomRightCorner){const nodes=cornerEdges(height,width,Math.max(x+width-(cornerRadiusBbox.x+cornerRadiusBbox.width-bottomRightCornerRadius),0),Math.max(y+height-(cornerRadiusBbox.y+cornerRadiusBbox.height-bottomRightCornerRadius),0),bottomRightCornerRadius);nodes.leadingClipped&&(drawTopRightCorner=!1),nodes.trailingClipped&&(drawBottomLeftCorner=!1);const x0=Math.min(x+width-nodes.leading1,x+width),y0=Math.min(y+height-nodes.leading0,y+height),x1=Math.min(x+width-nodes.trailing1,x+width),y1=Math.min(y+height-nodes.trailing0,y+height),cx=cornerRadiusBbox.x+cornerRadiusBbox.width-bottomRightCornerRadius,cy=cornerRadiusBbox.y+cornerRadiusBbox.height-bottomRightCornerRadius;bottomRightCorner={x0,y0,x1,y1,cx,cy}}if(drawBottomLeftCorner){const nodes=cornerEdges(width,height,Math.max(y+height-(cornerRadiusBbox.y+cornerRadiusBbox.height-bottomLeftCornerRadius),0),Math.max(cornerRadiusBbox.x+bottomLeftCornerRadius-x,0),bottomLeftCornerRadius);nodes.leadingClipped&&(drawBottomRightCorner=!1),nodes.trailingClipped&&(drawTopLeftCorner=!1);const x0=Math.max(x+nodes.leading0,x),y0=Math.min(y+height-nodes.leading1,y+height),x1=Math.max(x+nodes.trailing0,x),y1=Math.min(y+height-nodes.trailing1,y+height),cx=cornerRadiusBbox.x+bottomLeftCornerRadius,cy=cornerRadiusBbox.y+cornerRadiusBbox.height-bottomLeftCornerRadius;bottomLeftCorner={x0,y0,x1,y1,cx,cy}}let didMove=!1;drawTopLeftCorner&&topLeftCorner!=null&&(drawCorner(path,topLeftCorner,topLeftCornerRadius,!didMove),didMove||(didMove=!0)),drawTopRightCorner&&topRightCorner!=null&&(drawCorner(path,topRightCorner,topRightCornerRadius,!didMove),didMove||(didMove=!0)),drawBottomRightCorner&&bottomRightCorner!=null&&(drawCorner(path,bottomRightCorner,bottomRightCornerRadius,!didMove),didMove||(didMove=!0)),drawBottomLeftCorner&&bottomLeftCorner!=null&&(drawCorner(path,bottomLeftCorner,bottomLeftCornerRadius,!didMove),didMove||(didMove=!0)),path.closePath()},"insetCornerRadiusRect"),_a140,Rect=(_a140=class extends Path{constructor(){super(...arguments),this.borderPath=new Path2D,this.x=0,this.y=0,this.width=10,this.height=10,this.topLeftCornerRadius=0,this.topRightCornerRadius=0,this.bottomRightCornerRadius=0,this.bottomLeftCornerRadius=0,this.cornerRadiusBbox=void 0,this.crisp=!1,this.lastUpdatePathStrokeWidth=Shape.defaultStyles.strokeWidth,this.effectiveStrokeWidth=Shape.defaultStyles.strokeWidth,this.microPixelEffectOpacity=1}set cornerRadius(cornerRadius){this.topLeftCornerRadius=cornerRadius,this.topRightCornerRadius=cornerRadius,this.bottomRightCornerRadius=cornerRadius,this.bottomLeftCornerRadius=cornerRadius}isDirtyPath(){return this.lastUpdatePathStrokeWidth!==this.strokeWidth?!0:!!(this.path.isDirty()||this.borderPath.isDirty())}updatePath(){var _a201,_b,_c;const{path,borderPath,crisp,topLeftCornerRadius,topRightCornerRadius,bottomRightCornerRadius,bottomLeftCornerRadius}=this;let{x,y,width:w,height:h,strokeWidth,cornerRadiusBbox}=this;const pixelSize=1/((_b=(_a201=this.layerManager)==null?void 0:_a201.canvas.pixelRatio)!=null?_b:1);let microPixelEffectOpacity=1;if(path.clear({trackChanges:!0}),borderPath.clear({trackChanges:!0}),crisp&&(w<=pixelSize&&(microPixelEffectOpacity*=w/pixelSize),h<=pixelSize&&(microPixelEffectOpacity*=h/pixelSize),w=this.align(x,w),h=this.align(y,h),x=this.align(x),y=this.align(y),cornerRadiusBbox=cornerRadiusBbox!=null?new BBox(this.align(cornerRadiusBbox.x),this.align(cornerRadiusBbox.y),this.align(cornerRadiusBbox.x,cornerRadiusBbox.width),this.align(cornerRadiusBbox.y,cornerRadiusBbox.height)):void 0),strokeWidth)if(w<pixelSize){const lx=x+pixelSize/2;borderPath.moveTo(lx,y),borderPath.lineTo(lx,y+h),strokeWidth=pixelSize,this.borderClipPath=void 0}else if(h<pixelSize){const ly=y+pixelSize/2;borderPath.moveTo(x,ly),borderPath.lineTo(x+w,ly),strokeWidth=pixelSize,this.borderClipPath=void 0}else if(strokeWidth<w&&strokeWidth<h){const halfStrokeWidth=strokeWidth/2;x+=halfStrokeWidth,y+=halfStrokeWidth,w-=strokeWidth,h-=strokeWidth;const adjustedCornerRadiusBbox=cornerRadiusBbox==null?void 0:cornerRadiusBbox.clone().shrink(halfStrokeWidth),cornerRadii={topLeft:topLeftCornerRadius>0?topLeftCornerRadius-strokeWidth:0,topRight:topRightCornerRadius>0?topRightCornerRadius-strokeWidth:0,bottomRight:bottomRightCornerRadius>0?bottomRightCornerRadius-strokeWidth:0,bottomLeft:bottomLeftCornerRadius>0?bottomLeftCornerRadius-strokeWidth:0};this.borderClipPath=void 0,insetCornerRadiusRect(path,x,y,w,h,cornerRadii,adjustedCornerRadiusBbox),insetCornerRadiusRect(borderPath,x,y,w,h,cornerRadii,adjustedCornerRadiusBbox)}else this.borderClipPath=(_c=this.borderClipPath)!=null?_c:new Path2D,this.borderClipPath.clear({trackChanges:!0}),this.borderClipPath.rect(x,y,w,h),borderPath.rect(x,y,w,h);else{const cornerRadii={topLeft:topLeftCornerRadius,topRight:topRightCornerRadius,bottomRight:bottomRightCornerRadius,bottomLeft:bottomLeftCornerRadius};this.borderClipPath=void 0,insetCornerRadiusRect(path,x,y,w,h,cornerRadii,cornerRadiusBbox)}this.effectiveStrokeWidth=strokeWidth,this.lastUpdatePathStrokeWidth=strokeWidth,this.microPixelEffectOpacity=microPixelEffectOpacity}computeBBox(){const{x,y,width,height}=this;return new BBox(x,y,width,height)}isPointInPath(x,y){const point=this.transformPoint(x,y);return this.computeBBox().containsPoint(point.x,point.y)}applyFillAlpha(ctx){const{fillOpacity,microPixelEffectOpacity,opacity}=this,{globalAlpha}=ctx;ctx.globalAlpha=globalAlpha*opacity*fillOpacity*microPixelEffectOpacity}renderStroke(ctx){const{stroke,effectiveStrokeWidth,borderPath,borderClipPath,opacity,microPixelEffectOpacity}=this;if(!!stroke&&!!effectiveStrokeWidth){const{strokeOpacity,lineDash,lineDashOffset,lineCap,lineJoin}=this;borderClipPath&&(borderClipPath.draw(ctx),ctx.clip()),borderPath.draw(ctx);const{globalAlpha}=ctx;ctx.strokeStyle=stroke,ctx.globalAlpha=globalAlpha*opacity*strokeOpacity*microPixelEffectOpacity,ctx.lineWidth=effectiveStrokeWidth,lineDash&&ctx.setLineDash(lineDash),lineDashOffset&&(ctx.lineDashOffset=lineDashOffset),lineCap&&(ctx.lineCap=lineCap),lineJoin&&(ctx.lineJoin=lineJoin),ctx.stroke(),ctx.globalAlpha=globalAlpha}}},__name(_a140,"Rect"),_a140);Rect.className="Rect";__decorateClass([ScenePathChangeDetection()],Rect.prototype,"x",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"y",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"width",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"height",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"topLeftCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"topRightCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"bottomRightCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"bottomLeftCornerRadius",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"cornerRadiusBbox",2);__decorateClass([ScenePathChangeDetection()],Rect.prototype,"crisp",2);var _a141,Background=(_a141=class extends BaseModuleInstance{constructor(ctx){var _a201;super(),this.node=new Group({name:"background",zIndex:0}),this.rectNode=new Rect,this.visible=!0,this.fill="white",this.image=void 0,this.node.appendChild(this.rectNode),(_a201=ctx.scene.root)==null||_a201.appendChild(this.node),this.destroyFns.push(()=>{var _a210;return(_a210=ctx.scene.root)==null?void 0:_a210.removeChild(this.node)},ctx.layoutService.addListener("layout-complete",e=>this.onLayoutComplete(e)))}onLayoutComplete(e){const{width,height}=e.chart;this.rectNode.width=width,this.rectNode.height=height}},__name(_a141,"Background"),_a141);__decorateClass([Validate(BOOLEAN),ProxyPropertyOnWrite("node","visible")],Background.prototype,"visible",2);__decorateClass([Validate(COLOR_STRING,{optional:!0}),ProxyPropertyOnWrite("rectNode","fill")],Background.prototype,"fill",2);__decorateClass([Validate(OBJECT,{optional:!0})],Background.prototype,"image",2);var BackgroundModule={type:"root",optionsKey:"background",packageType:"community",chartTypes:["cartesian","polar","hierarchy"],instanceConstructor:Background},_a142,RangeHandle=(_a142=class extends Path{constructor(){super(...arguments),this._fill="#f2f2f2",this._stroke="#999999",this._strokeWidth=1,this._lineCap="square",this._centerX=0,this._centerY=0,this._width=8,this._gripLineGap=2,this._gripLineLength=8,this._height=16}set centerX(value){this._centerX!==value&&(this._centerX=value,this.dirtyPath=!0)}get centerX(){return this._centerX}set centerY(value){this._centerY!==value&&(this._centerY=value,this.dirtyPath=!0)}get centerY(){return this._centerY}set width(value){this._width!==value&&(this._width=value,this.dirtyPath=!0)}get width(){return this._width}set gripLineGap(value){this._gripLineGap!==value&&(this._gripLineGap=value,this.dirtyPath=!0)}get gripLineGap(){return this._gripLineGap}set gripLineLength(value){this._gripLineLength!==value&&(this._gripLineLength=value,this.dirtyPath=!0)}get gripLineLength(){return this._gripLineLength}set height(value){this._height!==value&&(this._height=value,this.dirtyPath=!0)}get height(){return this._height}computeBBox(){const{centerX,centerY,width,height}=this,x=centerX-width/2,y=centerY-height/2;return new BBox(x,y,width,height)}isPointInPath(x,y){const point=this.transformPoint(x,y);return this.computeBBox().containsPoint(point.x,point.y)}updatePath(){const{path,centerX,centerY,width,height}=this;path.clear();const x=centerX-width/2,y=centerY-height/2,ax=this.align(x),ay=this.align(y),axw=ax+this.align(x,width),ayh=ay+this.align(y,height);path.moveTo(ax,ay),path.lineTo(axw,ay),path.lineTo(axw,ayh),path.lineTo(ax,ayh),path.closePath();const dx=this.gripLineGap/2,dy=this.gripLineLength/2;path.moveTo(this.align(centerX-dx),this.align(centerY-dy)),path.lineTo(this.align(centerX-dx),this.align(centerY+dy)),path.moveTo(this.align(centerX+dx),this.align(centerY-dy)),path.lineTo(this.align(centerX+dx),this.align(centerY+dy))}},__name(_a142,"RangeHandle"),_a142);RangeHandle.className="RangeHandle";__decorateClass([Validate(COLOR_STRING)],RangeHandle.prototype,"_fill",2);__decorateClass([Validate(COLOR_STRING)],RangeHandle.prototype,"_stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],RangeHandle.prototype,"_strokeWidth",2);__decorateClass([Validate(LINE_CAP)],RangeHandle.prototype,"_lineCap",2);__decorateClass([Validate(POSITIVE_NUMBER)],RangeHandle.prototype,"_width",2);__decorateClass([Validate(POSITIVE_NUMBER)],RangeHandle.prototype,"_gripLineGap",2);__decorateClass([Validate(POSITIVE_NUMBER)],RangeHandle.prototype,"_gripLineLength",2);__decorateClass([Validate(POSITIVE_NUMBER)],RangeHandle.prototype,"_height",2);function markDirtyOnChange(newValue,oldValue){newValue!==oldValue&&(this.dirtyPath=!0)}__name(markDirtyOnChange,"markDirtyOnChange");var _a143,RangeMask=(_a143=class extends Path{constructor(){super(...arguments),this.x=0,this.y=0,this.width=200,this.height=30,this.minRange=.001,this._min=0,this._max=1}set min(value){var _a201;value=clamp(0,value,this.max-this.minRange),this._min!==value&&!isNaN(value)&&(this._min=value,this.dirtyPath=!0,(_a201=this.onRangeChange)==null||_a201.call(this))}get min(){return this._min}set max(value){var _a201;value=clamp(this.min+this.minRange,value,1),this._max!==value&&!isNaN(value)&&(this._max=value,this.dirtyPath=!0,(_a201=this.onRangeChange)==null||_a201.call(this))}get max(){return this._max}computeBBox(){const{x,y,width,height}=this;return new BBox(x,y,width,height)}computeVisibleRangeBBox(){const{x,y,width,height,min,max}=this,minX=x+width*min,maxX=x+width*max;return new BBox(minX,y,maxX-minX,height)}updatePath(){const{path,x,y,width,height,min,max}=this;path.clear();const ax=this.align(x),ay=this.align(y),axw=ax+this.align(x,width),ayh=ay+this.align(y,height);path.moveTo(ax,ay),path.lineTo(axw,ay),path.lineTo(axw,ayh),path.lineTo(ax,ayh),path.lineTo(ax,ay);const minX=this.align(x+width*min),maxX=this.align(x+width*max);path.moveTo(minX,ay),path.lineTo(minX,ayh),path.lineTo(maxX,ayh),path.lineTo(maxX,ay),path.lineTo(minX,ay)}},__name(_a143,"RangeMask"),_a143);RangeMask.className="RangeMask";__decorateClass([ActionOnSet({changeValue:markDirtyOnChange}),Validate(POSITIVE_NUMBER)],RangeMask.prototype,"x",2);__decorateClass([ActionOnSet({changeValue:markDirtyOnChange}),Validate(POSITIVE_NUMBER)],RangeMask.prototype,"y",2);__decorateClass([ActionOnSet({changeValue:markDirtyOnChange}),Validate(POSITIVE_NUMBER)],RangeMask.prototype,"width",2);__decorateClass([ActionOnSet({changeValue:markDirtyOnChange}),Validate(POSITIVE_NUMBER)],RangeMask.prototype,"height",2);__decorateClass([Validate(NUMBER)],RangeMask.prototype,"_min",2);__decorateClass([Validate(NUMBER)],RangeMask.prototype,"_max",2);var _a144,_RangeSelector=(_a144=class extends Group{constructor(){super({name:"rangeSelectorGroup",layer:!0}),this.minHandle=new RangeHandle,this.maxHandle=new RangeHandle,this.background=(()=>{const background=new Group({name:"navigator-background"});return background.zIndex=1,this.appendChild(background),background})(),this.mask=(()=>{const{x,y,width,height,min,max}=_a144.defaults,mask=new RangeMask;mask.x=x,mask.y=y,mask.width=width,mask.height=height,mask.min=min,mask.max=max,mask.zIndex=2;const{minHandle,maxHandle}=this;return minHandle.centerX=x,maxHandle.centerX=x+width,minHandle.centerY=maxHandle.centerY=y+height/2,minHandle.zIndex=4,maxHandle.zIndex=3,this.append([mask,minHandle,maxHandle]),mask.onRangeChange=()=>{var _a201;this.updateHandles(),(_a201=this.onRangeChange)==null||_a201.call(this)},mask})(),this.isContainerNode=!0}layout(x,y,width,height){this.mask.x=x,this.mask.y=y,this.mask.width=width,this.mask.height=height,this.updateHandles(),this.background.translationX=x,this.background.translationY=y}updateHandles(){const{x,y,width,height}=this.mask,{minHandle,maxHandle,min,max}=this;minHandle.centerX=x+width*min,maxHandle.centerX=x+width*max,minHandle.centerY=maxHandle.centerY=y+height/2,min+(max-min)/2<.5?(minHandle.zIndex=3,maxHandle.zIndex=4):(minHandle.zIndex=4,maxHandle.zIndex=3)}computeBBox(){return this.mask.computeBBox()}computeVisibleRangeBBox(){return this.mask.computeVisibleRangeBBox()}},__name(_a144,"_RangeSelector"),_a144);_RangeSelector.className="Range";_RangeSelector.defaults={x:0,y:0,width:200,height:30,min:0,max:1};__decorateClass([ProxyProperty("mask.min")],_RangeSelector.prototype,"min",2);__decorateClass([ProxyProperty("mask.max")],_RangeSelector.prototype,"max",2);var RangeSelector=_RangeSelector,_a145,Navigator=(_a145=class extends BaseModuleInstance{constructor(ctx){var _a201;super(),this.ctx=ctx,this.rs=new RangeSelector,this.miniChart=void 0,this.minHandleDragging=!1,this.maxHandleDragging=!1,this.panHandleOffset=NaN,this.enabled=!1,this.height=30,this.margin=10,this.visible=!0,this.x=0,this.y=0,this.width=0,this.rs.onRangeChange=debounce(()=>this.onRangeChange()),(_a201=ctx.scene.root)==null||_a201.appendChild(this.rs);const dragStates=13;this.destroyFns.push(ctx.interactionManager.addListener("drag-start",event=>this.onDragStart(event),dragStates),ctx.interactionManager.addListener("drag",event=>this.onDrag(event),dragStates),ctx.interactionManager.addListener("hover",event=>this.onDrag(event),dragStates),ctx.interactionManager.addListener("drag-end",()=>this.onDragStop(),dragStates),ctx.zoomManager.addListener("zoom-change",()=>this.onZoomChange()),()=>{var _a210;return(_a210=ctx.scene.root)==null?void 0:_a210.removeChild(this.rs)},()=>delete this.rs.onRangeChange),this.updateGroupVisibility()}updateGroupVisibility(){const visible=!!(this.enabled&&this.visible);visible!==this.rs.visible&&(this.rs.visible=visible,visible&&this.onRangeChange())}performLayout(_0){return __async(this,arguments,function*({shrinkRect}){if(this.enabled){const navigatorTotalHeight=this.height+this.margin;shrinkRect.shrink(navigatorTotalHeight,"bottom"),this.y=shrinkRect.y+shrinkRect.height+this.margin}else this.y=0;return{shrinkRect}})}performCartesianLayout(opts){return __async(this,null,function*(){const{x,width}=opts.seriesRect,visible=!0;if(this.enabled&&visible){const{y,height}=this;this.rs.layout(x,y,width,height)}this.visible=visible,this.x=x,this.width=width})}onRangeChange(){var _a201,_b;const{min,max}=this.rs,zoom=this.ctx.zoomManager.getZoom();(((_a201=zoom==null?void 0:zoom.x)==null?void 0:_a201.min)!==min||((_b=zoom==null?void 0:zoom.x)==null?void 0:_b.max)!==max)&&this.ctx.zoomManager.updateZoom({x:{min,max},y:zoom==null?void 0:zoom.y})}onZoomChange(){const currentZoom=this.ctx.zoomManager.getZoom();currentZoom&&currentZoom.x&&(this.min=currentZoom.x.min,this.max=currentZoom.x.max)}onDragStart(offset4){if(!this.enabled)return;const{offsetX,offsetY}=offset4,{rs}=this,{minHandle,maxHandle,min}=rs,{x,width}=this,visibleRange=rs.computeVisibleRangeBBox();this.minHandleDragging||this.maxHandleDragging||(minHandle.zIndex<maxHandle.zIndex?maxHandle.containsPoint(offsetX,offsetY)?this.maxHandleDragging=!0:minHandle.containsPoint(offsetX,offsetY)&&(this.minHandleDragging=!0):minHandle.containsPoint(offsetX,offsetY)?this.minHandleDragging=!0:maxHandle.containsPoint(offsetX,offsetY)&&(this.maxHandleDragging=!0),!this.minHandleDragging&&!this.maxHandleDragging&&visibleRange.containsPoint(offsetX,offsetY)&&(this.panHandleOffset=(offsetX-x)/width-min))}onDrag(offset4){if(!this.enabled)return;const{rs,panHandleOffset}=this,{minHandle,maxHandle}=rs,{x,y,width,height}=this,{offsetX,offsetY}=offset4,minX=x+width*rs.min,maxX=x+width*rs.max,visibleRange=new BBox(minX,y,maxX-minX,height),getRatio=__name(()=>clamp(0,(offsetX-x)/width,1),"getRatio");if(minHandle.containsPoint(offsetX,offsetY)||maxHandle.containsPoint(offsetX,offsetY)?this.ctx.cursorManager.updateCursor("navigator","ew-resize"):visibleRange.containsPoint(offsetX,offsetY)?this.ctx.cursorManager.updateCursor("navigator","grab"):this.ctx.cursorManager.updateCursor("navigator"),this.minHandleDragging)rs.min=getRatio();else if(this.maxHandleDragging)rs.max=getRatio();else if(!isNaN(panHandleOffset)){const span=rs.max-rs.min,min=Math.min(getRatio()-panHandleOffset,1-span);min<=rs.min?(rs.min=min,rs.max=rs.min+span):(rs.max=min+span,rs.min=rs.max-span)}}onDragStop(){this.stopHandleDragging()}stopHandleDragging(){this.minHandleDragging=this.maxHandleDragging=!1,this.panHandleOffset=NaN}},__name(_a145,"Navigator"),_a145);__decorateClass([Validate(OBJECT,{optional:!0})],Navigator.prototype,"miniChart",2);__decorateClass([Validate(BOOLEAN),ObserveChanges(target=>target.updateGroupVisibility())],Navigator.prototype,"enabled",2);__decorateClass([ProxyProperty("rs.mask")],Navigator.prototype,"mask",2);__decorateClass([ProxyProperty("rs.minHandle")],Navigator.prototype,"minHandle",2);__decorateClass([ProxyProperty("rs.maxHandle")],Navigator.prototype,"maxHandle",2);__decorateClass([ProxyProperty("rs.min")],Navigator.prototype,"min",2);__decorateClass([ProxyProperty("rs.max")],Navigator.prototype,"max",2);__decorateClass([Validate(POSITIVE_NUMBER)],Navigator.prototype,"margin",2);__decorateClass([Validate(BOOLEAN),ObserveChanges(target=>target.updateGroupVisibility())],Navigator.prototype,"visible",2);var NavigatorModule={type:"root",optionsKey:"navigator",packageType:"community",chartTypes:["cartesian"],instanceConstructor:Navigator,themeTemplate:{navigator:{enabled:!1,height:30,mask:{fill:"#999999",stroke:"#999999",strokeWidth:1,fillOpacity:.2},minHandle:{fill:"#f2f2f2",stroke:"#999999",strokeWidth:1,width:8,height:16,gripLineGap:2,gripLineLength:8},maxHandle:{fill:"#f2f2f2",stroke:"#999999",strokeWidth:1,width:8,height:16,gripLineGap:2,gripLineLength:8}}}},singleSeriesPaletteFactory=__name(({takeColors})=>{const{fills:[fill],strokes:[stroke]}=takeColors(1);return{fill,stroke}},"singleSeriesPaletteFactory"),markerPaletteFactory=__name(params=>{const{fill,stroke}=singleSeriesPaletteFactory(params);return{marker:{fill,stroke}}},"markerPaletteFactory");function pathMotion(groupId,subId,animationManager,paths,fns){const{addPhaseFn,updatePhaseFn,removePhaseFn}=fns,animate=__name((phase,path,updateFn)=>{animationManager.animate({id:`${groupId}_${subId}_${path.id}_${phase}`,groupId,from:0,to:1,ease:easeOut,onUpdate(ratio,preInit){preInit&&phase!=="removed"||(path.path.clear({trackChanges:!0}),updateFn(ratio,path),path.checkPathDirty())},onStop(){phase==="added"&&(path.path.clear({trackChanges:!0}),updateFn(1,path),path.checkPathDirty())},phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase]})},"animate");for(const path of paths)animationManager.isSkipped()||(animate("removed",path,removePhaseFn),animate("updated",path,updatePhaseFn)),animate("added",path,addPhaseFn)}__name(pathMotion,"pathMotion");var element=null;function sanitizeHtml(text){if(text!=null)return text===""?"":(element??(element=document.createElement("div")),element.textContent=String(text),element.innerHTML)}__name(sanitizeHtml,"sanitizeHtml");function seriesLabelFadeInAnimation({id},subId,animationManager,labelSelections){staticFromToMotion(id,subId,animationManager,labelSelections,{opacity:0},{opacity:1},{phase:"trailing"})}__name(seriesLabelFadeInAnimation,"seriesLabelFadeInAnimation");function seriesLabelFadeOutAnimation({id},subId,animationManager,labelSelections){staticFromToMotion(id,subId,animationManager,labelSelections,{opacity:1},{opacity:0},{phase:"remove"})}__name(seriesLabelFadeOutAnimation,"seriesLabelFadeOutAnimation");function resetLabelFn(_node){return{opacity:1}}__name(resetLabelFn,"resetLabelFn");var _a146,ChangeDetectableProperties=(_a146=class extends BaseProperties{constructor(){super(...arguments),this._dirty=3}markDirty(_source,type=1){this._dirty<type&&(this._dirty=type)}markClean(_opts){this._dirty=0}isDirty(){return this._dirty>0}},__name(_a146,"ChangeDetectableProperties"),_a146),_a147,DropShadow=(_a147=class extends ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.color="rgba(0, 0, 0, 0.5)",this.xOffset=0,this.yOffset=0,this.blur=5}},__name(_a147,"DropShadow"),_a147);__decorateClass([Validate(BOOLEAN),SceneChangeDetection({redraw:3})],DropShadow.prototype,"enabled",2);__decorateClass([Validate(COLOR_STRING),SceneChangeDetection({redraw:3})],DropShadow.prototype,"color",2);__decorateClass([Validate(NUMBER),SceneChangeDetection({redraw:3})],DropShadow.prototype,"xOffset",2);__decorateClass([Validate(NUMBER),SceneChangeDetection({redraw:3})],DropShadow.prototype,"yOffset",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3})],DropShadow.prototype,"blur",2);var MARKER_SHAPE=predicateWithMessage(value=>isMarkerShape(value)||Object.getPrototypeOf(value)===Marker,"a marker shape keyword such as 'circle', 'diamond' or 'square' or an object extending the Marker class"),_a148,SeriesMarker=(_a148=class extends ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.shape=Circle,this.size=6,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1}getStyle(){const{size,fill,fillOpacity,stroke,strokeWidth,strokeOpacity}=this;return{size,fill,fillOpacity,stroke,strokeWidth,strokeOpacity}}getDiameter(){return this.size+this.strokeWidth}},__name(_a148,"SeriesMarker"),_a148);__decorateClass([Validate(BOOLEAN),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"enabled",2);__decorateClass([Validate(MARKER_SHAPE),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"shape",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"size",2);__decorateClass([Validate(COLOR_STRING,{optional:!0}),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"fill",2);__decorateClass([Validate(RATIO),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0}),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"strokeOpacity",2);__decorateClass([Validate(FUNCTION,{optional:!0}),SceneChangeDetection({redraw:3})],SeriesMarker.prototype,"formatter",2);var _a149,SeriesTooltipInteraction=(_a149=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!1}},__name(_a149,"SeriesTooltipInteraction"),_a149);__decorateClass([Validate(BOOLEAN)],SeriesTooltipInteraction.prototype,"enabled",2);var _a150,SeriesTooltip=(_a150=class extends BaseProperties{constructor(){super(...arguments),this.enabled=!0,this.interaction=new SeriesTooltipInteraction,this.position=new TooltipPosition}toTooltipHtml(defaults,params){return this.renderer?toTooltipHtml(this.renderer(params),defaults):toTooltipHtml(defaults)}},__name(_a150,"SeriesTooltip"),_a150);__decorateClass([Validate(BOOLEAN)],SeriesTooltip.prototype,"enabled",2);__decorateClass([Validate(BOOLEAN,{optional:!0})],SeriesTooltip.prototype,"showArrow",2);__decorateClass([Validate(FUNCTION,{optional:!0})],SeriesTooltip.prototype,"renderer",2);__decorateClass([Validate(OBJECT)],SeriesTooltip.prototype,"interaction",2);__decorateClass([Validate(OBJECT)],SeriesTooltip.prototype,"position",2);var _a151,AreaSeriesProperties=(_a151=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.xName=void 0,this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.shadow=new DropShadow,this.marker=new SeriesMarker,this.label=new Label,this.tooltip=new SeriesTooltip,this.connectMissingData=!1}},__name(_a151,"AreaSeriesProperties"),_a151);__decorateClass([Validate(STRING)],AreaSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING,{optional:!0})],AreaSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING)],AreaSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],AreaSeriesProperties.prototype,"yName",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],AreaSeriesProperties.prototype,"normalizedTo",2);__decorateClass([Validate(COLOR_STRING)],AreaSeriesProperties.prototype,"fill",2);__decorateClass([Validate(RATIO)],AreaSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING)],AreaSeriesProperties.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],AreaSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],AreaSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],AreaSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],AreaSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"marker",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],AreaSeriesProperties.prototype,"tooltip",2);__decorateClass([Validate(BOOLEAN)],AreaSeriesProperties.prototype,"connectMissingData",2);function markerFadeInAnimation({id},animationManager,markerSelections,status){const params={phase:status?NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]:"trailing"};staticFromToMotion(id,"markers",animationManager,markerSelections,{opacity:0},{opacity:1},params),markerSelections.forEach(s=>s.cleanup())}__name(markerFadeInAnimation,"markerFadeInAnimation");function markerScaleInAnimation({id},animationManager,markerSelections){staticFromToMotion(id,"markers",animationManager,markerSelections,{scalingX:0,scalingY:0},{scalingX:1,scalingY:1},{phase:"initial"}),markerSelections.forEach(s=>s.cleanup())}__name(markerScaleInAnimation,"markerScaleInAnimation");function markerSwipeScaleInAnimation({id,nodeDataDependencies},animationManager,markerSelections){const seriesWidth=nodeDataDependencies.seriesRectWidth;fromToMotion(id,"markers",animationManager,markerSelections,{fromFn:__name((_,datum)=>{var _a201,_b;const x=(_b=(_a201=datum.midPoint)==null?void 0:_a201.x)!=null?_b:seriesWidth;return{scalingX:0,scalingY:0,delay:clamp(0,inverseEaseOut(x/seriesWidth),1),duration:QUICK_TRANSITION,phase:"initial"}},"fromFn"),toFn:__name(()=>({scalingX:1,scalingY:1}),"toFn")})}__name(markerSwipeScaleInAnimation,"markerSwipeScaleInAnimation");function resetMarkerFn(_node){return{opacity:1,scalingX:1,scalingY:1}}__name(resetMarkerFn,"resetMarkerFn");function resetMarkerPositionFn(_node,datum){var _a201,_b,_c,_d;return{translationX:(_b=(_a201=datum.point)==null?void 0:_a201.x)!=null?_b:NaN,translationY:(_d=(_c=datum.point)==null?void 0:_c.y)!=null?_d:NaN}}__name(resetMarkerPositionFn,"resetMarkerPositionFn");function prepareMarkerAnimation(pairMap,parentStatus){const readFirstPair=__name((xValue,type)=>{const val=pairMap[type][xValue];return Array.isArray(val)?val[0]:val},"readFirstPair"),markerStatus=__name(datum=>{const{xValue}=datum;return pairMap.moved[xValue]?{point:readFirstPair(xValue,"moved"),status:"updated"}:pairMap.removed[xValue]?{point:readFirstPair(xValue,"removed"),status:"removed"}:pairMap.added[xValue]?{point:readFirstPair(xValue,"added"),status:"added"}:{status:"unknown"}},"markerStatus");return{fromFn:__name((marker,datum)=>{var _a201,_b,_c,_d,_e,_f;const{status,point}=markerStatus(datum);if(status==="unknown")return{opacity:0};const defaults={translationX:(_b=(_a201=point==null?void 0:point.from)==null?void 0:_a201.x)!=null?_b:marker.translationX,translationY:(_d=(_c=point==null?void 0:point.from)==null?void 0:_c.y)!=null?_d:marker.translationY,opacity:marker.opacity,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]};return parentStatus==="added"?__spreadProps(__spreadValues({},defaults),{opacity:0,translationX:(_e=point==null?void 0:point.to)==null?void 0:_e.x,translationY:(_f=point==null?void 0:point.to)==null?void 0:_f.y,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.added}):(status==="added"&&(defaults.opacity=0),defaults)},"fromFn"),toFn:__name((_marker,datum)=>{var _a201,_b;const{status,point}=markerStatus(datum);if(status==="unknown")return{opacity:0};const defaults={translationX:datum.point.x,translationY:datum.point.y,opacity:1,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[status]};return status==="removed"||parentStatus==="removed"?__spreadProps(__spreadValues({},defaults),{translationX:(_a201=point==null?void 0:point.to)==null?void 0:_a201.x,translationY:(_b=point==null?void 0:point.to)==null?void 0:_b.y,opacity:0,phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING.removed}):defaults},"toFn")}}__name(prepareMarkerAnimation,"prepareMarkerAnimation");function minMax(nodeData){return nodeData.reduce(({min,max},node)=>((min==null||min.point.x>node.point.x)&&(min=node),(max==null||max.point.x<node.point.x)&&(max=node),{min,max}),{})}__name(minMax,"minMax");function intersectionOnLine(a,b,targetX){const m=(b.y-a.y)/(b.x-a.x),y=(targetX-a.x)*m+a.y;return{x:targetX,y}}__name(intersectionOnLine,"intersectionOnLine");function backfillPathPoint(results,process,skip,processFn){let prevMarkerIdx=-1,nextMarkerIdx=0;const toProcess=[];for(;nextMarkerIdx<results.length;){if(results[nextMarkerIdx].change===process){toProcess.push(results[nextMarkerIdx]),nextMarkerIdx++;continue}if(results[nextMarkerIdx].change===skip){nextMarkerIdx++;continue}toProcess.length>0&&(processFn(toProcess,prevMarkerIdx,nextMarkerIdx),toProcess.length=0),prevMarkerIdx=nextMarkerIdx,nextMarkerIdx++}toProcess.length>0&&processFn(toProcess,prevMarkerIdx,nextMarkerIdx)}__name(backfillPathPoint,"backfillPathPoint");function backfillPathPointData(result,splitMode){backfillPathPoint(result,"out","in",(toProcess,sIdx,eIdx)=>{var _a201,_b;sIdx===-1&&result[eIdx]?toProcess.forEach(d=>d.to=result[eIdx].from):eIdx===result.length&&result[sIdx]?toProcess.forEach(d=>d.to=result[sIdx].from):splitMode==="intersect"&&((_a201=result[sIdx])!=null&&_a201.from)&&((_b=result[eIdx])!=null&&_b.from)?toProcess.forEach(d=>d.to=intersectionOnLine(result[sIdx].from,result[eIdx].from,d.from.x)):toProcess.forEach(d=>d.to=d.from)}),backfillPathPoint(result,"in","out",(toProcess,sIdx,eIdx)=>{var _a201,_b;sIdx===-1&&result[eIdx]?toProcess.forEach(d=>d.from=result[eIdx].to):eIdx===result.length&&result[sIdx]?toProcess.forEach(d=>d.from=result[sIdx].to):splitMode==="intersect"&&((_a201=result[sIdx])!=null&&_a201.to)&&((_b=result[eIdx])!=null&&_b.to)?toProcess.forEach(d=>d.from=intersectionOnLine(result[sIdx].to,result[eIdx].to,d.to.x)):toProcess.forEach(d=>d.from=d.to)})}__name(backfillPathPointData,"backfillPathPointData");function calculatePoint(from,to,ratio){const x1=isNaN(from.x)?to.x:from.x,y1=isNaN(from.y)?to.y:from.y,xd=to.x-from.x,yd=to.y-from.y,xr=isNaN(xd)?0:xd*ratio,yr=isNaN(yd)?0:yd*ratio;return{x:x1+xr,y:y1+yr}}__name(calculatePoint,"calculatePoint");function renderPartialPath(pairData,ratios,path){const{path:linePath}=path;let previousTo;for(const data of pairData){const{from,to}=data,ratio=ratios[data.change];if(ratio==null||from==null||to==null)continue;const{x,y}=calculatePoint(from,to,ratio);if(data.moveTo===!1)linePath.lineTo(x,y);else if(data.moveTo===!0||!previousTo)linePath.moveTo(x,y);else if(previousTo){const moveToRatio=data.moveTo==="in"?ratio:1-ratio,{x:midPointX,y:midPointY}=calculatePoint(previousTo,{x,y},moveToRatio);linePath.lineTo(midPointX,midPointY),linePath.moveTo(x,y)}previousTo={x,y}}}__name(renderPartialPath,"renderPartialPath");function pathSwipeInAnimation({id,visible,nodeDataDependencies},animationManager,paths){const{seriesRectWidth:width,seriesRectHeight:height}=nodeDataDependencies;staticFromToMotion(id,"path_properties",animationManager,paths,{clipX:0},{clipX:width},{phase:"initial",start:{clipMode:"normal",clipY:height,visible},finish:{clipMode:void 0,visible}})}__name(pathSwipeInAnimation,"pathSwipeInAnimation");function pathFadeInAnimation({id},subId,animationManager,selection,phase="add"){staticFromToMotion(id,subId,animationManager,selection,{opacity:0},{opacity:1},{phase})}__name(pathFadeInAnimation,"pathFadeInAnimation");function pathFadeOutAnimation({id},subId,animationManager,selection){staticFromToMotion(id,subId,animationManager,selection,{opacity:1},{opacity:0},{phase:"remove"})}__name(pathFadeOutAnimation,"pathFadeOutAnimation");function buildResetPathFn(opts){return _node=>({opacity:opts.getOpacity(),clipScalingX:1,clipMode:void 0})}__name(buildResetPathFn,"buildResetPathFn");function updateClipPath({nodeDataDependencies},path){const toFinite=__name(value=>isFinite(value)?value:0,"toFinite");path.clipX=toFinite(nodeDataDependencies.seriesRectWidth),path.clipY=toFinite(nodeDataDependencies.seriesRectHeight)}__name(updateClipPath,"updateClipPath");function isContinuousScaling(scaling){return scaling.type==="continuous"||scaling.type==="log"}__name(isContinuousScaling,"isContinuousScaling");function isCategoryScaling(scaling){return scaling.type==="category"}__name(isCategoryScaling,"isCategoryScaling");function areEqual(a,b){return a.domain.length===b.domain.length&&a.range.length===b.range.length&&a.domain.every((val,index)=>val===b.domain[index])&&a.range.every((val,index)=>val===b.range[index])}__name(areEqual,"areEqual");function areScalingEqual(a,b){return a===void 0||b===void 0?a!==void 0||b!==void 0:isContinuousScaling(a)&&isContinuousScaling(b)?a.type===b.type&&areEqual(a,b):isCategoryScaling(a)&&isCategoryScaling(b)?areEqual(a,b):!1}__name(areScalingEqual,"areScalingEqual");function scale(val,scaling){if(!scaling)return NaN;if(val instanceof Date&&(val=val.getTime()),scaling.type==="continuous"&&typeof val=="number")return(val-scaling.domain[0])/(scaling.domain[1]-scaling.domain[0])*(scaling.range[1]-scaling.range[0])+scaling.range[0];if(scaling.type==="log"&&typeof val=="number")return scaling.convert(val);const matchingIndex=scaling.domain.findIndex(d=>d===val);return matchingIndex>=0?scaling.range[matchingIndex]:NaN}__name(scale,"scale");function scalesChanged(newData,oldData){return!areScalingEqual(newData.scales.x,oldData.scales.x)||!areScalingEqual(newData.scales.y,oldData.scales.y)}__name(scalesChanged,"scalesChanged");function closeMatch(a,b){const an=Number(a),bn=Number(b);return!isNaN(an)&&!isNaN(bn)?Math.abs(bn-an)<.25:a===b}__name(closeMatch,"closeMatch");function calculateMoveTo(from=!1,to=!1){return from===to?!!from:from?"in":"out"}__name(calculateMoveTo,"calculateMoveTo");function pairContinuousData(newData,oldData,opts={}){var _a201,_b,_c,_d;const{backfillSplitMode="intersect"}=opts,toNewScale=__name(oldDatum=>{var _a210,_b2;return{x:scale((_a210=oldDatum.xValue)!=null?_a210:NaN,newData.scales.x),y:scale((_b2=oldDatum.yValue)!=null?_b2:NaN,newData.scales.y)}},"toNewScale"),toOldScale=__name(newDatum=>{var _a210,_b2;return{x:scale((_a210=newDatum.xValue)!=null?_a210:NaN,oldData.scales.x),y:scale((_b2=newDatum.yValue)!=null?_b2:NaN,oldData.scales.y)}},"toOldScale"),result=[],resultMap={added:{},moved:{},removed:{}},pairUp=__name((from,to,xValue,change="move")=>{from&&(isNaN(from.point.x)||isNaN(from.point.y))&&(from=to);const resultPoint={from:from==null?void 0:from.point,to:to==null?void 0:to.point,moveTo:calculateMoveTo(from==null?void 0:from.point.moveTo,to==null?void 0:to.point.moveTo),change};change==="move"?(resultMap.moved[xValue]=resultPoint,oldIdx++,newIdx++):change==="in"?(resultMap.added[xValue]=resultPoint,newIdx++):change==="out"&&(resultMap.removed[xValue]=resultPoint,oldIdx++),result.push(resultPoint)},"pairUp"),{min:minFromNode,max:maxFromNode}=minMax(oldData.nodeData),{min:minToNode,max:maxToNode}=minMax(newData.nodeData);let oldIdx=0,newIdx=0;for(;oldIdx<oldData.nodeData.length||newIdx<newData.nodeData.length;){const from=oldData.nodeData[oldIdx],to=newData.nodeData[newIdx],fromShifted=from?toNewScale(from):void 0,toUnshifted=to?toOldScale(to):void 0,NA=void 0;if(fromShifted&&closeMatch(fromShifted.x,to==null?void 0:to.point.x))pairUp(from,to,to.xValue,"move");else if(fromShifted&&fromShifted.x<((_a201=minToNode==null?void 0:minToNode.point.x)!=null?_a201:-1/0))pairUp(from,NA,from.xValue,"out");else if(fromShifted&&fromShifted.x>((_b=maxToNode==null?void 0:maxToNode.point.x)!=null?_b:1/0))pairUp(from,NA,from.xValue,"out");else if(toUnshifted&&toUnshifted.x<((_c=minFromNode==null?void 0:minFromNode.point.x)!=null?_c:-1/0))pairUp(NA,to,to.xValue,"in");else if(toUnshifted&&toUnshifted.x>((_d=maxFromNode==null?void 0:maxFromNode.point.x)!=null?_d:1/0))pairUp(NA,to,to.xValue,"in");else if(fromShifted&&fromShifted.x<(to==null?void 0:to.point.x))pairUp(from,NA,from.xValue,"out");else if(toUnshifted&&toUnshifted.x<(from==null?void 0:from.point.x))pairUp(NA,to,to.xValue,"in");else if(from)pairUp(from,NA,from.xValue,"out");else if(to)pairUp(NA,to,to.xValue,"in");else throw new Error("Unable to process points")}return backfillPathPointData(result,backfillSplitMode),{result,resultMap}}__name(pairContinuousData,"pairContinuousData");function pairCategoryData(newData,oldData,diff2,opts={}){var _a201,_b,_c;const{backfillSplitMode="intersect",multiDatum=!1}=opts,result=[],resultMapSingle={added:{},moved:{},removed:{}},resultMapMulti={added:{},moved:{},removed:{}};let previousResultPoint,previousXValue;const addToResultMap=__name((xValue,result2)=>{var _a210,_b2;const type=result2.change==="move"?"moved":result2.change==="in"?"added":"removed";multiDatum?((_b2=(_a210=resultMapMulti[type])[xValue])!=null||(_a210[xValue]=[]),resultMapMulti[type][xValue].push(result2)):resultMapSingle[type][xValue]=result2,previousResultPoint=result2,previousXValue=transformIntegratedCategoryValue(xValue)},"addToResultMap");let oldIndex=0,newIndex=0,isXUnordered=!1;for(;oldIndex<oldData.nodeData.length||newIndex<newData.nodeData.length;){const before=oldData.nodeData[oldIndex],after=newData.nodeData[newIndex],bXValue=transformIntegratedCategoryValue(before==null?void 0:before.xValue),aXValue=transformIntegratedCategoryValue(after==null?void 0:after.xValue);let resultPoint;if(bXValue===aXValue)resultPoint={change:"move",moveTo:calculateMoveTo((_a201=before.point.moveTo)!=null?_a201:!1,after.point.moveTo),from:before.point,to:after.point},addToResultMap(before==null?void 0:before.xValue,resultPoint),oldIndex++,newIndex++;else if(diff2!==void 0&&diff2.removed.indexOf(String(bXValue))>=0)resultPoint={change:"out",moveTo:(_b=before.point.moveTo)!=null?_b:!1,from:before.point},addToResultMap(before==null?void 0:before.xValue,resultPoint),oldIndex++;else if(diff2!==void 0&&diff2.added.indexOf(String(aXValue))>=0)resultPoint={change:"in",moveTo:(_c=after.point.moveTo)!=null?_c:!1,to:after.point},addToResultMap(after==null?void 0:after.xValue,resultPoint),newIndex++;else if(multiDatum&&previousResultPoint&&previousXValue===bXValue)resultPoint=__spreadValues({},previousResultPoint),addToResultMap(before==null?void 0:before.xValue,resultPoint),oldIndex++;else if(multiDatum&&previousResultPoint&&previousXValue===aXValue)resultPoint=__spreadValues({},previousResultPoint),addToResultMap(after==null?void 0:after.xValue,resultPoint),newIndex++;else{isXUnordered=!0;break}result.push(resultPoint)}let previousX=-1/0;return isXUnordered||(isXUnordered=result.some(pathPoint=>{const{change:marker,to:{x=-1/0}={}}=pathPoint;if(marker==="out")return;const result2=x<previousX;return previousX=x,result2})),isXUnordered?{result:void 0,resultMap:void 0}:(backfillPathPointData(result,backfillSplitMode),multiDatum?{result,resultMap:resultMapMulti}:{result,resultMap:resultMapSingle})}__name(pairCategoryData,"pairCategoryData");function determinePathStatus(newData,oldData){let status="updated";const visible=__name(data=>data.visible,"visible");return!visible(oldData)&&visible(newData)?status="added":visible(oldData)&&!visible(newData)&&(status="removed"),status}__name(determinePathStatus,"determinePathStatus");function prepareLinePathPropertyAnimation(status,visibleToggleMode){const phase=visibleToggleMode==="none"?"updated":status,result={fromFn:_path=>{let mixin;return status==="removed"?mixin={finish:{visible:!1}}:status==="added"?mixin={start:{visible:!0}}:mixin={},__spreadValues({phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase]},mixin)},toFn:_path=>({phase:NODE_UPDATE_STATE_TO_PHASE_MAPPING[phase]})};return visibleToggleMode==="fade"?{fromFn:path=>{const opacity=status==="added"?0:path.opacity;return __spreadValues({opacity},result.fromFn(path))},toFn:path=>__spreadValues({opacity:status==="removed"?0:1},result.toFn(path))}:result}__name(prepareLinePathPropertyAnimation,"prepareLinePathPropertyAnimation");function prepareLinePathAnimationFns(newData,oldData,pairData,visibleToggleMode,render){const status=determinePathStatus(newData,oldData),removePhaseFn=__name((ratio,path)=>{render(pairData,{move:0,out:ratio},path)},"removePhaseFn"),updatePhaseFn=__name((ratio,path)=>{render(pairData,{move:ratio},path)},"updatePhaseFn"),addPhaseFn=__name((ratio,path)=>{render(pairData,{move:1,in:ratio},path)},"addPhaseFn"),pathProperties=prepareLinePathPropertyAnimation(status,visibleToggleMode);return{status,path:{addPhaseFn,updatePhaseFn,removePhaseFn},pathProperties}}__name(prepareLinePathAnimationFns,"prepareLinePathAnimationFns");function prepareLinePathAnimation(newData,oldData,diff2){var _a201,_b,_c;const isCategoryBased=((_a201=newData.scales.x)==null?void 0:_a201.type)==="category",wasCategoryBased=((_b=oldData.scales.x)==null?void 0:_b.type)==="category";if(isCategoryBased!==wasCategoryBased)return;const{result:pairData,resultMap:pairMap}=isCategoryBased?pairCategoryData(newData,oldData,diff2):pairContinuousData(newData,oldData);let status="updated";if(oldData.visible&&!newData.visible?status="removed":!oldData.visible&&newData.visible&&(status="added"),pairData===void 0||pairMap===void 0)return;const hasMotion=((_c=diff2==null?void 0:diff2.changed)!=null?_c:!0)||scalesChanged(newData,oldData)||status!=="updated",pathFns=prepareLinePathAnimationFns(newData,oldData,pairData,"fade",renderPartialPath),marker=prepareMarkerAnimation(pairMap,status);return __spreadProps(__spreadValues({},pathFns),{marker,hasMotion})}__name(prepareLinePathAnimation,"prepareLinePathAnimation");var AreaSeriesTag=(AreaSeriesTag2=>(AreaSeriesTag2[AreaSeriesTag2.Fill=0]="Fill",AreaSeriesTag2[AreaSeriesTag2.Stroke=1]="Stroke",AreaSeriesTag2[AreaSeriesTag2.Marker=2]="Marker",AreaSeriesTag2[AreaSeriesTag2.Label=3]="Label",AreaSeriesTag2))(AreaSeriesTag||{});function splitFillPoints(context){const{points}=context.fillData;return{top:points.slice(0,points.length/2),bottom:points.slice(points.length/2).reverse()}}__name(splitFillPoints,"splitFillPoints");function prepPoints(key,ctx,points){return{scales:ctx.scales,nodeData:points[key],visible:ctx.visible}}__name(prepPoints,"prepPoints");function pairFillCategoryData(newData,oldData,diff2){const oldPoints=splitFillPoints(oldData),newPoints=splitFillPoints(newData),pairOpts={multiDatum:!0};return{top:pairCategoryData(prepPoints("top",newData,newPoints),prepPoints("top",oldData,oldPoints),diff2,pairOpts),bottom:pairCategoryData(prepPoints("bottom",newData,newPoints),prepPoints("bottom",oldData,oldPoints),diff2,pairOpts)}}__name(pairFillCategoryData,"pairFillCategoryData");function pairFillContinuousData(newData,oldData){const oldPoints=splitFillPoints(oldData),newPoints=splitFillPoints(newData);return{top:pairContinuousData(prepPoints("top",newData,newPoints),prepPoints("top",oldData,oldPoints)),bottom:pairContinuousData(prepPoints("bottom",newData,newPoints),prepPoints("bottom",oldData,oldPoints))}}__name(pairFillContinuousData,"pairFillContinuousData");function prepareAreaPathAnimation(newData,oldData,diff2){var _a201,_b;const isCategoryBased=((_a201=newData.scales.x)==null?void 0:_a201.type)==="category",wasCategoryBased=((_b=oldData.scales.x)==null?void 0:_b.type)==="category";if(isCategoryBased!==wasCategoryBased)return;let status="updated";oldData.visible&&!newData.visible?status="removed":!oldData.visible&&newData.visible&&(status="added");const prepareMarkerPairs=__name(()=>isCategoryBased?pairCategoryData(newData,oldData,diff2,{backfillSplitMode:"static",multiDatum:!0}):pairContinuousData(newData,oldData,{backfillSplitMode:"static"}),"prepareMarkerPairs"),prepareFillPairs=__name(()=>isCategoryBased?pairFillCategoryData(newData,oldData,diff2):pairFillContinuousData(newData,oldData),"prepareFillPairs"),{resultMap:markerPairMap}=prepareMarkerPairs(),{top,bottom}=prepareFillPairs();if(markerPairMap===void 0||top.result===void 0||bottom.result===void 0)return;const pairData=[...top.result,...bottom.result.reverse()],fadeMode=(oldData.stackVisible?newData.stackVisible:!1)?"none":"fade",fill=prepareLinePathAnimationFns(newData,oldData,pairData,fadeMode,renderPartialPath),marker=prepareMarkerAnimation(markerPairMap,status);return{fill,marker}}__name(prepareAreaPathAnimation,"prepareAreaPathAnimation");var _a152,_AreaSeries=(_a152=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,pathsPerSeries:2,pathsZIndexSubOrderOffset:[0,1e3],hasMarkers:!0,markerSelectionGarbageCollection:!1,pickModes:[1,0],animationResetFns:{path:buildResetPathFn({getOpacity:()=>this.getOpacity()}),label:resetLabelFn,marker:(node,datum)=>__spreadValues(__spreadValues({},resetMarkerFn()),resetMarkerPositionFn(node,datum))}}),this.properties=new AreaSeriesProperties}processData(dataController){return __async(this,null,function*(){if(this.data==null||!this.properties.isValid())return;const{data,visible,seriesGrouping:{groupIndex=this.id,stackCount=1}={}}=this,{xKey,yKey,connectMissingData,normalizedTo}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),{isContinuousX,isContinuousY}=this.isContinuous(),ids=[`area-stack-${groupIndex}-yValues`,`area-stack-${groupIndex}-yValues-trailing`,`area-stack-${groupIndex}-yValues-prev`,`area-stack-${groupIndex}-yValues-trailing-prev`,`area-stack-${groupIndex}-yValues-marker`],extraProps=[];isDefined(normalizedTo)&&(extraProps.push(normaliseGroupTo(this,[ids[0],ids[1],ids[4]],normalizedTo,"range")),extraProps.push(normaliseGroupTo(this,[ids[2],ids[3]],normalizedTo,"range"))),!isContinuousX&&animationEnabled&&this.processedData&&extraProps.push(diff(this.processedData)),animationEnabled&&extraProps.push(animationValidation(this));const common={invalidValue:null};connectMissingData&&stackCount>1&&(common.invalidValue=0),visible||(common.forceValue=0),yield this.requestDataModel(dataController,data,{props:[keyProperty(this,xKey,isContinuousX,{id:"xValue"}),valueProperty(this,yKey,isContinuousY,__spreadValues({id:"yValueRaw"},common)),...groupAccumulativeValueProperty(this,yKey,isContinuousY,"window","current",__spreadProps(__spreadValues({id:"yValueEnd"},common),{groupId:ids[0]})),...groupAccumulativeValueProperty(this,yKey,isContinuousY,"window-trailing","current",__spreadProps(__spreadValues({id:"yValueStart"},common),{groupId:ids[1]})),...groupAccumulativeValueProperty(this,yKey,isContinuousY,"window","last",__spreadProps(__spreadValues({id:"yValuePreviousEnd"},common),{groupId:ids[2]})),...groupAccumulativeValueProperty(this,yKey,isContinuousY,"window-trailing","last",__spreadProps(__spreadValues({id:"yValuePreviousStart"},common),{groupId:ids[3]})),...groupAccumulativeValueProperty(this,yKey,isContinuousY,"normal","current",__spreadProps(__spreadValues({id:"yValueCumulative"},common),{groupId:ids[4]})),...extraProps],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")})}getSeriesDomain(direction){const{processedData,dataModel,axes}=this;if(!processedData||!dataModel||processedData.data.length===0)return[];const xAxis=axes.x,yAxis=axes.y,keyDef=dataModel.resolveProcessedDataDefById(this,"xValue"),keys=dataModel.getDomain(this,"xValue","key",processedData),yExtent=dataModel.getDomain(this,"yValueEnd","value",processedData);if(direction==="x")return(keyDef==null?void 0:keyDef.def.type)==="key"&&keyDef.def.valueType==="category"?keys:fixNumericExtent(extent(keys),xAxis);if(yAxis instanceof LogAxis||yAxis instanceof TimeAxis)return fixNumericExtent(yExtent,yAxis);{const fixedYExtent=[yExtent[0]>0?0:yExtent[0],yExtent[1]<0?0:yExtent[1]];return fixNumericExtent(fixedYExtent,yAxis)}}createNodeData(){return __async(this,null,function*(){var _a201;const{axes,data,processedData:{data:groupedData}={},dataModel}=this,xAxis=axes.x,yAxis=axes.y;if(!xAxis||!yAxis||!data||!dataModel||!this.properties.isValid())return[];const{yKey,xKey,marker,label,fill:seriesFill,stroke:seriesStroke,connectMissingData}=this.properties,{scale:xScale}=xAxis,{scale:yScale}=yAxis,continuousY=ContinuousScale.is(yScale),xOffset=((_a201=xScale.bandwidth)!=null?_a201:0)/2,defs=dataModel.resolveProcessedDataDefsByIds(this,["yValueStart","yValueEnd","yValueRaw","yValuePreviousStart","yValuePreviousEnd","yValueCumulative"]),createMovePoint=__name(plainPoint=>{const _a210=plainPoint,{point}=_a210,stroke=__objRest(_a210,["point"]);return __spreadProps(__spreadValues({},stroke),{point:__spreadProps(__spreadValues({},point),{moveTo:!0})})},"createMovePoint"),createPathCoordinates=__name((xValue,lastYEnd,yEnd)=>{const x=xScale.convert(xValue)+xOffset,prevYCoordinate=yScale.convert(lastYEnd),currYCoordinate=yScale.convert(yEnd);return[{point:{x,y:currYCoordinate},yValue:yEnd,xValue},{point:{x,y:prevYCoordinate},yValue:lastYEnd,xValue}]},"createPathCoordinates"),createMarkerCoordinate=__name((xDatum,yEnd,rawYDatum)=>{let currY;return(isDefined(this.properties.normalizedTo)?continuousY&&isContinuous(rawYDatum):!isNaN(rawYDatum))&&(currY=yEnd),{x:xScale.convert(xDatum)+xOffset,y:yScale.convert(currY),size:marker.size}},"createMarkerCoordinate"),itemId=yKey,labelData=[],markerData=[],{visibleSameStackCount}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this),context={itemId,fillData:{itemId,points:[]},strokeData:{itemId,points:[]},labelData,nodeData:markerData,scales:__superGet(_a152.prototype,this,"calculateScaling").call(this),visible:this.visible,stackVisible:visibleSameStackCount>0},fillPoints=context.fillData.points,fillPhantomPoints=[],strokePoints=context.strokeData.points;let datumIdx=-1,lastXDatum,lastYDatum=-1/0;return groupedData==null||groupedData.forEach(datumGroup=>{const{keys,keys:[xDatum],datum:datumArray,values:valuesArray}=datumGroup;valuesArray.forEach((values,valueIdx)=>{var _a210,_b,_c;datumIdx++;const seriesDatum=datumArray[valueIdx],dataValues=dataModel.resolveProcessedDataDefsValues(defs,{keys,values}),{yValueRaw:yDatum,yValueCumulative}=dataValues;let{yValueStart,yValueEnd,yValuePreviousStart,yValuePreviousEnd}=dataValues;const validPoint=yDatum!=null,point=createMarkerCoordinate(xDatum,+yValueCumulative,yDatum);if(validPoint&&marker&&markerData.push({index:datumIdx,series:this,itemId,datum:seriesDatum,midPoint:{x:point.x,y:point.y},cumulativeValue:yValueEnd,yValue:yDatum,xValue:xDatum,yKey,xKey,point,fill:(_a210=marker.fill)!=null?_a210:seriesFill,stroke:(_b=marker.stroke)!=null?_b:seriesStroke,strokeWidth:(_c=marker.strokeWidth)!=null?_c:this.getStrokeWidth(this.properties.strokeWidth)}),validPoint&&label){const labelText=this.getLabelText(label,{value:yDatum,datum:seriesDatum,xKey,yKey,xName:this.properties.xName,yName:this.properties.yName},value=>isFiniteNumber(value)?value.toFixed(2):String(value));labelData.push({index:datumIdx,series:this,itemId:yKey,datum:seriesDatum,x:point.x,y:point.y,label:labelText?{text:labelText,fontStyle:label.fontStyle,fontWeight:label.fontWeight,fontSize:label.fontSize,fontFamily:label.fontFamily,textAlign:"center",textBaseline:"bottom",fill:label.color}:void 0})}const xValid=lastXDatum!=null&&xDatum!=null,yValid=lastYDatum!=null&&validPoint;yValid||(yValueStart=yValueStart??0,yValueEnd=yValueStart??0,yValuePreviousStart=yValuePreviousStart??0,yValuePreviousEnd=yValuePreviousStart??0);const[prevTop,prevBottom]=createPathCoordinates(lastXDatum,yValuePreviousStart,yValuePreviousEnd),[top,bottom]=createPathCoordinates(xDatum,yValueStart,yValueEnd);xValid&&(!connectMissingData||yValid)&&(fillPoints.push(prevTop),fillPhantomPoints.push(prevBottom),fillPoints.push(top),fillPhantomPoints.push(bottom)),yValid&&datumIdx>0&&(strokePoints.push(createMovePoint(prevTop)),strokePoints.push(top)),lastXDatum=xDatum,lastYDatum=yDatum})}),strokePoints.length>0&&(strokePoints[0]=createMovePoint(strokePoints[0])),fillPhantomPoints.reverse(),fillPoints.push(...fillPhantomPoints),[context]})}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}markerFactory(){const{shape}=this.properties.marker,MarkerShape=getMarker(shape);return new MarkerShape}updatePathNodes(opts){return __async(this,null,function*(){const{opacity,visible,animationEnabled}=opts,[fill,stroke]=opts.paths,strokeWidth=this.getStrokeWidth(this.properties.strokeWidth);stroke.setProperties({tag:1,fill:void 0,lineJoin:stroke.lineCap="round",pointerEvents:1,stroke:this.properties.stroke,strokeWidth,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity,visible}),fill.setProperties({tag:0,stroke:void 0,lineJoin:"round",pointerEvents:1,fill:this.properties.fill,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,strokeOpacity:this.properties.strokeOpacity,fillShadow:this.properties.shadow,opacity,visible:visible||animationEnabled,strokeWidth}),updateClipPath(this,stroke),updateClipPath(this,fill)})}updatePaths(opts){return __async(this,null,function*(){this.updateAreaPaths([opts.paths],[opts.contextData])})}updateAreaPaths(paths,contextData){this.updateFillPath(paths,contextData),this.updateStrokePath(paths,contextData)}updateFillPath(paths,contextData){contextData.forEach(({fillData},contextDataIndex)=>{const[fill]=paths[contextDataIndex],{path:fillPath}=fill;fillPath.clear({trackChanges:!0});for(const{point}of fillData.points)point.moveTo?fillPath.moveTo(point.x,point.y):fillPath.lineTo(point.x,point.y);fillPath.closePath(),fill.checkPathDirty()})}updateStrokePath(paths,contextData){contextData.forEach(({strokeData},contextDataIndex)=>{const[,stroke]=paths[contextDataIndex],{path:strokePath}=stroke;strokePath.clear({trackChanges:!0});for(const{point}of strokeData.points)point.moveTo?strokePath.moveTo(point.x,point.y):strokePath.lineTo(point.x,point.y);stroke.checkPathDirty()})}updateMarkerSelection(opts){return __async(this,null,function*(){const{nodeData,markerSelection}=opts;return this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(this.properties.marker.enabled?nodeData:[])})}updateMarkerNodes(opts){return __async(this,null,function*(){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,marker,fill,stroke,strokeWidth,fillOpacity,strokeOpacity,highlightStyle}=this.properties,baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle(),{fill,stroke,strokeWidth,fillOpacity,strokeOpacity});markerSelection.each((node,datum)=>{this.updateMarkerStyle(node,marker,{datum,highlighted,xKey,yKey},baseStyle)}),highlighted||this.properties.marker.markClean()})}updateLabelSelection(opts){return __async(this,null,function*(){const{labelData,labelSelection}=opts;return labelSelection.update(labelData,text=>{text.tag=3})})}updateLabelNodes(opts){return __async(this,null,function*(){const{labelSelection}=opts,{enabled:labelEnabled,fontStyle,fontWeight,fontSize,fontFamily,color}=this.properties.label;labelSelection.each((text,datum)=>{const{x,y,label}=datum;label&&labelEnabled&&this.visible?(text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.textAlign=label.textAlign,text.textBaseline=label.textBaseline,text.text=label.text,text.x=x,text.y=y-10,text.fill=color,text.visible=!0):text.visible=!1})})}getTooltipHtml(nodeDatum){const{id:seriesId,axes,dataModel}=this,{xKey,xName,yName,tooltip,marker}=this.properties,{yKey,xValue,yValue,datum}=nodeDatum,xAxis=axes.x,yAxis=axes.y;if(!this.properties.isValid()||!(xAxis&&yAxis&&isFiniteNumber(yValue))||!dataModel)return"";const xString=xAxis.formatDatum(xValue),yString=yAxis.formatDatum(yValue),title=sanitizeHtml(yName),content=sanitizeHtml(xString+": "+yString),baseStyle=mergeDefaults({fill:this.properties.fill},marker.getStyle(),{stroke:this.properties.stroke,strokeWidth:this.properties.strokeWidth}),{fill:color}=this.getMarkerStyle(marker,{datum:nodeDatum,xKey,yKey,highlighted:!1},baseStyle);return tooltip.toTooltipHtml({title,content,backgroundColor:color},{datum,xKey,xName,yKey,yName,color,title,seriesId})}getLegendData(legendType){var _a201,_b,_c,_d;if(!((_a201=this.data)!=null&&_a201.length)||!this.properties.isValid()||legendType!=="category")return[];const{yKey,yName,fill,stroke,fillOpacity,strokeOpacity,strokeWidth,lineDash,marker,visible}=this.properties,useAreaFill=!marker.enabled||marker.fill===void 0;return[{legendType,id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:yName??yKey},marker:{shape:marker.shape,fill:useAreaFill?fill:marker.fill,fillOpacity:useAreaFill?fillOpacity:marker.fillOpacity,stroke:(_b=marker.stroke)!=null?_b:stroke,strokeOpacity:(_c=marker.strokeOpacity)!=null?_c:strokeOpacity,strokeWidth:(_d=marker.strokeWidth)!=null?_d:0,enabled:marker.enabled||strokeWidth<=0},line:{stroke,strokeOpacity,strokeWidth,lineDash}}]}animateEmptyUpdateReady(animationData){const{markerSelections,labelSelections,contextData,paths}=animationData,{animationManager}=this.ctx;this.updateAreaPaths(paths,contextData),pathSwipeInAnimation(this,animationManager,paths.flat()),resetMotion(markerSelections,resetMarkerPositionFn),markerSwipeScaleInAnimation(this,animationManager,markerSelections),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections)}animateReadyResize(animationData){const{contextData,paths}=animationData;this.updateAreaPaths(paths,contextData),super.animateReadyResize(animationData)}animateWaitingUpdateReady(animationData){var _a201,_b;const{animationManager}=this.ctx,{markerSelections,labelSelections,contextData,paths,previousContextData}=animationData,[[fill,stroke]]=paths;super.resetAllAnimation(animationData);const update=__name(()=>{this.updateAreaPaths(paths,contextData),this.updateStrokePath(paths,contextData)},"update"),skip=__name(()=>{animationManager.skipCurrentBatch(),update()},"skip");if(contextData.length===0||(previousContextData==null?void 0:previousContextData.length)===0){update(),markerFadeInAnimation(this,animationManager,markerSelections,"added"),pathFadeInAnimation(this,"fill_path_properties",animationManager,[fill]),pathFadeInAnimation(this,"stroke",animationManager,[stroke],"trailing"),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections);return}const[newData]=contextData,[oldData]=previousContextData??[],fns=prepareAreaPathAnimation(newData,oldData,(_b=(_a201=this.processedData)==null?void 0:_a201.reduced)==null?void 0:_b.diff);if(fns===void 0){skip();return}markerFadeInAnimation(this,animationManager,markerSelections),fromToMotion(this.id,"fill_path_properties",animationManager,[fill],fns.fill.pathProperties),pathMotion(this.id,"fill_path_update",animationManager,[fill],fns.fill.path),this.updateStrokePath(paths,contextData),pathFadeInAnimation(this,"stroke",animationManager,[stroke],"trailing"),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}},__name(_a152,"_AreaSeries"),_a152);_AreaSeries.className="AreaSeries";_AreaSeries.type="area";var AreaSeries=_AreaSeries,AreaSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"area",instanceConstructor:AreaSeries,stackable:!0,seriesDefaults:{axes:[{type:"number",position:"left"},{type:"category",position:"bottom"}]},themeTemplate:{series:{__extends__:EXTENDS_SERIES_DEFAULTS,nodeClickRange:"nearest",tooltip:{position:{type:"node"}},fillOpacity:.8,strokeOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5},marker:{__extends__:EXTENDS_CARTESIAN_MARKER_DEFAULTS,enabled:!1,fillOpacity:1,strokeOpacity:1,strokeWidth:0},label:{enabled:!1,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,formatter:void 0}}},paletteFactory:params=>{const{marker}=markerPaletteFactory(params);return{fill:marker.fill,stroke:marker.stroke,marker}}},_a153,AbstractBarSeriesProperties=(_a153=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.direction="vertical"}},__name(_a153,"AbstractBarSeriesProperties"),_a153);__decorateClass([Validate(DIRECTION)],AbstractBarSeriesProperties.prototype,"direction",2);var _a154,AbstractBarSeries=(_a154=class extends CartesianSeries{getBandScalePadding(){return{inner:.2,outer:.1}}shouldFlipXY(){return!this.isVertical()}isVertical(){return this.properties.direction==="vertical"}getBarDirection(){return this.shouldFlipXY()?"x":"y"}getCategoryDirection(){return this.shouldFlipXY()?"y":"x"}getValueAxis(){const direction=this.getBarDirection();return this.axes[direction]}getCategoryAxis(){const direction=this.getCategoryDirection();return this.axes[direction]}},__name(_a154,"AbstractBarSeries"),_a154),_a155,BarSeriesLabel=(_a155=class extends Label{constructor(){super(...arguments),this.placement="inside"}},__name(_a155,"BarSeriesLabel"),_a155);__decorateClass([Validate(PLACEMENT)],BarSeriesLabel.prototype,"placement",2);var _a156,BarSeriesProperties=(_a156=class extends AbstractBarSeriesProperties{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new DropShadow,this.label=new BarSeriesLabel,this.tooltip=new SeriesTooltip}},__name(_a156,"BarSeriesProperties"),_a156);__decorateClass([Validate(STRING)],BarSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING,{optional:!0})],BarSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING)],BarSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],BarSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],BarSeriesProperties.prototype,"stackGroup",2);__decorateClass([Validate(NUMBER,{optional:!0})],BarSeriesProperties.prototype,"normalizedTo",2);__decorateClass([Validate(COLOR_STRING)],BarSeriesProperties.prototype,"fill",2);__decorateClass([Validate(RATIO)],BarSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING)],BarSeriesProperties.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],BarSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],BarSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],BarSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],BarSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(POSITIVE_NUMBER)],BarSeriesProperties.prototype,"cornerRadius",2);__decorateClass([Validate(FUNCTION,{optional:!0})],BarSeriesProperties.prototype,"formatter",2);__decorateClass([Validate(OBJECT,{optional:!0})],BarSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],BarSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],BarSeriesProperties.prototype,"tooltip",2);function updateRect({rect,config}){const{crisp=!0,fill,stroke,strokeWidth,fillOpacity,strokeOpacity,lineDash,lineDashOffset,fillShadow,cornerRadius=0,topLeftCornerRadius,topRightCornerRadius,bottomRightCornerRadius,bottomLeftCornerRadius,cornerRadiusBbox,visible=!0}=config;rect.crisp=crisp,rect.fill=fill,rect.stroke=stroke,rect.strokeWidth=strokeWidth,rect.fillOpacity=fillOpacity,rect.strokeOpacity=strokeOpacity,rect.lineDash=lineDash,rect.lineDashOffset=lineDashOffset,rect.fillShadow=fillShadow,rect.topLeftCornerRadius=topLeftCornerRadius?cornerRadius:0,rect.topRightCornerRadius=topRightCornerRadius?cornerRadius:0,rect.bottomRightCornerRadius=bottomRightCornerRadius?cornerRadius:0,rect.bottomLeftCornerRadius=bottomLeftCornerRadius?cornerRadius:0,rect.cornerRadiusBbox=cornerRadiusBbox,rect.visible=visible}__name(updateRect,"updateRect");function getRectConfig(_a201){var _b=_a201,{datum,isHighlighted,style,highlightStyle,formatter,seriesId,ctx:{callbackCache}}=_b,opts=__objRest(_b,["datum","isHighlighted","style","highlightStyle","formatter","seriesId","ctx"]),_a210,_b2,_c,_d,_e,_f;const{fill,fillOpacity,stroke,strokeWidth}=mergeDefaults(isHighlighted&&highlightStyle,style),{strokeOpacity,fillShadow,lineDash,lineDashOffset,cornerRadius=0,topLeftCornerRadius=!0,topRightCornerRadius=!0,bottomRightCornerRadius=!0,bottomLeftCornerRadius=!0,cornerRadiusBbox}=style;let format2;return formatter&&(format2=callbackCache.call(formatter,__spreadValues({datum:datum.datum,xKey:datum.xKey,fill,stroke,strokeWidth,cornerRadius,highlighted:isHighlighted,seriesId},opts))),{fill:(_a210=format2==null?void 0:format2.fill)!=null?_a210:fill,stroke:(_b2=format2==null?void 0:format2.stroke)!=null?_b2:stroke,strokeWidth:(_c=format2==null?void 0:format2.strokeWidth)!=null?_c:strokeWidth,fillOpacity:(_d=format2==null?void 0:format2.fillOpacity)!=null?_d:fillOpacity,strokeOpacity:(_e=format2==null?void 0:format2.strokeOpacity)!=null?_e:strokeOpacity,lineDash,lineDashOffset,fillShadow,cornerRadius:(_f=format2==null?void 0:format2.cornerRadius)!=null?_f:cornerRadius,topLeftCornerRadius,topRightCornerRadius,bottomRightCornerRadius,bottomLeftCornerRadius,cornerRadiusBbox}}__name(getRectConfig,"getRectConfig");function checkCrisp(visibleRange=[]){const[visibleMin,visibleMax]=visibleRange;return!(visibleMin!==0||visibleMax!==1)}__name(checkCrisp,"checkCrisp");var isDatumNegative=__name(datum=>{var _a201;return isNegative((_a201=datum.yValue)!=null?_a201:0)},"isDatumNegative");function collapsedStartingBarPosition(isVertical,axes,mode){const{startingX,startingY}=getStartingValues(isVertical,axes);return{isVertical,calculate:__name((datum,prevDatum)=>{let x=isVertical?datum.x:startingX,y=isVertical?startingY:datum.y,width=isVertical?datum.width:0,height=isVertical?0:datum.height;const opacity=datum.opacity;return prevDatum&&(isNaN(x)||isNaN(y))&&({x,y}=prevDatum,width=isVertical?prevDatum.width:0,height=isVertical?0:prevDatum.height,isVertical&&!isDatumNegative(prevDatum)?y+=prevDatum.height:!isVertical&&isDatumNegative(prevDatum)&&(x+=prevDatum.width)),{x,y,width,height,opacity}},"calculate"),mode}}__name(collapsedStartingBarPosition,"collapsedStartingBarPosition");function midpointStartingBarPosition(isVertical,mode){return{isVertical,calculate:datum=>({x:isVertical?datum.x:datum.x+datum.width/2,y:isVertical?datum.y+datum.height/2:datum.y,width:isVertical?datum.width:0,height:isVertical?0:datum.height,opacity:datum.opacity}),mode}}__name(midpointStartingBarPosition,"midpointStartingBarPosition");function prepareBarAnimationFunctions(initPos){const isRemoved=__name(datum=>datum==null||isNaN(datum.x)||isNaN(datum.y),"isRemoved");return{toFn:__name((rect,datum,status)=>status==="removed"&&rect.datum==null&&initPos.mode==="fade"?__spreadProps(__spreadValues({},resetBarSelectionsFn(rect,datum)),{opacity:0}):status==="removed"||isRemoved(datum)?initPos.calculate(datum,rect.previousDatum):{x:datum.x,y:datum.y,width:datum.width,height:datum.height,opacity:datum.opacity},"toFn"),fromFn:__name((rect,datum,status)=>{status==="updated"&&isRemoved(datum)?status="removed":status==="updated"&&isRemoved(rect.previousDatum)&&(status="added");let source={x:rect.x,y:rect.y,width:rect.width,height:rect.height,opacity:rect.opacity};status==="added"&&rect.previousDatum==null&&initPos.mode==="fade"?source=__spreadProps(__spreadValues({},resetBarSelectionsFn(rect,datum)),{opacity:0}):(status==="unknown"||status==="added")&&(source=initPos.calculate(datum,rect.previousDatum));const phase=NODE_UPDATE_STATE_TO_PHASE_MAPPING[status];return __spreadProps(__spreadValues({},source),{phase})},"fromFn")}}__name(prepareBarAnimationFunctions,"prepareBarAnimationFunctions");function getStartingValues(isVertical,axes){const axis=axes[isVertical?"y":"x"];let startingX=1/0,startingY=0;return axis?(isVertical?startingY=axis.scale.convert(ContinuousScale.is(axis.scale)?0:Math.max(...axis.range)):startingX=axis.scale.convert(ContinuousScale.is(axis.scale)?0:Math.min(...axis.range)),{startingX,startingY}):{startingX,startingY}}__name(getStartingValues,"getStartingValues");function resetBarSelectionsFn(_node,{x,y,width,height,opacity}){return{x,y,width,height,opacity}}__name(resetBarSelectionsFn,"resetBarSelectionsFn");function updateLabelNode(textNode,label,labelDatum){if(label.enabled&&labelDatum){const{x,y,text,textAlign,textBaseline}=labelDatum,{color:fill,fontStyle,fontWeight,fontSize,fontFamily}=label;textNode.setProperties({visible:!0,x,y,text,fill,fontStyle,fontWeight,fontSize,fontFamily,textAlign,textBaseline})}else textNode.visible=!1}__name(updateLabelNode,"updateLabelNode");function adjustLabelPlacement({isPositive,isVertical,placement,padding=0,rect}){let x=rect.x+rect.width/2,y=rect.y+rect.height/2,textAlign="center",textBaseline="middle";switch(placement){case"start":{isVertical?(y=isPositive?rect.y+rect.height+padding:rect.y-padding,textBaseline=isPositive?"top":"bottom"):(x=isPositive?rect.x-padding:rect.x+rect.width+padding,textAlign=isPositive?"start":"end");break}case"outside":case"end":{isVertical?(y=isPositive?rect.y-padding:rect.y+rect.height+padding,textBaseline=isPositive?"bottom":"top"):(x=isPositive?rect.x+rect.width+padding:rect.x-padding,textAlign=isPositive?"start":"end");break}}return{x,y,textAlign,textBaseline}}__name(adjustLabelPlacement,"adjustLabelPlacement");var _a157,_BarSeries=(_a157=class extends AbstractBarSeries{constructor(moduleCtx){super({moduleCtx,pickModes:[0],pathsPerSeries:0,hasHighlightedLabels:!0,datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:resetBarSelectionsFn,label:resetLabelFn}}),this.properties=new BarSeriesProperties,this.groupScale=new BandScale,this.smallestDataInterval=void 0}resolveKeyDirection(direction){return this.getBarDirection()==="x"?direction==="x"?"y":"x":direction}processData(dataController){return __async(this,null,function*(){var _a201,_b,_c,_d;if(!this.properties.isValid()||!this.data)return;const{seriesGrouping:{groupIndex=this.id}={},data=[]}=this,{xKey,yKey,normalizedTo}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),normalizedToAbs=Math.abs(normalizedTo??NaN),isContinuousX=ContinuousScale.is((_a201=this.getCategoryAxis())==null?void 0:_a201.scale),isContinuousY=ContinuousScale.is((_b=this.getValueAxis())==null?void 0:_b.scale),stackGroupName=`bar-stack-${groupIndex}-yValues`,stackGroupTrailingName=`${stackGroupName}-trailing`,normaliseTo=normalizedToAbs&&isFinite(normalizedToAbs)?normalizedToAbs:void 0,extraProps=[];normaliseTo&&extraProps.push(normaliseGroupTo(this,[stackGroupName,stackGroupTrailingName],normaliseTo,"range")),animationEnabled&&this.processedData&&extraProps.push(diff(this.processedData)),animationEnabled&&extraProps.push(animationValidation(this));const visibleProps=this.visible?{}:{forceValue:0},{processedData}=yield this.requestDataModel(dataController,data,{props:[keyProperty(this,xKey,isContinuousX,{id:"xValue"}),valueProperty(this,yKey,isContinuousY,__spreadValues({id:"yValue-raw",invalidValue:null},visibleProps)),...groupAccumulativeValueProperty(this,yKey,isContinuousY,"normal","current",__spreadValues({id:"yValue-end",rangeId:"yValue-range",invalidValue:null,missingValue:0,groupId:stackGroupName,separateNegative:!0},visibleProps)),...groupAccumulativeValueProperty(this,yKey,isContinuousY,"trailing","current",__spreadValues({id:"yValue-start",invalidValue:null,missingValue:0,groupId:stackGroupTrailingName,separateNegative:!0},visibleProps)),...isContinuousX?[SMALLEST_KEY_INTERVAL]:[],...extraProps],groupByKeys:!0,groupByData:!1});this.smallestDataInterval={x:(_d=(_c=processedData.reduced)==null?void 0:_c.smallestKeyInterval)!=null?_d:1/0,y:1/0},this.animationState.transition("updateData")})}getSeriesDomain(direction){var _a201;const{processedData,dataModel}=this;if(!processedData||!dataModel||processedData.data.length===0)return[];const{reduced:{[SMALLEST_KEY_INTERVAL.property]:smallestX}={}}=processedData,categoryAxis=this.getCategoryAxis(),valueAxis=this.getValueAxis(),keyDef=dataModel.resolveProcessedDataDefById(this,"xValue"),keys=dataModel.getDomain(this,"xValue","key",processedData),yExtent=dataModel.getDomain(this,"yValue-end","value",processedData);if(direction===this.getCategoryDirection()){if((keyDef==null?void 0:keyDef.def.type)==="key"&&(keyDef==null?void 0:keyDef.def.valueType)==="category")return keys;const scalePadding=smallestX!=null&&isFinite(smallestX)?smallestX:0,keysExtent=(_a201=extent(keys))!=null?_a201:[NaN,NaN],isReversed=categoryAxis==null?void 0:categoryAxis.isReversed();if(direction==="y"){const d02=keysExtent[0]+(isReversed?0:-scalePadding),d12=keysExtent[1]+(isReversed?scalePadding:0);return fixNumericExtent([d02,d12],categoryAxis)}const d0=keysExtent[0]+(isReversed?-scalePadding:0),d1=keysExtent[1]+(isReversed?0:scalePadding);return fixNumericExtent([d0,d1],categoryAxis)}else{if(this.getValueAxis()instanceof LogAxis)return fixNumericExtent(yExtent,valueAxis);{const fixedYExtent=[yExtent[0]>0?0:yExtent[0],yExtent[1]<0?0:yExtent[1]];return fixNumericExtent(fixedYExtent,valueAxis)}}}createNodeData(){return __async(this,null,function*(){const{dataModel}=this,xAxis=this.getCategoryAxis(),yAxis=this.getValueAxis();if(!(dataModel&&xAxis&&yAxis&&this.properties.isValid()))return[];const xScale=xAxis.scale,yScale=yAxis.scale,{groupScale,processedData,smallestDataInterval,ctx:{seriesStateManager}}=this,{xKey,yKey,xName,yName,fill,stroke,strokeWidth,cornerRadius,legendItemName,label}=this.properties,yReversed=yAxis.isReversed(),xBandWidth=ContinuousScale.is(xScale)?xScale.calcBandwidth(smallestDataInterval==null?void 0:smallestDataInterval.x):xScale.bandwidth,domain=[],{index:groupIndex,visibleGroupCount}=seriesStateManager.getVisiblePeerGroupIndex(this);for(let groupIdx=0;groupIdx<visibleGroupCount;groupIdx++)domain.push(String(groupIdx));groupScale.domain=domain,groupScale.range=[0,xBandWidth??0],xAxis instanceof CategoryAxis?groupScale.paddingInner=xAxis.groupPaddingInner:xAxis instanceof GroupedCategoryAxis?groupScale.padding=.1:groupScale.padding=0,groupScale.round=groupScale.padding!==0;const barWidth=groupScale.bandwidth>=1?groupScale.bandwidth:groupScale.rawBandwidth,xIndex=dataModel.resolveProcessedDataIndexById(this,"xValue").index,yRawIndex=dataModel.resolveProcessedDataIndexById(this,"yValue-raw").index,yStartIndex=dataModel.resolveProcessedDataIndexById(this,"yValue-start").index,yEndIndex=dataModel.resolveProcessedDataIndexById(this,"yValue-end").index,yRangeIndex=dataModel.resolveProcessedDataDefById(this,"yValue-range").index,animationEnabled=!this.ctx.animationManager.isSkipped(),contexts=[];return processedData==null||processedData.data.forEach(({keys,datum:seriesDatum,values,aggValues})=>{values.forEach((value,contextIndex)=>{var _a201,_b;(_a201=contexts[contextIndex])!=null||(contexts[contextIndex]={itemId:yKey,nodeData:[],labelData:[],scales:__superGet(_a157.prototype,this,"calculateScaling").call(this),visible:this.visible||animationEnabled});const xValue=keys[xIndex],x=xScale.convert(xValue),currY=+value[yEndIndex],prevY=+value[yStartIndex],yRawValue=value[yRawIndex],isPositive=yRawValue>=0,isUpward=isPositive!==yReversed,yRange=(_b=aggValues==null?void 0:aggValues[yRangeIndex][isPositive?1:0])!=null?_b:0,barX=x+groupScale.convert(String(groupIndex));if(isNaN(currY))return;const y=yScale.convert(currY),bottomY=yScale.convert(prevY),barAlongX=this.getBarDirection()==="x",bboxHeight=yScale.convert(yRange),bboxBottom=yScale.convert(0),cornerRadiusBbox=new BBox(barAlongX?Math.min(bboxBottom,bboxHeight):barX,barAlongX?barX:Math.min(bboxBottom,bboxHeight),barAlongX?Math.abs(bboxBottom-bboxHeight):barWidth,barAlongX?barWidth:Math.abs(bboxBottom-bboxHeight)),rect={x:barAlongX?Math.min(y,bottomY):barX,y:barAlongX?barX:Math.min(y,bottomY),width:barAlongX?Math.abs(bottomY-y):barWidth,height:barAlongX?barWidth:Math.abs(bottomY-y),cornerRadiusBbox},{fontStyle:labelFontStyle,fontWeight:labelFontWeight,fontSize:labelFontSize,fontFamily:labelFontFamily,color:labelColor,placement}=label,labelText=this.getLabelText(this.properties.label,{datum:seriesDatum[contextIndex],value:yRawValue,xKey,yKey,xName,yName,legendItemName},value2=>isFiniteNumber(value2)?value2.toFixed(2):""),labelDatum=labelText?__spreadValues({text:labelText,fill:labelColor,fontStyle:labelFontStyle,fontWeight:labelFontWeight,fontSize:labelFontSize,fontFamily:labelFontFamily},adjustLabelPlacement({isPositive,isVertical:!barAlongX,placement,rect})):void 0,lengthRatioMultiplier=this.shouldFlipXY()?rect.height:rect.width,nodeData={series:this,itemId:yKey,datum:seriesDatum[contextIndex],cumulativeValue:currY,xValue,yValue:yRawValue,yKey,xKey,capDefaults:{lengthRatioMultiplier,lengthMax:lengthRatioMultiplier},x:rect.x,y:rect.y,width:rect.width,height:rect.height,midPoint:{x:rect.x+rect.width/2,y:rect.y+rect.height/2},fill,stroke,opacity:1,strokeWidth,cornerRadius,topLeftCornerRadius:barAlongX!==isUpward,topRightCornerRadius:isUpward,bottomRightCornerRadius:barAlongX===isUpward,bottomLeftCornerRadius:!isUpward,cornerRadiusBbox,label:labelDatum};contexts[contextIndex].nodeData.push(nodeData),contexts[contextIndex].labelData.push(nodeData)})}),contexts})}nodeFactory(){return new Rect}updateDatumSelection(opts){return __async(this,null,function*(){return opts.datumSelection.update(opts.nodeData,rect=>{rect.tag=0},datum=>createDatumId(datum.xValue))})}updateDatumNodes(opts){return __async(this,null,function*(){if(!this.properties.isValid())return;const{yKey,stackGroup,fill,fillOpacity,stroke,strokeWidth,strokeOpacity,lineDash,lineDashOffset,formatter,shadow,highlightStyle:{item:itemHighlightStyle}}=this.properties,xAxis=this.axes.x,crisp=checkCrisp(xAxis==null?void 0:xAxis.visibleRange),categoryAlongX=this.getCategoryDirection()==="x";opts.datumSelection.each((rect,datum)=>{const style={fill,stroke,fillOpacity,strokeOpacity,lineDash,lineDashOffset,fillShadow:shadow,strokeWidth:this.getStrokeWidth(strokeWidth),cornerRadius:datum.cornerRadius,topLeftCornerRadius:datum.topLeftCornerRadius,topRightCornerRadius:datum.topRightCornerRadius,bottomRightCornerRadius:datum.bottomRightCornerRadius,bottomLeftCornerRadius:datum.bottomLeftCornerRadius,cornerRadiusBbox:datum.cornerRadiusBbox},visible=categoryAlongX?datum.width>0:datum.height>0,config=getRectConfig({datum,ctx:this.ctx,seriesId:this.id,isHighlighted:opts.isHighlight,highlightStyle:itemHighlightStyle,yKey,style,formatter,stackGroup});config.crisp=crisp,config.visible=visible,updateRect({rect,config})})})}updateLabelSelection(opts){return __async(this,null,function*(){const data=this.isLabelEnabled()?opts.labelData:[];return opts.labelSelection.update(data,text=>{text.tag=1,text.pointerEvents=1})})}updateLabelNodes(opts){return __async(this,null,function*(){opts.labelSelection.each((textNode,datum)=>{updateLabelNode(textNode,this.properties.label,datum.label)})})}getTooltipHtml(nodeDatum){var _a201;const{id:seriesId,processedData,ctx:{callbackCache}}=this,xAxis=this.getCategoryAxis(),yAxis=this.getValueAxis();if(!processedData||!this.properties.isValid()||!xAxis||!yAxis)return"";const{xKey,yKey,xName,yName,fill,stroke,strokeWidth,tooltip,formatter,stackGroup}=this.properties,{xValue,yValue,datum}=nodeDatum,xString=xAxis.formatDatum(xValue),yString=yAxis.formatDatum(yValue),title=sanitizeHtml(yName),content=sanitizeHtml(xString+": "+yString);let format2;formatter&&(format2=callbackCache.call(formatter,{seriesId,datum,xKey,yKey,stackGroup,fill,stroke,strokeWidth:this.getStrokeWidth(strokeWidth),highlighted:!1}));const color=(_a201=format2==null?void 0:format2.fill)!=null?_a201:fill;return tooltip.toTooltipHtml({title,content,backgroundColor:color},__spreadValues({seriesId,datum,xKey,yKey,xName,yName,stackGroup,title,color},this.getModuleTooltipParams()))}getLegendData(legendType){var _a201,_b;const{showInLegend}=this.properties;if(legendType!=="category"||!((_a201=this.data)!=null&&_a201.length)||!this.properties.isValid()||!showInLegend)return[];const{yKey,yName,fill,stroke,strokeWidth,fillOpacity,strokeOpacity,legendItemName,visible}=this.properties;return[{legendType:"category",id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:(_b=legendItemName??yName)!=null?_b:yKey},marker:{fill,fillOpacity,stroke,strokeWidth,strokeOpacity},legendItemName}]}animateEmptyUpdateReady({datumSelections,labelSelections,annotationSelections}){const fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(this.isVertical(),this.axes,"normal"));fromToMotion(this.id,"nodes",this.ctx.animationManager,datumSelections,fns),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,annotationSelections)}animateWaitingUpdateReady(data){var _a201,_b,_c;const{datumSelections,labelSelections,annotationSelections,previousContextData}=data;this.ctx.animationManager.stopByAnimationGroupId(this.id);const diff2=(_b=(_a201=this.processedData)==null?void 0:_a201.reduced)==null?void 0:_b.diff,mode=(previousContextData==null?void 0:previousContextData.length)===0?"fade":"normal",fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(this.isVertical(),this.axes,mode));fromToMotion(this.id,"nodes",this.ctx.animationManager,datumSelections,fns,(_,datum)=>createDatumId(datum.xValue),diff2),((_c=diff2==null?void 0:diff2.changed)!=null?_c:!0)&&(seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,annotationSelections))}isLabelEnabled(){return this.properties.label.enabled}},__name(_a157,"_BarSeries"),_a157);_BarSeries.className="BarSeries";_BarSeries.type="bar";var BarSeries=_BarSeries,BarSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bar",instanceConstructor:BarSeries,stackable:!0,groupable:!0,seriesDefaults:{axes:[{type:"number",position:"left"},{type:"category",position:"bottom"}]},swapDefaultAxesCondition:series=>(series==null?void 0:series.direction)==="horizontal",themeTemplate:{series:{__extends__:EXTENDS_SERIES_DEFAULTS,direction:"vertical",fillOpacity:1,strokeWidth:0,lineDash:[0],lineDashOffset:0,label:{enabled:!1,fontStyle:void 0,fontWeight:"normal",fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_INSIDE_SERIES_LABEL_COLOUR,formatter:void 0,placement:"inside"},shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5}}},enterpriseThemeTemplate:{series:{errorBar:{cap:{lengthRatio:.3}}}},paletteFactory:singleSeriesPaletteFactory},convertColorStringToOklcha=__name(v=>{const color=Color.fromString(v),[l,c,h]=Color.RGBtoOKLCH(color.r,color.g,color.b);return{l,c,h,a:color.a}},"convertColorStringToOklcha"),interpolateOklch=__name((x,y,d)=>{d=clamp(0,d,1);let h,c;if(Number.isNaN(x.h)&&Number.isNaN(y.h))h=0,c=0;else if(Number.isNaN(x.h))h=y.h,c=y.c;else if(Number.isNaN(y.h))h=x.h,c=x.c;else{const xH=x.h;let yH=y.h;const deltaH=y.h-x.h;deltaH>180?yH-=360:deltaH<-180&&(yH+=360),h=xH*(1-d)+yH*d,c=x.c*(1-d)+y.c*d}const l=x.l*(1-d)+y.l*d,a=x.a*(1-d)+y.a*d;return Color.fromOKLCH(l,c,h,a)},"interpolateOklch"),_a158,ColorScale=(_a158=class{constructor(){this.invalid=!0,this.domain=[0,1],this.range=["red","blue"],this.parsedRange=this.range.map(convertColorStringToOklcha)}update(){const{domain,range:range3}=this;domain.length<2&&(Logger.warnOnce("`colorDomain` should have at least 2 values."),domain.length===0?domain.push(0,1):domain.length===1&&domain.push(domain[0]+1));for(let i=1;i<domain.length;i++){const a=domain[i-1],b=domain[i];if(a>=b){Logger.warnOnce("`colorDomain` values should be supplied in ascending order."),domain.sort((a2,b2)=>a2-b2);break}}if(range3.length<domain.length)for(let i=range3.length;i<domain.length;i++)range3.push(range3.length>0?range3[0]:"black");this.parsedRange=this.range.map(convertColorStringToOklcha)}convert(x){this.refresh();const{domain,range:range3,parsedRange}=this,d0=domain[0],d1=domain.at(-1),r0=range3[0],r1=range3[range3.length-1];if(x<=d0)return r0;if(x>=d1)return r1;let index,q;if(domain.length===2){const t=(x-d0)/(d1-d0),step=1/(range3.length-1);index=range3.length<=2?0:Math.min(Math.floor(t*(range3.length-1)),range3.length-2),q=(t-index*step)/step}else{for(index=0;index<domain.length-2&&!(x<domain[index+1]);index++);const a=domain[index],b=domain[index+1];q=(x-a)/(b-a)}const c0=parsedRange[index],c1=parsedRange[index+1];return interpolateOklch(c0,c1,q).toRgbaString()}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}},__name(_a158,"ColorScale"),_a158);__decorateClass([Invalidating],ColorScale.prototype,"domain",2);__decorateClass([Invalidating],ColorScale.prototype,"range",2);var _a159,BubbleSeriesMarker=(_a159=class extends SeriesMarker{constructor(){super(...arguments),this.maxSize=30}},__name(_a159,"BubbleSeriesMarker"),_a159);__decorateClass([Validate(POSITIVE_NUMBER),SceneChangeDetection({redraw:3})],BubbleSeriesMarker.prototype,"maxSize",2);__decorateClass([Validate(NUMBER_ARRAY,{optional:!0}),SceneChangeDetection({redraw:3})],BubbleSeriesMarker.prototype,"domain",2);var _a160,BubbleSeriesProperties=(_a160=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.colorRange=["#ffff00","#00ff00","#0000ff"],this.marker=new BubbleSeriesMarker,this.label=new Label,this.tooltip=new SeriesTooltip}},__name(_a160,"BubbleSeriesProperties"),_a160);__decorateClass([Validate(STRING)],BubbleSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING)],BubbleSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING)],BubbleSeriesProperties.prototype,"sizeKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"labelKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"colorKey",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"sizeName",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"labelName",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"colorName",2);__decorateClass([Validate(NUMBER_ARRAY,{optional:!0})],BubbleSeriesProperties.prototype,"colorDomain",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],BubbleSeriesProperties.prototype,"colorRange",2);__decorateClass([Validate(STRING,{optional:!0})],BubbleSeriesProperties.prototype,"title",2);__decorateClass([Validate(OBJECT)],BubbleSeriesProperties.prototype,"marker",2);__decorateClass([Validate(OBJECT)],BubbleSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],BubbleSeriesProperties.prototype,"tooltip",2);var _a161,BubbleSeriesNodeClickEvent=(_a161=class extends CartesianSeriesNodeClickEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.sizeKey=series.properties.sizeKey}},__name(_a161,"BubbleSeriesNodeClickEvent"),_a161),_a162,_BubbleSeries=(_a162=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,pickModes:[2,3,0],pathsPerSeries:0,hasMarkers:!0,markerSelectionGarbageCollection:!1,animationResetFns:{label:resetLabelFn,marker:resetMarkerFn}}),this.NodeClickEvent=BubbleSeriesNodeClickEvent,this.properties=new BubbleSeriesProperties,this.sizeScale=new LinearScale,this.colorScale=new ColorScale}processData(dataController){return __async(this,null,function*(){var _a201,_b;if(!this.properties.isValid()||this.data==null)return;const{isContinuousX,isContinuousY}=this.isContinuous(),{xKey,yKey,sizeKey,labelKey,colorDomain,colorRange,colorKey,marker}=this.properties,{dataModel,processedData}=yield this.requestDataModel(dataController,this.data,{props:[keyProperty(this,xKey,isContinuousX,{id:"xKey-raw"}),keyProperty(this,yKey,isContinuousY,{id:"yKey-raw"}),...labelKey?[keyProperty(this,labelKey,!1,{id:"labelKey-raw"})]:[],valueProperty(this,xKey,isContinuousX,{id:"xValue"}),valueProperty(this,yKey,isContinuousY,{id:"yValue"}),valueProperty(this,sizeKey,!0,{id:"sizeValue"}),...colorKey?[valueProperty(this,colorKey,!0,{id:"colorValue"})]:[],...labelKey?[valueProperty(this,labelKey,!1,{id:"labelValue"})]:[]],dataVisible:this.visible}),sizeKeyIdx=dataModel.resolveProcessedDataIndexById(this,"sizeValue").index,processedSize=(_a201=processedData.domain.values[sizeKeyIdx])!=null?_a201:[];if(this.sizeScale.domain=marker.domain?marker.domain:processedSize,colorKey){const colorKeyIdx=dataModel.resolveProcessedDataIndexById(this,"colorValue").index;this.colorScale.domain=(_b=colorDomain??processedData.domain.values[colorKeyIdx])!=null?_b:[],this.colorScale.range=colorRange,this.colorScale.update()}this.animationState.transition("updateData")})}getSeriesDomain(direction){const{dataModel,processedData}=this;if(!processedData||!dataModel)return[];const id=direction==="x"?"xValue":"yValue",dataDef=dataModel.resolveProcessedDataDefById(this,id),domain=dataModel.getDomain(this,id,"value",processedData);if((dataDef==null?void 0:dataDef.def.type)==="value"&&(dataDef==null?void 0:dataDef.def.valueType)==="category")return domain;const axis=this.axes[direction];return fixNumericExtent(extent(domain),axis)}createNodeData(){return __async(this,null,function*(){var _a201,_b,_c;const{axes,dataModel,processedData,colorScale,sizeScale}=this,{xKey,yKey,sizeKey,labelKey,xName,yName,sizeName,labelName,label,colorKey,marker,visible}=this.properties,xAxis=axes.x,yAxis=axes.y;if(!(dataModel&&processedData&&visible&&xAxis&&yAxis))return[];const xDataIdx=dataModel.resolveProcessedDataIndexById(this,"xValue").index,yDataIdx=dataModel.resolveProcessedDataIndexById(this,"yValue").index,sizeDataIdx=sizeKey?dataModel.resolveProcessedDataIndexById(this,"sizeValue").index:-1,colorDataIdx=colorKey?dataModel.resolveProcessedDataIndexById(this,"colorValue").index:-1,labelDataIdx=labelKey?dataModel.resolveProcessedDataIndexById(this,"labelValue").index:-1,xScale=xAxis.scale,yScale=yAxis.scale,xOffset=((_a201=xScale.bandwidth)!=null?_a201:0)/2,yOffset=((_b=yScale.bandwidth)!=null?_b:0)/2,nodeData=[];sizeScale.range=[marker.size,marker.maxSize];const font=label.getFont();for(const{values,datum}of(_c=processedData.data)!=null?_c:[]){const xDatum=values[xDataIdx],yDatum=values[yDataIdx],x=xScale.convert(xDatum)+xOffset,y=yScale.convert(yDatum)+yOffset,labelText=this.getLabelText(label,{value:labelKey?values[labelDataIdx]:yDatum,datum,xKey,yKey,sizeKey,labelKey,xName,yName,sizeName,labelName}),size=HdpiCanvas.getTextSize(String(labelText),font),markerSize=sizeKey?sizeScale.convert(values[sizeDataIdx]):marker.size,fill=colorKey?colorScale.convert(values[colorDataIdx]):void 0;nodeData.push({series:this,itemId:yKey,yKey,xKey,datum,xValue:xDatum,yValue:yDatum,sizeValue:values[sizeDataIdx],point:{x,y,size:markerSize},midPoint:{x,y},fill,label:__spreadValues({text:labelText},size)})}return[{itemId:yKey,nodeData,labelData:nodeData,scales:__superGet(_a162.prototype,this,"calculateScaling").call(this),visible:this.visible}]})}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){var _a201;return(_a201=this.contextNodeData)==null?void 0:_a201.reduce((r,n)=>r.concat(n.labelData),[])}markerFactory(){const{shape}=this.properties.marker,MarkerShape=getMarker(shape);return new MarkerShape}updateMarkerSelection(opts){return __async(this,null,function*(){const{nodeData,markerSelection}=opts;this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup());const data=this.properties.marker.enabled?nodeData:[];return markerSelection.update(data,void 0,datum=>createDatumId([datum.xValue,datum.yValue,datum.label.text]))})}updateMarkerNodes(opts){return __async(this,null,function*(){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,sizeKey,labelKey,marker}=this.properties,baseStyle=mergeDefaults(highlighted&&this.properties.highlightStyle.item,marker.getStyle());this.sizeScale.range=[marker.size,marker.maxSize],markerSelection.each((node,datum)=>{this.updateMarkerStyle(node,marker,{datum,highlighted,xKey,yKey,sizeKey,labelKey},baseStyle)}),highlighted||this.properties.marker.markClean()})}updateLabelSelection(opts){return __async(this,null,function*(){var _a201,_b;const placedLabels=this.properties.label.enabled?(_b=(_a201=this.chart)==null?void 0:_a201.placeLabels().get(this))!=null?_b:[]:[];return opts.labelSelection.update(placedLabels.map(v=>__spreadProps(__spreadValues({},v.datum),{point:{x:v.x,y:v.y,size:v.datum.point.size}})))})}updateLabelNodes(opts){return __async(this,null,function*(){const{label}=this.properties;opts.labelSelection.each((text,datum)=>{var _a201,_b,_c,_d;text.text=datum.label.text,text.fill=label.color,text.x=(_b=(_a201=datum.point)==null?void 0:_a201.x)!=null?_b:0,text.y=(_d=(_c=datum.point)==null?void 0:_c.y)!=null?_d:0,text.fontStyle=label.fontStyle,text.fontWeight=label.fontWeight,text.fontSize=label.fontSize,text.fontFamily=label.fontFamily,text.textAlign="left",text.textBaseline="top"})})}getTooltipHtml(nodeDatum){var _a201;const xAxis=this.axes.x,yAxis=this.axes.y;if(!this.properties.isValid()||!xAxis||!yAxis)return"";const{xKey,yKey,sizeKey,labelKey,xName,yName,sizeName,labelName,marker,tooltip}=this.properties,title=(_a201=this.properties.title)!=null?_a201:yName,baseStyle=mergeDefaults({fill:nodeDatum.fill,strokeWidth:this.getStrokeWidth(marker.strokeWidth)},marker.getStyle()),{fill:color="gray"}=this.getMarkerStyle(marker,{datum:nodeDatum,highlighted:!1,xKey,yKey,sizeKey,labelKey},baseStyle),{datum,xValue,yValue,sizeValue,label:{text:labelText}}=nodeDatum,xString=sanitizeHtml(xAxis.formatDatum(xValue)),yString=sanitizeHtml(yAxis.formatDatum(yValue));let content=`<b>${sanitizeHtml(xName??xKey)}</b>: ${xString}<br><b>${sanitizeHtml(yName??yKey)}</b>: ${yString}`;return sizeKey&&(content+=`<br><b>${sanitizeHtml(sizeName??sizeKey)}</b>: ${sanitizeHtml(String(sizeValue))}`),labelKey&&(content=`<b>${sanitizeHtml(labelName??labelKey)}</b>: ${sanitizeHtml(labelText)}<br>`+content),tooltip.toTooltipHtml({title,content,backgroundColor:color},{datum,xKey,xName,yKey,yName,sizeKey,sizeName,labelKey,labelName,title,color,seriesId:this.id})}getLegendData(){var _a201,_b;if(!((_a201=this.data)!=null&&_a201.length)||!this.properties.isValid())return[];const{yKey,yName,title,marker,visible}=this.properties,{shape,fill,stroke,fillOpacity,strokeOpacity,strokeWidth}=marker;return[{legendType:"category",id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:(_b=title??yName)!=null?_b:yKey},marker:{shape,fill:fill??"rgba(0, 0, 0, 0)",stroke:stroke??"rgba(0, 0, 0, 0)",fillOpacity:fillOpacity??1,strokeOpacity:strokeOpacity??1,strokeWidth:strokeWidth??0}}]}animateEmptyUpdateReady({markerSelections,labelSelections}){markerScaleInAnimation(this,this.ctx.animationManager,markerSelections),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelections)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}},__name(_a162,"_BubbleSeries"),_a162);_BubbleSeries.className="BubbleSeries";_BubbleSeries.type="bubble";var BubbleSeries=_BubbleSeries,BubbleSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bubble",instanceConstructor:BubbleSeries,seriesDefaults:{axes:[{type:"number",position:"bottom"},{type:"number",position:"left"}]},themeTemplate:{series:{__extends__:EXTENDS_SERIES_DEFAULTS,tooltip:{position:{type:"node"}},marker:{__extends__:EXTENDS_CARTESIAN_MARKER_DEFAULTS,maxSize:30,fillOpacity:.8},label:{enabled:!1,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR}}},paletteFactory:markerPaletteFactory},_a163,HistogramSeriesProperties=(_a163=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.areaPlot=!1,this.aggregation="sum",this.shadow=new DropShadow,this.label=new Label,this.tooltip=new SeriesTooltip}},__name(_a163,"HistogramSeriesProperties"),_a163);__decorateClass([Validate(STRING)],HistogramSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING,{optional:!0})],HistogramSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],HistogramSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING,{optional:!0})],HistogramSeriesProperties.prototype,"yName",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],HistogramSeriesProperties.prototype,"fill",2);__decorateClass([Validate(RATIO)],HistogramSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(COLOR_STRING,{optional:!0})],HistogramSeriesProperties.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],HistogramSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],HistogramSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],HistogramSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],HistogramSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(BOOLEAN)],HistogramSeriesProperties.prototype,"areaPlot",2);__decorateClass([Validate(ARRAY,{optional:!0})],HistogramSeriesProperties.prototype,"bins",2);__decorateClass([Validate(UNION(["count","sum","mean"],"a histogram aggregation"))],HistogramSeriesProperties.prototype,"aggregation",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],HistogramSeriesProperties.prototype,"binCount",2);__decorateClass([Validate(OBJECT)],HistogramSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],HistogramSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],HistogramSeriesProperties.prototype,"tooltip",2);var defaultBinCount=10,_a164,_HistogramSeries=(_a164=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,pickModes:[0],datumSelectionGarbageCollection:!1,animationResetFns:{datum:resetBarSelectionsFn,label:resetLabelFn}}),this.properties=new HistogramSeriesProperties,this.calculatedBins=[]}deriveBins(xDomain){if(this.properties.binCount)return this.calculateNiceBins(xDomain,this.properties.binCount);const binStarts=ticks_default(xDomain[0],xDomain[1],defaultBinCount),binSize=tickStep(xDomain[0],xDomain[1],defaultBinCount),[firstBinEnd]=binStarts,expandStartToBin=__name(n=>[n,n+binSize],"expandStartToBin");return[[firstBinEnd-binSize,firstBinEnd],...binStarts.map(expandStartToBin)]}calculateNiceBins(domain,binCount){const startGuess=Math.floor(domain[0]),stop=domain[1],segments=binCount||1,{start,binSize}=this.calculateNiceStart(startGuess,stop,segments);return this.getBins(start,stop,binSize,segments)}getBins(start,stop,step,count2){const bins=[],precision=this.calculatePrecision(step);for(let i=0;i<count2;i++){const a=Math.round((start+i*step)*precision)/precision;let b=Math.round((start+(i+1)*step)*precision)/precision;i===count2-1&&(b=Math.max(b,stop)),bins[i]=[a,b]}return bins}calculatePrecision(step){let precision=10;if(isFinite(step)&&step>0)for(;step<1;)precision*=10,step*=10;return precision}calculateNiceStart(a,b,segments){const binSize=Math.abs(b-a)/segments,order=Math.floor(Math.log10(binSize)),magnitude=Math.pow(10,order);return{start:Math.floor(a/magnitude)*magnitude,binSize}}processData(dataController){return __async(this,null,function*(){var _a201;const{xKey,yKey,areaPlot,aggregation}=this.properties,props=[keyProperty(this,xKey,!0),SORT_DOMAIN_GROUPS];if(yKey){let aggProp=groupCount(this,"groupCount");aggregation==="count"||(aggregation==="sum"?aggProp=groupSum(this,"groupAgg"):aggregation==="mean"&&(aggProp=groupAverage(this,"groupAgg"))),areaPlot&&(aggProp=area(this,"groupAgg",aggProp)),props.push(valueProperty(this,yKey,!0,{invalidValue:void 0}),aggProp)}else{let aggProp=groupCount(this,"groupAgg");areaPlot&&(aggProp=area(this,"groupAgg",aggProp)),props.push(aggProp)}const groupByFn=__name(dataSet=>{var _a210;const xExtent=fixNumericExtent(dataSet.domain.keys[0]);if(xExtent.length===0)return dataSet.domain.groups=[],()=>[];const bins=(_a210=this.properties.bins)!=null?_a210:this.deriveBins(xExtent),binCount=bins.length;return this.calculatedBins=[...bins],item=>{const xValue=item.keys[0];for(let i=0;i<binCount;i++){const nextBin=bins[i];if(xValue>=nextBin[0]&&xValue<nextBin[1]||i===binCount-1&&xValue<=nextBin[1])return nextBin}return[]}},"groupByFn");!this.ctx.animationManager.isSkipped()&&this.processedData&&props.push(diff(this.processedData,!1)),yield this.requestDataModel(dataController,(_a201=this.data)!=null?_a201:[],{props,dataVisible:this.visible,groupByFn}),this.animationState.transition("updateData")})}getSeriesDomain(direction){var _a201,_b,_c,_d;const{processedData,dataModel}=this;if(!processedData||!dataModel||!this.calculatedBins.length)return[];const yDomain=dataModel.getDomain(this,"groupAgg","aggregate",processedData),xDomainMin=(_a201=this.calculatedBins)==null?void 0:_a201[0][0],xDomainMax=(_d=this.calculatedBins)==null?void 0:_d[((_c=(_b=this.calculatedBins)==null?void 0:_b.length)!=null?_c:0)-1][1];return fixNumericExtent(direction==="x"?[xDomainMin,xDomainMax]:yDomain)}createNodeData(){return __async(this,null,function*(){var _a201;const{id:seriesId,axes,processedData,ctx:{callbackCache}}=this,xAxis=axes.x,yAxis=axes.y;if(!this.visible||!xAxis||!yAxis||!processedData||processedData.type!=="grouped")return[];const{scale:xScale}=xAxis,{scale:yScale}=yAxis,{xKey,yKey,xName,yName,fill,stroke,strokeWidth}=this.properties,{formatter:labelFormatter=__name(params=>String(params.value),"labelFormatter"),fontStyle:labelFontStyle,fontWeight:labelFontWeight,fontSize:labelFontSize,fontFamily:labelFontFamily,color:labelColor}=this.properties.label,nodeData=[];return processedData.data.forEach(group2=>{var _a210;const{aggValues:[[negativeAgg,positiveAgg]]=[[0,0]],datum,datum:{length:frequency},keys:domain,keys:[xDomainMin,xDomainMax]}=group2,xMinPx=xScale.convert(xDomainMin),xMaxPx=xScale.convert(xDomainMax),total=negativeAgg+positiveAgg,yZeroPx=yScale.convert(0),yMaxPx=yScale.convert(total),w=Math.abs(xMaxPx-xMinPx),h=Math.abs(yMaxPx-yZeroPx),x=Math.min(xMinPx,xMaxPx),y=Math.min(yZeroPx,yMaxPx),selectionDatumLabel=total!==0?{text:(_a210=callbackCache.call(labelFormatter,{value:total,datum,seriesId,xKey,yKey,xName,yName}))!=null?_a210:String(total),fontStyle:labelFontStyle,fontWeight:labelFontWeight,fontSize:labelFontSize,fontFamily:labelFontFamily,fill:labelColor,x:x+w/2,y:y+h/2}:void 0,nodeMidPoint={x:x+w/2,y:y+h/2};nodeData.push({series:this,datum,aggregatedValue:total,frequency,domain,yKey,xKey,x,y,xValue:xMinPx,yValue:yMaxPx,width:w,height:h,midPoint:nodeMidPoint,fill,stroke,opacity:1,strokeWidth,label:selectionDatumLabel})}),[{itemId:(_a201=this.properties.yKey)!=null?_a201:this.id,nodeData,labelData:nodeData,scales:__superGet(_a164.prototype,this,"calculateScaling").call(this),animationValid:!0,visible:this.visible}]})}nodeFactory(){return new Rect}updateDatumSelection(opts){return __async(this,null,function*(){const{nodeData,datumSelection}=opts;return datumSelection.update(nodeData,rect=>{rect.tag=0,rect.crisp=!0},datum=>datum.domain.join("_"))})}updateDatumNodes(opts){return __async(this,null,function*(){const{isHighlight:isDatumHighlighted}=opts,{fillOpacity:seriesFillOpacity,strokeOpacity,lineDash,lineDashOffset,shadow,highlightStyle:{item:{fill:highlightedFill,fillOpacity:highlightFillOpacity=seriesFillOpacity,stroke:highlightedStroke,strokeWidth:highlightedDatumStrokeWidth}}}=this.properties;opts.datumSelection.each((rect,datum,index)=>{var _a201,_b;const strokeWidth=isDatumHighlighted&&highlightedDatumStrokeWidth!==void 0?highlightedDatumStrokeWidth:datum.strokeWidth,fillOpacity=isDatumHighlighted?highlightFillOpacity:seriesFillOpacity;rect.fill=(_a201=isDatumHighlighted?highlightedFill:void 0)!=null?_a201:datum.fill,rect.stroke=(_b=isDatumHighlighted?highlightedStroke:void 0)!=null?_b:datum.stroke,rect.fillOpacity=fillOpacity,rect.strokeOpacity=strokeOpacity,rect.strokeWidth=strokeWidth,rect.lineDash=lineDash,rect.lineDashOffset=lineDashOffset,rect.fillShadow=shadow,rect.zIndex=isDatumHighlighted?Series.highlightedZIndex:index,rect.visible=datum.height>0})})}updateLabelSelection(opts){return __async(this,null,function*(){const{labelData,labelSelection}=opts;return labelSelection.update(labelData,text=>{text.tag=1,text.pointerEvents=1,text.textAlign="center",text.textBaseline="middle"})})}updateLabelNodes(opts){return __async(this,null,function*(){const labelEnabled=this.isLabelEnabled();opts.labelSelection.each((text,datum)=>{const label=datum.label;label&&labelEnabled?(text.text=label.text,text.x=label.x,text.y=label.y,text.fontStyle=label.fontStyle,text.fontWeight=label.fontWeight,text.fontSize=label.fontSize,text.fontFamily=label.fontFamily,text.fill=label.fill,text.visible=!0):text.visible=!1})})}getTooltipHtml(nodeDatum){const xAxis=this.axes.x,yAxis=this.axes.y;if(!this.properties.isValid()||!xAxis||!yAxis)return"";const{xKey,yKey,xName,yName,fill:color,aggregation,tooltip}=this.properties,{aggregatedValue,frequency,domain:[rangeMin,rangeMax]}=nodeDatum,title=`${sanitizeHtml(xName??xKey)}: ${xAxis.formatDatum(rangeMin)} - ${xAxis.formatDatum(rangeMax)}`;let content=yKey?`<b>${sanitizeHtml(yName??yKey)} (${aggregation})</b>: ${yAxis.formatDatum(aggregatedValue)}<br>`:"";content+=`<b>Frequency</b>: ${frequency}`;const defaults={title,backgroundColor:color,content};return tooltip.toTooltipHtml(defaults,{datum:{data:nodeDatum.datum,aggregatedValue:nodeDatum.aggregatedValue,domain:nodeDatum.domain,frequency:nodeDatum.frequency},xKey,xName,yKey,yName,color,title,seriesId:this.id})}getLegendData(legendType){var _a201,_b;if(!((_a201=this.data)!=null&&_a201.length)||legendType!=="category")return[];const{xKey,yName,fill,fillOpacity,stroke,strokeWidth,strokeOpacity,visible}=this.properties;return[{legendType:"category",id:this.id,itemId:xKey,seriesId:this.id,enabled:visible,label:{text:(_b=yName??xKey)!=null?_b:"Frequency"},marker:{fill:fill??"rgba(0, 0, 0, 0)",stroke:stroke??"rgba(0, 0, 0, 0)",fillOpacity,strokeOpacity,strokeWidth}}]}animateEmptyUpdateReady({datumSelections,labelSelections}){const fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(!0,this.axes,"normal"));fromToMotion(this.id,"datums",this.ctx.animationManager,datumSelections,fns),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelections)}animateWaitingUpdateReady(data){var _a201,_b;const diff2=(_b=(_a201=this.processedData)==null?void 0:_a201.reduced)==null?void 0:_b.diff,fns=prepareBarAnimationFunctions(collapsedStartingBarPosition(!0,this.axes,"normal"));fromToMotion(this.id,"datums",this.ctx.animationManager,data.datumSelections,fns,(_,datum)=>createDatumId(datum.domain),diff2),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,data.labelSelections)}isLabelEnabled(){return this.properties.label.enabled}},__name(_a164,"_HistogramSeries"),_a164);_HistogramSeries.className="HistogramSeries";_HistogramSeries.type="histogram";var HistogramSeries=_HistogramSeries,HistogramSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"histogram",instanceConstructor:HistogramSeries,seriesDefaults:{axes:[{type:"number",position:"bottom"},{type:"number",position:"left"}]},themeTemplate:{series:{__extends__:EXTENDS_SERIES_DEFAULTS,strokeWidth:1,fillOpacity:1,strokeOpacity:1,lineDash:[0],lineDashOffset:0,label:{enabled:!1,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_INSIDE_SERIES_LABEL_COLOUR,formatter:void 0},shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5}}},paletteFactory:({takeColors})=>{const{fills:[fill],strokes:[stroke]}=takeColors(1);return{fill,stroke}}},_a165,LineSeriesProperties=(_a165=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.marker=new SeriesMarker,this.label=new Label,this.tooltip=new SeriesTooltip,this.connectMissingData=!1}},__name(_a165,"LineSeriesProperties"),_a165);__decorateClass([Validate(STRING)],LineSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING)],LineSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],LineSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING,{optional:!0})],LineSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],LineSeriesProperties.prototype,"title",2);__decorateClass([Validate(COLOR_STRING)],LineSeriesProperties.prototype,"stroke",2);__decorateClass([Validate(POSITIVE_NUMBER)],LineSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(RATIO)],LineSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],LineSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],LineSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(OBJECT)],LineSeriesProperties.prototype,"marker",2);__decorateClass([Validate(OBJECT)],LineSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],LineSeriesProperties.prototype,"tooltip",2);__decorateClass([Validate(BOOLEAN)],LineSeriesProperties.prototype,"connectMissingData",2);var _a166,_LineSeries=(_a166=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,hasMarkers:!0,pickModes:[2,3,0],markerSelectionGarbageCollection:!1,animationResetFns:{path:buildResetPathFn({getOpacity:()=>this.getOpacity()}),label:resetLabelFn,marker:(node,datum)=>__spreadValues(__spreadValues({},resetMarkerFn()),resetMarkerPositionFn(node,datum))}}),this.properties=new LineSeriesProperties}processData(dataController){return __async(this,null,function*(){if(!this.properties.isValid()||this.data==null)return;const{xKey,yKey}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),{isContinuousX,isContinuousY}=this.isContinuous(),props=[];isContinuousX||(props.push(keyProperty(this,xKey,isContinuousX,{id:"xKey"})),animationEnabled&&this.processedData&&props.push(diff(this.processedData))),animationEnabled&&props.push(animationValidation(this,isContinuousX?["xValue"]:[])),props.push(valueProperty(this,xKey,isContinuousX,{id:"xValue"}),valueProperty(this,yKey,isContinuousY,{id:"yValue",invalidValue:void 0})),yield this.requestDataModel(dataController,this.data,{props}),this.animationState.transition("updateData")})}getSeriesDomain(direction){const{axes,dataModel,processedData}=this;if(!processedData||!dataModel)return[];const xAxis=axes.x,yAxis=axes.y,xDef=dataModel.resolveProcessedDataDefById(this,"xValue");if(direction==="x"){const domain=dataModel.getDomain(this,"xValue","value",processedData);return(xDef==null?void 0:xDef.def.type)==="value"&&xDef.def.valueType==="category"?domain:fixNumericExtent(extent(domain),xAxis)}else{const domain=dataModel.getDomain(this,"yValue","value",processedData);return fixNumericExtent(domain,yAxis)}}createNodeData(){return __async(this,null,function*(){var _a201,_b,_c;const{processedData,dataModel,axes}=this,xAxis=axes.x,yAxis=axes.y;if(!processedData||!dataModel||!xAxis||!yAxis)return[];const{xKey,yKey,xName,yName,marker,label,connectMissingData}=this.properties,xScale=xAxis.scale,yScale=yAxis.scale,xOffset=((_a201=xScale.bandwidth)!=null?_a201:0)/2,yOffset=((_b=yScale.bandwidth)!=null?_b:0)/2,nodeData=[],size=marker.enabled?marker.size:0,xIdx=dataModel.resolveProcessedDataIndexById(this,"xValue").index,yIdx=dataModel.resolveProcessedDataIndexById(this,"yValue").index;let moveTo=!0,nextPoint;for(let i=0;i<processedData.data.length;i++){const{datum,values}=nextPoint??processedData.data[i],xDatum=values[xIdx],yDatum=values[yIdx];if(yDatum===void 0)moveTo=!connectMissingData;else{const x=xScale.convert(xDatum)+xOffset;if(isNaN(x)){moveTo=!connectMissingData,nextPoint=void 0;continue}nextPoint=((_c=processedData.data[i+1])==null?void 0:_c.values[yIdx])===void 0?void 0:processedData.data[i+1];const y=yScale.convert(yDatum)+yOffset,labelText=this.getLabelText(label,{value:yDatum,datum,xKey,yKey,xName,yName},value=>isFiniteNumber(value)?value.toFixed(2):String(value));nodeData.push({series:this,datum,yKey,xKey,point:{x,y,moveTo,size},midPoint:{x,y},yValue:yDatum,xValue:xDatum,capDefaults:{lengthRatioMultiplier:this.properties.marker.getDiameter(),lengthMax:1/0},label:labelText?{text:labelText,fontStyle:label.fontStyle,fontWeight:label.fontWeight,fontSize:label.fontSize,fontFamily:label.fontFamily,textAlign:"center",textBaseline:"bottom",fill:label.color}:void 0}),moveTo=!1}}return[{itemId:yKey,nodeData,labelData:nodeData,scales:__superGet(_a166.prototype,this,"calculateScaling").call(this),visible:this.visible}]})}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}markerFactory(){const{shape}=this.properties.marker,MarkerShape=getMarker(shape);return new MarkerShape}updatePathNodes(opts){return __async(this,null,function*(){const{paths:[lineNode],opacity,visible,animationEnabled}=opts;lineNode.setProperties({fill:void 0,lineJoin:"round",pointerEvents:1,opacity,stroke:this.properties.stroke,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset}),animationEnabled||(lineNode.visible=visible),updateClipPath(this,lineNode)})}updateMarkerSelection(opts){return __async(this,null,function*(){let{nodeData}=opts;const{markerSelection}=opts,{shape,enabled}=this.properties.marker;return nodeData=shape&&enabled?nodeData:[],this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(nodeData,void 0,datum=>createDatumId(datum.xValue))})}updateMarkerNodes(opts){return __async(this,null,function*(){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,stroke,strokeWidth,strokeOpacity,marker,highlightStyle}=this.properties,baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle(),{stroke,strokeWidth,strokeOpacity}),applyTranslation=this.ctx.animationManager.isSkipped();markerSelection.each((node,datum)=>{this.updateMarkerStyle(node,marker,{datum,highlighted,xKey,yKey},baseStyle,{applyTranslation})}),highlighted||marker.markClean()})}updateLabelSelection(opts){return __async(this,null,function*(){return opts.labelSelection.update(this.isLabelEnabled()?opts.labelData:[])})}updateLabelNodes(opts){return __async(this,null,function*(){const{enabled,fontStyle,fontWeight,fontSize,fontFamily,color}=this.properties.label;opts.labelSelection.each((text,datum)=>{const{point,label}=datum;datum&&label&&enabled?(text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.textAlign=label.textAlign,text.textBaseline=label.textBaseline,text.text=label.text,text.x=point.x,text.y=point.y-10,text.fill=color,text.visible=!0):text.visible=!1})})}getTooltipHtml(nodeDatum){var _a201;const xAxis=this.axes.x,yAxis=this.axes.y;if(!this.properties.isValid()||!xAxis||!yAxis)return"";const{xKey,yKey,xName,yName,strokeWidth,marker,tooltip}=this.properties,{datum,xValue,yValue}=nodeDatum,xString=xAxis.formatDatum(xValue),yString=yAxis.formatDatum(yValue),title=sanitizeHtml((_a201=this.properties.title)!=null?_a201:yName),content=sanitizeHtml(xString+": "+yString),baseStyle=mergeDefaults({fill:marker.stroke},marker.getStyle(),{strokeWidth}),{fill:color}=this.getMarkerStyle(marker,{datum:nodeDatum,xKey,yKey,highlighted:!1},baseStyle);return tooltip.toTooltipHtml({title,content,backgroundColor:color},__spreadValues({datum,xKey,xName,yKey,yName,title,color,seriesId:this.id},this.getModuleTooltipParams()))}getLegendData(legendType){var _a201,_b,_c,_d,_e,_f,_g,_h,_i;if(!((_a201=this.data)!=null&&_a201.length&&this.properties.isValid()&&legendType==="category"))return[];const{yKey,yName,stroke,strokeOpacity,strokeWidth,lineDash,title,marker,visible}=this.properties,color0="rgba(0, 0, 0, 0)";return[{legendType:"category",id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:(_b=title??yName)!=null?_b:yKey},marker:{shape:marker.shape,fill:(_c=marker.fill)!=null?_c:color0,stroke:(_e=(_d=marker.stroke)!=null?_d:stroke)!=null?_e:color0,fillOpacity:(_f=marker.fillOpacity)!=null?_f:1,strokeOpacity:(_h=(_g=marker.strokeOpacity)!=null?_g:strokeOpacity)!=null?_h:1,strokeWidth:(_i=marker.strokeWidth)!=null?_i:0,enabled:marker.enabled},line:{stroke:stroke??color0,strokeOpacity,strokeWidth,lineDash}}]}updatePaths(opts){return __async(this,null,function*(){this.updateLinePaths([opts.paths],[opts.contextData])})}updateLinePaths(paths,contextData){contextData.forEach(({nodeData},contextDataIndex)=>{const[lineNode]=paths[contextDataIndex],{path:linePath}=lineNode;linePath.clear({trackChanges:!0});for(const data of nodeData)data.point.moveTo?linePath.moveTo(data.point.x,data.point.y):linePath.lineTo(data.point.x,data.point.y);lineNode.checkPathDirty()})}animateEmptyUpdateReady(animationData){const{markerSelections,labelSelections,annotationSelections,contextData,paths}=animationData,{animationManager}=this.ctx;this.updateLinePaths(paths,contextData),pathSwipeInAnimation(this,animationManager,paths.flat()),resetMotion(markerSelections,resetMarkerPositionFn),markerSwipeScaleInAnimation(this,animationManager,markerSelections),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",animationManager,annotationSelections)}animateReadyResize(animationData){const{contextData,paths}=animationData;this.updateLinePaths(paths,contextData),super.animateReadyResize(animationData)}animateWaitingUpdateReady(animationData){var _a201,_b;const{animationManager}=this.ctx,{markerSelections,labelSelections,annotationSelections,contextData,paths,previousContextData}=animationData,[path]=paths;super.resetAllAnimation(animationData);const update=__name(()=>{this.updateLinePaths(paths,contextData)},"update"),skip=__name(()=>{animationManager.skipCurrentBatch(),update()},"skip");if(contextData.length===0||(previousContextData==null?void 0:previousContextData.length)===0){update(),markerFadeInAnimation(this,animationManager,markerSelections,"added"),pathFadeInAnimation(this,"path_properties",animationManager,path??[]),seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",animationManager,annotationSelections);return}const[newData]=contextData,[oldData]=previousContextData??[],fns=prepareLinePathAnimation(newData,oldData,(_b=(_a201=this.processedData)==null?void 0:_a201.reduced)==null?void 0:_b.diff);if(fns===void 0){skip();return}markerFadeInAnimation(this,animationManager,markerSelections),fromToMotion(this.id,"path_properties",animationManager,path,fns.pathProperties),pathMotion(this.id,"path_update",animationManager,path,fns.path),fns.hasMotion&&(seriesLabelFadeInAnimation(this,"labels",animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",animationManager,annotationSelections))}isLabelEnabled(){return this.properties.label.enabled}getBandScalePadding(){return{inner:1,outer:.1}}nodeFactory(){return new Group}},__name(_a166,"_LineSeries"),_a166);_LineSeries.className="LineSeries";_LineSeries.type="line";var LineSeries=_LineSeries,LineSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"line",instanceConstructor:LineSeries,seriesDefaults:{axes:[{type:"number",position:"left"},{type:"category",position:"bottom"}]},themeTemplate:{series:{__extends__:EXTENDS_SERIES_DEFAULTS,tooltip:{position:{type:"node"}},strokeWidth:2,strokeOpacity:1,lineDash:[0],lineDashOffset:0,marker:{__extends__:EXTENDS_CARTESIAN_MARKER_DEFAULTS,fillOpacity:1,strokeOpacity:1,strokeWidth:0},label:{enabled:!1,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,formatter:void 0}}},enterpriseThemeTemplate:{series:{errorBar:{cap:{lengthRatio:1}}}},paletteFactory:params=>{const{marker}=markerPaletteFactory(params);return{stroke:marker.fill,marker}}},_a167,ScatterSeriesProperties=(_a167=class extends CartesianSeriesProperties{constructor(){super(...arguments),this.colorRange=["#ffff00","#00ff00","#0000ff"],this.marker=new SeriesMarker,this.label=new Label,this.tooltip=new SeriesTooltip}},__name(_a167,"ScatterSeriesProperties"),_a167);__decorateClass([Validate(STRING)],ScatterSeriesProperties.prototype,"xKey",2);__decorateClass([Validate(STRING)],ScatterSeriesProperties.prototype,"yKey",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"labelKey",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"colorKey",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"xName",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"yName",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"labelName",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"colorName",2);__decorateClass([Validate(NUMBER_ARRAY,{optional:!0})],ScatterSeriesProperties.prototype,"colorDomain",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],ScatterSeriesProperties.prototype,"colorRange",2);__decorateClass([Validate(STRING,{optional:!0})],ScatterSeriesProperties.prototype,"title",2);__decorateClass([Validate(OBJECT)],ScatterSeriesProperties.prototype,"marker",2);__decorateClass([Validate(OBJECT)],ScatterSeriesProperties.prototype,"label",2);__decorateClass([Validate(OBJECT)],ScatterSeriesProperties.prototype,"tooltip",2);var _a168,_ScatterSeries=(_a168=class extends CartesianSeries{constructor(moduleCtx){super({moduleCtx,pickModes:[2,3,0],pathsPerSeries:0,hasMarkers:!0,markerSelectionGarbageCollection:!1,animationResetFns:{marker:resetMarkerFn,label:resetLabelFn}}),this.properties=new ScatterSeriesProperties,this.colorScale=new ColorScale}processData(dataController){return __async(this,null,function*(){var _a201;if(!this.properties.isValid()||this.data==null)return;const{isContinuousX,isContinuousY}=this.isContinuous(),{xKey,yKey,labelKey,colorKey,colorDomain,colorRange}=this.properties,{dataModel,processedData}=yield this.requestDataModel(dataController,this.data,{props:[keyProperty(this,xKey,isContinuousX,{id:"xKey-raw"}),keyProperty(this,yKey,isContinuousY,{id:"yKey-raw"}),...labelKey?[keyProperty(this,labelKey,!1,{id:"labelKey-raw"})]:[],valueProperty(this,xKey,isContinuousX,{id:"xValue"}),valueProperty(this,yKey,isContinuousY,{id:"yValue"}),...colorKey?[valueProperty(this,colorKey,!0,{id:"colorValue"})]:[],...labelKey?[valueProperty(this,labelKey,!1,{id:"labelValue"})]:[]],dataVisible:this.visible});if(colorKey){const colorKeyIdx=dataModel.resolveProcessedDataIndexById(this,"colorValue").index;this.colorScale.domain=(_a201=colorDomain??processedData.domain.values[colorKeyIdx])!=null?_a201:[],this.colorScale.range=colorRange,this.colorScale.update()}this.animationState.transition("updateData")})}getSeriesDomain(direction){const{dataModel,processedData}=this;if(!processedData||!dataModel)return[];const id=direction==="x"?"xValue":"yValue",dataDef=dataModel.resolveProcessedDataDefById(this,id),domain=dataModel.getDomain(this,id,"value",processedData);if((dataDef==null?void 0:dataDef.def.type)==="value"&&(dataDef==null?void 0:dataDef.def.valueType)==="category")return domain;const axis=this.axes[direction];return fixNumericExtent(extent(domain),axis)}createNodeData(){return __async(this,null,function*(){var _a201,_b,_c;const{axes,dataModel,processedData,colorScale}=this,{xKey,yKey,labelKey,colorKey,xName,yName,labelName,marker,label,visible}=this.properties,xAxis=axes.x,yAxis=axes.y;if(!(dataModel&&processedData&&visible&&xAxis&&yAxis))return[];const xDataIdx=dataModel.resolveProcessedDataIndexById(this,"xValue").index,yDataIdx=dataModel.resolveProcessedDataIndexById(this,"yValue").index,colorDataIdx=colorKey?dataModel.resolveProcessedDataIndexById(this,"colorValue").index:-1,labelDataIdx=labelKey?dataModel.resolveProcessedDataIndexById(this,"labelValue").index:-1,xScale=xAxis.scale,yScale=yAxis.scale,xOffset=((_a201=xScale.bandwidth)!=null?_a201:0)/2,yOffset=((_b=yScale.bandwidth)!=null?_b:0)/2,nodeData=[],font=label.getFont();for(const{values,datum}of(_c=processedData.data)!=null?_c:[]){const xDatum=values[xDataIdx],yDatum=values[yDataIdx],x=xScale.convert(xDatum)+xOffset,y=yScale.convert(yDatum)+yOffset,labelText=this.getLabelText(label,{value:labelKey?values[labelDataIdx]:yDatum,datum,xKey,yKey,labelKey,xName,yName,labelName}),size=HdpiCanvas.getTextSize(labelText,font),fill=colorKey?colorScale.convert(values[colorDataIdx]):void 0;nodeData.push({series:this,itemId:yKey,yKey,xKey,datum,xValue:xDatum,yValue:yDatum,capDefaults:{lengthRatioMultiplier:marker.getDiameter(),lengthMax:1/0},point:{x,y,size:marker.size},midPoint:{x,y},fill,label:__spreadValues({text:labelText},size)})}return[{itemId:yKey,nodeData,labelData:nodeData,scales:__superGet(_a168.prototype,this,"calculateScaling").call(this),visible:this.visible}]})}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){var _a201;return(_a201=this.contextNodeData)==null?void 0:_a201.reduce((r,n)=>r.concat(n.labelData),[])}markerFactory(){const{shape}=this.properties.marker,MarkerShape=getMarker(shape);return new MarkerShape}updateMarkerSelection(opts){return __async(this,null,function*(){const{nodeData,markerSelection}=opts;return this.properties.marker.isDirty()&&(markerSelection.clear(),markerSelection.cleanup()),markerSelection.update(this.properties.marker.enabled?nodeData:[])})}updateMarkerNodes(opts){return __async(this,null,function*(){const{markerSelection,isHighlight:highlighted}=opts,{xKey,yKey,labelKey,marker,highlightStyle}=this.properties,baseStyle=mergeDefaults(highlighted&&highlightStyle.item,marker.getStyle());markerSelection.each((node,datum)=>{this.updateMarkerStyle(node,marker,{datum,highlighted,xKey,yKey,labelKey},baseStyle)}),highlighted||marker.markClean()})}updateLabelSelection(opts){return __async(this,null,function*(){var _a201,_b;const placedLabels=this.isLabelEnabled()?(_b=(_a201=this.chart)==null?void 0:_a201.placeLabels().get(this))!=null?_b:[]:[];return opts.labelSelection.update(placedLabels.map(({datum,x,y})=>__spreadProps(__spreadValues({},datum),{point:{x,y,size:datum.point.size}})),text=>{text.pointerEvents=1})})}updateLabelNodes(opts){return __async(this,null,function*(){const{label}=this.properties;opts.labelSelection.each((text,datum)=>{var _a201,_b,_c,_d;text.text=datum.label.text,text.fill=label.color,text.x=(_b=(_a201=datum.point)==null?void 0:_a201.x)!=null?_b:0,text.y=(_d=(_c=datum.point)==null?void 0:_c.y)!=null?_d:0,text.fontStyle=label.fontStyle,text.fontWeight=label.fontWeight,text.fontSize=label.fontSize,text.fontFamily=label.fontFamily,text.textAlign="left",text.textBaseline="top"})})}getTooltipHtml(nodeDatum){const xAxis=this.axes.x,yAxis=this.axes.y;if(!this.properties.isValid()||!xAxis||!yAxis)return"";const{xKey,yKey,labelKey,xName,yName,labelName,title=yName,marker,tooltip}=this.properties,{datum,xValue,yValue,label}=nodeDatum,baseStyle=mergeDefaults({fill:nodeDatum.fill,strokeWidth:this.getStrokeWidth(marker.strokeWidth)},marker.getStyle()),{fill:color="gray"}=this.getMarkerStyle(marker,{datum:nodeDatum,highlighted:!1,xKey,yKey,labelKey},baseStyle),xString=sanitizeHtml(xAxis.formatDatum(xValue)),yString=sanitizeHtml(yAxis.formatDatum(yValue));let content=`<b>${sanitizeHtml(xName??xKey)}</b>: ${xString}<br><b>${sanitizeHtml(yName??yKey)}</b>: ${yString}`;return labelKey&&(content=`<b>${sanitizeHtml(labelName??labelKey)}</b>: ${sanitizeHtml(label.text)}<br>`+content),tooltip.toTooltipHtml({title,content,backgroundColor:color},__spreadValues({datum,xKey,xName,yKey,yName,labelKey,labelName,title,color,seriesId:this.id},this.getModuleTooltipParams()))}getLegendData(legendType){var _a201,_b,_c,_d,_e,_f;const{yKey,yName,title,marker,visible}=this.properties,{fill,stroke,fillOpacity,strokeOpacity,strokeWidth}=marker;return!((_a201=this.data)!=null&&_a201.length)||!this.properties.isValid()||legendType!=="category"?[]:[{legendType:"category",id:this.id,itemId:yKey,seriesId:this.id,enabled:visible,label:{text:(_b=title??yName)!=null?_b:yKey},marker:{shape:marker.shape,fill:(_d=(_c=marker.fill)!=null?_c:fill)!=null?_d:"rgba(0, 0, 0, 0)",stroke:(_f=(_e=marker.stroke)!=null?_e:stroke)!=null?_f:"rgba(0, 0, 0, 0)",fillOpacity:fillOpacity??1,strokeOpacity:strokeOpacity??1,strokeWidth:strokeWidth??0}}]}animateEmptyUpdateReady(data){const{markerSelections,labelSelections,annotationSelections}=data;markerScaleInAnimation(this,this.ctx.animationManager,markerSelections),seriesLabelFadeInAnimation(this,"labels",this.ctx.animationManager,labelSelections),seriesLabelFadeInAnimation(this,"annotations",this.ctx.animationManager,annotationSelections)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Group}},__name(_a168,"_ScatterSeries"),_a168);_ScatterSeries.className="ScatterSeries";_ScatterSeries.type="scatter";var ScatterSeries=_ScatterSeries,ScatterSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"scatter",instanceConstructor:ScatterSeries,seriesDefaults:{axes:[{type:"number",position:"bottom"},{type:"number",position:"left"}]},themeTemplate:{series:{__extends__:EXTENDS_SERIES_DEFAULTS,tooltip:{position:{type:"node"}},marker:{__extends__:EXTENDS_CARTESIAN_MARKER_DEFAULTS,fillOpacity:.8},label:{enabled:!1,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR}}},enterpriseThemeTemplate:{series:{errorBar:{cap:{lengthRatio:1}}}},paletteFactory:markerPaletteFactory};function isPointInSector(x,y,sector){const radius=Math.sqrt(Math.pow(x,2)+Math.pow(y,2)),{innerRadius,outerRadius}=sector;if(sector.startAngle===sector.endAngle||radius<Math.min(innerRadius,outerRadius)||radius>Math.max(innerRadius,outerRadius))return!1;const startAngle=normalizeAngle180(sector.startAngle),endAngle=normalizeAngle180(sector.endAngle),angle=Math.atan2(y,x);return startAngle<endAngle?angle<=endAngle&&angle>=startAngle:angle<=endAngle&&angle>=-Math.PI||angle>=startAngle&&angle<=Math.PI}__name(isPointInSector,"isPointInSector");function lineCollidesSector(line,sector){const{startAngle,endAngle,innerRadius,outerRadius}=sector,outerStart={x:outerRadius*Math.cos(startAngle),y:outerRadius*Math.sin(startAngle)},outerEnd={x:outerRadius*Math.cos(endAngle),y:outerRadius*Math.sin(endAngle)},innerStart=innerRadius===0?{x:0,y:0}:{x:innerRadius*Math.cos(startAngle),y:innerRadius*Math.sin(startAngle)},innerEnd=innerRadius===0?{x:0,y:0}:{x:innerRadius*Math.cos(endAngle),y:innerRadius*Math.sin(endAngle)};return segmentIntersection(line.start.x,line.start.y,line.end.x,line.end.y,outerStart.x,outerStart.y,innerStart.x,innerStart.y)!=null||segmentIntersection(line.start.x,line.start.y,line.end.x,line.end.y,outerEnd.x,outerEnd.y,innerEnd.x,innerEnd.y)!=null||arcIntersections(0,0,outerRadius,startAngle,endAngle,!0,line.start.x,line.start.y,line.end.x,line.end.y).length>0}__name(lineCollidesSector,"lineCollidesSector");function boxCollidesSector(box,sector){const topLeft={x:box.x,y:box.y},topRight={x:box.x+box.width,y:box.y},bottomLeft={x:box.x,y:box.y+box.height},bottomRight={x:box.x+box.width,y:box.y+box.height};return lineCollidesSector({start:topLeft,end:topRight},sector)||lineCollidesSector({start:bottomLeft,end:bottomRight},sector)}__name(boxCollidesSector,"boxCollidesSector");var _a169,Sector=(_a169=class extends Path{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.innerRadius=10,this.outerRadius=20,this.startAngle=0,this.endAngle=Math.PI*2,this.angleOffset=0,this.inset=0}computeBBox(){const radius=this.outerRadius;return new BBox(this.centerX-radius,this.centerY-radius,radius*2,radius*2)}updatePath(){const path=this.path,{angleOffset,inset}=this,startAngle=this.startAngle+angleOffset,endAngle=this.endAngle+angleOffset,sweep=startAngle<=endAngle?endAngle-startAngle:Math.PI*2-(startAngle-endAngle),innerRadius=Math.max(Math.min(this.innerRadius,this.outerRadius)+inset,0),outerRadius=Math.max(Math.max(this.innerRadius,this.outerRadius)-inset,0),fullPie=sweep>=2*Math.PI,centerX=this.centerX,centerY=this.centerY;if(path.clear(),fullPie)path.arc(centerX,centerY,outerRadius,startAngle,endAngle),innerRadius>inset&&(path.moveTo(centerX+innerRadius*Math.cos(endAngle),centerY+innerRadius*Math.sin(endAngle)),path.arc(centerX,centerY,innerRadius,endAngle,startAngle,!0));else{const innerAngleOffset=innerRadius>0?inset/innerRadius:0,outerAngleOffset=outerRadius>0?inset/outerRadius:0;if(sweep<2*outerAngleOffset)return;const innerAngleExceeded=innerRadius<=inset||sweep<2*innerAngleOffset;if(innerAngleExceeded){const x=sweep<Math.PI*.5?inset*(1+Math.cos(sweep))/Math.sin(sweep):NaN;let r;x>0&&x<outerRadius?r=Math.max(Math.hypot(inset,x),innerRadius):r=innerRadius;const midAngle=startAngle+sweep*.5;path.moveTo(centerX+r*Math.cos(midAngle),centerY+r*Math.sin(midAngle))}else path.moveTo(centerX+innerRadius*Math.cos(startAngle+innerAngleOffset),centerY+innerRadius*Math.sin(startAngle+innerAngleOffset));path.arc(centerX,centerY,outerRadius,startAngle+outerAngleOffset,endAngle-outerAngleOffset),innerAngleExceeded||(innerRadius>0?path.arc(centerX,centerY,innerRadius,endAngle-innerAngleOffset,startAngle+innerAngleOffset,!0):path.lineTo(centerX,centerY))}path.closePath(),this.dirtyPath=!1}isPointInPath(x,y){const{angleOffset}=this,startAngle=this.startAngle+angleOffset,endAngle=this.endAngle+angleOffset,innerRadius=Math.min(this.innerRadius,this.outerRadius),outerRadius=Math.max(this.innerRadius,this.outerRadius),point=this.transformPoint(x,y);return isPointInSector(point.x,point.y,{startAngle,endAngle,innerRadius,outerRadius})}},__name(_a169,"Sector"),_a169);Sector.className="Sector";__decorateClass([ScenePathChangeDetection()],Sector.prototype,"centerX",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"centerY",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"innerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"outerRadius",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"angleOffset",2);__decorateClass([ScenePathChangeDetection()],Sector.prototype,"inset",2);var _a170,DonutTitle=(_a170=class extends Caption{constructor(){super(...arguments),this.showInLegend=!1}},__name(_a170,"DonutTitle"),_a170);__decorateClass([Validate(BOOLEAN)],DonutTitle.prototype,"showInLegend",2);var _a171,DonutInnerLabel=(_a171=class extends Label{constructor(){super(...arguments),this.margin=2}set(properties,_reset){return super.set(properties)}},__name(_a171,"DonutInnerLabel"),_a171);__decorateClass([Validate(STRING)],DonutInnerLabel.prototype,"text",2);__decorateClass([Validate(NUMBER)],DonutInnerLabel.prototype,"margin",2);var _a172,DonutInnerCircle=(_a172=class extends BaseProperties{constructor(){super(...arguments),this.fill="transparent",this.fillOpacity=1}},__name(_a172,"DonutInnerCircle"),_a172);__decorateClass([Validate(COLOR_STRING)],DonutInnerCircle.prototype,"fill",2);__decorateClass([Validate(RATIO)],DonutInnerCircle.prototype,"fillOpacity",2);var _a173,DonutSeriesCalloutLabel=(_a173=class extends Label{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}},__name(_a173,"DonutSeriesCalloutLabel"),_a173);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLabel.prototype,"offset",2);__decorateClass([Validate(DEGREE)],DonutSeriesCalloutLabel.prototype,"minAngle",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLabel.prototype,"minSpacing",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLabel.prototype,"maxCollisionOffset",2);__decorateClass([Validate(BOOLEAN)],DonutSeriesCalloutLabel.prototype,"avoidCollisions",2);var _a174,DonutSeriesSectorLabel=(_a174=class extends Label{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}},__name(_a174,"DonutSeriesSectorLabel"),_a174);__decorateClass([Validate(NUMBER)],DonutSeriesSectorLabel.prototype,"positionOffset",2);__decorateClass([Validate(RATIO)],DonutSeriesSectorLabel.prototype,"positionRatio",2);var _a175,DonutSeriesCalloutLine=(_a175=class extends BaseProperties{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}},__name(_a175,"DonutSeriesCalloutLine"),_a175);__decorateClass([Validate(COLOR_STRING_ARRAY,{optional:!0})],DonutSeriesCalloutLine.prototype,"colors",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLine.prototype,"length",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesCalloutLine.prototype,"strokeWidth",2);var _a176,DonutSeriesProperties=(_a176=class extends SeriesProperties{constructor(){super(...arguments),this.fills=Object.values(DEFAULT_FILLS),this.strokes=Object.values(DEFAULT_STROKES),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=void 0,this.innerLabels=new PropertiesArray(DonutInnerLabel),this.title=new DonutTitle,this.innerCircle=new DonutInnerCircle,this.shadow=new DropShadow,this.calloutLabel=new DonutSeriesCalloutLabel,this.sectorLabel=new DonutSeriesSectorLabel,this.calloutLine=new DonutSeriesCalloutLine,this.tooltip=new SeriesTooltip,this.__BACKGROUND_COLOR_DO_NOT_USE=void 0}isValid(){const superIsValid=super.isValid();return this.innerRadiusRatio==null&&this.innerRadiusOffset==null?(Logger.warnOnce("Either an [innerRadiusRatio] or an [innerRadiusOffset] must be set to render a donut series."),!1):superIsValid}},__name(_a176,"DonutSeriesProperties"),_a176);__decorateClass([Validate(STRING)],DonutSeriesProperties.prototype,"angleKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"angleName",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"radiusKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"radiusName",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],DonutSeriesProperties.prototype,"radiusMin",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],DonutSeriesProperties.prototype,"radiusMax",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"calloutLabelKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"calloutLabelName",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"sectorLabelKey",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"sectorLabelName",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"legendItemKey",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],DonutSeriesProperties.prototype,"fills",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],DonutSeriesProperties.prototype,"strokes",2);__decorateClass([Validate(RATIO)],DonutSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(RATIO)],DonutSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],DonutSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(FUNCTION,{optional:!0})],DonutSeriesProperties.prototype,"formatter",2);__decorateClass([Validate(DEGREE)],DonutSeriesProperties.prototype,"rotation",2);__decorateClass([Validate(NUMBER)],DonutSeriesProperties.prototype,"outerRadiusOffset",2);__decorateClass([Validate(RATIO)],DonutSeriesProperties.prototype,"outerRadiusRatio",2);__decorateClass([Validate(NUMBER,{optional:!0})],DonutSeriesProperties.prototype,"innerRadiusOffset",2);__decorateClass([Validate(RATIO,{optional:!0})],DonutSeriesProperties.prototype,"innerRadiusRatio",2);__decorateClass([Validate(POSITIVE_NUMBER)],DonutSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],DonutSeriesProperties.prototype,"sectorSpacing",2);__decorateClass([Validate(OBJECT_ARRAY)],DonutSeriesProperties.prototype,"innerLabels",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"title",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"innerCircle",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"calloutLabel",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"sectorLabel",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"calloutLine",2);__decorateClass([Validate(OBJECT)],DonutSeriesProperties.prototype,"tooltip",2);__decorateClass([Validate(STRING,{optional:!0})],DonutSeriesProperties.prototype,"__BACKGROUND_COLOR_DO_NOT_USE",2);function preparePieSeriesAnimationFunctions(initialLoad,rotationDegrees,scaleFn,oldScaleFn){const scale2=[scaleFn.convert(0),scaleFn.convert(1)],oldScale=[oldScaleFn.convert(0),oldScaleFn.convert(1)],rotation=Math.PI/-2+toRadians(rotationDegrees),scaleToNewRadius=__name(({radius})=>({innerRadius:scale2[0],outerRadius:scale2[0]+(scale2[1]-scale2[0])*radius}),"scaleToNewRadius"),scaleToOldRadius=__name(({radius})=>({innerRadius:oldScale[0],outerRadius:oldScale[0]+(oldScale[1]-oldScale[0])*radius}),"scaleToOldRadius");return{nodes:{toFn:__name((_sect,datum,status,{prevLive})=>{var _a201,_b;let{startAngle,endAngle,innerRadius,outerRadius}=datum;const{stroke,fill}=datum.sectorFormat;if(status==="removed"&&prevLive?(startAngle=(_a201=prevLive.datum)==null?void 0:_a201.endAngle,endAngle=(_b=prevLive.datum)==null?void 0:_b.endAngle):status==="removed"&&!prevLive&&(startAngle=rotation,endAngle=rotation),status==="removed"){const radii=scaleToNewRadius(datum);innerRadius=radii.innerRadius,outerRadius=radii.outerRadius}return{startAngle,endAngle,outerRadius,innerRadius,stroke,fill}},"toFn"),fromFn:__name((sect,datum,status,{prevFromProps})=>{var _a201,_b,_c,_d,_e,_f;let{startAngle,endAngle,innerRadius,outerRadius}=sect,{fill,stroke}=datum.sectorFormat;if(status==="unknown"||status==="added"&&!prevFromProps?(startAngle=rotation,endAngle=rotation,innerRadius=datum.innerRadius,outerRadius=datum.outerRadius):status==="added"&&prevFromProps&&(startAngle=(_a201=prevFromProps.endAngle)!=null?_a201:rotation,endAngle=(_b=prevFromProps.endAngle)!=null?_b:rotation,innerRadius=(_c=prevFromProps.innerRadius)!=null?_c:datum.innerRadius,outerRadius=(_d=prevFromProps.outerRadius)!=null?_d:datum.outerRadius),status==="added"&&!initialLoad){const radii=scaleToOldRadius(datum);innerRadius=radii.innerRadius,outerRadius=radii.outerRadius}return status==="updated"&&(fill=(_e=sect.fill)!=null?_e:fill,stroke=(_f=sect.stroke)!=null?_f:stroke),{startAngle,endAngle,innerRadius,outerRadius,fill,stroke,phase:"initial"}},"fromFn")},innerCircle:{fromFn:__name((node,_)=>{var _a201,_b,_c;return{size:(_c=(_b=(_a201=node.previousDatum)==null?void 0:_a201.radius)!=null?_b:node.size)!=null?_c:0,phase:"initial"}},"innerCircleFromFn"),toFn:__name((_,datum)=>{var _a201;return{size:(_a201=datum.radius)!=null?_a201:0}},"innerCircleToFn")}}}__name(preparePieSeriesAnimationFunctions,"preparePieSeriesAnimationFunctions");function resetPieSelectionsFn(_node,datum){return{startAngle:datum.startAngle,endAngle:datum.endAngle,innerRadius:datum.innerRadius,outerRadius:datum.outerRadius,fill:datum.sectorFormat.fill,stroke:datum.sectorFormat.stroke}}__name(resetPieSelectionsFn,"resetPieSelectionsFn");var _a177,PolarSeries=(_a177=class extends DataModelSeries{constructor(_a201){var _b=_a201,{useLabelLayer=!1,pickModes=[0],canHaveAxes=!1,animationResetFns}=_b,opts=__objRest(_b,["useLabelLayer","pickModes","canHaveAxes","animationResetFns"]);super(__spreadProps(__spreadValues({},opts),{useLabelLayer,pickModes,contentGroupVirtual:!1,directionKeys:{x:["angleKey"],y:["radiusKey"]},directionNames:{x:["angleName"],y:["radiusName"]},canHaveAxes})),this.itemGroup=this.contentGroup.appendChild(new Group),this.itemSelection=Selection.select(this.itemGroup,()=>this.nodeFactory(),!1),this.labelSelection=Selection.select(this.labelGroup,Text,!1),this.highlightSelection=Selection.select(this.highlightGroup,()=>this.nodeFactory()),this.centerX=0,this.centerY=0,this.radius=0,this.itemGroup.zIndexSubOrder=[()=>this._declarationOrder,1],this.animationResetFns=animationResetFns,this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:data=>this.animateEmptyUpdateReady(data)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:data=>this.animateReadyHighlight(data),highlightMarkers:data=>this.animateReadyHighlightMarkers(data),resize:data=>this.animateReadyResize(data),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:data=>this.animateWaitingUpdateReady(data)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:data=>this.animateClearingUpdateEmpty(data)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"&&this.animationState.transition("skip")}getLabelData(){return[]}computeLabelsBBox(_options,_seriesRect){return null}resetAllAnimation(){var _a201;const{item,label}=(_a201=this.animationResetFns)!=null?_a201:{};this.ctx.animationManager.stopByAnimationGroupId(this.id),item&&resetMotion([this.itemSelection,this.highlightSelection],item),label&&resetMotion([this.labelSelection],label),this.itemSelection.cleanup(),this.labelSelection.cleanup(),this.highlightSelection.cleanup()}animateEmptyUpdateReady(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateWaitingUpdateReady(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateReadyHighlight(_data){var _a201;const{item}=(_a201=this.animationResetFns)!=null?_a201:{};item&&resetMotion([this.highlightSelection],item)}animateReadyHighlightMarkers(_data){}animateReadyResize(_data){this.resetAllAnimation()}animateClearingUpdateEmpty(_data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animationTransitionClear(){this.animationState.transition("clear",this.getAnimationData())}getAnimationData(seriesRect){return{seriesRect}}},__name(_a177,"PolarSeries"),_a177),_a178,DonutSeriesNodeClickEvent=(_a178=class extends SeriesNodeClickEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.angleKey=series.properties.angleKey,this.radiusKey=series.properties.radiusKey,this.calloutLabelKey=series.properties.calloutLabelKey,this.sectorLabelKey=series.properties.sectorLabelKey}},__name(_a178,"DonutSeriesNodeClickEvent"),_a178),_a179,DonutSeries=(_a179=class extends PolarSeries{constructor(moduleCtx){super({moduleCtx,useLabelLayer:!0,animationResetFns:{item:resetPieSelectionsFn,label:resetLabelFn}}),this.properties=new DonutSeriesProperties,this.previousRadiusScale=new LinearScale,this.radiusScale=new LinearScale,this.backgroundGroup=this.rootGroup.appendChild(new Group({name:`${this.id}-background`,layer:!0,zIndex:0})),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new Circle),this.zerosumInnerRing=this.zerosumRingsGroup.appendChild(new Circle),this.innerCircleGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-innerCircle`})),this.nodeData=[],this.seriesItemEnabled=[],this.surroundingRadius=void 0,this.NodeClickEvent=DonutSeriesNodeClickEvent,this.angleScale=new LinearScale,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(angle=>angle+Math.PI/2);const pieCalloutLabels=new Group({name:"pieCalloutLabels"}),pieSectorLabels=new Group({name:"pieSectorLabels"}),innerLabels=new Group({name:"innerLabels"});this.labelGroup.append(pieCalloutLabels),this.labelGroup.append(pieSectorLabels),this.labelGroup.append(innerLabels),this.calloutLabelSelection=Selection.select(pieCalloutLabels,Group),this.sectorLabelSelection=Selection.select(pieSectorLabels,Text),this.innerLabelsSelection=Selection.select(innerLabels,Text),this.innerCircleSelection=Selection.select(this.innerCircleGroup,Circle);for(const circle of[this.zerosumInnerRing,this.zerosumOuterRing])circle.fillOpacity=0,circle.stroke=this.properties.calloutLabel.color,circle.strokeWidth=1,circle.strokeOpacity=1}addChartEventListeners(){var _a201;this.destroyFns.push((_a201=this.ctx.chartEventManager)==null?void 0:_a201.addListener("legend-item-click",event=>this.onLegendItemClick(event)))}visibleChanged(){this.processSeriesItemEnabled()}get visible(){return this.seriesItemEnabled.length?this.seriesItemEnabled.some(visible=>visible):super.visible}processSeriesItemEnabled(){var _a201;const{data,visible}=this;this.seriesItemEnabled=(_a201=data==null?void 0:data.map(()=>visible))!=null?_a201:[]}nodeFactory(){return new Sector}getSeriesDomain(direction){return direction==="x"?this.angleScale.domain:this.radiusScale.domain}processData(dataController){return __async(this,null,function*(){var _a201,_b,_c,_d,_e;if(this.data==null||!this.properties.isValid())return;let{data}=this;const{seriesItemEnabled}=this,{angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),extraKeyProps=[],extraProps=[];legendItemKey?extraKeyProps.push(keyProperty(this,legendItemKey,!1,{id:"legendItemKey"})):calloutLabelKey?extraKeyProps.push(keyProperty(this,calloutLabelKey,!1,{id:"calloutLabelKey"})):sectorLabelKey&&extraKeyProps.push(keyProperty(this,sectorLabelKey,!1,{id:"sectorLabelKey"})),radiusKey&&extraProps.push(rangedValueProperty(this,radiusKey,{id:"radiusValue",min:(_a201=this.properties.radiusMin)!=null?_a201:0,max:this.properties.radiusMax}),valueProperty(this,radiusKey,!0,{id:"radiusRaw"}),normalisePropertyTo(this,{id:"radiusValue"},[0,1],1,(_b=this.properties.radiusMin)!=null?_b:0,this.properties.radiusMax)),calloutLabelKey&&extraProps.push(valueProperty(this,calloutLabelKey,!1,{id:"calloutLabelValue"})),sectorLabelKey&&extraProps.push(valueProperty(this,sectorLabelKey,!1,{id:"sectorLabelValue"})),legendItemKey&&extraProps.push(valueProperty(this,legendItemKey,!1,{id:"legendItemValue"})),animationEnabled&&this.processedData&&extraKeyProps.length>0&&extraProps.push(diff(this.processedData)),extraProps.push(animationValidation(this)),data=data.map((d,idx)=>seriesItemEnabled[idx]?d:__spreadProps(__spreadValues({},d),{[angleKey]:0})),yield this.requestDataModel(dataController,data,{props:[...extraKeyProps,accumulativeValueProperty(this,angleKey,!0,{id:"angleValue",onlyPositive:!0}),valueProperty(this,angleKey,!0,{id:"angleRaw"}),normalisePropertyTo(this,{id:"angleValue"},[0,1],0,0),...extraProps]});for(const valueDef of(_e=(_d=(_c=this.processedData)==null?void 0:_c.defs)==null?void 0:_d.values)!=null?_e:[]){const{id,missing,property}=valueDef,missCount=getMissCount(this,missing);id!=="angleRaw"&&missCount>0&&Logger.warnOnce(`no value was found for the key '${String(property)}' on ${missCount} data element${missCount>1?"s":""}`)}this.animationState.transition("updateData")})}maybeRefreshNodeData(){return __async(this,null,function*(){if(!this.nodeDataRefresh)return;const[{nodeData=[]}={}]=yield this.createNodeData();this.nodeData=nodeData,this.nodeDataRefresh=!1})}getProcessedDataIndexes(dataModel){const angleIdx=dataModel.resolveProcessedDataIndexById(this,"angleValue").index,radiusIdx=this.properties.radiusKey?dataModel.resolveProcessedDataIndexById(this,"radiusValue").index:-1,calloutLabelIdx=this.properties.calloutLabelKey?dataModel.resolveProcessedDataIndexById(this,"calloutLabelValue").index:-1,sectorLabelIdx=this.properties.sectorLabelKey?dataModel.resolveProcessedDataIndexById(this,"sectorLabelValue").index:-1,legendItemIdx=this.properties.legendItemKey?dataModel.resolveProcessedDataIndexById(this,"legendItemValue").index:-1;return{angleIdx,radiusIdx,calloutLabelIdx,sectorLabelIdx,legendItemIdx}}createNodeData(){return __async(this,null,function*(){const{id:seriesId,processedData,dataModel,angleScale}=this,{rotation,innerRadiusRatio}=this.properties;if(!this.properties.isValid())return this.zerosumOuterRing.visible=!0,this.zerosumInnerRing.visible=!0,[{itemId:seriesId,nodeData:[],labelData:[]}];if(!processedData||!dataModel||processedData.type!=="ungrouped")return[];const{angleIdx,radiusIdx,calloutLabelIdx,sectorLabelIdx,legendItemIdx}=this.getProcessedDataIndexes(dataModel);let currentStart=0,sum2=0;const nodeData=processedData.data.map((group2,index)=>{var _a201;const{datum,values}=group2,currentValue=values[angleIdx],startAngle=angleScale.convert(currentStart)+toRadians(rotation);currentStart=currentValue,sum2+=currentValue;const endAngle=angleScale.convert(currentStart)+toRadians(rotation),span=Math.abs(endAngle-startAngle),midAngle=startAngle+span/2,angleValue=values[angleIdx+1],radius=radiusIdx>=0&&(_a201=values[radiusIdx])!=null?_a201:1,radiusValue=radiusIdx>=0?values[radiusIdx+1]:void 0,legendItemValue=legendItemIdx>=0?values[legendItemIdx]:void 0,labels=this.getLabels(datum,midAngle,span,!0,values[calloutLabelIdx],values[sectorLabelIdx],legendItemValue),sectorFormat=this.getSectorFormat(datum,index,!1);return __spreadValues({itemId:index,series:this,datum,index,angleValue,midAngle,midCos:Math.cos(midAngle),midSin:Math.sin(midAngle),startAngle,endAngle,sectorFormat,radiusValue,radius,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(radius),0),legendItemValue},labels)});return this.zerosumOuterRing.visible=sum2===0,this.zerosumInnerRing.visible=sum2===0&&innerRadiusRatio!=null&&innerRadiusRatio!==1&&innerRadiusRatio>0,[{itemId:seriesId,nodeData,labelData:nodeData}]})}getLabels(datum,midAngle,span,skipDisabled,calloutLabelValue,sectorLabelValue,legendItemValue){const{calloutLabel,sectorLabel,legendItemKey}=this.properties,calloutLabelKey=!skipDisabled||calloutLabel.enabled?this.properties.calloutLabelKey:void 0,sectorLabelKey=!skipDisabled||sectorLabel.enabled?this.properties.sectorLabelKey:void 0;if(!calloutLabelKey&&!sectorLabelKey&&!legendItemKey)return{};const labelFormatterParams={datum,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},result={};return calloutLabelKey&&span>toRadians(calloutLabel.minAngle)&&(result.calloutLabel=__spreadProps(__spreadValues({},this.getTextAlignment(midAngle)),{text:this.getLabelText(calloutLabel,__spreadProps(__spreadValues({},labelFormatterParams),{value:calloutLabelValue})),hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0})),sectorLabelKey&&(result.sectorLabel={text:this.getLabelText(sectorLabel,__spreadProps(__spreadValues({},labelFormatterParams),{value:sectorLabelValue}))}),legendItemKey!=null&&legendItemValue!=null&&(result.legendItem={key:legendItemKey,text:legendItemValue}),result}getTextAlignment(midAngle){const quadrantTextOpts=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"hanging"},{textAlign:"right",textBaseline:"middle"}],midAngle180=normalizeAngle180(midAngle),quadrantStart=-3*Math.PI/4,quadrantOffset=midAngle180-quadrantStart,quadrant=Math.floor(quadrantOffset/(Math.PI/2)),quadrantIndex=mod(quadrant,quadrantTextOpts.length);return quadrantTextOpts[quadrantIndex]}getSectorFormat(datum,formatIndex,highlight){var _a201,_b,_c,_d,_e;const{callbackCache,highlightManager}=this.ctx,{angleKey,radiusKey,fills,strokes,formatter,sectorSpacing,__BACKGROUND_COLOR_DO_NOT_USE}=this.properties,highlightedDatum=highlightManager.getActiveHighlight(),isDatumHighlighted=highlight&&(highlightedDatum==null?void 0:highlightedDatum.series)===this&&formatIndex===highlightedDatum.itemId,{fill,fillOpacity,stroke,strokeWidth,strokeOpacity}=mergeDefaults(isDatumHighlighted&&this.properties.highlightStyle.item,{fill:fills.length>0?fills[formatIndex%fills.length]:void 0,fillOpacity:this.properties.fillOpacity,stroke:sectorSpacing!=null?strokes.length>0?strokes[formatIndex%strokes.length]:void 0:strokes.length>0?strokes[formatIndex%strokes.length]:__BACKGROUND_COLOR_DO_NOT_USE,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.getOpacity()});let format2;return formatter&&(format2=callbackCache.call(formatter,{datum,angleKey,radiusKey,fill,stroke,fills,strokes,strokeWidth,highlighted:isDatumHighlighted,seriesId:this.id})),{fill:(_a201=format2==null?void 0:format2.fill)!=null?_a201:fill,fillOpacity:(_b=format2==null?void 0:format2.fillOpacity)!=null?_b:fillOpacity,stroke:(_c=format2==null?void 0:format2.stroke)!=null?_c:stroke,strokeWidth:(_d=format2==null?void 0:format2.strokeWidth)!=null?_d:strokeWidth,strokeOpacity:(_e=format2==null?void 0:format2.strokeOpacity)!=null?_e:strokeOpacity}}getInnerRadius(){const{radius}=this,{innerRadiusRatio=1,innerRadiusOffset=0}=this.properties,innerRadius=radius*innerRadiusRatio+innerRadiusOffset;return innerRadius===radius||innerRadius<0?0:innerRadius}getOuterRadius(){const{outerRadiusRatio,outerRadiusOffset}=this.properties;return Math.max(this.radius*outerRadiusRatio+outerRadiusOffset,0)}updateRadiusScale(resize){const newRange=[this.getInnerRadius(),this.getOuterRadius()];this.radiusScale.range=newRange,resize&&(this.previousRadiusScale.range=newRange),this.nodeData=this.nodeData.map(_a201=>{var _b=_a201,{radius}=_b,d=__objRest(_b,["radius"]);return __spreadProps(__spreadValues({},d),{radius,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(radius),0)})})}getTitleTranslationY(){var _a201,_b;const outerRadius=Math.max(0,this.radiusScale.range[1]);if(outerRadius===0)return NaN;const titleOffset=2+((_b=(_a201=this.properties.title)==null?void 0:_a201.spacing)!=null?_b:0),dy=Math.max(0,-outerRadius);return-outerRadius-titleOffset-dy}update(_0){return __async(this,arguments,function*({seriesRect}){const{title}=this.properties,newNodeDataDependencies={seriesRectWidth:seriesRect==null?void 0:seriesRect.width,seriesRectHeight:seriesRect==null?void 0:seriesRect.height},resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;if(resize&&(this._nodeDataDependencies=newNodeDataDependencies),yield this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(resize),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),title){const dy=this.getTitleTranslationY(),titleBox=title.node.computeBBox();title.node.visible=title.enabled&&isFinite(dy)&&!this.bboxIntersectsSurroundingSeries(titleBox,0,dy),title.node.translationY=isFinite(dy)?dy:0}this.updateNodeMidPoint(),yield this.updateSelections(),yield this.updateNodes(seriesRect)})}updateTitleNodes(){var _a201,_b;const{oldTitle}=this,{title}=this.properties;oldTitle!==title&&(oldTitle&&((_a201=this.labelGroup)==null||_a201.removeChild(oldTitle.node)),title&&(title.node.textBaseline="bottom",(_b=this.labelGroup)==null||_b.appendChild(title.node)),this.oldTitle=title)}updateNodeMidPoint(){this.nodeData.forEach(d=>{const radius=d.innerRadius+(d.outerRadius-d.innerRadius)/2;d.midPoint={x:d.midCos*Math.max(0,radius),y:d.midSin*Math.max(0,radius)}})}updateSelections(){return __async(this,null,function*(){yield this.updateGroupSelection(),this.updateInnerCircleSelection()})}updateGroupSelection(){return __async(this,null,function*(){const{itemSelection,highlightSelection,calloutLabelSelection,sectorLabelSelection,innerLabelsSelection}=this,update=__name((selection,clone)=>{let nodeData=this.nodeData;clone&&(nodeData=nodeData.map(datum=>__spreadProps(__spreadValues({},datum),{sectorFormat:__spreadValues({},datum.sectorFormat)}))),selection.update(nodeData,void 0,datum=>this.getDatumId(datum)),this.ctx.animationManager.isSkipped()&&selection.cleanup()},"update");update(itemSelection,!1),update(highlightSelection,!0),calloutLabelSelection.update(this.nodeData,group2=>{const line=new Line;line.tag=1,line.pointerEvents=1,group2.appendChild(line);const text=new Text;text.tag=2,text.pointerEvents=1,group2.appendChild(text)}),sectorLabelSelection.update(this.nodeData,node=>{node.pointerEvents=1}),innerLabelsSelection.update(this.properties.innerLabels,node=>{node.pointerEvents=1})})}updateInnerCircleSelection(){const{innerCircle}=this.properties;let radius=0;const innerRadius=this.getInnerRadius();if(innerRadius>0){const circleRadius=Math.min(innerRadius,this.getOuterRadius());radius=Math.ceil(circleRadius*2+1)}const datums=innerCircle?[{radius}]:[];this.innerCircleSelection.update(datums)}updateNodes(seriesRect){return __async(this,null,function*(){const highlightedDatum=this.ctx.highlightManager.getActiveHighlight(),isVisible=this.seriesItemEnabled.indexOf(!0)>=0;this.rootGroup.visible=isVisible,this.backgroundGroup.visible=isVisible,this.contentGroup.visible=isVisible,this.highlightGroup.visible=isVisible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.labelGroup&&(this.labelGroup.visible=isVisible),this.contentGroup.opacity=this.getOpacity(),this.innerCircleSelection.each((node,{radius})=>{var _a201,_b;node.setProperties({fill:(_a201=this.properties.innerCircle)==null?void 0:_a201.fill,opacity:(_b=this.properties.innerCircle)==null?void 0:_b.fillOpacity,size:radius})});const updateSectorFn=__name((sector,datum,_index,isDatumHighlighted)=>{const format2=this.getSectorFormat(datum.datum,datum.itemId,isDatumHighlighted);datum.sectorFormat.fill=format2.fill,datum.sectorFormat.stroke=format2.stroke;const animationDisabled=this.ctx.animationManager.isSkipped();animationDisabled&&(sector.startAngle=datum.startAngle,sector.endAngle=datum.endAngle,sector.innerRadius=datum.innerRadius,sector.outerRadius=datum.outerRadius),(isDatumHighlighted||animationDisabled)&&(sector.fill=format2.fill,sector.stroke=format2.stroke),sector.strokeWidth=format2.strokeWidth,sector.fillOpacity=format2.fillOpacity,sector.strokeOpacity=this.properties.strokeOpacity,sector.lineDash=this.properties.lineDash,sector.lineDashOffset=this.properties.lineDashOffset,sector.fillShadow=this.properties.shadow,sector.inset=this.properties.sectorSpacing!=null?(this.properties.sectorSpacing+(format2.stroke!=null?format2.strokeWidth:0))/2:0,sector.lineJoin=this.properties.sectorSpacing!=null?"miter":"round"},"updateSectorFn");this.itemSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.highlightSelection.each((node,datum,index)=>{const isDatumHighlighted=(highlightedDatum==null?void 0:highlightedDatum.series)===this&&node.datum.itemId===highlightedDatum.itemId;updateSectorFn(node,datum,index,!0),node.visible=isDatumHighlighted}),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(seriesRect),this.updateSectorLabelNodes(),this.updateInnerLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")})}updateCalloutLineNodes(){var _a201;const{calloutLine}=this.properties,calloutLength=calloutLine.length,calloutStrokeWidth=calloutLine.strokeWidth,calloutColors=(_a201=calloutLine.colors)!=null?_a201:this.properties.strokes,{offset:offset4}=this.properties.calloutLabel;this.calloutLabelSelection.selectByTag(1).forEach((line,index)=>{const datum=line.datum,{calloutLabel:label,outerRadius}=datum;if(label!=null&&label.text&&!label.hidden&&outerRadius!==0){line.visible=!0,line.strokeWidth=calloutStrokeWidth,line.stroke=calloutColors[index%calloutColors.length],line.fill=void 0;const x1=datum.midCos*outerRadius,y1=datum.midSin*outerRadius;let x2=datum.midCos*(outerRadius+calloutLength),y2=datum.midSin*(outerRadius+calloutLength);if((label.collisionTextAlign||label.collisionOffsetY!==0)&&label.box!=null){const box=label.box;let cx=x2,cy=y2;x2<box.x?cx=box.x:x2>box.x+box.width&&(cx=box.x+box.width),y2<box.y?cy=box.y:y2>box.y+box.height&&(cy=box.y+box.height);const dx=cx-x2,dy=cy-y2,length=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)),paddedLength=length-offset4;paddedLength>0&&(x2=x2+dx*paddedLength/length,y2=y2+dy*paddedLength/length)}line.x1=x1,line.y1=y1,line.x2=x2,line.y2=y2}else line.visible=!1})}getLabelOverflow(text,box,seriesRect){const seriesLeft=seriesRect.x-this.centerX,seriesRight=seriesRect.x+seriesRect.width-this.centerX,seriesTop=seriesRect.y-this.centerY,seriesBottom=seriesRect.y+seriesRect.height-this.centerY,errPx=1;let visibleTextPart=1;box.x+errPx<seriesLeft?visibleTextPart=(box.x+box.width-seriesLeft)/box.width:box.x+box.width-errPx>seriesRight&&(visibleTextPart=(seriesRight-box.x)/box.width);const hasVerticalOverflow=box.y+errPx<seriesTop||box.y+box.height-errPx>seriesBottom,textLength=visibleTextPart===1?text.length:Math.floor(text.length*visibleTextPart)-1,hasSurroundingSeriesOverflow=this.bboxIntersectsSurroundingSeries(box);return{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}}bboxIntersectsSurroundingSeries(box,dx=0,dy=0){const{surroundingRadius}=this;if(surroundingRadius==null)return!1;const corners=[{x:box.x+dx,y:box.y+dy},{x:box.x+box.width+dx,y:box.y+dy},{x:box.x+box.width+dx,y:box.y+box.height+dy},{x:box.x+dx,y:box.y+box.height+dy}],sur2=__pow(surroundingRadius,2);return corners.some(corner=>__pow(corner.x,2)+__pow(corner.y,2)>sur2)}computeCalloutLabelCollisionOffsets(){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,{offset:offset4,minSpacing}=calloutLabel,innerRadius=radiusScale.convert(0),shouldSkip=__name(datum=>!datum.calloutLabel||datum.outerRadius===0,"shouldSkip"),fullData=this.nodeData,data=this.nodeData.filter(t=>!shouldSkip(t));if(data.forEach(datum=>{const label=datum.calloutLabel;label!=null&&(label.hidden=!1,label.collisionTextAlign=void 0,label.collisionOffsetY=0)}),data.length<=1)return;const leftLabels=data.filter(d=>d.midCos<0).sort((a,b)=>a.midSin-b.midSin),rightLabels=data.filter(d=>d.midCos>=0).sort((a,b)=>a.midSin-b.midSin),topLabels=data.filter(d=>{var _a201;return d.midSin<0&&((_a201=d.calloutLabel)==null?void 0:_a201.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),bottomLabels=data.filter(d=>{var _a201;return d.midSin>=0&&((_a201=d.calloutLabel)==null?void 0:_a201.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),tempTextNode=new Text,getTextBBox=__name(datum=>{var _a201;const label=datum.calloutLabel;if(label==null)return new BBox(0,0,0,0);const labelRadius=datum.outerRadius+calloutLine.length+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY;return tempTextNode.text=label.text,tempTextNode.x=x,tempTextNode.y=y,tempTextNode.setFont(this.properties.calloutLabel),tempTextNode.setAlign({textAlign:(_a201=label.collisionTextAlign)!=null?_a201:label.textAlign,textBaseline:label.textBaseline}),tempTextNode.computeBBox()},"getTextBBox"),avoidNeighbourYCollision=__name((label,next,direction)=>{const box=getTextBBox(label).grow(minSpacing/2),other=getTextBBox(next).grow(minSpacing/2);if(box.x<other.x+other.width&&box.x+box.width>other.x&&(direction==="to-top"?box.y<other.y+other.height:box.y+box.height>other.y)){const dy=direction==="to-top"?box.y-other.y-other.height:box.y+box.height-other.y;next.calloutLabel.collisionOffsetY=dy}},"avoidNeighbourYCollision"),avoidYCollisions=__name(labels=>{const midLabel=labels.slice().sort((a,b)=>Math.abs(a.midSin)-Math.abs(b.midSin))[0],midIndex=labels.indexOf(midLabel);for(let i=midIndex-1;i>=0;i--){const prev=labels[i+1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-top")}for(let i=midIndex+1;i<labels.length;i++){const prev=labels[i-1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-bottom")}},"avoidYCollisions"),avoidXCollisions=__name(labels=>{const labelsCollideLabelsByY=data.some(datum=>datum.calloutLabel.collisionOffsetY!==0),boxes=labels.map(label=>getTextBBox(label)),paddedBoxes=boxes.map(box=>box.clone().grow(minSpacing/2));let labelsCollideLabelsByX=!1;for(let i=0;i<paddedBoxes.length&&!labelsCollideLabelsByX;i++){const box=paddedBoxes[i];for(let j=i+1;j<labels.length;j++){const other=paddedBoxes[j];if(box.collidesBBox(other)){labelsCollideLabelsByX=!0;break}}}const sectors=fullData.map(datum=>{const{startAngle,endAngle,outerRadius}=datum;return{startAngle,endAngle,innerRadius,outerRadius}}),labelsCollideSectors=boxes.some(box=>sectors.some(sector=>boxCollidesSector(box,sector)));!labelsCollideLabelsByX&&!labelsCollideLabelsByY&&!labelsCollideSectors||labels.filter(d=>d.calloutLabel.textAlign==="center").forEach(d=>{const label=d.calloutLabel;d.midCos<0?label.collisionTextAlign="right":d.midCos>0?label.collisionTextAlign="left":label.collisionTextAlign="center"})},"avoidXCollisions");avoidYCollisions(leftLabels),avoidYCollisions(rightLabels),avoidXCollisions(topLabels),avoidXCollisions(bottomLabels)}updateCalloutLabelNodes(seriesRect){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,color}=calloutLabel,tempTextNode=new Text;this.calloutLabelSelection.selectByTag(2).forEach(text=>{var _a201;const{datum}=text,label=datum.calloutLabel,radius=radiusScale.convert(datum.radius),outerRadius=Math.max(0,radius);if(!(label!=null&&label.text)||outerRadius===0||label.hidden){text.visible=!1;return}const labelRadius=outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,align={textAlign:(_a201=label.collisionTextAlign)!=null?_a201:label.textAlign,textBaseline:label.textBaseline};tempTextNode.text=label.text,tempTextNode.x=x,tempTextNode.y=y,tempTextNode.setFont(this.properties.calloutLabel),tempTextNode.setAlign(align);const box=tempTextNode.computeBBox();let displayText=label.text,visible=!0;if(calloutLabel.avoidCollisions){const{textLength,hasVerticalOverflow}=this.getLabelOverflow(label.text,box,seriesRect);displayText=label.text.length===textLength?label.text:`${label.text.substring(0,textLength)}`,visible=!hasVerticalOverflow}text.text=displayText,text.x=x,text.y=y,text.setFont(this.properties.calloutLabel),text.setAlign(align),text.fill=color,text.visible=visible})}computeLabelsBBox(options,seriesRect){return __async(this,null,function*(){const{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,maxCollisionOffset,minSpacing}=calloutLabel;if(!calloutLabel.avoidCollisions)return null;yield this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const textBoxes=[],text=new Text;let titleBox;const{title}=this.properties;if(title!=null&&title.text&&title.enabled){const dy=this.getTitleTranslationY();isFinite(dy)&&(text.text=title.text,text.x=0,text.y=dy,text.setFont(title),text.setAlign({textBaseline:"bottom",textAlign:"center"}),titleBox=text.computeBBox(),textBoxes.push(titleBox))}return this.nodeData.forEach(datum=>{var _a201;const label=datum.calloutLabel;if(!label||datum.outerRadius===0)return null;const labelRadius=datum.outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY;text.text=label.text,text.x=x,text.y=y,text.setFont(this.properties.calloutLabel),text.setAlign({textAlign:(_a201=label.collisionTextAlign)!=null?_a201:label.textAlign,textBaseline:label.textBaseline});const box=text.computeBBox();if(label.box=box,Math.abs(label.collisionOffsetY)>maxCollisionOffset){label.hidden=!0;return}if(titleBox){const seriesTop=seriesRect.y-this.centerY,titleCleanArea=new BBox(titleBox.x-minSpacing,seriesTop,titleBox.width+2*minSpacing,titleBox.y+titleBox.height+minSpacing-seriesTop);if(box.collidesBBox(titleCleanArea)){label.hidden=!0;return}}if(options.hideWhenNecessary){const{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}=this.getLabelOverflow(label.text,box,seriesRect),isTooShort=label.text.length>2&&textLength<2;if(hasVerticalOverflow||isTooShort||hasSurroundingSeriesOverflow){label.hidden=!0;return}}label.hidden=!1,textBoxes.push(box)}),textBoxes.length===0?null:BBox.merge(textBoxes)})}updateSectorLabelNodes(){const{radiusScale}=this,innerRadius=radiusScale.convert(0),{fontSize,fontStyle,fontWeight,fontFamily,positionOffset,positionRatio,color}=this.properties.sectorLabel;this.sectorLabelSelection.each((text,datum)=>{const{sectorLabel,outerRadius}=datum;let isTextVisible=!1;if(sectorLabel&&outerRadius!==0){const labelRadius=innerRadius*(1-positionRatio)+outerRadius*positionRatio+positionOffset;text.fill=color,text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.text=sectorLabel.text,text.x=datum.midCos*labelRadius,text.y=datum.midSin*labelRadius,text.textAlign="center",text.textBaseline="middle";const bbox=text.computeBBox(),corners=[[bbox.x,bbox.y],[bbox.x+bbox.width,bbox.y],[bbox.x+bbox.width,bbox.y+bbox.height],[bbox.x,bbox.y+bbox.height]],{startAngle,endAngle}=datum,sectorBounds={startAngle,endAngle,innerRadius,outerRadius};corners.every(([x,y])=>isPointInSector(x,y,sectorBounds))&&(isTextVisible=!0)}text.visible=isTextVisible})}updateInnerLabelNodes(){const textBBoxes=[],margins=[];this.innerLabelsSelection.each((text,datum)=>{const{fontStyle,fontWeight,fontSize,fontFamily,color}=datum;text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.text=datum.text,text.x=0,text.y=0,text.fill=color,text.textAlign="center",text.textBaseline="alphabetic",textBBoxes.push(text.computeBBox()),margins.push(datum.margin)});const getMarginTop=__name(index=>index===0?0:margins[index],"getMarginTop"),getMarginBottom=__name(index=>index===margins.length-1?0:margins[index],"getMarginBottom"),totalHeight=textBBoxes.reduce((sum2,bbox,i)=>sum2+bbox.height+getMarginTop(i)+getMarginBottom(i),0),totalWidth=Math.max(...textBBoxes.map(bbox=>bbox.width)),innerRadius=this.getInnerRadius(),labelsVisible=Math.sqrt(Math.pow(totalWidth/2,2)+Math.pow(totalHeight/2,2))<=(innerRadius>0?innerRadius:this.getOuterRadius()),textBottoms=[];for(let i=0,prev=-totalHeight/2;i<textBBoxes.length;i++){const bottom=textBBoxes[i].height+prev+getMarginTop(i);textBottoms.push(bottom),prev=bottom+getMarginBottom(i)}this.innerLabelsSelection.each((text,_datum,index)=>{text.y=textBottoms[index],text.visible=labelsVisible})}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2,this.zerosumInnerRing.size=this.getInnerRadius()*2}getDatumLegendName(nodeDatum){const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,{sectorLabel,calloutLabel,legendItem}=nodeDatum;if(legendItemKey&&legendItem!==void 0)return legendItem.text;if(calloutLabelKey&&calloutLabelKey!==angleKey&&(calloutLabel==null?void 0:calloutLabel.text)!==void 0)return calloutLabel.text;if(sectorLabelKey&&sectorLabelKey!==angleKey&&(sectorLabel==null?void 0:sectorLabel.text)!==void 0)return sectorLabel.text}getTooltipHtml(nodeDatum){var _a201;if(!this.properties.isValid())return"";const{datum,angleValue,sectorFormat:{fill:color}}=nodeDatum,title=sanitizeHtml((_a201=this.properties.title)==null?void 0:_a201.text),content=isFiniteNumber(angleValue)?toFixed(angleValue):String(angleValue),labelText=this.getDatumLegendName(nodeDatum);return this.properties.tooltip.toTooltipHtml({title:title??labelText,content:title&&labelText?`${labelText}: ${content}`:content,backgroundColor:color},{datum,title,color,seriesId:this.id,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName})}getLegendData(legendType){var _a201,_b,_c,_d,_e;const{processedData,dataModel}=this;if(!dataModel||!(processedData!=null&&processedData.data.length)||!this.properties.isValid()||legendType!=="category")return[];const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;if(!legendItemKey&&(!calloutLabelKey||calloutLabelKey===angleKey)&&(!sectorLabelKey||sectorLabelKey===angleKey))return[];const{calloutLabelIdx,sectorLabelIdx,legendItemIdx}=this.getProcessedDataIndexes(dataModel),titleText=((_a201=this.properties.title)==null?void 0:_a201.showInLegend)&&this.properties.title.text,legendData=[];for(let index=0;index<processedData.data.length;index++){const{datum,values}=processedData.data[index],labelParts=[];titleText&&labelParts.push(titleText);const labels=this.getLabels(datum,2*Math.PI,2*Math.PI,!1,values[calloutLabelIdx],values[sectorLabelIdx],values[legendItemIdx]);if(legendItemKey&&labels.legendItem!==void 0?labelParts.push(labels.legendItem.text):calloutLabelKey&&calloutLabelKey!==angleKey&&((_b=labels.calloutLabel)==null?void 0:_b.text)!==void 0?labelParts.push((_c=labels.calloutLabel)==null?void 0:_c.text):sectorLabelKey&&sectorLabelKey!==angleKey&&((_d=labels.sectorLabel)==null?void 0:_d.text)!==void 0&&labelParts.push((_e=labels.sectorLabel)==null?void 0:_e.text),labelParts.length===0)continue;const sectorFormat=this.getSectorFormat(datum,index,!1);legendData.push({legendType:"category",id:this.id,itemId:index,seriesId:this.id,enabled:this.seriesItemEnabled[index],label:{text:labelParts.join(" - ")},marker:{fill:sectorFormat.fill,stroke:sectorFormat.stroke,fillOpacity:this.properties.fillOpacity,strokeOpacity:this.properties.strokeOpacity,strokeWidth:this.properties.strokeWidth},legendItemName:legendItemKey!=null?datum[legendItemKey]:void 0})}return legendData}onLegendItemClick(event){const{enabled,itemId,series,legendItemName}=event;series.id===this.id?this.toggleSeriesItem(itemId,enabled):legendItemName!=null&&this.toggleOtherSeriesItems(legendItemName,enabled)}toggleSeriesItem(itemId,enabled){this.seriesItemEnabled[itemId]=enabled,this.nodeDataRefresh=!0}toggleOtherSeriesItems(legendItemName,enabled){var _a201;if(!this.properties.legendItemKey||!this.dataModel)return;const legendItemIdx=this.dataModel.resolveProcessedDataIndexById(this,"legendItemValue").index;(_a201=this.processedData)==null||_a201.data.forEach(({values},datumItemId)=>{values[legendItemIdx]===legendItemName&&this.toggleSeriesItem(datumItemId,enabled)})}animateEmptyUpdateReady(_data){const{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[this.itemSelection,this.highlightSelection],fns.nodes),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeInAnimation(this,"callout",animationManager,[this.calloutLabelSelection]),seriesLabelFadeInAnimation(this,"sector",animationManager,[this.sectorLabelSelection]),seriesLabelFadeInAnimation(this,"inner",animationManager,[this.innerLabelsSelection]),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){var _a201,_b,_c,_d,_e,_f;const{itemSelection,highlightSelection,processedData,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,diff2=(_a201=processedData==null?void 0:processedData.reduced)==null?void 0:_a201.diff;this.ctx.animationManager.stopByAnimationGroupId(this.id);const supportedDiff=((_b=diff2==null?void 0:diff2.moved.length)!=null?_b:0)===0&&(diff2==null?void 0:diff2.addedIndices.every(i=>!diff2.removedIndices.includes(i))),hasKeys=((_c=processedData==null?void 0:processedData.defs.keys.length)!=null?_c:0)>0,hasUniqueKeys=(_f=(_e=(_d=processedData==null?void 0:processedData.reduced)==null?void 0:_d.animationValidation)==null?void 0:_e.uniqueKeys)!=null?_f:!0;(!supportedDiff||!hasKeys||!hasUniqueKeys)&&this.ctx.animationManager.skipCurrentBatch();const fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection],fns.nodes,(_,datum)=>this.getDatumId(datum),diff2),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeInAnimation(this,"callout",this.ctx.animationManager,[this.calloutLabelSelection]),seriesLabelFadeInAnimation(this,"sector",this.ctx.animationManager,[this.sectorLabelSelection]),seriesLabelFadeInAnimation(this,"inner",this.ctx.animationManager,[this.innerLabelsSelection]),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection,highlightSelection,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection],fns.nodes),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeOutAnimation(this,"callout",this.ctx.animationManager,[this.calloutLabelSelection]),seriesLabelFadeOutAnimation(this,"sector",this.ctx.animationManager,[this.sectorLabelSelection]),seriesLabelFadeOutAnimation(this,"inner",this.ctx.animationManager,[this.innerLabelsSelection]),this.previousRadiusScale.range=this.radiusScale.range}getDatumIdFromData(datum){var _a201,_b,_c;const{calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;if((_c=(_b=(_a201=this.processedData)==null?void 0:_a201.reduced)==null?void 0:_b.animationValidation)!=null&&_c.uniqueKeys){if(legendItemKey)return datum[legendItemKey];if(calloutLabelKey)return datum[calloutLabelKey];if(sectorLabelKey)return datum[sectorLabelKey]}}getDatumId(datum){var _a201;const{index}=datum;return(_a201=this.getDatumIdFromData(datum.datum))!=null?_a201:`${index}`}onDataChange(){this.processSeriesItemEnabled()}},__name(_a179,"DonutSeries"),_a179);DonutSeries.className="DonutSeries";DonutSeries.type="donut";var pieTheme={series:{__extends__:EXTENDS_SERIES_DEFAULTS,title:{enabled:!0,fontStyle:void 0,fontWeight:"normal",fontSize:14,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_MUTED_LABEL_COLOUR,spacing:5},calloutLabel:{enabled:!0,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,offset:3,minAngle:0},sectorLabel:{enabled:!0,fontStyle:void 0,fontWeight:"normal",fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_INSIDE_SERIES_LABEL_COLOUR,positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2},fillOpacity:1,strokeOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,rotation:0,shadow:{enabled:!1,color:DEFAULT_SHADOW_COLOUR,xOffset:3,yOffset:3,blur:5},innerLabels:{fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:DEFAULT_FONT_FAMILY,color:DEFAULT_LABEL_COLOUR,margin:2},__BACKGROUND_COLOR_DO_NOT_USE:DEFAULT_BACKGROUND_COLOUR}},piePaletteFactory=__name(({takeColors,colorsCount,userPalette})=>{const{fills,strokes}=takeColors(colorsCount);return{fills,strokes:userPalette?strokes:[],calloutLine:{colors:strokes}}},"piePaletteFactory"),DonutSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"donut",instanceConstructor:DonutSeries,seriesDefaults:{},themeTemplate:pieTheme,paletteFactory:piePaletteFactory},_a180,PieTitle=(_a180=class extends Caption{constructor(){super(...arguments),this.showInLegend=!1}},__name(_a180,"PieTitle"),_a180);__decorateClass([Validate(BOOLEAN)],PieTitle.prototype,"showInLegend",2);var _a181,DonutInnerLabel2=(_a181=class extends Label{set(properties,_reset){return super.set(properties)}},__name(_a181,"DonutInnerLabel2"),_a181);__decorateClass([Deprecated("Use a Donut Series instead"),Validate(STRING,{optional:!0})],DonutInnerLabel2.prototype,"text",2);__decorateClass([Deprecated("Use a Donut Series instead"),Validate(NUMBER,{optional:!0})],DonutInnerLabel2.prototype,"margin",2);var _a182,DonutInnerCircle2=(_a182=class extends BaseProperties{},__name(_a182,"DonutInnerCircle2"),_a182);__decorateClass([Deprecated("Use a Donut Series instead"),Validate(COLOR_STRING,{optional:!0})],DonutInnerCircle2.prototype,"fill",2);__decorateClass([Deprecated("Use a Donut Series instead"),Validate(RATIO,{optional:!0})],DonutInnerCircle2.prototype,"fillOpacity",2);var _a183,PieSeriesCalloutLabel=(_a183=class extends Label{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}},__name(_a183,"PieSeriesCalloutLabel"),_a183);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLabel.prototype,"offset",2);__decorateClass([Validate(DEGREE)],PieSeriesCalloutLabel.prototype,"minAngle",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLabel.prototype,"minSpacing",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLabel.prototype,"maxCollisionOffset",2);__decorateClass([Validate(BOOLEAN)],PieSeriesCalloutLabel.prototype,"avoidCollisions",2);var _a184,PieSeriesSectorLabel=(_a184=class extends Label{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}},__name(_a184,"PieSeriesSectorLabel"),_a184);__decorateClass([Validate(NUMBER)],PieSeriesSectorLabel.prototype,"positionOffset",2);__decorateClass([Validate(RATIO)],PieSeriesSectorLabel.prototype,"positionRatio",2);var _a185,PieSeriesCalloutLine=(_a185=class extends BaseProperties{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}},__name(_a185,"PieSeriesCalloutLine"),_a185);__decorateClass([Validate(COLOR_STRING_ARRAY,{optional:!0})],PieSeriesCalloutLine.prototype,"colors",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLine.prototype,"length",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesCalloutLine.prototype,"strokeWidth",2);var _a186,PieSeriesProperties=(_a186=class extends SeriesProperties{constructor(){super(...arguments),this.fills=Object.values(DEFAULT_FILLS),this.strokes=Object.values(DEFAULT_STROKES),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=void 0,this.innerLabels=new PropertiesArray(DonutInnerLabel2),this.title=new PieTitle,this.innerCircle=new DonutInnerCircle2,this.shadow=new DropShadow,this.calloutLabel=new PieSeriesCalloutLabel,this.sectorLabel=new PieSeriesSectorLabel,this.calloutLine=new PieSeriesCalloutLine,this.tooltip=new SeriesTooltip,this.__BACKGROUND_COLOR_DO_NOT_USE=void 0}},__name(_a186,"PieSeriesProperties"),_a186);__decorateClass([Validate(STRING)],PieSeriesProperties.prototype,"angleKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"angleName",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"radiusKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"radiusName",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],PieSeriesProperties.prototype,"radiusMin",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],PieSeriesProperties.prototype,"radiusMax",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"calloutLabelKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"calloutLabelName",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"sectorLabelKey",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"sectorLabelName",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"legendItemKey",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],PieSeriesProperties.prototype,"fills",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],PieSeriesProperties.prototype,"strokes",2);__decorateClass([Validate(RATIO)],PieSeriesProperties.prototype,"fillOpacity",2);__decorateClass([Validate(RATIO)],PieSeriesProperties.prototype,"strokeOpacity",2);__decorateClass([Validate(LINE_DASH)],PieSeriesProperties.prototype,"lineDash",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesProperties.prototype,"lineDashOffset",2);__decorateClass([Validate(FUNCTION,{optional:!0})],PieSeriesProperties.prototype,"formatter",2);__decorateClass([Validate(DEGREE)],PieSeriesProperties.prototype,"rotation",2);__decorateClass([Validate(NUMBER)],PieSeriesProperties.prototype,"outerRadiusOffset",2);__decorateClass([Validate(RATIO)],PieSeriesProperties.prototype,"outerRadiusRatio",2);__decorateClass([Deprecated("Use a Donut Series instead"),Validate(NUMBER,{optional:!0})],PieSeriesProperties.prototype,"innerRadiusOffset",2);__decorateClass([Deprecated("Use a Donut Series instead"),Validate(RATIO,{optional:!0})],PieSeriesProperties.prototype,"innerRadiusRatio",2);__decorateClass([Validate(POSITIVE_NUMBER)],PieSeriesProperties.prototype,"strokeWidth",2);__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],PieSeriesProperties.prototype,"sectorSpacing",2);__decorateClass([Validate(OBJECT_ARRAY)],PieSeriesProperties.prototype,"innerLabels",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"title",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"innerCircle",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"shadow",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"calloutLabel",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"sectorLabel",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"calloutLine",2);__decorateClass([Validate(OBJECT)],PieSeriesProperties.prototype,"tooltip",2);__decorateClass([Validate(STRING,{optional:!0})],PieSeriesProperties.prototype,"__BACKGROUND_COLOR_DO_NOT_USE",2);var _a187,PieSeriesNodeClickEvent=(_a187=class extends SeriesNodeClickEvent{constructor(type,nativeEvent,datum,series){super(type,nativeEvent,datum,series),this.angleKey=series.properties.angleKey,this.radiusKey=series.properties.radiusKey,this.calloutLabelKey=series.properties.calloutLabelKey,this.sectorLabelKey=series.properties.sectorLabelKey}},__name(_a187,"PieSeriesNodeClickEvent"),_a187),_a188,PieSeries=(_a188=class extends PolarSeries{constructor(moduleCtx){super({moduleCtx,useLabelLayer:!0,animationResetFns:{item:resetPieSelectionsFn,label:resetLabelFn}}),this.properties=new PieSeriesProperties,this.previousRadiusScale=new LinearScale,this.radiusScale=new LinearScale,this.backgroundGroup=this.rootGroup.appendChild(new Group({name:`${this.id}-background`,layer:!0,zIndex:0})),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new Circle),this.zerosumInnerRing=this.zerosumRingsGroup.appendChild(new Circle),this.innerCircleGroup=this.backgroundGroup.appendChild(new Group({name:`${this.id}-innerCircle`})),this.nodeData=[],this.seriesItemEnabled=[],this.surroundingRadius=void 0,this.NodeClickEvent=PieSeriesNodeClickEvent,this.angleScale=new LinearScale,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(angle=>angle+Math.PI/2);const pieCalloutLabels=new Group({name:"pieCalloutLabels"}),pieSectorLabels=new Group({name:"pieSectorLabels"}),innerLabels=new Group({name:"innerLabels"});this.labelGroup.append(pieCalloutLabels),this.labelGroup.append(pieSectorLabels),this.labelGroup.append(innerLabels),this.calloutLabelSelection=Selection.select(pieCalloutLabels,Group),this.sectorLabelSelection=Selection.select(pieSectorLabels,Text),this.innerLabelsSelection=Selection.select(innerLabels,Text),this.innerCircleSelection=Selection.select(this.innerCircleGroup,Circle);for(const circle of[this.zerosumInnerRing,this.zerosumOuterRing])circle.fillOpacity=0,circle.stroke=this.properties.calloutLabel.color,circle.strokeWidth=1,circle.strokeOpacity=1}addChartEventListeners(){var _a201;this.destroyFns.push((_a201=this.ctx.chartEventManager)==null?void 0:_a201.addListener("legend-item-click",event=>this.onLegendItemClick(event)))}visibleChanged(){this.processSeriesItemEnabled()}get visible(){return this.seriesItemEnabled.length?this.seriesItemEnabled.some(visible=>visible):super.visible}processSeriesItemEnabled(){var _a201;const{data,visible}=this;this.seriesItemEnabled=(_a201=data==null?void 0:data.map(()=>visible))!=null?_a201:[]}nodeFactory(){return new Sector}getSeriesDomain(direction){return direction==="x"?this.angleScale.domain:this.radiusScale.domain}processData(dataController){return __async(this,null,function*(){var _a201,_b,_c,_d,_e;if(this.data==null||!this.properties.isValid())return;let{data}=this;const{seriesItemEnabled}=this,{angleKey,radiusKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,animationEnabled=!this.ctx.animationManager.isSkipped(),extraKeyProps=[],extraProps=[];legendItemKey?extraKeyProps.push(keyProperty(this,legendItemKey,!1,{id:"legendItemKey"})):calloutLabelKey?extraKeyProps.push(keyProperty(this,calloutLabelKey,!1,{id:"calloutLabelKey"})):sectorLabelKey&&extraKeyProps.push(keyProperty(this,sectorLabelKey,!1,{id:"sectorLabelKey"})),radiusKey&&extraProps.push(rangedValueProperty(this,radiusKey,{id:"radiusValue",min:(_a201=this.properties.radiusMin)!=null?_a201:0,max:this.properties.radiusMax}),valueProperty(this,radiusKey,!0,{id:"radiusRaw"}),normalisePropertyTo(this,{id:"radiusValue"},[0,1],1,(_b=this.properties.radiusMin)!=null?_b:0,this.properties.radiusMax)),calloutLabelKey&&extraProps.push(valueProperty(this,calloutLabelKey,!1,{id:"calloutLabelValue"})),sectorLabelKey&&extraProps.push(valueProperty(this,sectorLabelKey,!1,{id:"sectorLabelValue"})),legendItemKey&&extraProps.push(valueProperty(this,legendItemKey,!1,{id:"legendItemValue"})),animationEnabled&&this.processedData&&extraKeyProps.length>0&&extraProps.push(diff(this.processedData)),extraProps.push(animationValidation(this)),data=data.map((d,idx)=>seriesItemEnabled[idx]?d:__spreadProps(__spreadValues({},d),{[angleKey]:0})),yield this.requestDataModel(dataController,data,{props:[...extraKeyProps,accumulativeValueProperty(this,angleKey,!0,{id:"angleValue",onlyPositive:!0}),valueProperty(this,angleKey,!0,{id:"angleRaw"}),normalisePropertyTo(this,{id:"angleValue"},[0,1],0,0),...extraProps]});for(const valueDef of(_e=(_d=(_c=this.processedData)==null?void 0:_c.defs)==null?void 0:_d.values)!=null?_e:[]){const{id,missing,property}=valueDef,missCount=getMissCount(this,missing);id!=="angleRaw"&&missCount>0&&Logger.warnOnce(`no value was found for the key '${String(property)}' on ${missCount} data element${missCount>1?"s":""}`)}this.animationState.transition("updateData")})}maybeRefreshNodeData(){return __async(this,null,function*(){if(!this.nodeDataRefresh)return;const[{nodeData=[]}={}]=yield this.createNodeData();this.nodeData=nodeData,this.nodeDataRefresh=!1})}getProcessedDataIndexes(dataModel){const angleIdx=dataModel.resolveProcessedDataIndexById(this,"angleValue").index,radiusIdx=this.properties.radiusKey?dataModel.resolveProcessedDataIndexById(this,"radiusValue").index:-1,calloutLabelIdx=this.properties.calloutLabelKey?dataModel.resolveProcessedDataIndexById(this,"calloutLabelValue").index:-1,sectorLabelIdx=this.properties.sectorLabelKey?dataModel.resolveProcessedDataIndexById(this,"sectorLabelValue").index:-1,legendItemIdx=this.properties.legendItemKey?dataModel.resolveProcessedDataIndexById(this,"legendItemValue").index:-1;return{angleIdx,radiusIdx,calloutLabelIdx,sectorLabelIdx,legendItemIdx}}createNodeData(){return __async(this,null,function*(){const{id:seriesId,processedData,dataModel,angleScale}=this,{rotation}=this.properties;if(!processedData||!dataModel||processedData.type!=="ungrouped")return[];const{angleIdx,radiusIdx,calloutLabelIdx,sectorLabelIdx,legendItemIdx}=this.getProcessedDataIndexes(dataModel);let currentStart=0,sum2=0;const nodeData=processedData.data.map((group2,index)=>{var _a201;const{datum,values}=group2,currentValue=values[angleIdx],startAngle=angleScale.convert(currentStart)+toRadians(rotation);currentStart=currentValue,sum2+=currentValue;const endAngle=angleScale.convert(currentStart)+toRadians(rotation),span=Math.abs(endAngle-startAngle),midAngle=startAngle+span/2,angleValue=values[angleIdx+1],radius=radiusIdx>=0&&(_a201=values[radiusIdx])!=null?_a201:1,radiusValue=radiusIdx>=0?values[radiusIdx+1]:void 0,legendItemValue=legendItemIdx>=0?values[legendItemIdx]:void 0,labels=this.getLabels(datum,midAngle,span,!0,values[calloutLabelIdx],values[sectorLabelIdx],legendItemValue),sectorFormat=this.getSectorFormat(datum,index,!1);return __spreadValues({itemId:index,series:this,datum,index,angleValue,midAngle,midCos:Math.cos(midAngle),midSin:Math.sin(midAngle),startAngle,endAngle,sectorFormat,radiusValue,radius,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(radius),0),legendItemValue},labels)});this.zerosumOuterRing.visible=sum2===0;const{innerRadiusRatio=1}=this.properties;return this.zerosumInnerRing.visible=sum2===0&&innerRadiusRatio!==1&&innerRadiusRatio>0,[{itemId:seriesId,nodeData,labelData:nodeData}]})}getLabels(datum,midAngle,span,skipDisabled,calloutLabelValue,sectorLabelValue,legendItemValue){const{calloutLabel,sectorLabel,legendItemKey}=this.properties,calloutLabelKey=!skipDisabled||calloutLabel.enabled?this.properties.calloutLabelKey:void 0,sectorLabelKey=!skipDisabled||sectorLabel.enabled?this.properties.sectorLabelKey:void 0;if(!calloutLabelKey&&!sectorLabelKey&&!legendItemKey)return{};const labelFormatterParams={datum,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},result={};return calloutLabelKey&&span>toRadians(calloutLabel.minAngle)&&(result.calloutLabel=__spreadProps(__spreadValues({},this.getTextAlignment(midAngle)),{text:this.getLabelText(calloutLabel,__spreadProps(__spreadValues({},labelFormatterParams),{value:calloutLabelValue})),hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0})),sectorLabelKey&&(result.sectorLabel={text:this.getLabelText(sectorLabel,__spreadProps(__spreadValues({},labelFormatterParams),{value:sectorLabelValue}))}),legendItemKey!=null&&legendItemValue!=null&&(result.legendItem={key:legendItemKey,text:legendItemValue}),result}getTextAlignment(midAngle){const quadrantTextOpts=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"hanging"},{textAlign:"right",textBaseline:"middle"}],midAngle180=normalizeAngle180(midAngle),quadrantStart=-3*Math.PI/4,quadrantOffset=midAngle180-quadrantStart,quadrant=Math.floor(quadrantOffset/(Math.PI/2)),quadrantIndex=mod(quadrant,quadrantTextOpts.length);return quadrantTextOpts[quadrantIndex]}getSectorFormat(datum,formatIndex,highlight){var _a201,_b,_c,_d,_e;const{callbackCache,highlightManager}=this.ctx,{angleKey,radiusKey,fills,strokes,formatter,sectorSpacing,__BACKGROUND_COLOR_DO_NOT_USE}=this.properties,highlightedDatum=highlightManager.getActiveHighlight(),isDatumHighlighted=highlight&&(highlightedDatum==null?void 0:highlightedDatum.series)===this&&formatIndex===highlightedDatum.itemId,{fill,fillOpacity,stroke,strokeWidth,strokeOpacity}=mergeDefaults(isDatumHighlighted&&this.properties.highlightStyle.item,{fill:fills.length>0?fills[formatIndex%fills.length]:void 0,fillOpacity:this.properties.fillOpacity,stroke:sectorSpacing!=null?strokes.length>0?strokes[formatIndex%strokes.length]:void 0:strokes.length>0?strokes[formatIndex%strokes.length]:__BACKGROUND_COLOR_DO_NOT_USE,strokeWidth:this.getStrokeWidth(this.properties.strokeWidth),strokeOpacity:this.getOpacity()});let format2;return formatter&&(format2=callbackCache.call(formatter,{datum,angleKey,radiusKey,fill,stroke,fills,strokes,strokeWidth,highlighted:isDatumHighlighted,seriesId:this.id})),{fill:(_a201=format2==null?void 0:format2.fill)!=null?_a201:fill,fillOpacity:(_b=format2==null?void 0:format2.fillOpacity)!=null?_b:fillOpacity,stroke:(_c=format2==null?void 0:format2.stroke)!=null?_c:stroke,strokeWidth:(_d=format2==null?void 0:format2.strokeWidth)!=null?_d:strokeWidth,strokeOpacity:(_e=format2==null?void 0:format2.strokeOpacity)!=null?_e:strokeOpacity}}getInnerRadius(){const{radius}=this,{innerRadiusRatio=1,innerRadiusOffset=0}=this.properties,innerRadius=radius*innerRadiusRatio+innerRadiusOffset;return innerRadius===radius||innerRadius<0?0:innerRadius}getOuterRadius(){return Math.max(this.radius*this.properties.outerRadiusRatio+this.properties.outerRadiusOffset,0)}updateRadiusScale(resize){const newRange=[this.getInnerRadius(),this.getOuterRadius()];this.radiusScale.range=newRange,resize&&(this.previousRadiusScale.range=newRange),this.nodeData=this.nodeData.map(_a201=>{var _b=_a201,{radius}=_b,d=__objRest(_b,["radius"]);return __spreadProps(__spreadValues({},d),{radius,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(radius),0)})})}getTitleTranslationY(){var _a201,_b;const outerRadius=Math.max(0,this.radiusScale.range[1]);if(outerRadius===0)return NaN;const titleOffset=2+((_b=(_a201=this.properties.title)==null?void 0:_a201.spacing)!=null?_b:0),dy=Math.max(0,-outerRadius);return-outerRadius-titleOffset-dy}update(_0){return __async(this,arguments,function*({seriesRect}){const{title}=this.properties,newNodeDataDependencies={seriesRectWidth:seriesRect==null?void 0:seriesRect.width,seriesRectHeight:seriesRect==null?void 0:seriesRect.height},resize=jsonDiff(this.nodeDataDependencies,newNodeDataDependencies)!=null;if(resize&&(this._nodeDataDependencies=newNodeDataDependencies),yield this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(resize),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),title){const dy=this.getTitleTranslationY(),titleBox=title.node.computeBBox();title.node.visible=title.enabled&&isFinite(dy)&&!this.bboxIntersectsSurroundingSeries(titleBox,0,dy),title.node.translationY=isFinite(dy)?dy:0}this.updateNodeMidPoint(),yield this.updateSelections(),yield this.updateNodes(seriesRect)})}updateTitleNodes(){var _a201,_b;const{oldTitle}=this,{title}=this.properties;oldTitle!==title&&(oldTitle&&((_a201=this.labelGroup)==null||_a201.removeChild(oldTitle.node)),title&&(title.node.textBaseline="bottom",(_b=this.labelGroup)==null||_b.appendChild(title.node)),this.oldTitle=title)}updateNodeMidPoint(){this.nodeData.forEach(d=>{const radius=d.innerRadius+(d.outerRadius-d.innerRadius)/2;d.midPoint={x:d.midCos*Math.max(0,radius),y:d.midSin*Math.max(0,radius)}})}updateSelections(){return __async(this,null,function*(){yield this.updateGroupSelection(),this.updateInnerCircleSelection()})}updateGroupSelection(){return __async(this,null,function*(){const{itemSelection,highlightSelection,calloutLabelSelection,sectorLabelSelection,innerLabelsSelection}=this,update=__name((selection,clone)=>{let nodeData=this.nodeData;clone&&(nodeData=nodeData.map(datum=>__spreadProps(__spreadValues({},datum),{sectorFormat:__spreadValues({},datum.sectorFormat)}))),selection.update(nodeData,void 0,datum=>this.getDatumId(datum)),this.ctx.animationManager.isSkipped()&&selection.cleanup()},"update");update(itemSelection,!1),update(highlightSelection,!0),calloutLabelSelection.update(this.nodeData,group2=>{const line=new Line;line.tag=1,line.pointerEvents=1,group2.appendChild(line);const text=new Text;text.tag=2,text.pointerEvents=1,group2.appendChild(text)}),sectorLabelSelection.update(this.nodeData,node=>{node.pointerEvents=1}),innerLabelsSelection.update(this.properties.innerLabels,node=>{node.pointerEvents=1})})}updateInnerCircleSelection(){const{innerCircle}=this.properties;let radius=0;const innerRadius=this.getInnerRadius();if(innerRadius>0){const circleRadius=Math.min(innerRadius,this.getOuterRadius());radius=Math.ceil(circleRadius*2+1)}const datums=innerCircle?[{radius}]:[];this.innerCircleSelection.update(datums)}updateNodes(seriesRect){return __async(this,null,function*(){const highlightedDatum=this.ctx.highlightManager.getActiveHighlight(),isVisible=this.seriesItemEnabled.indexOf(!0)>=0;this.rootGroup.visible=isVisible,this.backgroundGroup.visible=isVisible,this.contentGroup.visible=isVisible,this.highlightGroup.visible=isVisible&&(highlightedDatum==null?void 0:highlightedDatum.series)===this,this.labelGroup&&(this.labelGroup.visible=isVisible),this.contentGroup.opacity=this.getOpacity(),this.innerCircleSelection.each((node,{radius})=>{var _a201,_b;node.setProperties({fill:(_a201=this.properties.innerCircle)==null?void 0:_a201.fill,opacity:(_b=this.properties.innerCircle)==null?void 0:_b.fillOpacity,size:radius})});const updateSectorFn=__name((sector,datum,_index,isDatumHighlighted)=>{const format2=this.getSectorFormat(datum.datum,datum.itemId,isDatumHighlighted);datum.sectorFormat.fill=format2.fill,datum.sectorFormat.stroke=format2.stroke;const animationDisabled=this.ctx.animationManager.isSkipped();animationDisabled&&(sector.startAngle=datum.startAngle,sector.endAngle=datum.endAngle,sector.innerRadius=datum.innerRadius,sector.outerRadius=datum.outerRadius),(isDatumHighlighted||animationDisabled)&&(sector.fill=format2.fill,sector.stroke=format2.stroke),sector.strokeWidth=format2.strokeWidth,sector.fillOpacity=format2.fillOpacity,sector.strokeOpacity=this.properties.strokeOpacity,sector.lineDash=this.properties.lineDash,sector.lineDashOffset=this.properties.lineDashOffset,sector.fillShadow=this.properties.shadow,sector.inset=this.properties.sectorSpacing!=null?(this.properties.sectorSpacing+(format2.stroke!=null?format2.strokeWidth:0))/2:0,sector.lineJoin=this.properties.sectorSpacing!=null?"miter":"round"},"updateSectorFn");this.itemSelection.each((node,datum,index)=>updateSectorFn(node,datum,index,!1)),this.highlightSelection.each((node,datum,index)=>{const isDatumHighlighted=(highlightedDatum==null?void 0:highlightedDatum.series)===this&&node.datum.itemId===highlightedDatum.itemId;updateSectorFn(node,datum,index,!0),node.visible=isDatumHighlighted}),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(seriesRect),this.updateSectorLabelNodes(),this.updateInnerLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")})}updateCalloutLineNodes(){var _a201;const{calloutLine}=this.properties,calloutLength=calloutLine.length,calloutStrokeWidth=calloutLine.strokeWidth,calloutColors=(_a201=calloutLine.colors)!=null?_a201:this.properties.strokes,{offset:offset4}=this.properties.calloutLabel;this.calloutLabelSelection.selectByTag(1).forEach((line,index)=>{const datum=line.datum,{calloutLabel:label,outerRadius}=datum;if(label!=null&&label.text&&!label.hidden&&outerRadius!==0){line.visible=!0,line.strokeWidth=calloutStrokeWidth,line.stroke=calloutColors[index%calloutColors.length],line.fill=void 0;const x1=datum.midCos*outerRadius,y1=datum.midSin*outerRadius;let x2=datum.midCos*(outerRadius+calloutLength),y2=datum.midSin*(outerRadius+calloutLength);if((label.collisionTextAlign||label.collisionOffsetY!==0)&&label.box!=null){const box=label.box;let cx=x2,cy=y2;x2<box.x?cx=box.x:x2>box.x+box.width&&(cx=box.x+box.width),y2<box.y?cy=box.y:y2>box.y+box.height&&(cy=box.y+box.height);const dx=cx-x2,dy=cy-y2,length=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)),paddedLength=length-offset4;paddedLength>0&&(x2=x2+dx*paddedLength/length,y2=y2+dy*paddedLength/length)}line.x1=x1,line.y1=y1,line.x2=x2,line.y2=y2}else line.visible=!1})}getLabelOverflow(text,box,seriesRect){const seriesLeft=seriesRect.x-this.centerX,seriesRight=seriesRect.x+seriesRect.width-this.centerX,seriesTop=seriesRect.y-this.centerY,seriesBottom=seriesRect.y+seriesRect.height-this.centerY,errPx=1;let visibleTextPart=1;box.x+errPx<seriesLeft?visibleTextPart=(box.x+box.width-seriesLeft)/box.width:box.x+box.width-errPx>seriesRight&&(visibleTextPart=(seriesRight-box.x)/box.width);const hasVerticalOverflow=box.y+errPx<seriesTop||box.y+box.height-errPx>seriesBottom,textLength=visibleTextPart===1?text.length:Math.floor(text.length*visibleTextPart)-1,hasSurroundingSeriesOverflow=this.bboxIntersectsSurroundingSeries(box);return{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}}bboxIntersectsSurroundingSeries(box,dx=0,dy=0){const{surroundingRadius}=this;if(surroundingRadius==null)return!1;const corners=[{x:box.x+dx,y:box.y+dy},{x:box.x+box.width+dx,y:box.y+dy},{x:box.x+box.width+dx,y:box.y+box.height+dy},{x:box.x+dx,y:box.y+box.height+dy}],sur2=__pow(surroundingRadius,2);return corners.some(corner=>__pow(corner.x,2)+__pow(corner.y,2)>sur2)}computeCalloutLabelCollisionOffsets(){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,{offset:offset4,minSpacing}=calloutLabel,innerRadius=radiusScale.convert(0),shouldSkip=__name(datum=>!datum.calloutLabel||datum.outerRadius===0,"shouldSkip"),fullData=this.nodeData,data=this.nodeData.filter(t=>!shouldSkip(t));if(data.forEach(datum=>{const label=datum.calloutLabel;label!=null&&(label.hidden=!1,label.collisionTextAlign=void 0,label.collisionOffsetY=0)}),data.length<=1)return;const leftLabels=data.filter(d=>d.midCos<0).sort((a,b)=>a.midSin-b.midSin),rightLabels=data.filter(d=>d.midCos>=0).sort((a,b)=>a.midSin-b.midSin),topLabels=data.filter(d=>{var _a201;return d.midSin<0&&((_a201=d.calloutLabel)==null?void 0:_a201.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),bottomLabels=data.filter(d=>{var _a201;return d.midSin>=0&&((_a201=d.calloutLabel)==null?void 0:_a201.textAlign)==="center"}).sort((a,b)=>a.midCos-b.midCos),tempTextNode=new Text,getTextBBox=__name(datum=>{var _a201;const label=datum.calloutLabel;if(label==null)return new BBox(0,0,0,0);const labelRadius=datum.outerRadius+calloutLine.length+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY;return tempTextNode.text=label.text,tempTextNode.x=x,tempTextNode.y=y,tempTextNode.setFont(this.properties.calloutLabel),tempTextNode.setAlign({textAlign:(_a201=label.collisionTextAlign)!=null?_a201:label.textAlign,textBaseline:label.textBaseline}),tempTextNode.computeBBox()},"getTextBBox"),avoidNeighbourYCollision=__name((label,next,direction)=>{const box=getTextBBox(label).grow(minSpacing/2),other=getTextBBox(next).grow(minSpacing/2);if(box.x<other.x+other.width&&box.x+box.width>other.x&&(direction==="to-top"?box.y<other.y+other.height:box.y+box.height>other.y)){const dy=direction==="to-top"?box.y-other.y-other.height:box.y+box.height-other.y;next.calloutLabel.collisionOffsetY=dy}},"avoidNeighbourYCollision"),avoidYCollisions=__name(labels=>{const midLabel=labels.slice().sort((a,b)=>Math.abs(a.midSin)-Math.abs(b.midSin))[0],midIndex=labels.indexOf(midLabel);for(let i=midIndex-1;i>=0;i--){const prev=labels[i+1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-top")}for(let i=midIndex+1;i<labels.length;i++){const prev=labels[i-1],next=labels[i];avoidNeighbourYCollision(prev,next,"to-bottom")}},"avoidYCollisions"),avoidXCollisions=__name(labels=>{const labelsCollideLabelsByY=data.some(datum=>datum.calloutLabel.collisionOffsetY!==0),boxes=labels.map(label=>getTextBBox(label)),paddedBoxes=boxes.map(box=>box.clone().grow(minSpacing/2));let labelsCollideLabelsByX=!1;for(let i=0;i<paddedBoxes.length&&!labelsCollideLabelsByX;i++){const box=paddedBoxes[i];for(let j=i+1;j<labels.length;j++){const other=paddedBoxes[j];if(box.collidesBBox(other)){labelsCollideLabelsByX=!0;break}}}const sectors=fullData.map(datum=>{const{startAngle,endAngle,outerRadius}=datum;return{startAngle,endAngle,innerRadius,outerRadius}}),labelsCollideSectors=boxes.some(box=>sectors.some(sector=>boxCollidesSector(box,sector)));!labelsCollideLabelsByX&&!labelsCollideLabelsByY&&!labelsCollideSectors||labels.filter(d=>d.calloutLabel.textAlign==="center").forEach(d=>{const label=d.calloutLabel;d.midCos<0?label.collisionTextAlign="right":d.midCos>0?label.collisionTextAlign="left":label.collisionTextAlign="center"})},"avoidXCollisions");avoidYCollisions(leftLabels),avoidYCollisions(rightLabels),avoidXCollisions(topLabels),avoidXCollisions(bottomLabels)}updateCalloutLabelNodes(seriesRect){const{radiusScale}=this,{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,color}=calloutLabel,tempTextNode=new Text;this.calloutLabelSelection.selectByTag(2).forEach(text=>{var _a201;const{datum}=text,label=datum.calloutLabel,radius=radiusScale.convert(datum.radius),outerRadius=Math.max(0,radius);if(!(label!=null&&label.text)||outerRadius===0||label.hidden){text.visible=!1;return}const labelRadius=outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY,align={textAlign:(_a201=label.collisionTextAlign)!=null?_a201:label.textAlign,textBaseline:label.textBaseline};tempTextNode.text=label.text,tempTextNode.x=x,tempTextNode.y=y,tempTextNode.setFont(this.properties.calloutLabel),tempTextNode.setAlign(align);const box=tempTextNode.computeBBox();let displayText=label.text,visible=!0;if(calloutLabel.avoidCollisions){const{textLength,hasVerticalOverflow}=this.getLabelOverflow(label.text,box,seriesRect);displayText=label.text.length===textLength?label.text:`${label.text.substring(0,textLength)}`,visible=!hasVerticalOverflow}text.text=displayText,text.x=x,text.y=y,text.setFont(this.properties.calloutLabel),text.setAlign(align),text.fill=color,text.visible=visible})}computeLabelsBBox(options,seriesRect){return __async(this,null,function*(){const{calloutLabel,calloutLine}=this.properties,calloutLength=calloutLine.length,{offset:offset4,maxCollisionOffset,minSpacing}=calloutLabel;if(!calloutLabel.avoidCollisions)return null;yield this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const textBoxes=[],text=new Text;let titleBox;const{title}=this.properties;if(title!=null&&title.text&&title.enabled){const dy=this.getTitleTranslationY();isFinite(dy)&&(text.text=title.text,text.x=0,text.y=dy,text.setFont(title),text.setAlign({textBaseline:"bottom",textAlign:"center"}),titleBox=text.computeBBox(),textBoxes.push(titleBox))}return this.nodeData.forEach(datum=>{var _a201;const label=datum.calloutLabel;if(!label||datum.outerRadius===0)return null;const labelRadius=datum.outerRadius+calloutLength+offset4,x=datum.midCos*labelRadius,y=datum.midSin*labelRadius+label.collisionOffsetY;text.text=label.text,text.x=x,text.y=y,text.setFont(this.properties.calloutLabel),text.setAlign({textAlign:(_a201=label.collisionTextAlign)!=null?_a201:label.textAlign,textBaseline:label.textBaseline});const box=text.computeBBox();if(label.box=box,Math.abs(label.collisionOffsetY)>maxCollisionOffset){label.hidden=!0;return}if(titleBox){const seriesTop=seriesRect.y-this.centerY,titleCleanArea=new BBox(titleBox.x-minSpacing,seriesTop,titleBox.width+2*minSpacing,titleBox.y+titleBox.height+minSpacing-seriesTop);if(box.collidesBBox(titleCleanArea)){label.hidden=!0;return}}if(options.hideWhenNecessary){const{textLength,hasVerticalOverflow,hasSurroundingSeriesOverflow}=this.getLabelOverflow(label.text,box,seriesRect),isTooShort=label.text.length>2&&textLength<2;if(hasVerticalOverflow||isTooShort||hasSurroundingSeriesOverflow){label.hidden=!0;return}}label.hidden=!1,textBoxes.push(box)}),textBoxes.length===0?null:BBox.merge(textBoxes)})}updateSectorLabelNodes(){const{radiusScale}=this,innerRadius=radiusScale.convert(0),{fontSize,fontStyle,fontWeight,fontFamily,positionOffset,positionRatio,color}=this.properties.sectorLabel,isDonut=innerRadius>0,singleVisibleSector=this.seriesItemEnabled.filter(Boolean).length===1;this.sectorLabelSelection.each((text,datum)=>{const{sectorLabel,outerRadius}=datum;let isTextVisible=!1;if(sectorLabel&&outerRadius!==0){const labelRadius=innerRadius*(1-positionRatio)+outerRadius*positionRatio+positionOffset;text.fill=color,text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.text=sectorLabel.text,!isDonut&&singleVisibleSector?(text.x=0,text.y=0):(text.x=datum.midCos*labelRadius,text.y=datum.midSin*labelRadius),text.textAlign="center",text.textBaseline="middle";const bbox=text.computeBBox(),corners=[[bbox.x,bbox.y],[bbox.x+bbox.width,bbox.y],[bbox.x+bbox.width,bbox.y+bbox.height],[bbox.x,bbox.y+bbox.height]],{startAngle,endAngle}=datum,sectorBounds={startAngle,endAngle,innerRadius,outerRadius};corners.every(([x,y])=>isPointInSector(x,y,sectorBounds))&&(isTextVisible=!0)}text.visible=isTextVisible})}updateInnerLabelNodes(){const textBBoxes=[],margins=[];this.innerLabelsSelection.each((text,datum)=>{const{fontStyle,fontWeight,fontSize,fontFamily,color,margin=2}=datum;text.fontStyle=fontStyle,text.fontWeight=fontWeight,text.fontSize=fontSize,text.fontFamily=fontFamily,text.text=datum.text,text.x=0,text.y=0,text.fill=color,text.textAlign="center",text.textBaseline="alphabetic",textBBoxes.push(text.computeBBox()),margins.push(margin)});const getMarginTop=__name(index=>index===0?0:margins[index],"getMarginTop"),getMarginBottom=__name(index=>index===margins.length-1?0:margins[index],"getMarginBottom"),totalHeight=textBBoxes.reduce((sum2,bbox,i)=>sum2+bbox.height+getMarginTop(i)+getMarginBottom(i),0),totalWidth=Math.max(...textBBoxes.map(bbox=>bbox.width)),innerRadius=this.getInnerRadius(),labelsVisible=Math.sqrt(Math.pow(totalWidth/2,2)+Math.pow(totalHeight/2,2))<=(innerRadius>0?innerRadius:this.getOuterRadius()),textBottoms=[];for(let i=0,prev=-totalHeight/2;i<textBBoxes.length;i++){const bottom=textBBoxes[i].height+prev+getMarginTop(i);textBottoms.push(bottom),prev=bottom+getMarginBottom(i)}this.innerLabelsSelection.each((text,_datum,index)=>{text.y=textBottoms[index],text.visible=labelsVisible})}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2,this.zerosumInnerRing.size=this.getInnerRadius()*2}getDatumLegendName(nodeDatum){const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties,{sectorLabel,calloutLabel,legendItem}=nodeDatum;if(legendItemKey&&legendItem!==void 0)return legendItem.text;if(calloutLabelKey&&calloutLabelKey!==angleKey&&(calloutLabel==null?void 0:calloutLabel.text)!==void 0)return calloutLabel.text;if(sectorLabelKey&&sectorLabelKey!==angleKey&&(sectorLabel==null?void 0:sectorLabel.text)!==void 0)return sectorLabel.text}getTooltipHtml(nodeDatum){var _a201;if(!this.properties.isValid())return"";const{datum,angleValue,sectorFormat:{fill:color}}=nodeDatum,title=sanitizeHtml((_a201=this.properties.title)==null?void 0:_a201.text),content=isFiniteNumber(angleValue)?toFixed(angleValue):String(angleValue),labelText=this.getDatumLegendName(nodeDatum);return this.properties.tooltip.toTooltipHtml({title:title??labelText,content:title&&labelText?`${labelText}: ${content}`:content,backgroundColor:color},{datum,title,color,seriesId:this.id,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName})}getLegendData(legendType){var _a201,_b,_c,_d,_e;const{processedData,dataModel}=this;if(!dataModel||!(processedData!=null&&processedData.data.length)||legendType!=="category")return[];const{angleKey,calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;if(!legendItemKey&&(!calloutLabelKey||calloutLabelKey===angleKey)&&(!sectorLabelKey||sectorLabelKey===angleKey))return[];const{calloutLabelIdx,sectorLabelIdx,legendItemIdx}=this.getProcessedDataIndexes(dataModel),titleText=((_a201=this.properties.title)==null?void 0:_a201.showInLegend)&&this.properties.title.text,legendData=[];for(let index=0;index<processedData.data.length;index++){const{datum,values}=processedData.data[index],labelParts=[];titleText&&labelParts.push(titleText);const labels=this.getLabels(datum,2*Math.PI,2*Math.PI,!1,values[calloutLabelIdx],values[sectorLabelIdx],values[legendItemIdx]);if(legendItemKey&&labels.legendItem!==void 0?labelParts.push(labels.legendItem.text):calloutLabelKey&&calloutLabelKey!==angleKey&&((_b=labels.calloutLabel)==null?void 0:_b.text)!==void 0?labelParts.push((_c=labels.calloutLabel)==null?void 0:_c.text):sectorLabelKey&&sectorLabelKey!==angleKey&&((_d=labels.sectorLabel)==null?void 0:_d.text)!==void 0&&labelParts.push((_e=labels.sectorLabel)==null?void 0:_e.text),labelParts.length===0)continue;const sectorFormat=this.getSectorFormat(datum,index,!1);legendData.push({legendType:"category",id:this.id,itemId:index,seriesId:this.id,enabled:this.seriesItemEnabled[index],label:{text:labelParts.join(" - ")},marker:{fill:sectorFormat.fill,stroke:sectorFormat.stroke,fillOpacity:this.properties.fillOpacity,strokeOpacity:this.properties.strokeOpacity,strokeWidth:this.properties.strokeWidth},legendItemName:legendItemKey!=null?datum[legendItemKey]:void 0})}return legendData}onLegendItemClick(event){const{enabled,itemId,series,legendItemName}=event;series.id===this.id?this.toggleSeriesItem(itemId,enabled):legendItemName!=null&&this.toggleOtherSeriesItems(legendItemName,enabled)}toggleSeriesItem(itemId,enabled){this.seriesItemEnabled[itemId]=enabled,this.nodeDataRefresh=!0}toggleOtherSeriesItems(legendItemName,enabled){var _a201;if(!this.properties.legendItemKey||!this.dataModel)return;const legendItemIdx=this.dataModel.resolveProcessedDataIndexById(this,"legendItemValue").index;(_a201=this.processedData)==null||_a201.data.forEach(({values},datumItemId)=>{values[legendItemIdx]===legendItemName&&this.toggleSeriesItem(datumItemId,enabled)})}animateEmptyUpdateReady(_data){const{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[this.itemSelection,this.highlightSelection],fns.nodes),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeInAnimation(this,"callout",animationManager,[this.calloutLabelSelection]),seriesLabelFadeInAnimation(this,"sector",animationManager,[this.sectorLabelSelection]),seriesLabelFadeInAnimation(this,"inner",animationManager,[this.innerLabelsSelection]),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){var _a201,_b,_c,_d,_e,_f;const{itemSelection,highlightSelection,processedData,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,diff2=(_a201=processedData==null?void 0:processedData.reduced)==null?void 0:_a201.diff;this.ctx.animationManager.stopByAnimationGroupId(this.id);const supportedDiff=((_b=diff2==null?void 0:diff2.moved.length)!=null?_b:0)===0&&(diff2==null?void 0:diff2.addedIndices.every(i=>!diff2.removedIndices.includes(i))),hasKeys=((_c=processedData==null?void 0:processedData.defs.keys.length)!=null?_c:0)>0,hasUniqueKeys=(_f=(_e=(_d=processedData==null?void 0:processedData.reduced)==null?void 0:_d.animationValidation)==null?void 0:_e.uniqueKeys)!=null?_f:!0;(!supportedDiff||!hasKeys||!hasUniqueKeys)&&this.ctx.animationManager.skipCurrentBatch();const fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection],fns.nodes,(_,datum)=>this.getDatumId(datum),diff2),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeInAnimation(this,"callout",this.ctx.animationManager,[this.calloutLabelSelection]),seriesLabelFadeInAnimation(this,"sector",this.ctx.animationManager,[this.sectorLabelSelection]),seriesLabelFadeInAnimation(this,"inner",this.ctx.animationManager,[this.innerLabelsSelection]),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection,highlightSelection,radiusScale,previousRadiusScale}=this,{animationManager}=this.ctx,fns=preparePieSeriesAnimationFunctions(!1,this.properties.rotation,radiusScale,previousRadiusScale);fromToMotion(this.id,"nodes",animationManager,[itemSelection,highlightSelection],fns.nodes),fromToMotion(this.id,"innerCircle",animationManager,[this.innerCircleSelection],fns.innerCircle),seriesLabelFadeOutAnimation(this,"callout",this.ctx.animationManager,[this.calloutLabelSelection]),seriesLabelFadeOutAnimation(this,"sector",this.ctx.animationManager,[this.sectorLabelSelection]),seriesLabelFadeOutAnimation(this,"inner",this.ctx.animationManager,[this.innerLabelsSelection]),this.previousRadiusScale.range=this.radiusScale.range}getDatumIdFromData(datum){var _a201,_b,_c;const{calloutLabelKey,sectorLabelKey,legendItemKey}=this.properties;if((_c=(_b=(_a201=this.processedData)==null?void 0:_a201.reduced)==null?void 0:_b.animationValidation)!=null&&_c.uniqueKeys){if(legendItemKey)return datum[legendItemKey];if(calloutLabelKey)return datum[calloutLabelKey];if(sectorLabelKey)return datum[sectorLabelKey]}}getDatumId(datum){var _a201;const{index}=datum;return(_a201=this.getDatumIdFromData(datum.datum))!=null?_a201:`${index}`}onDataChange(){this.processSeriesItemEnabled()}},__name(_a188,"PieSeries"),_a188);PieSeries.className="PieSeries";PieSeries.type="pie";var PieSeriesModule={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"pie",instanceConstructor:PieSeries,seriesDefaults:{},themeTemplate:pieTheme,paletteFactory:piePaletteFactory};function registerInbuiltModules(){registerModule(BackgroundModule),registerModule(NavigatorModule),registerModule(AreaSeriesModule),registerModule(BarSeriesModule),registerModule(BubbleSeriesModule),registerModule(LineSeriesModule),registerModule(ScatterSeriesModule),registerModule(DonutSeriesModule),registerModule(PieSeriesModule),registerModule(HistogramSeriesModule),new Map([[NumberAxis.type,NumberAxis],[CategoryAxis.type,CategoryAxis],[TimeAxis.type,TimeAxis],[GroupedCategoryAxis.type,GroupedCategoryAxis],[LogAxis.type,LogAxis]]).forEach((impl,type)=>{registerAxis(type,impl)}),registerLegend("category","legend",Legend,void 0)}__name(registerInbuiltModules,"registerInbuiltModules");function setupModules(){for(const m of REGISTERED_MODULES){if(m.packageType==="enterprise"&&!verifyIfModuleExpected(m)&&Logger.errorOnce("Unexpected enterprise module registered: "+m.identifier),m.type==="root"&&m.themeTemplate)for(const chartType2 of m.chartTypes)registerChartDefaults(chartType2,m.themeTemplate);if(m.type==="series"){if(m.chartTypes.length>1)throw new Error(`AG Charts - Module definition error: ${m.identifier}`);registerSeries(m)}if(m.type==="series-option"&&m.themeTemplate)for(const seriesType of m.seriesTypes)registerSeriesThemeTemplate(seriesType,m.themeTemplate);if(m.type==="axis-option"&&m.themeTemplate)for(const axisType of m.axisTypes){const axisTypeTheme=m.themeTemplate[axisType],theme=__spreadValues(__spreadValues({},m.themeTemplate),axisTypeTheme);for(const axisType2 of m.axisTypes)delete theme[axisType2];registerAxisThemeTemplate(axisType,theme)}m.type==="axis"&&(registerAxis(m.identifier,m.instanceConstructor),m.themeTemplate&&registerAxisThemeTemplate(m.identifier,m.themeTemplate)),m.type==="legend"&&registerLegend(m.identifier,m.optionsKey,m.instanceConstructor,m.themeTemplate)}if(hasRegisteredEnterpriseModules()){const expectedButUnused=getUnusedExpectedModules();expectedButUnused.length>0&&Logger.errorOnce("Enterprise modules expected but not registered: ",expectedButUnused)}}__name(setupModules,"setupModules");var _a189,_HierarchyChart=(_a189=class extends Chart{constructor(options,resources){super(options,resources),this._data={}}performLayout(){return __async(this,null,function*(){const shrinkRect=yield __superGet(_a189.prototype,this,"performLayout").call(this),{seriesArea:{padding},seriesRoot}=this,fullSeriesRect=shrinkRect.clone();return shrinkRect.shrink(padding.left,"left"),shrinkRect.shrink(padding.top,"top"),shrinkRect.shrink(padding.right,"right"),shrinkRect.shrink(padding.bottom,"bottom"),this.seriesRect=shrinkRect,this.animationRect=shrinkRect,this.hoverRect=shrinkRect,seriesRoot.translationX=Math.floor(shrinkRect.x),seriesRoot.translationY=Math.floor(shrinkRect.y),yield Promise.all(this.series.map(series=>__async(this,null,function*(){yield series.update({seriesRect:shrinkRect})}))),seriesRoot.visible=this.series[0].visible,seriesRoot.setClipRectInGroupCoordinateSpace(new BBox(shrinkRect.x,shrinkRect.y,shrinkRect.width,shrinkRect.height)),this.layoutService.dispatchLayoutComplete({type:"layout-complete",chart:{width:this.scene.width,height:this.scene.height},clipSeries:!1,series:{rect:fullSeriesRect,paddedRect:shrinkRect,visible:!0},axes:[]}),shrinkRect})}},__name(_a189,"_HierarchyChart"),_a189);_HierarchyChart.className="HierarchyChart";_HierarchyChart.type="hierarchy";var HierarchyChart=_HierarchyChart,_a190,PolarAxis=(_a190=class extends Axis{constructor(){super(...arguments),this.shape="polygon",this.innerRadiusRatio=0,this.defaultTickMinSpacing=20}computeLabelsBBox(_options,_seriesRect){return null}},__name(_a190,"PolarAxis"),_a190);__decorateClass([Validate(UNION(["polygon","circle"],"a polar axis shape"))],PolarAxis.prototype,"shape",2);__decorateClass([Validate(RATIO)],PolarAxis.prototype,"innerRadiusRatio",2);var _a191,_PolarChart=(_a191=class extends Chart{constructor(options,resources){super(options,resources),this.padding=new Padding(40),this.axisGroup.zIndex=5}performLayout(){return __async(this,null,function*(){const shrinkRect=yield __superGet(_a191.prototype,this,"performLayout").call(this),fullSeriesRect=shrinkRect.clone();return this.computeSeriesRect(shrinkRect),yield this.computeCircle(shrinkRect),this.axes.forEach(axis=>axis.update()),this.hoverRect=shrinkRect,this.layoutService.dispatchLayoutComplete({type:"layout-complete",chart:{width:this.scene.width,height:this.scene.height},clipSeries:!1,series:{rect:fullSeriesRect,paddedRect:shrinkRect,visible:!0},axes:[]}),shrinkRect})}updateAxes(cx,cy,radius){var _a201,_b;const angleAxis=this.axes.find(axis=>axis.direction==="x"),radiusAxis=this.axes.find(axis=>axis.direction==="y");if(!(angleAxis instanceof PolarAxis)||!(radiusAxis instanceof PolarAxis))return;const angleScale=angleAxis.scale,angles=(_a201=angleScale.ticks)==null?void 0:_a201.call(angleScale).map(value=>angleScale.convert(value)),innerRadiusRatio=radiusAxis.innerRadiusRatio;angleAxis.innerRadiusRatio=innerRadiusRatio,(_b=angleAxis.computeRange)==null||_b.call(angleAxis),angleAxis.gridLength=radius,radiusAxis.gridAngles=angles,radiusAxis.gridRange=angleAxis.range,radiusAxis.range=[radius,radius*innerRadiusRatio],[angleAxis,radiusAxis].forEach(axis=>{axis.translation.x=cx,axis.translation.y=cy,axis.calculateLayout()})}computeSeriesRect(shrinkRect){const{seriesArea:{padding}}=this;shrinkRect.shrink(padding.left,"left"),shrinkRect.shrink(padding.top,"top"),shrinkRect.shrink(padding.right,"right"),shrinkRect.shrink(padding.bottom,"bottom"),this.seriesRect=shrinkRect,this.animationRect=shrinkRect}computeCircle(seriesBox){return __async(this,null,function*(){const polarSeries=this.series.filter(series=>series instanceof PolarSeries),polarAxes=this.axes.filter(axis=>axis instanceof PolarAxis),setSeriesCircle=__name((cx,cy,r)=>{this.updateAxes(cx,cy,r),polarSeries.forEach(series=>{series.centerX=cx,series.centerY=cy,series.radius=r});const pieSeries=polarSeries.filter(s=>s instanceof PieSeries||s instanceof DonutSeries);if(pieSeries.length>1){const innerRadii=pieSeries.map(series=>{const innerRadius=series.getInnerRadius();return{series,innerRadius}}).sort((a,b)=>a.innerRadius-b.innerRadius);innerRadii.at(-1).series.surroundingRadius=void 0;for(let i=0;i<innerRadii.length-1;i++)innerRadii[i].series.surroundingRadius=innerRadii[i+1].innerRadius}},"setSeriesCircle"),centerX=seriesBox.x+seriesBox.width/2,centerY=seriesBox.y+seriesBox.height/2,initialRadius=Math.max(0,Math.min(seriesBox.width,seriesBox.height)/2);let radius=initialRadius;setSeriesCircle(centerX,centerY,radius);const shake=__name((..._0)=>__async(this,[..._0],function*({hideWhenNecessary=!1}={}){const labelBoxes=[];for(const series of[...polarAxes,...polarSeries]){const box=yield series.computeLabelsBBox({hideWhenNecessary},seriesBox);box&&labelBoxes.push(box)}if(labelBoxes.length===0){setSeriesCircle(centerX,centerY,initialRadius);return}const labelBox=BBox.merge(labelBoxes),refined=this.refineCircle(labelBox,radius,seriesBox);setSeriesCircle(refined.centerX,refined.centerY,refined.radius),refined.radius!==radius&&(radius=refined.radius)}),"shake");return yield shake(),yield shake(),yield shake(),yield shake({hideWhenNecessary:!0}),yield shake({hideWhenNecessary:!0}),{radius,centerX,centerY}})}refineCircle(labelsBox,radius,seriesBox){const circleLeft=-radius,circleTop=-radius,circleRight=radius,circleBottom=radius;let padLeft=Math.max(0,circleLeft-labelsBox.x),padTop=Math.max(0,circleTop-labelsBox.y),padRight=Math.max(0,labelsBox.x+labelsBox.width-circleRight),padBottom=Math.max(0,labelsBox.y+labelsBox.height-circleBottom);padLeft=padRight=Math.max(padLeft,padRight),padTop=padBottom=Math.max(padTop,padBottom);const availCircleWidth=seriesBox.width-padLeft-padRight,availCircleHeight=seriesBox.height-padTop-padBottom;let newRadius=Math.min(availCircleWidth,availCircleHeight)/2;const minHorizontalRadius=.5*seriesBox.width/2,minVerticalRadius=.5*seriesBox.height/2,minRadius=Math.min(minHorizontalRadius,minVerticalRadius);if(newRadius<minRadius){newRadius=minRadius;const horizontalPadding=padLeft+padRight,verticalPadding=padTop+padBottom;if(2*newRadius+verticalPadding>seriesBox.height){const padHeight=seriesBox.height-2*newRadius;Math.min(padTop,padBottom)*2>padHeight?(padTop=padHeight/2,padBottom=padHeight/2):padTop>padBottom?padTop=padHeight-padBottom:padBottom=padHeight-padTop}if(2*newRadius+horizontalPadding>seriesBox.width){const padWidth=seriesBox.width-2*newRadius;Math.min(padLeft,padRight)*2>padWidth?(padLeft=padWidth/2,padRight=padWidth/2):padLeft>padRight?padLeft=padWidth-padRight:padRight=padWidth-padLeft}}const newWidth=padLeft+2*newRadius+padRight,newHeight=padTop+2*newRadius+padBottom;return{centerX:seriesBox.x+(seriesBox.width-newWidth)/2+padLeft+newRadius,centerY:seriesBox.y+(seriesBox.height-newHeight)/2+padTop+newRadius,radius:newRadius}}},__name(_a191,"_PolarChart"),_a191);_PolarChart.className="PolarChart";_PolarChart.type="polar";var PolarChart=_PolarChart,debug2=Debug.create(!0,"opts");function chartType(options){if(isAgCartesianChartOptions(options))return"cartesian";if(isAgPolarChartOptions(options))return"polar";if(isAgHierarchyChartOptions(options))return"hierarchy";throw new Error(`AG Chart - unknown type of chart for options with type: ${options.type}`)}__name(chartType,"chartType");var _a192,_AgCharts=(_a192=class{static licenseCheck(options){var _a201,_b,_c,_d;this.licenseChecked||(this.licenseManager=(_b=(_a201=enterpriseModule).licenseManager)==null?void 0:_b.call(_a201,options),(_c=this.licenseManager)==null||_c.setLicenseKey(this.licenseKey,this.gridContext),(_d=this.licenseManager)==null||_d.validateLicense(),this.licenseChecked=!0)}static setLicenseKey(licenseKey){this.licenseKey=licenseKey}static setGridContext(gridContext){this.gridContext=gridContext}static getLicenseDetails(licenseKey){var _a201,_b;return(_b=(_a201=enterpriseModule).licenseManager)==null?void 0:_b.call(_a201,{}).getLicenseDetails(licenseKey)}static getInstance(element2){return AgChartsInternal.getInstance(element2)}static create(options){var _a201,_b,_c,_d;this.licenseCheck(options);const chart=AgChartsInternal.createOrUpdate(options);return(_a201=this.licenseManager)!=null&&_a201.isDisplayWatermark()&&((_d=(_c=enterpriseModule).injectWatermark)==null||_d.call(_c,(_b=options.document)!=null?_b:document,chart.chart.element,this.licenseManager.getWatermarkMessage())),chart}static update(chart,options){if(!AgChartInstanceProxy.isInstance(chart))throw new Error(_a192.INVALID_CHART_REF_MESSAGE);AgChartsInternal.createOrUpdate(options,chart)}static updateDelta(chart,deltaOptions){if(!AgChartInstanceProxy.isInstance(chart))throw new Error(_a192.INVALID_CHART_REF_MESSAGE);AgChartsInternal.updateUserDelta(chart,deltaOptions)}static download(chart,options){if(!(chart instanceof AgChartInstanceProxy))throw new Error(_a192.INVALID_CHART_REF_MESSAGE);AgChartsInternal.download(chart,options)}static getImageDataURL(chart,options){if(!(chart instanceof AgChartInstanceProxy))throw new Error(_a192.INVALID_CHART_REF_MESSAGE);return AgChartsInternal.getImageDataURL(chart,options)}},__name(_a192,"_AgCharts"),_a192);_AgCharts.INVALID_CHART_REF_MESSAGE="AG Charts - invalid chart reference passed";_AgCharts.licenseChecked=!1;_AgCharts.gridContext=!1;var AgCharts=_AgCharts,_a193,_AgChartsInternal=(_a193=class{static getInstance(element2){const chart=Chart.getInstance(element2);return chart!=null?AgChartInstanceProxy.chartInstances.get(chart):void 0}static initialiseModules(){_a193.initialised||(registerInbuiltModules(),setupModules(),_a193.initialised=!0)}static createOrUpdate(options,proxy){var _b;_a193.initialiseModules(),debug2(">>> AgChartV2.createOrUpdate() user options",options);const _a201=options,{overrideDevicePixelRatio,document:document2,window:userWindow}=_a201,userOptions=__objRest(_a201,["overrideDevicePixelRatio","document","window"]),chartOptions=new ChartOptions(userOptions,{overrideDevicePixelRatio,document:document2,window:userWindow});let chart=proxy==null?void 0:proxy.chart;return(chart==null||chartType(userOptions)!==chartType(chart.processedOptions))&&(chart=_a193.createChartInstance(chartOptions,chart)),proxy==null?proxy=new AgChartInstanceProxy(chart):proxy.chart=chart,debug2.check()&&typeof window<"u"&&((_b=window.agChartInstances)!=null||(window.agChartInstances={}),window.agChartInstances[chart.id]=chart),chart.queuedUserOptions.push(userOptions),chart.requestFactoryUpdate(chart2=>{chart2.applyOptions(chartOptions),chart2.queuedUserOptions.splice(0,chart2.queuedUserOptions.indexOf(userOptions))}),proxy}static updateUserDelta(proxy,deltaOptions){deltaOptions=deepClone(deltaOptions,{shallow:["data"]}),jsonWalk(deltaOptions,node=>{if(typeof node=="object")for(const[key,value]of Object.entries(node))typeof value>"u"&&Object.assign(node,{[key]:Symbol("UNSET")})},{skip:["data"]});const{chart}=proxy,lastUpdateOptions=chart.getOptions(),userOptions=mergeDefaults(deltaOptions,lastUpdateOptions);debug2(">>> AgChartV2.updateUserDelta() user delta",deltaOptions),debug2("AgChartV2.updateUserDelta() - base options",lastUpdateOptions),_a193.createOrUpdate(userOptions,proxy)}static download(proxy,opts){return __async(this,null,function*(){try{const clone=yield _a193.prepareResizedChart(proxy,opts);clone.chart.scene.download(opts==null?void 0:opts.fileName,opts==null?void 0:opts.fileFormat),clone.destroy()}catch(error){Logger.errorOnce(error)}})}static getImageDataURL(proxy,opts){return __async(this,null,function*(){const clone=yield _a193.prepareResizedChart(proxy,opts),{canvas}=clone.chart.scene,result=canvas.getDataURL(opts==null?void 0:opts.fileFormat);return clone.destroy(),result})}static prepareResizedChart(_0){return __async(this,arguments,function*(chartProxy,opts={}){const{chart}=chartProxy,{width=chart.width,height=chart.height}=opts,options=mergeDefaults({container:document.createElement("div"),overrideDevicePixelRatio:1,autoSize:!1,width,height},hasRegisteredEnterpriseModules()&&{animation:{enabled:!1}},chart.userOptions),cloneProxy=_a193.createOrUpdate(options);return cloneProxy.chart.zoomManager.updateZoom(chartProxy.chart.zoomManager.getZoom()),chartProxy.chart.series.forEach((series,index)=>{series.visible!==!0&&(cloneProxy.chart.series[index].visible=series.visible)}),chartProxy.chart.update(0,{forceNodeDataRefresh:!0}),yield cloneProxy.chart.waitForUpdate(),cloneProxy})}static createChartInstance(options,oldChart){const transferableResource=oldChart==null?void 0:oldChart.destroy({keepTransferableResources:!0}),ChartConstructor=_a193.getChartByOptions(options.processedOptions);return new ChartConstructor(options,transferableResource)}static getChartByOptions(options){if(isAgCartesianChartOptions(options))return CartesianChart;if(isAgHierarchyChartOptions(options))return HierarchyChart;if(isAgPolarChartOptions(options))return PolarChart;throw new Error("AG Charts - couldn't apply configuration, check options are correctly structured and series types are specified")}},__name(_a193,"_AgChartsInternal"),_a193);_AgChartsInternal.initialised=!1;var AgChartsInternal=_AgChartsInternal,integrated_charts_scene_exports={};__export(integrated_charts_scene_exports,{Arc:()=>Arc,BBox:()=>BBox,BandScale:()=>BandScale,Caption:()=>Caption,Circle:()=>Circle,ContinuousScale:()=>ContinuousScale,Diamond:()=>Diamond,DropShadow:()=>DropShadow,Group:()=>Group,HdpiCanvas:()=>HdpiCanvas,Image:()=>Image,Label:()=>Label,Line:()=>Line,LinearGradientFill:()=>LinearGradientFill,LinearScale:()=>LinearScale,Marker:()=>Marker,Node:()=>Node,Path:()=>Path,Path2D:()=>Path2D,PointerEvents:()=>PointerEvents,RadialColumnShape:()=>RadialColumnShape,Rect:()=>Rect,RedrawType:()=>RedrawType,Scene:()=>Scene,SceneChangeDetection:()=>SceneChangeDetection,ScenePathChangeDetection:()=>ScenePathChangeDetection,Sector:()=>Sector,Selection:()=>Selection,Shape:()=>Shape,Square:()=>Square,Text:()=>Text,Tooltip:()=>Tooltip,Triangle:()=>Triangle,easing:()=>easing_exports,getFont:()=>getFont,getMarker:()=>getMarker,getRadialColumnWidth:()=>getRadialColumnWidth,motion:()=>motion,nearestSquared:()=>nearestSquared,nearestSquaredInContainer:()=>nearestSquaredInContainer,toRadians:()=>toRadians,toTooltipHtml:()=>toTooltipHtml});var _a194,Arc=(_a194=class extends Path{constructor(){super(),this.centerX=0,this.centerY=0,this.radius=10,this.startAngle=0,this.endAngle=Math.PI*2,this.counterClockwise=!1,this.type=0,this.restoreOwnStyles()}get fullPie(){return isEqual(normalizeAngle360(this.startAngle),normalizeAngle360(this.endAngle))}updatePath(){const path=this.path;path.clear(),path.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,this.counterClockwise),this.type===1?path.closePath():this.type===2&&!this.fullPie&&(path.lineTo(this.centerX,this.centerY),path.closePath())}computeBBox(){return new BBox(this.centerX-this.radius,this.centerY-this.radius,this.radius*2,this.radius*2)}isPointInPath(x,y){const point=this.transformPoint(x,y),bbox=this.computeBBox();return this.type!==0&&bbox.containsPoint(point.x,point.y)&&this.path.isPointInPath(point.x,point.y)}},__name(_a194,"Arc"),_a194);Arc.className="Arc";Arc.defaultStyles=Object.assign({},Shape.defaultStyles,{lineWidth:1,fillStyle:null});__decorateClass([ScenePathChangeDetection()],Arc.prototype,"centerX",2);__decorateClass([ScenePathChangeDetection()],Arc.prototype,"centerY",2);__decorateClass([ScenePathChangeDetection()],Arc.prototype,"radius",2);__decorateClass([ScenePathChangeDetection()],Arc.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],Arc.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],Arc.prototype,"counterClockwise",2);__decorateClass([ScenePathChangeDetection()],Arc.prototype,"type",2);var _a195,LinearGradientFill=(_a195=class extends Shape{constructor(){super(...arguments),this.direction="to-right",this.stops=void 0,this._mask=void 0}get mask(){return this._mask}set mask(newMask){this._mask!=null&&this.removeChild(this._mask),newMask!=null&&this.appendChild(newMask),this._mask=newMask}isPointInPath(x,y){var _a201,_b;return(_b=(_a201=this.mask)==null?void 0:_a201.isPointInPath(x,y))!=null?_b:!1}computeBBox(){var _a201;return(_a201=this.mask)==null?void 0:_a201.computeBBox()}render(renderCtx){const{mask,stops}=this,{ctx,devicePixelRatio}=renderCtx,pixelLength=1/devicePixelRatio,maskBbox=mask==null?void 0:mask.computeTransformedBBox();if(mask==null||stops==null||maskBbox==null)return;mask.dirtyPath&&(mask.updatePath(),mask.dirtyPath=!1),ctx.save(),ctx.beginPath(),mask.path.draw(ctx),ctx.clip(),ctx.resetTransform();const x0=Math.floor(maskBbox.x),x1=Math.ceil(maskBbox.x+maskBbox.width),y0=Math.floor(maskBbox.y),y1=Math.ceil(maskBbox.y+maskBbox.height),colorScale=new ColorScale,[i0,i1]=this.direction==="to-right"?[x0,x1]:[y0,y1];if(colorScale.domain=stops.map((_,index)=>i0+(i1-i0)*index/(stops.length-1)),colorScale.range=stops,colorScale.update(),this.direction==="to-right"){const height=y1-y0;for(let x=x0;x<=x1;x+=pixelLength)ctx.fillStyle=colorScale.convert(x),ctx.fillRect(x,y0,pixelLength,height)}else{const width=x1-x0;for(let y=y0;y<=y1;y+=pixelLength)ctx.fillStyle=colorScale.convert(y),ctx.fillRect(x0,y,width,pixelLength)}ctx.restore()}},__name(_a195,"LinearGradientFill"),_a195);__decorateClass([SceneChangeDetection({redraw:3})],LinearGradientFill.prototype,"direction",2);__decorateClass([SceneChangeDetection({redraw:3})],LinearGradientFill.prototype,"stops",2);__decorateClass([SceneChangeDetection({redraw:3})],LinearGradientFill.prototype,"_mask",2);function rotatePoint(x,y,rotation){const radius=Math.sqrt(__pow(x,2)+__pow(y,2)),rotated=Math.atan2(y,x)+rotation;return{x:Math.cos(rotated)*radius,y:Math.sin(rotated)*radius}}__name(rotatePoint,"rotatePoint");var _a196,RadialColumnShape=(_a196=class extends Path{constructor(){super(...arguments),this.borderPath=new Path2D,this.isBeveled=!0,this.columnWidth=0,this.startAngle=0,this.endAngle=0,this.outerRadius=0,this.innerRadius=0,this.axisInnerRadius=0,this.axisOuterRadius=0,this.isRadiusAxisReversed=!1}getRotation(){const{startAngle,endAngle}=this,midAngle=angleBetween(startAngle,endAngle);return normalizeAngle360(startAngle+midAngle/2+Math.PI/2)}updatePath(){const{isBeveled}=this;isBeveled?this.updateBeveledPath():this.updateRectangularPath(),this.checkPathDirty()}updateRectangularPath(){const{columnWidth,innerRadius,outerRadius,path}=this,left=-columnWidth/2,right=columnWidth/2,top=-outerRadius,bottom=-innerRadius,rotation=this.getRotation(),points=[[left,bottom],[left,top],[right,top],[right,bottom],[left,bottom]].map(([x,y])=>rotatePoint(x,y,rotation));path.clear({trackChanges:!0}),path.moveTo(points[0].x,points[0].y),path.lineTo(points[1].x,points[1].y),path.lineTo(points[2].x,points[2].y),path.lineTo(points[3].x,points[3].y),path.lineTo(points[0].x,points[0].y),path.closePath()}updateBeveledPath(){const{columnWidth,path,outerRadius,innerRadius,axisInnerRadius,axisOuterRadius,isRadiusAxisReversed}=this,isStackBottom=isEqual(innerRadius,axisInnerRadius),sideRotation=Math.asin(columnWidth/2/innerRadius),pointRotation=this.getRotation(),rotate=__name((x,y)=>rotatePoint(x,y,pointRotation),"rotate"),getTriangleHypotenuse=__name((leg,otherLeg)=>Math.sqrt(__pow(leg,2)+__pow(otherLeg,2)),"getTriangleHypotenuse"),getTriangleLeg=__name((hypotenuse,otherLeg)=>otherLeg>hypotenuse?0:Math.sqrt(__pow(hypotenuse,2)-__pow(otherLeg,2)),"getTriangleLeg"),compare=__name((value,otherValue,lessThan)=>lessThan?value<otherValue:value>otherValue,"compare"),shouldConnectBottomCircle=isStackBottom&&!isNaN(sideRotation)&&sideRotation<Math.PI/6;let left=-columnWidth/2,right=columnWidth/2;const top=-outerRadius,bottom=-innerRadius*(shouldConnectBottomCircle?Math.cos(sideRotation):1),hasBottomIntersection=compare(axisOuterRadius,getTriangleHypotenuse(innerRadius,columnWidth/2),!isRadiusAxisReversed);if(hasBottomIntersection){const bottomIntersectionX=getTriangleLeg(axisOuterRadius,innerRadius);left=-bottomIntersectionX,right=bottomIntersectionX}path.clear({trackChanges:!0});const bottomLeftPt=rotate(left,bottom);path.moveTo(bottomLeftPt.x,bottomLeftPt.y);const isEmpty=isEqual(innerRadius,outerRadius),hasSideIntersection=compare(axisOuterRadius,getTriangleHypotenuse(outerRadius,columnWidth/2),!isRadiusAxisReversed);if(isEmpty&&shouldConnectBottomCircle)path.arc(0,0,innerRadius,normalizeAngle360(-sideRotation-Math.PI/2)+pointRotation,normalizeAngle360(sideRotation-Math.PI/2)+pointRotation,!1);else if(hasSideIntersection){const sideIntersectionY=-getTriangleLeg(axisOuterRadius,columnWidth/2),topIntersectionX=getTriangleLeg(axisOuterRadius,outerRadius);if(!hasBottomIntersection){const topLeftPt=rotate(left,sideIntersectionY);path.lineTo(topLeftPt.x,topLeftPt.y)}if(path.arc(0,0,axisOuterRadius,Math.atan2(sideIntersectionY,left)+pointRotation,Math.atan2(top,-topIntersectionX)+pointRotation,!1),!isEqual(topIntersectionX,0)){const topRightBevelPt=rotate(topIntersectionX,top);path.lineTo(topRightBevelPt.x,topRightBevelPt.y)}path.arc(0,0,axisOuterRadius,Math.atan2(top,topIntersectionX)+pointRotation,Math.atan2(sideIntersectionY,right)+pointRotation,!1)}else{const topLeftPt=rotate(left,top),topRightPt=rotate(right,top);path.lineTo(topLeftPt.x,topLeftPt.y),path.lineTo(topRightPt.x,topRightPt.y)}const bottomRightPt=rotate(right,bottom);if(path.lineTo(bottomRightPt.x,bottomRightPt.y),shouldConnectBottomCircle)path.arc(0,0,innerRadius,normalizeAngle360(sideRotation-Math.PI/2)+pointRotation,normalizeAngle360(-sideRotation-Math.PI/2)+pointRotation,!0);else{const bottomLeftPt2=rotate(left,bottom);path.lineTo(bottomLeftPt2.x,bottomLeftPt2.y)}path.closePath()}},__name(_a196,"RadialColumnShape"),_a196);RadialColumnShape.className="RadialColumnShape";__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"isBeveled",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"columnWidth",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"startAngle",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"endAngle",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"outerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"innerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"axisInnerRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"axisOuterRadius",2);__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"isRadiusAxisReversed",2);function getRadialColumnWidth(startAngle,endAngle,axisOuterRadius,columnWidthRatio,maxColumnWidthRatio){const rotation=angleBetween(startAngle,endAngle),pad2=rotation*(1-columnWidthRatio)/2;if(startAngle+=pad2,endAngle-=pad2,rotation<.001)return 2*axisOuterRadius*maxColumnWidthRatio;if(rotation>=2*Math.PI){const midAngle=startAngle+rotation/2;startAngle=midAngle-Math.PI,endAngle=midAngle+Math.PI}const startX=axisOuterRadius*Math.cos(startAngle),startY=axisOuterRadius*Math.sin(startAngle),endX=axisOuterRadius*Math.cos(endAngle),endY=axisOuterRadius*Math.sin(endAngle),colWidth=Math.floor(Math.sqrt(__pow(startX-endX,2)+__pow(startY-endY,2))),maxWidth=2*axisOuterRadius*maxColumnWidthRatio;return Math.max(1,Math.min(maxWidth,colWidth))}__name(getRadialColumnWidth,"getRadialColumnWidth");var _a197,Image=(_a197=class extends Node{constructor(sourceImage){super(),this.x=0,this.y=0,this.width=0,this.height=0,this.opacity=1,this.sourceImage=sourceImage}render(renderCtx){const{ctx,forceRender,stats}=renderCtx;if(this.dirty===0&&!forceRender){stats&&stats.nodesSkipped++;return}this.computeTransformMatrix(),this.matrix.toContext(ctx);const image=this.sourceImage;ctx.globalAlpha=this.opacity,ctx.drawImage(image,0,0,image.width,image.height,this.x,this.y,this.width,this.height),super.render(renderCtx)}},__name(_a197,"Image"),_a197);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"x",2);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"y",2);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"width",2);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"height",2);__decorateClass([SceneChangeDetection({redraw:3})],Image.prototype,"opacity",2);var motion=__spreadValues(__spreadValues({},fromToMotion_exports),resetMotion_exports),integrated_charts_theme_exports={};__export(integrated_charts_theme_exports,{CARTESIAN_AXIS_TYPE:()=>CARTESIAN_AXIS_TYPE,ChartTheme:()=>ChartTheme,DEFAULT_AXIS_GRID_COLOUR:()=>DEFAULT_AXIS_GRID_COLOUR,DEFAULT_AXIS_LINE_COLOUR:()=>DEFAULT_AXIS_LINE_COLOUR,DEFAULT_BACKGROUND_COLOUR:()=>DEFAULT_BACKGROUND_COLOUR,DEFAULT_CROSS_LINES_COLOUR:()=>DEFAULT_CROSS_LINES_COLOUR,DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:()=>DEFAULT_DIVERGING_SERIES_COLOUR_RANGE,DEFAULT_FONT_FAMILY:()=>DEFAULT_FONT_FAMILY,DEFAULT_HIERARCHY_FILLS:()=>DEFAULT_HIERARCHY_FILLS,DEFAULT_HIERARCHY_STROKES:()=>DEFAULT_HIERARCHY_STROKES,DEFAULT_INSIDE_SERIES_LABEL_COLOUR:()=>DEFAULT_INSIDE_SERIES_LABEL_COLOUR,DEFAULT_INVERTED_LABEL_COLOUR:()=>DEFAULT_INVERTED_LABEL_COLOUR,DEFAULT_LABEL_COLOUR:()=>DEFAULT_LABEL_COLOUR,DEFAULT_MUTED_LABEL_COLOUR:()=>DEFAULT_MUTED_LABEL_COLOUR,DEFAULT_POLAR_SERIES_STROKE:()=>DEFAULT_POLAR_SERIES_STROKE,DEFAULT_SHADOW_COLOUR:()=>DEFAULT_SHADOW_COLOUR,DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE:()=>DEFAULT_WATERFALL_SERIES_CONNECTOR_LINE_STROKE,DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS:()=>DEFAULT_WATERFALL_SERIES_NEGATIVE_COLOURS,DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS:()=>DEFAULT_WATERFALL_SERIES_POSITIVE_COLOURS,DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS:()=>DEFAULT_WATERFALL_SERIES_TOTAL_COLOURS,EXTENDS_AXES_DEFAULTS:()=>EXTENDS_AXES_DEFAULTS,EXTENDS_AXES_GRID_LINE_DEFAULTS:()=>EXTENDS_AXES_GRID_LINE_DEFAULTS,EXTENDS_AXES_LABEL_DEFAULTS:()=>EXTENDS_AXES_LABEL_DEFAULTS,EXTENDS_AXES_LINE_DEFAULTS:()=>EXTENDS_AXES_LINE_DEFAULTS,EXTENDS_AXES_TICK_DEFAULTS:()=>EXTENDS_AXES_TICK_DEFAULTS,EXTENDS_CARTESIAN_MARKER_DEFAULTS:()=>EXTENDS_CARTESIAN_MARKER_DEFAULTS,EXTENDS_CHART_DEFAULTS:()=>EXTENDS_CHART_DEFAULTS,EXTENDS_LEGEND_DEFAULTS:()=>EXTENDS_LEGEND_DEFAULTS,EXTENDS_LEGEND_ITEM_DEFAULTS:()=>EXTENDS_LEGEND_ITEM_DEFAULTS,EXTENDS_LEGEND_ITEM_MARKER_DEFAULTS:()=>EXTENDS_LEGEND_ITEM_MARKER_DEFAULTS,EXTENDS_SERIES_DEFAULTS:()=>EXTENDS_SERIES_DEFAULTS,FONT_SIZE:()=>FONT_SIZE,FONT_WEIGHT:()=>FONT_WEIGHT,IS_DARK_THEME:()=>IS_DARK_THEME,OVERRIDE_SERIES_LABEL_DEFAULTS:()=>OVERRIDE_SERIES_LABEL_DEFAULTS,POLAR_AXIS_SHAPE:()=>POLAR_AXIS_SHAPE,POLAR_AXIS_TYPE:()=>POLAR_AXIS_TYPE,POSITION:()=>POSITION,getChartTheme:()=>getChartTheme,themes:()=>themes2});var themes2=Object.entries(themes).reduce((obj,[name,factory])=>(obj[name]=factory(),obj),{}),sparklines_scale_exports={};__export(sparklines_scale_exports,{BandScale:()=>BandScale,ColorScale:()=>ColorScale,ContinuousScale:()=>ContinuousScale,Invalidating:()=>Invalidating,LinearScale:()=>LinearScale,TimeScale:()=>TimeScale});var sparklines_util_exports={};__export(sparklines_util_exports,{Color:()=>Color,Logger:()=>Logger,Padding:()=>Padding,angleBetween:()=>angleBetween,checkDatum:()=>checkDatum,clamp:()=>clamp,clampArray:()=>clampArray,countFractionDigits:()=>countFractionDigits,createId:()=>createId,deepClone:()=>deepClone,extent:()=>extent,findMinMax:()=>findMinMax,findRangeExtent:()=>findRangeExtent,isContinuous:()=>isContinuous,isDate:()=>isValidDate,isEqual:()=>isEqual,isNegative:()=>isNegative,isNumber:()=>isFiniteNumber,isNumberEqual:()=>isEqual,isString:()=>isString,isStringObject:()=>isStringObject,jsonApply:()=>jsonApply,jsonDiff:()=>jsonDiff,jsonWalk:()=>jsonWalk,mod:()=>mod,normalisedExtent:()=>normalisedExtent,normalisedExtentWithMetadata:()=>normalisedExtentWithMetadata,normalizeAngle180:()=>normalizeAngle180,normalizeAngle360:()=>normalizeAngle360,normalizeAngle360Inclusive:()=>normalizeAngle360Inclusive,range:()=>range,resetIds:()=>resetIds,round:()=>round,sanitizeHtml:()=>sanitizeHtml,shallowClone:()=>shallowClone,tickFormat:()=>tickFormat,tickStep:()=>tickStep,ticks:()=>ticks_default,toDegrees:()=>toDegrees,toFixed:()=>toFixed,toRadians:()=>toRadians,transformIntegratedCategoryValue:()=>transformIntegratedCategoryValue,zipObject:()=>zipObject});var module_support_exports={};__export(module_support_exports,{ADD_PHASE:()=>ADD_PHASE,AGG_VALUES_EXTENT:()=>AGG_VALUES_EXTENT,AND:()=>AND,ANIMATION_PHASE_ORDER:()=>ANIMATION_PHASE_ORDER,ANIMATION_PHASE_TIMINGS:()=>ANIMATION_PHASE_TIMINGS,ARRAY:()=>ARRAY,ARRAY_OF:()=>ARRAY_OF,AbstractBarSeries:()=>AbstractBarSeries,AbstractBarSeriesProperties:()=>AbstractBarSeriesProperties,ActionOnSet:()=>ActionOnSet,Animation:()=>Animation,AnimationManager:()=>AnimationManager,AreaSeriesTag:()=>AreaSeriesTag,Axis:()=>Axis,AxisLabel:()=>AxisLabel,AxisTick:()=>AxisTick,BOOLEAN:()=>BOOLEAN,BOOLEAN_ARRAY:()=>BOOLEAN_ARRAY,Background:()=>Background,BackgroundModule:()=>BackgroundModule,BaseModuleInstance:()=>BaseModuleInstance,BaseProperties:()=>BaseProperties,COLOR_STRING:()=>COLOR_STRING,COLOR_STRING_ARRAY:()=>COLOR_STRING_ARRAY,CartesianAxis:()=>CartesianAxis,CartesianSeries:()=>CartesianSeries,CartesianSeriesNodeClickEvent:()=>CartesianSeriesNodeClickEvent,CartesianSeriesProperties:()=>CartesianSeriesProperties,CategoryAxis:()=>CategoryAxis,ChartAxisDirection:()=>ChartAxisDirection,ChartEventManager:()=>ChartEventManager,ChartOptions:()=>ChartOptions,ChartUpdateType:()=>ChartUpdateType,ContextMenuRegistry:()=>ContextMenuRegistry,CursorManager:()=>CursorManager,DATE:()=>DATE,DATE_ARRAY:()=>DATE_ARRAY,DATE_OR_DATETIME_MS:()=>DATE_OR_DATETIME_MS,DEGREE:()=>DEGREE,DIRECTION:()=>DIRECTION,DataController:()=>DataController,DataModel:()=>DataModel,DataService:()=>DataService,Default:()=>Default,Deprecated:()=>Deprecated,DeprecatedAndRenamedTo:()=>DeprecatedAndRenamedTo,FONT_STYLE:()=>FONT_STYLE,FONT_WEIGHT:()=>FONT_WEIGHT2,FUNCTION:()=>FUNCTION,GREATER_THAN:()=>GREATER_THAN,GestureDetector:()=>GestureDetector,GroupedCategoryAxis:()=>GroupedCategoryAxis,HierarchyNode:()=>HierarchyNode,HierarchySeries:()=>HierarchySeries,HierarchySeriesProperties:()=>HierarchySeriesProperties,HighlightManager:()=>HighlightManager,HighlightStyle:()=>HighlightStyle,INITIAL_LOAD:()=>INITIAL_LOAD,INTERACTION_RANGE:()=>INTERACTION_RANGE,INTERACTION_TYPES:()=>INTERACTION_TYPES,InteractionManager:()=>InteractionManager,InteractionState:()=>InteractionState,LABEL_PHASE:()=>LABEL_PHASE,LESS_THAN:()=>LESS_THAN,LINE_CAP:()=>LINE_CAP,LINE_DASH:()=>LINE_DASH,LINE_JOIN:()=>LINE_JOIN,Layers:()=>Layers,LayoutService:()=>LayoutService,MATCHING_CROSSLINE_TYPE:()=>MATCHING_CROSSLINE_TYPE,MAX_SPACING:()=>MAX_SPACING,MIN_SPACING:()=>MIN_SPACING,Motion:()=>easing_exports,NAN:()=>NAN,NODE_UPDATE_PHASES:()=>NODE_UPDATE_PHASES,NODE_UPDATE_STATE_TO_PHASE_MAPPING:()=>NODE_UPDATE_STATE_TO_PHASE_MAPPING,NUMBER:()=>NUMBER,NUMBER_ARRAY:()=>NUMBER_ARRAY,NUMBER_OR_NAN:()=>NUMBER_OR_NAN,Navigator:()=>Navigator,NavigatorModule:()=>NavigatorModule,OBJECT:()=>OBJECT,OBJECT_ARRAY:()=>OBJECT_ARRAY,OR:()=>OR,OVERFLOW_STRATEGY:()=>OVERFLOW_STRATEGY,ObserveChanges:()=>ObserveChanges,PLACEMENT:()=>PLACEMENT,POSITION:()=>POSITION2,POSITIVE_NUMBER:()=>POSITIVE_NUMBER,PolarAxis:()=>PolarAxis,PolarSeries:()=>PolarSeries,PropertiesArray:()=>PropertiesArray,ProxyOnWrite:()=>ProxyOnWrite,ProxyProperty:()=>ProxyProperty,ProxyPropertyOnWrite:()=>ProxyPropertyOnWrite,QUICK_TRANSITION:()=>QUICK_TRANSITION,RATIO:()=>RATIO,REGISTERED_MODULES:()=>REGISTERED_MODULES,REMOVE_PHASE:()=>REMOVE_PHASE,RepeatType:()=>RepeatType,SMALLEST_KEY_INTERVAL:()=>SMALLEST_KEY_INTERVAL,SORT_DOMAIN_GROUPS:()=>SORT_DOMAIN_GROUPS,STRING:()=>STRING,STRING_ARRAY:()=>STRING_ARRAY,Series:()=>Series,SeriesGroupingChangedEvent:()=>SeriesGroupingChangedEvent,SeriesItemHighlightStyle:()=>SeriesItemHighlightStyle,SeriesMarker:()=>SeriesMarker,SeriesNodeClickEvent:()=>SeriesNodeClickEvent,SeriesNodePickMode:()=>SeriesNodePickMode,SeriesProperties:()=>SeriesProperties,SeriesTooltip:()=>SeriesTooltip,StateMachine:()=>StateMachine,TEXT_ALIGN:()=>TEXT_ALIGN,TEXT_WRAP:()=>TEXT_WRAP,Tags:()=>Tags,TooltipManager:()=>TooltipManager,UNION:()=>UNION,UPDATE_PHASE:()=>UPDATE_PHASE,UpdateService:()=>UpdateService,VERTICAL_ALIGN:()=>VERTICAL_ALIGN,Validate:()=>Validate,ZoomManager:()=>ZoomManager,__FORCE_MODULE_DETECTION:()=>__FORCE_MODULE_DETECTION2,accumulateGroup:()=>accumulateGroup,accumulatedValue:()=>accumulatedValue,accumulativeValueProperty:()=>accumulativeValueProperty,adjustLabelPlacement:()=>adjustLabelPlacement,animationValidation:()=>animationValidation,area:()=>area,arraysEqual:()=>arraysEqual,assignJsonApplyConstructedArray:()=>assignJsonApplyConstructedArray,average:()=>average,backfillPathPointData:()=>backfillPathPointData,buildResetPathFn:()=>buildResetPathFn,checkCrisp:()=>checkCrisp,circularSliceArray:()=>circularSliceArray,clamp:()=>clamp,clampArray:()=>clampArray,collapsedStartingBarPosition:()=>collapsedStartingBarPosition,count:()=>count,countFractionDigits:()=>countFractionDigits,createDatumId:()=>createDatumId,createDeprecationWarning:()=>createDeprecationWarning,deconstructSelectionsOrNodes:()=>deconstructSelectionsOrNodes,deepClone:()=>deepClone,deepMerge:()=>deepMerge,determinePathStatus:()=>determinePathStatus,diff:()=>diff,enterpriseModule:()=>enterpriseModule,extent:()=>extent,extractDecoratedProperties:()=>extractDecoratedProperties,findMinMax:()=>findMinMax,findRangeExtent:()=>findRangeExtent,fixNumericExtent:()=>fixNumericExtent,fromToMotion:()=>fromToMotion,getMissCount:()=>getMissCount,getPath:()=>getPath,getRectConfig:()=>getRectConfig,groupAccumulativeValueProperty:()=>groupAccumulativeValueProperty,groupAverage:()=>groupAverage,groupBy:()=>groupBy,groupCount:()=>groupCount,groupSum:()=>groupSum,hasRegisteredEnterpriseModules:()=>hasRegisteredEnterpriseModules,injectStyle:()=>injectStyle,invertShapeDirection:()=>invertShapeDirection,isArray:()=>isArray,isBoolean:()=>isBoolean,isDate:()=>isDate,isDecoratedObject:()=>isDecoratedObject,isDefined:()=>isDefined,isEnumKey:()=>isEnumKey,isEnumValue:()=>isEnumValue,isEqual:()=>isEqual,isFiniteNumber:()=>isFiniteNumber,isFunction:()=>isFunction,isHtmlElement:()=>isHtmlElement,isNegative:()=>isNegative,isNumber:()=>isNumber,isObject:()=>isObject,isObjectLike:()=>isObjectLike,isPlainObject:()=>isPlainObject,isProperties:()=>isProperties,isRegExp:()=>isRegExp,isString:()=>isString,isSymbol:()=>isSymbol,isValidDate:()=>isValidDate,jsonApply:()=>jsonApply,jsonDiff:()=>jsonDiff,jsonWalk:()=>jsonWalk,keyProperty:()=>keyProperty,listDecoratedProperties:()=>listDecoratedProperties,mapValues:()=>mapValues,markerFadeInAnimation:()=>markerFadeInAnimation,markerPaletteFactory:()=>markerPaletteFactory,markerScaleInAnimation:()=>markerScaleInAnimation,markerSwipeScaleInAnimation:()=>markerSwipeScaleInAnimation,mergeArrayDefaults:()=>mergeArrayDefaults,mergeDefaults:()=>mergeDefaults,midpointStartingBarPosition:()=>midpointStartingBarPosition,minMax:()=>minMax,mod:()=>mod,normaliseGroupTo:()=>normaliseGroupTo,normalisePropertyTo:()=>normalisePropertyTo,normalisedExtent:()=>normalisedExtent,normalisedExtentWithMetadata:()=>normalisedExtentWithMetadata,pairCategoryData:()=>pairCategoryData,pairContinuousData:()=>pairContinuousData,partialAssign:()=>partialAssign,pathFadeInAnimation:()=>pathFadeInAnimation,pathFadeOutAnimation:()=>pathFadeOutAnimation,pathSwipeInAnimation:()=>pathSwipeInAnimation,predicateWithMessage:()=>predicateWithMessage,prepareAreaPathAnimation:()=>prepareAreaPathAnimation,prepareAxisAnimationContext:()=>prepareAxisAnimationContext,prepareAxisAnimationFunctions:()=>prepareAxisAnimationFunctions,prepareBarAnimationFunctions:()=>prepareBarAnimationFunctions,prepareLinePathAnimation:()=>prepareLinePathAnimation,prepareLinePathAnimationFns:()=>prepareLinePathAnimationFns,prepareMarkerAnimation:()=>prepareMarkerAnimation,range:()=>range2,rangedValueProperty:()=>rangedValueProperty,registerModule:()=>registerModule,renderPartialPath:()=>renderPartialPath,resetAxisGroupFn:()=>resetAxisGroupFn,resetAxisLabelSelectionFn:()=>resetAxisLabelSelectionFn,resetAxisLineSelectionFn:()=>resetAxisLineSelectionFn,resetAxisSelectionFn:()=>resetAxisSelectionFn,resetBarSelectionsFn:()=>resetBarSelectionsFn,resetIds:()=>resetIds,resetLabelFn:()=>resetLabelFn,resetMarkerFn:()=>resetMarkerFn,resetMarkerPositionFn:()=>resetMarkerPositionFn,resetMotion:()=>resetMotion,round:()=>round,seriesLabelFadeInAnimation:()=>seriesLabelFadeInAnimation,seriesLabelFadeOutAnimation:()=>seriesLabelFadeOutAnimation,setPath:()=>setPath,shallowClone:()=>shallowClone,singleSeriesPaletteFactory:()=>singleSeriesPaletteFactory,staticFromToMotion:()=>staticFromToMotion,stringify:()=>stringify,sum:()=>sum,toArray:()=>toArray,toFixed:()=>toFixed,trailingAccumulatedValue:()=>trailingAccumulatedValue,trailingAccumulatedValueProperty:()=>trailingAccumulatedValueProperty,trailingValue:()=>trailingValue,trailingValueProperty:()=>trailingValueProperty,unique:()=>unique,updateClipPath:()=>updateClipPath,updateLabelNode:()=>updateLabelNode,updateRect:()=>updateRect,validateCrossLineValues:()=>validateCrossLineValues,valueProperty:()=>valueProperty});function invertShapeDirection(...supportedShapes){for(const shape of supportedShapes)if(shape instanceof Rect){const{x,y,width,height}=shape;shape.setProperties({x:y,y:x,width:height,height:width})}else if(shape instanceof Line){const{x1,y1,x2,y2}=shape;shape.setProperties({x1:y1,y1:x1,x2:y2,y2:x2})}}__name(invertShapeDirection,"invertShapeDirection");var _a198,_HierarchyNode=(_a198=class{constructor(series,index,datum,size,colorValue,fill,stroke,sumSize,depth,parent,children){this.series=series,this.index=index,this.datum=datum,this.size=size,this.colorValue=colorValue,this.fill=fill,this.stroke=stroke,this.sumSize=sumSize,this.depth=depth,this.parent=parent,this.children=children,this.midPoint={x:0,y:0}}contains(other){let current=other;for(;current!=null&&current.index>=this.index;){if(current===this)return!0;current=current.parent}return!1}walk(callback,order=_a198.Walk.PreOrder){order===_a198.Walk.PreOrder&&callback(this),this.children.forEach(child=>{child.walk(callback,order)}),order===_a198.Walk.PostOrder&&callback(this)}*[Symbol.iterator](){yield this;for(const child of this.children)yield*__yieldStar(child)}},__name(_a198,"_HierarchyNode"),_a198);_HierarchyNode.Walk={PreOrder:0,PostOrder:1};var HierarchyNode=_HierarchyNode,_a199,HierarchySeries=(_a199=class extends Series{constructor(moduleCtx){super({moduleCtx,pickModes:[0],contentGroupVirtual:!1}),this.rootNode=new HierarchyNode(this,0,void 0,0,void 0,void 0,void 0,0,void 0,void 0,[]),this.colorDomain=[0,0],this.maxDepth=0,this.animationState=new StateMachine("empty",{empty:{update:{target:"ready",action:data=>this.animateEmptyUpdateReady(data)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:data=>this.animateReadyHighlight(data),resize:data=>this.animateReadyResize(data),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:data=>this.animateWaitingUpdateReady(data)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:data=>this.animateClearingUpdateEmpty(data)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}resetAnimation(phase){phase==="initial"?this.animationState.transition("reset"):phase==="ready"&&this.animationState.transition("skip")}processData(){return __async(this,null,function*(){var _a201,_b;const{childrenKey,sizeKey,colorKey,fills,strokes,colorRange}=this.properties;let index=0;const getIndex=__name(()=>(index+=1,index),"getIndex");let maxDepth=0,minColor=1/0,maxColor=-1/0;const colors=new Array(((_b=(_a201=this.data)==null?void 0:_a201.length)!=null?_b:0)+1).fill(void 0),createNode=__name((datum,parent)=>{const index2=getIndex(),depth=parent.depth!=null?parent.depth+1:0,children=childrenKey!=null?datum[childrenKey]:void 0,isLeaf=children==null||children.length===0;let size=sizeKey!=null?datum[sizeKey]:void 0;Number.isFinite(size)?size=Math.max(size,0):size=isLeaf?1:0;const sumSize=size;maxDepth=Math.max(maxDepth,depth);const color=colorKey!=null?datum[colorKey]:void 0;return typeof color=="number"&&(colors[index2]=color,minColor=Math.min(minColor,color),maxColor=Math.max(maxColor,color)),appendChildren(new HierarchyNode(this,index2,datum,size,color,void 0,void 0,sumSize,depth,parent,[]),children)},"createNode"),appendChildren=__name((node,data)=>(data==null||data.forEach(datum=>{const child=createNode(datum,node);node.children.push(child),node.sumSize+=child.sumSize}),node),"appendChildren"),rootNode=appendChildren(new HierarchyNode(this,0,void 0,0,void 0,void 0,void 0,0,void 0,void 0,[]),this.data),colorDomain=[minColor,maxColor];let colorScale;colorRange!=null&&Number.isFinite(minColor)&&Number.isFinite(maxColor)&&(colorScale=new ColorScale,colorScale.domain=colorDomain,colorScale.range=colorRange,colorScale.update()),rootNode.children.forEach((child,index2)=>{child.walk(node=>{let fill;const color=colors[node.index];color!=null&&(fill=colorScale==null?void 0:colorScale.convert(color)),fill??(fill=fills==null?void 0:fills[index2%fills.length]),node.fill=fill,node.stroke=colorScale==null?strokes==null?void 0:strokes[index2%strokes.length]:"rgba(0, 0, 0, 0.2)"})}),this.rootNode=rootNode,this.maxDepth=maxDepth,this.colorDomain=colorDomain})}update(_0){return __async(this,arguments,function*({seriesRect}){yield this.updateSelections(),yield this.updateNodes();const animationData=this.getAnimationData();this.checkResize(seriesRect)&&this.animationState.transition("resize",animationData),this.animationState.transition("update",animationData)})}resetAllAnimation(data){var _a201;const datum=(_a201=this.animationResetFns)==null?void 0:_a201.datum;this.ctx.animationManager.stopByAnimationGroupId(this.id),datum!=null&&resetMotion(data.datumSelections,datum)}animateEmptyUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateWaitingUpdateReady(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animateReadyHighlight(data){var _a201;const datum=(_a201=this.animationResetFns)==null?void 0:_a201.datum;datum!=null&&resetMotion([data],datum)}animateReadyResize(data){this.resetAllAnimation(data)}animateClearingUpdateEmpty(data){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(data)}animationTransitionClear(){this.animationState.transition("clear",this.getAnimationData())}getAnimationData(){return{datumSelections:[this.groupSelection]}}isProcessedDataAnimatable(){return!0}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(legendType){const{colorKey,colorName,colorRange,visible}=this.properties;return legendType==="gradient"&&colorKey!=null&&colorRange!=null?[{legendType:"gradient",enabled:visible,seriesId:this.id,colorName,colorRange,colorDomain:this.colorDomain}]:[]}getDatumIdFromData(node){return`${node.index}`}getDatumId(node){return this.getDatumIdFromData(node)}},__name(_a199,"HierarchySeries"),_a199),_a200,HierarchySeriesProperties=(_a200=class extends SeriesProperties{constructor(){super(...arguments),this.childrenKey="children",this.fills=Object.values(DEFAULT_FILLS),this.strokes=Object.values(DEFAULT_STROKES)}},__name(_a200,"HierarchySeriesProperties"),_a200);__decorateClass([Validate(STRING)],HierarchySeriesProperties.prototype,"childrenKey",2);__decorateClass([Validate(STRING,{optional:!0})],HierarchySeriesProperties.prototype,"sizeKey",2);__decorateClass([Validate(STRING,{optional:!0})],HierarchySeriesProperties.prototype,"colorKey",2);__decorateClass([Validate(STRING,{optional:!0})],HierarchySeriesProperties.prototype,"colorName",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],HierarchySeriesProperties.prototype,"fills",2);__decorateClass([Validate(COLOR_STRING_ARRAY)],HierarchySeriesProperties.prototype,"strokes",2);__decorateClass([Validate(COLOR_STRING_ARRAY,{optional:!0})],HierarchySeriesProperties.prototype,"colorRange",2);var __FORCE_MODULE_DETECTION2=0;export{AgCharts as A};
//# sourceMappingURL=ag-charts-community-BzVcA-B_.js.map
